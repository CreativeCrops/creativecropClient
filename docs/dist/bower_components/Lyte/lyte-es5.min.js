function ReplaceWith(e){var t=this.parentNode,r=arguments.length,o=+(t&&"object"==typeof e);if(t){for(;r-- >o;)t&&"object"!=typeof arguments[r]&&(arguments[r]=document.createTextNode(arguments[r])),t||!arguments[r].parentNode?t.insertBefore(this.previousSibling,arguments[r]):arguments[r].parentNode.removeChild(arguments[r]);o&&t.replaceChild(this,e)}}[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(e){e.hasOwnProperty("after")||Object.defineProperty(e,"after",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),t=document.createDocumentFragment();e.forEach(function(e){var r=e instanceof Node;t.appendChild(r?e:document.createTextNode(String(e)))}),this.parentNode.insertBefore(t,this.nextSibling)}})}),Element.prototype.replaceWith||(Element.prototype.replaceWith=ReplaceWith),CharacterData.prototype.replaceWith||(CharacterData.prototype.replaceWith=ReplaceWith),DocumentType.prototype.replaceWith||(DocumentType.prototype.replaceWith=ReplaceWith),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-e.length,t)===e});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Lyte={version:"2.0.0",$:{},registeredMixins:{},Mixin:{},debug:!1,performance:!1,toBeRegistered:[]};var consoleTime=[];Lyte.$.assetsDiv=document.createElement("div"),Lyte.$.assetsDiv.setAttribute("id","lyteAssetsDiv"),document.head.appendChild(Lyte.$.assetsDiv),Lyte.registerErrorCodes=function(e){Object.assign(Lyte.errorCodes,e)},Lyte.getErrorMessage=function(e){var t=Array.from(arguments).slice(1);return Lyte.errorCodes[e]?Lyte.errorCodes[e].replace(/{(\d+)}/g,function(e,r){return t[r]}):e},Lyte.error=function(){var e=arguments[0].stack||Error(Lyte.getErrorMessage.apply(Lyte,arguments));Lyte.onerror&&Lyte.onerror.call(this,e),Lyte.triggerEvent("error",e),console.error.call(console,e)},Lyte.warn=function(){var e=arguments[0].stack||Error(Lyte.getErrorMessage.apply(Lyte,arguments));console.warn.call(console,e)},Lyte.Mixin.register=function(e,t){Lyte.registeredMixins[e]=t},Lyte.Mixin.exists=function(e){return!!Lyte.registeredMixins[e]||(Lyte.error("Mixin used before being registered."),!1)},Lyte.log=function(e,t){Lyte.debug&&console.log((t?"%c":"")+e,"color:"+t)},Lyte.time=function(e){var t;Lyte.performance&&(-1!=(t=consoleTime.indexOf(e))?(consoleTime.splice(t,1),console.timeEnd(e)):(consoleTime.push(e),console.time(e)))},Lyte.isRecord=function(e){return!!(e&&e.$&&e.$.hasOwnProperty("isModified"))},Lyte.isComponent=function(e){return!!(e&&e.$node&&e.__data)};var reqFiles={};function domContentLoaded1(){var e=Lyte.toBeRegistered;if(e.length){for(var t=0;t<e.length;t++)customElements.define(e[t].name,e[t].def);Lyte.toBeRegistered=[]}}Lyte.injectResources=function(e,t,r){var o=[],n=[];return t=t||function(){},r=r||function(){},new Promise(function(r){!function e(r,i){if(r){Array.isArray(r)||(r=[r]),r.length||i();var a=-r.length;r.forEach(function(r){"string"==typeof r?function(e,r,i){reqFiles[e]?reqFiles[e].push(i):(reqFiles[e]=[i],r&&"error"!=r.event.type?(-1!=Lyte.removeFromCache.arr.indexOf(e)&&Lyte.removeFromCache.arr.splice(Lyte.removeFromCache.arr.indexOf(e),1),c.call(r.tag,r.event,!0),i()):function(e,t){var r,i=e.split("."),a=i[i.length-1];if(r=document.createElement({js:"script",css:"link"}[a]),1==i.length)return void Lyte.error("Type of file is not specified in injectResources.");"css"==a?(r.setAttribute("href",e),r.setAttribute("type","text/css"),r.setAttribute("rel","stylesheet")):r.setAttribute("src",e);r.onerror=r.onload=function(e){"error"==e.type?n.push(e):o.push(e),t&&t.call(this,e)},document.getElementById("lyteAssetsDiv").appendChild(r)}(e,function(r){reqFiles[e].forEach(function(e){e()}),c.call(this,r),t.call(this,r)}))}(r,Lyte.injectResources.availableTags[r],function(){s()}):Array.isArray(r)?new Promise(function(t){e(r,t)}).then(function(){s()}):new Promise(function(t){e(r.parent,t)}).then(function(){new Promise(function(t){e(r.child,t)}).then(function(){s()})})})}else i();function s(){0==++a&&i()}function c(e,t){var r=this.getAttribute("src")||this.getAttribute("href");delete reqFiles[r],t||(Lyte.injectResources.availableTags[r]&&Lyte.injectResources.availableTags[r].tag.remove(),this.onerror=this.onload=void 0,Lyte.injectResources.availableTags[r]={tag:this,event:{type:e.type}})}}(e,r)}).then(function(){r(o,n)})},Lyte.injectResources.availableTags=[],Lyte.removeFromCache=function(e){Lyte.removeFromCache.assign(e),Lyte.removeFromCache.arr.length&&(Lyte.removeFromCache.arr.forEach(function(e){Lyte.injectResources.availableTags[e]&&(Lyte.injectResources.availableTags[e].tag.remove(),delete Lyte.injectResources.availableTags[e])}),Lyte.removeFromCache.arr=[])},Lyte.removeFromCache.arr=[],Lyte.removeFromCache.assign=function(e){e="*"==e?Object.keys(Lyte.injectResources.availableTags):Array.isArray(e)?e:[e],Lyte.removeFromCache.arr=Lyte.removeFromCache.arr.concat(e)},Lyte.checkProperty=function(e,t,r,o,n,i){switch(e){case"type":if(Lyte.Transform.hasOwnProperty(o)){if(Array.isArray(t)){if("array"!=Lyte.Transform[o].extends)return{code:"ERR03",message:Lyte.errorCodes.ERR03,expected:o}}else if(Lyte.Transform[o].extends!=(void 0===t?"undefined":_typeof(t)))return{code:"ERR03",message:Lyte.errorCodes.ERR03,expected:o}}else if(void 0!==t)if(Array.isArray(t)){if("array"!=o)return{code:"ERR03",message:Lyte.errorCodes.ERR03,expected:o}}else if(o!=(void 0===t?"undefined":_typeof(t)))return{code:"ERR03",message:Lyte.errorCodes.ERR03,expected:o};break;case"mandatory":if(void 0==t||null==t||""==t)return{code:"ERR02",message:Lyte.errorCodes.ERR02};break;case"maximum":if("number"==typeof t&&t>o)return{code:"ERR04",message:Lyte.errorCodes.ERR04,expected:o};break;case"minimum":if("number"==typeof t&&t<o)return{code:"ERR05",message:Lyte.errorCodes.ERR05,expected:o};break;case"maxLength":case"maxItems":if(t&&t.length>o)return{code:"ERR06",message:Lyte.errorCodes.ERR06,expected:o};break;case"minLength":case"minItems":if(t&&t.length<o)return{code:"ERR07",message:Lyte.errorCodes.ERR07,expected:o};break;case"pattern":if(t&&"string"==typeof t&&!new RegExp(o).test(t))return{code:"ERR08",message:Lyte.errorCodes.ERR08,expected:o};break;case"uniqueItems":if(Array.isArray(t)&&o)for(var a=[],s=0;s<t.length;s++){var c=t[s];if(-1!=a.indexOf(c))return{code:"ERR09",message:Lyte.errorCodes.ERR09};a.push(c)}break;case"constant":if(Array.isArray(t)){if(!(l=t.length==o.length&&t.every(function(e,t){return e===o[t]})))return{code:"ERR10",message:Lyte.errorCodes.ERR10,expected:o}}else if("object"==(void 0===t?"undefined":_typeof(t))){if(!(l=store.adapter.$.compareObjects(t,o)))return{code:"ERR10",message:Lyte.errorCodes.ERR10,expected:o}}else if(t&&t!=o)return{code:"ERR10",message:Lyte.errorCodes.ERR10,expected:o};break;case"items":if(Array.isArray(t))for(s=0;s<t.length;s++)for(var e in o){if(1!=(l=Lyte.checkProperty(e,t[s],s,o[e])))return l}break;case"properties":if("object"==(void 0===t?"undefined":_typeof(t))&&!Array.isArray(t))for(var r in t)for(var e in o){if(1!=(l=Lyte.checkProperty(e,t[r],r,o[e])))return l}break;case"validation":var l;if(1!=(l=Lyte.customValidator[o].apply(n,[r,t])))return l}return!0},Lyte.types=["string","object","number","boolean","array"],Lyte.attr=function(e,t){var r={};if(r.type=e,void 0==t&&(t={}),-1==this.types.indexOf(e)&&!Lyte.Transform.hasOwnProperty(e))throw new Error("Not a valid field type - "+e);return Object.assign(r,t),r},Lyte.defineRelation=function(e,t,r){var o={type:"relation",relType:t,relatedTo:e};return r&&(o.opts=r),o},Lyte.belongsTo=function(e,t){return this.defineRelation(e,"belongsTo",t)},Lyte.hasMany=function(e,t){return this.defineRelation(e,"hasMany",t)},Lyte.Transform={},Lyte.customValidator={},Lyte.registerDataType=function(e,t){if(this.Transform.hasOwnProperty(e))throw new Error("Custom Field Type - "+e+" -  already exists.");if(void 0==t.extends||-1==Lyte.types.indexOf(t.extends))throw new Error("Not a valid field type - "+t.extends);this.Transform[e]=t},Lyte.registerValidator=function(e,t){if(this.customValidator.hasOwnProperty(e))throw new Error("Custom Validator with name - "+e+" - already exists");this.customValidator[e]=t},Lyte.patterns={email:/^([A-Za-z0-9._%\-'+/]+@[A-Za-z0-9.-]+\.[a-zA-Z]{2,22})$/,url:/(^(ht|f)tp(s?):\/\/[0-9a-zA-Z][-.\w]*(:[0-9])*(\/?)([a-zA-Z0-9\-.?,:'/\\+=&amp;%$#_[\]@!()*;~]*)?$)/,ampm:/^(AM|PM|am|pm)$/,hour:/^(0?[0-9]|1[0-9]|2[0-4])$/,minute:/^(0?[0-9]|[1-5][0-9]|60)$/,boolean:/^(true|false|TRUE|FALSE)$/,alphaNumeric:/([a-zA-Z0-9])+/,alphabetsOnly:/([a-zA-Z])+/,numeric:/([0-9])+/,phoneNo:/^[0-9a-zA-Z+.()\-;\s]+$/},Lyte.validate=function(e,t,r,o){var n=o.__data[t],i=!1,a=n?n.type:void 0;for(var s in n)if(!0!==(i=Lyte.checkProperty(s,r,t,n[s],e,a)))return i;return!1},Lyte.registerPattern=function(e,t){this.patterns[e]=t},Lyte.errorCodes={ERR01:"Primary key cannot be modified",ERR02:"Mandatory field cannot be empty",ERR03:"Type of value does not match the specified data type",ERR04:"Value is greater than the maximum value allowed",ERR05:"Value is less than the minimum value allowed",ERR06:"Length of string/array is greater than the maximum limit allowed",ERR07:"Length of string/array is less than the minimum limit allowed",ERR08:"String does not match the specified pattern",ERR09:"Values in array are not unique",ERR10:"Value is not equal to the specified constant",ERR11:"Model of related field is not defined",ERR12:"Model of backward relation is not defined",ERR13:"Record not found",ERR14:"Model does not match the related field model",ERR15:"Error in creating a record as a relation",ERR16:"Record with primary key already exists",ERR17:"Value cannot be changed because record has been deleted",ERR18:"Action not defined",ERR19:"Model not defined",ERR20:"Key not specified",ERR21:"'belongsTo' relationship expects a single object/id",ERR22:"Type not specified for polymorphic relation",ERR23:"Primary Key value not present",ERR24:"Error while relating record",ERR25:"Backward relation not present"},Lyte.registeredGlobalEvents={},Lyte.triggerEvent=function(){var e=Array.prototype.slice.call(arguments,1),t=arguments[0],r=!1,o=this.registeredGlobalEvents[t];if(o)for(var n=0;n<o.listeners.length;n++){var i=o.listeners[n];if(i)if(!1===i.apply(this,e)){r=!0;break}}else o=this.registeredGlobalEvents[t]={listeners:[]};var a=new CustomEvent(t,{detail:e});r||document.dispatchEvent(a)},Lyte.addEventListener=function(e,t){if("function"==typeof t){var r=this.registeredGlobalEvents[e];return r||(r=this.registeredGlobalEvents[e]={listeners:[]}),e+"-"+(r.listeners.push(t)-1)}Lyte.error("Second parameter to LyteComponent.addGlobalEventListener() must be a function")},Lyte.removeEventListener=function(e){if(e){var t=e.split("-"),r=this.registeredGlobalEvents[t[0]];r&&r.listeners[t[1]]?r.listeners[t[1]]=null:Lyte.error("No such listener registered")}else Lyte.error("listener unique id not specified")},Lyte.deepCopyObject=function(e){for(var t,r,o,n,i,a,s=[{source:e,target:Array.isArray(e)?[]:Object.create(Object.getPrototypeOf(e))}],c=[e],l=s[0].target,y=[l];t=s.shift();)for(r=Object.getOwnPropertyNames(t.source),o=0;o<r.length;o++)(n=Object.getOwnPropertyDescriptor(t.source,r[o])).value&&"object"==_typeof(n.value)?(i=n.value,n.value=Array.isArray(i)?[]:i instanceof Set?new Set:Object.create(Object.getPrototypeOf(i)),-1==(a=c.indexOf(i))?(c.push(i),y.push(n.value),Object.defineProperty(t.target,r[o],n),s.push({source:i,target:n.value})):(n.value=y[a],Object.defineProperty(t.target,r[o],n))):Object.defineProperty(t.target,r[o],n);return l},Lyte.resolvePromises=function(e){if("string"==typeof e)return e;if(Array.isArray(e))return function(e){var t=[],r=!1;if(e.every(function(e,t){return!(e instanceof Promise&&(r=!0,1))}),!r)return e;return new Promise(function(r,o){Promise.all(e).then(function(o){e.forEach(function(e,r){t[r]=o[r]}),r(t)},function(e){o(e),Lyte.error(e)})})}(e);if("object"==(void 0===e?"undefined":_typeof(e)))return function(e){var t=[],r=[],o=Object.keys(e);if(o.forEach(function(o){var n=e[o];n instanceof Promise&&(t.push(o),r.push(n))}),r.length){var n={},i=new Promise(function(i,a){Promise.all(r).then(function(r){o.forEach(function(o){-1!=t.indexOf(o)?n[o]=r[t.indexOf(o)]:n[o]=e[o]}),i(n)},function(e){a(e),Lyte.error(e)})});return i}return e}(e)},Lyte.createCustomElement=function(e,t){var r=t.constructor;delete t.constructor,this.defProperty=function(e,t,r){var o={};r.get&&(o.get=r.get),r.set&&(o.set=r.set),Object.defineProperty(e,t,o)};var o=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r&&r.apply(e,Array.from(arguments)),e}return _inherits(t,HTMLElement),t}(),n=t.static;if(n){for(var i in n)"object"===_typeof(n[i])?this.defProperty(o,i,n[i]):Object.defineProperty(o,i,{value:n[i]});delete t.static}for(var i in t)"object"===_typeof(t[i])?this.defProperty(o.prototype,i,t[i]):Object.defineProperty(o.prototype,i,{value:t[i]});t.static=n[i],t.constructor=r,"complete"===document.readyState||"interactive"===document.readyState?customElements.define(e,o):Lyte.toBeRegistered.push({name:e,def:o})},"complete"===document.readyState||"interactive"===document.readyState?domContentLoaded1():document.addEventListener("DOMContentLoaded",function(e){domContentLoaded1()},!0);"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function e(t){t.lyteRouter=function r(n){function o(e,t){return t=t||Z,{queryParams:t.routeInstances[e].__lp.queryParams,dynamicParam:t.routeInstances[e].__lp.dynamicParam}}function i(e){var r=e.replace?"replaceState":"pushState",n=e.url?le.history?S(v(e.url,!0)):"#"+S(e.url):void 0;return e.title=e.title||document.title,n?t.history[r](e.state,e.title,n):t.history[r](e.state,e.title),e}function a(e){return{meta:{matched:e.matched,index:e.replace&&history.state&&history.state.meta?history.state.meta.index:fe?history.length-1:history.length},data:e.data}}function s(e){return se.history||_(),se.history.fromHistory=!!e.fromHistory&&((se.history.index=e.state.meta.index)<history.length-1?"back":"forward"),me=!0,se.history.state=history.state?history.state.data:{},se.history.initial=fe,se.history}function u(e,t){var r=ue,n=e.length-1;e.forEach(function(e,o){n===o?r[e]?r[e].__lp=t:r[e]={__lp:t}:r[e]||(r[e]={}),r=r[e]})}function c(){var e=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,HTMLElement),_createClass(t,[{key:"attributeChangedCallback",value:function(e,t,r){if(this.hasAttribute("lyte-rendered")&&this._linkCreated){var n=this.children[0];"lt-prop"===e?(this.handleLtProp(),this.hasAttribute("lt-prop-custom")||this.setCustomAttributes(n,!0),this.pendingCallback||(this.pendingCallback=!0,setTimeout(function(){this.pendingCallback=!1,this.getMatchedObject()}.bind(this),0)),"A"===n.tagName&&this.constructHref(n)):/^(lt-prop-route|lt-prop-fragment|lt-prop-dp|lt-prop-qp)$/.test(e)?(this.getMatchedObject(),"A"===n.tagName&&this.constructHref(n,e,t,r)):this.hasAttribute("lt-prop-custom")||n.setAttribute(e.substring(8),r)}}},{key:"connectedCallback",value:function(){if(this.ltProp=this.ltProp||{},this.hasAttribute("lyte-rendered"))return this._linkCreated=!0,void this.getMatchedObject();this.handleLtProp();var e=void 0;if(this.hasAttribute("lt-prop-custom")||this.ltProp.custom)this.getMatchedObject(),"A"===this.children[0].tagName&&this.constructHref(this.children[0]);else{e=document.createElement("a");for(var t=this.childNodes.length,r=0;r<t;r++)e.appendChild(this.childNodes[0]);this.setCustomAttributes(e),this.getMatchedObject(),this.constructHref(e),this.appendChild(e)}this.setAttribute("lyte-rendered",""),LyteComponent?this._linkToEventId=LyteComponent.addLyteEventListener(this,"click",function(e){l(e,this)},this):this.addEventListener("click",l),this._linkCreated=!0}},{key:"modifyLinkToTagsInRoute",value:function(e){var t=ue,r=e&&1!=e?e:this.matched.route;r?(r=h(r)).forEach(function(r){if(!(t=k(r,t))||!t.__lp)return Error(H(422,this.matched.target)),!1;var n=t.__lp.__lp;e?n.linkTags.splice(n.linkTags.indexOf(this),1):n.linkTags.push(this)}.bind(this)):U(498,"route","link-to")}},{key:"disconnectedCallback",value:function(){this._linkToEventId&&!LyteComponent.ignoreDisconnect&&(this.modifyLinkToTagsInRoute(!0),LyteComponent.removeLyteEventListener(this,this._linkToEventId))}},{key:"handleLtProp",value:function(){var e=this.getAttribute("lt-prop");if(e)try{var t=JSON.parse(e);this.ltProp=t}catch(e){console.warn("Error while parsing ltProp in link-to")}}},{key:"setCustomAttributes",value:function(e,t){for(var r in this.ltProp)/^(id|class|style|target)$/.test(r)&&e.setAttribute(r,this.ltProp[r]);if(!t)for(var n=this.attributes,o=0;o<n.length;o++){var i=n[o].nodeName;"lt-prop"!==i&&/^(lt-prop-id|lt-prop-class|lt-prop-style|lt-prop-target)$/.test(i)&&e.setAttribute(i.substring(8),n[o].nodeValue)}}},{key:"constructHref",value:function(e,t,r,n){var o=void 0;(o=se.getURL(this.matched))&&(e.setAttribute("href",o),t?"lt-prop-route"==t?(this.modifyLinkToTagsInRoute(r),this.modifyLinkToTagsInRoute()):(this.modifyLinkToTagsInRoute(this.matched.route),this.modifyLinkToTagsInRoute()):this.modifyLinkToTagsInRoute())}}],[{key:"observedAttributes",get:function(){return["lt-prop-route","lt-prop-dp","lt-prop-fragment","lt-prop-qp","lt-prop","lt-prop-class","lt-prop-id","lt-prop-rel","lt-prop-title","lt-prop-style","lt-prop-target"]}}]),t}();e.prototype.getMatchedObject=function(e){var t=e?{}:this.matched?this.matched:{};t.route=this.getAttribute("lt-prop-route")||this.ltProp.route,t.fragment=this.getAttribute("lt-prop-fragment");var r=this.getAttribute("lt-prop-dp")||this.ltProp.dp||[],n=this.getAttribute("lt-prop-qp")||this.ltProp.qp||{};if(r instanceof Array)t.dynamicParams=[];else try{t.dynamicParams=JSON.parse(r)||[]}catch(e){return U(498,"dynamicParams","link-to"),void(t.dynamicParams=[])}if(n instanceof Object)t.queryParams={};else try{t.queryParams=JSON.parse(n)}catch(e){U(498,"queryParams","link-to"),t.queryParams={}}return this.matched=t},customElements.define("link-to",e)}function l(e,t){if(2!=e.button&&!e.defaultPrevented){var r=t||e.currentTarget;if("A"!==r.children[0].tagName||!(1==e.ctrlKey||1==e.metaKey||2==e.which||r.children[0].hasAttribute("target")&&"_self"!==r.children[0].getAttribute("target"))){e.preventDefault();var n,o=se.getRouteInstance().transition;n=o&&se.checkIfSameRoute(r.matched,o.info)&&r.hasAttribute("lt-prop-refresh-route")?se.getRouteInstance(r.getAttribute("lt-prop-refresh-route")).refresh():se.transitionTo(r.matched);var i={};if(r.getAttribute("lt-prop-trans"))try{i=JSON.parse(r.getAttribute("lt-prop-trans"))}catch(e){U(498,"lt-prop-trans","link-to")}var a=r.getAttribute("lt-prop-td");if(a=a||i.data){if("string"==typeof a)try{a=JSON.parse(a)}catch(e){U(498,"lt-prop-td","link-to")}i.data=a}for(var s in i)n[s]=i[s]}}}function h(e){return e.split(".").filter(function(e){return""!=e})}function d(e){return void 0!=e}function f(e){Lyte.time("parseRouteMapping");var t={},n={},o=[],i=[];return oe={route:function(e,a,s){if("object"==(void 0===a?"undefined":_typeof(a)))if(a.path||(a.path=S(e)),j(a.path,"?")){var u=a.path.split("?");a.defQP=r.frameQueryParams(u[1]),a.path=u[0]}else a.queryParams&&(a.defQP=a.queryParams,delete a.queryParams);else"function"==typeof a&&(s=a),a={path:S(e)};if("/"==a.path)n=k(o,he)[a.path]={__lp:{}},o.push("/");else{var c=a.path;n=k(o,he)[a.path]={__lp:{}},B(c)||$(c)?N(c).every(function(e,t,r){if(B(e))return a.dynamicKey=n.__lp.dynamicKey=e.replace(":",""),a.dynamicIndex=n.__lp.dynamicIndex=t,!1;if($(e)){a.dynamicKey=n.__lp.dynamicKey=e.replace("*",""),a.dynamicIndex=n.__lp.dynamicIndex=t,a.wildcard=n.__lp.wildcard=!0,a.sufix=n.__lp.sufix=[];for(var o=t+1;o<r.length;o++)n.__lp.sufix.push(r[o]);return!1}return!0}):a.dynamicKey=n.__lp.dynamicKey=void 0,o.push(c)}i.push(e),n.__lp.route=Array.from(i);var l=t;i.forEach(function(e,t){t+1!=i.length&&(l=l[e])}),l[e]={__lp:a},s&&s.call(this,{}),i.pop(),o.pop()}},e.call(oe,{}),Lyte.time("parseRouteMapping"),t}function p(e){if(e){if("object"==(void 0===e?"undefined":_typeof(e))){var t;Y={replace:e.replace,title:Z?Z.title:document.title,fromHistory:!1},t=G(e),Lyte.log("Transitioning to "+e.route.join(".")+" "+t,de)}else U(498,JSON.stringify(e));return Z.routeTrans}U(499)}function m(){if(le.history){var e=y(ce.pathname+ce.search+(ce.hash||""));return e=v(e),S(e)}return S(y(ce.hash.replace(/^(#\/|#|\/)/,"")))}function y(e){return e||i({replace:!0,state:a({replace:!0,data:history.state&&history.state.data||void 0}),url:e="/"}),e}function v(e,t){var r=le.baseURL;if(r&&e){if(r=S(le.baseURL),0==e.indexOf(r)&&!t)return e.replace(r,"");if(t&&-1==e.indexOf(r))return r+e}return e}function g(e){if(e){e.route&&!Array.isArray(e.route)&&(e.route=h(e.route));var t,r=!!Z,n=ue,o=le.routes,i="";return e.route.forEach(function(t,a){r&&Z&&Z.matched.route[a]!=t&&(r=!1);var s=e.route.slice(0,a+1);if(o=k(t,o),n=k(t,n),!o&&!o.__lp)return U(422,s.join(".")),!1;var u=o.__lp.path;if(n&&n.__lp){if(n.__lp.queryParams){var c=o.__lp.defQP,l=n.__lp.__lp.queryParamsDef;for(var h in l)e.queryParams.hasOwnProperty(h)||(r&&l[h].sticky?e.queryParams[h]=n.__lp.__lp.queryParams[h]:c&&c.hasOwnProperty(h)&&(e.queryParams[h]=c[h])),l[h].refreshModel&&(e.refreshModel=!0)}}else if(c=o.__lp.defQP)for(var h in c)e.queryParams&&!e.queryParams.hasOwnProperty(h)&&(e.queryParams[h]=c[h]);if(o.__lp.dynamicKey){var d=N(u);if(!e.dynamicParams||void 0==e.dynamicParams[a])return U(499,t),!1;d[o.__lp.dynamicIndex]=encodeURI(e.dynamicParams[a]),i+=S(d.join("/"))}else i+=S(u)}.bind(this)),i="/"==i[i.length-1]&&1!=i.length?i.slice(0,-1):i,t=Object.keys(e.queryParams).filter(function(t){return void 0!=e.queryParams[t]&&t}),e.queryParams&&t.length&&(i+="?",t.forEach(function(r,n){i+=r+"="+encodeURIComponent(e.queryParams[r])+(n<t.length-1?"&":"")})),le.history&&e.fragment&&(i=i+"#"+e.fragment),F(i)}}function _(){function e(){return this}function t(e,t,r,n){i({state:{meta:n?history.state.meta:history.state.meta+1,data:e},title:t,url:r})}se.history=new e,Object.defineProperty(e.prototype,"state",{get:function(){return history.state.data},set:function(e){return me?me=!1:console.warn("setting on data will not be pushed to history. If needed, use `Lyte.Router.history.replaceState`."),e}}),e.prototype.replaceState=function(){t.apply(Array.from(arguments).push(!0))},e.prototype.pushState=function(){t.apply(Array.from(arguments))}}function P(e,t){Lyte.time("RouteTransition"),Z&&(Z.routeTrans.state&&102==Z.routeTrans.state||ee&&Z!=ee)&&(clearTimeout(ie),Z.abort({state:409,internalAbort:!0})),(t=t||(!fe&&history.state&&history.state.meta&&history.state.meta.matched?Q(history.state.meta.matched):K(e)))&&t.matched.route.length&&(t.prevTrans=t.prevTrans||ee,R(e,t),ie=setTimeout(function(){Lyte.time("constructRunLoop"),t.previous=!0,Z.runLoop=T(ae=t),Y&&Z.routeTrans.data&&(Y.data=Z.routeTrans.data),Z.running=!0,Z.run(),Lyte.time("constructRunLoop")},0))}function b(e,t,r){function n(e){var r=!0;return!i.queryParams&&!i.__lp.dynamicParam||(!i.__lp.dynamicParam||h.dynamicParams[e]==t.dynamicParams[e])&&(i.queryParams&&i.queryParams.every(function(e){return!r||!i.__lp.queryParamsDef[e].refreshModel||!t.queryParams&&!h.queryParams||t.queryParams[e]==h.queryParams[e]||(r=!1)}),r)}var o,i,a=!0,s=!0,u=[],c=[],l=[];if(e){var h=e.matched;if(t.route.forEach(function(t,d){s&&t==h.route[d]?(i=r?r[d]:se.__lp.getDefinition(t.slice(0,d)),a&&n(d)?(e.routeInstances[d].__lp.rendered?u.push(t):(a=!1,l.push(t)),c.push(t)):(a=!1,l.push(t))):(s=!1,void 0==o&&e.routeInstances[d]&&e.routeInstances[d].__lp.rendered&&(o=d),l.push(t))}),h.route.length>t.route.length){var d=t.route.length;void 0==o&&e.routeInstances[d].__lp.rendered&&(o=d)}}else l=l.concat(t.route);return{rendered:u,unRendered:l,common:c,templateToRemove:o}}function T(e){var t=e.transComparison||b(ee,e.matched,e.currentRoutes),r=[],n={beforeModel:[],model:[],afterModel:[]},i=[],a=[],s=[],u=[];if(e.previous){var c=[{hook:"beforeRouteTransition"}];if(ee){for(var l=ee.matched.route.length-1;l>=0;l--)ee.matched.route[l]&&ee.matched.route[l]!=Z.matched.route[l]&&a.push({hook:"beforeExit",index:l}),s.push({hook:"willTransition",index:l});return{previous:s.concat(a.concat(c)),current:[],forceFetch:[]}}return{previous:c,current:[],forceFetch:[]}}return t.rendered&&t.rendered.length&&t.rendered.forEach(function(e,t){Z.routeInstances[t].__lp.rendered=!0,r.push({hook:"redirect",index:t}),u.push({hook:"didTransition",index:Z.matched.route.length-t-1})}),t.unRendered&&t.unRendered.length&&t.unRendered.forEach(function(a,s){s=t.rendered.length+s,t.executed&&t.executed.index==s?"getResources"==t.executed.hook&&i.push({hook:"getDependencies",index:s}):(i.push({hook:"getResources",index:s}),i.push({hook:"getDependencies",index:s}));var c=Z.routeInstances[s];if("function"==typeof c.forceFetch?E.call(this,c.forceFetch,c,"forceFetch",o(s)):c.forceFetch)["beforeModel","model","afterModel"].forEach(function(e){n[e].push({hook:e,index:s})}),e.currentRoutes[s]._fetchStatus="pending",["redirect","renderTemplate","afterRender"].forEach(function(e){r.push({hook:e,index:s})});else{var l=!1;ve.forEach(function(e){t.executed&&t.executed.index==s?(t.executed.hook==e||l)&&("redirect"==e&&r.push({hook:e,index:s}),l?r.push({hook:e,index:s}):l=!0):r.push({hook:e,index:s})})}u.push({hook:"didTransition",index:Z.matched.route.length-s-1})}),r={previous:[],current:i.concat(r).concat(u),forceFetch:n},r.templateToRemove=ee&&ee.runLoop.templateToRemove?ee.runLoop.templateToRemove:[],void 0!=t.templateToRemove&&r.templateToRemove.push({index:t.templateToRemove,routeInstances:ee.routeInstances}),r}function R(e,t){se.__lp.trans=Z=new x(t),Z.url=e,Z.runLoop={previous:[],current:[],forceFetch:[]},Z.routeTrans=J(Z),Z.routeInstances=r.initRoute(t),ne?(Y=ne,Z.routeTrans.data=history.state?history.state.data:{},ne.replace=!0,ne=void 0):Z.routeTrans.data&&se.history.replaceState(Z.routeTrans.data)}function k(e,t){if(t)return e?(Array.isArray(e)||"string"!=typeof e||(e=h(e)),e.every(function(e){return t&&t[e]?(t=t[e],!0):t=!1}),t):t;U(H(498))}function L(e){e.runningPromise&&e.runningPromise.reject("aborted"),e.forcedRunningPromise&&e.forcedRunningPromise.reject("aborted")}function x(e){this.matched=e.matched,this.target=e.matched.target,this.timeouteFns=[],this.info={route:e.matched.target,queryParams:e.matched.queryParams,dynamicParams:e.matched.dynamicParams.filter(d)},e.matched.fragment&&(this.info.fragment=e.matched.fragment),this.currentRoutes=e.currentRoutes,this.aborted=this.paused=!1,this.abort=function(e){this.aborted||(L(this),this.timeouteFns.forEach(function(e){clearTimeout(e)}),this.aborted=!0,e||(e={state:308}),Lyte.log("Transition aborted.",de),e.internalAbort||(delete this.runLoop.templateToRemove,ee.url!=m()&&201==this.routeTrans.state&&(pe=!0,history.state&&history.state.meta&&void 0!=history.state.meta.index&&history.state.meta.index<history.length?history.go(1):history.go(-1))),D(e))}.bind(this),this.pause=function(){if(!this.paused)return Lyte.log("Transition paused.",de),L(this),this.routeTrans.state=307,this.paused=Z.currentPromise||!0,this.resume=this.routeTrans.resume=function(e){if(e=e||this,delete e.routeTrans.resume,delete e.resume,Lyte.log("Transition resumed.",de),e.paused){if(1!=e.paused){var t=e.paused.state;e.runLoop[t][0]&&e.runLoop[t][0].hook==e.paused.hook&&e.runLoop[t][0].index==e.paused.index&&C(e.runLoop[t],e.paused.hook,e.paused.index)}e.paused=!1,e.routeTrans.state=102,e.run()}}.bind(this),this.routeTrans}.bind(this)}function q(e){var t=e.reqType,r=e.currentRoute,n=e.index,o=Z.currentPromise.hook,i="dependencies"==t?"errorDependencies":"errorResources",a=this;Lyte.injectResources(r.__lp[t],function(){},function(e,s){r.__lp[t+"Loaded"]=!0,s.length?a.aborted||(a.paused||a.pause(),ye.onError.call(a,n,{state:424,error:r.__lp[i]=s,hook:o})):Z.pending&&void 0!=Z.pending[t]&&Z.pending[t]==n&&Z.run()})}function I(e){e.forEach(function(e){for(var t,r=e.routeInstances.length-1;r>=e.index;r--)delete(t=e.routeInstances[r]).__lp.rendered,t.outlet&&(t.component&&(t.component._route=void 0),Lyte.triggerEvent("beforeTemplateDestroy",t.outletName,t),t.outlet.innerHTML="")})}function A(e){return j(_e,e)}function M(e,t){if(e){var r,n=arguments,o=Z.currentPromise.hook,i=A(o),a=this;return Promise.resolve(new Promise(function(s,u){try{var c=e.apply(t,Array.from(n).slice(2));i&&c&&(c=Lyte.resolvePromises(c)),r=Promise.resolve(c)}catch(e){return void w.call(a,i,e,t)}r.then(function(e){s(e)},function(e){U(e),"model"==o&&(t.currentModel=e),w.call(a,i,e,t)})}))}return Promise.resolve()}function E(e,t,r){if(e){var n=A(r);try{return e.apply(t,Array.from(arguments).slice(3))}catch(e){return void w.call(this,n,e,t)}}}function O(e,t,r){var n;if(this.routeInstances[t].actions&&(n=this.routeInstances[t].actions[e]))try{if(0==n.apply(this.routeInstances[t],r))return!1}catch(e){return U(e),!1}}function w(e,t,r){if(Z.currentPromise){var n=Z.currentPromise.hook,o=Z.currentPromise.index;Z.pause(),U(t),e?ye.onError.call(this,o,{state:420,error:t,hook:n}):(U(420,n,r.routeName),j(["willTransition","didTransition","beforeExit"],n)?Z.resume():Z.abort({state:4,internalAbort:!0}))}}function C(e,t,r){for(var n=0;n<e.length;n++){var o=e[n];if(o.hook==t)if(void 0!=r){if(r==o.index){e.splice(n,1);break}}else e.splice(n,1),n--}}function j(e,t){return-1!=e.indexOf(t)}function D(e){if(Z.running){if(Z.running=!1,Z.routeTrans.state&&201!=Z.routeTrans.state&&(se.afterRouteTransition(Z.routeTrans),Z.routeTrans.state=e.state),fe||200==Z.routeTrans.state){if(se.__lp.prevTrans=ee=Z,Lyte.time("RouteTransition"),Lyte.log("Transition completed.",de),le.history&&Z.info.fragment){var t;(t=document.getElementById(Z.routeTrans.info.fragment))&&t.scrollIntoView&&t.scrollIntoView()}}else e.internalAbort||re==Z?se.__lp.prevTrans=ee=Z:se.__lp.trans=Z=ee;fe&&(fe=!1)}}function S(e){return"/"==e[0]?e:"/"+e}function N(e){return e.match(/[^/?]+/g)||[]}function F(e){return e=e.replace(/\/\//g,"/"),e=e.replace(/\/\?/g,"?")}function H(e,t){return"LRE "+e+": "+{400:"url '"+(t=Array.isArray(t)?t:Array.from(arguments).slice(1))[0]+"' is not defined in router.",422:"There is no route definition for the route "+t[0]+".",498:"Invalid argument "+t[0]+(t[1]?" provided in link-to.":"."),499:t[0]?"Dynamic params for the route "+t[0]+" is not provided.":"Transition tried without arguments.",420:"Error on "+t[0]+" of route "+t[1]+".",428:"There is no outlet named "+t[0]+".",203:"Data provided for component is not valid."}[e]}function U(){Lyte.error(arguments[0].stack||1==arguments.length?arguments[0]:H.apply(this,arguments))}function K(e,n){function o(e,n,o,s){var u,c,l={route:k(n,he).__lp.route,queryParams:s?r.frameQueryParams(s):{}};if(le.history&&(l.fragment=a),l.dynamicParams=r.frameDynamicParams(o,l),e)return l;var h=Q(l);return 0!=h&&(u=g(c=Lyte.deepCopyObject(h.matched)),V(c.queryParams,l.queryParams)||(ne=i({replace:!0,data:t.history.state,url:u,fromHistory:!0}))),h}if(e){var a,s=[];if(le.history){var u=e.split("#");u[1]&&(a=u[1],e=u[0])}var c=e.split("?");e=decodeURI(c[0]),e=decodeURI(c[0]);var l=c[1],h=N(e);if("/"==e){if(!k(["/"],he))return void U(400,e);s.push([e])}else{var d,f=function(e,t,r,n,o){if(!n.__lp.wildcard&&!n.__lp.dynamicKey){var i;if((i=k(o,he).__lp)&&i.wildcard&&!(r+=t.slice(r).indexOf(e[0])))return!1}for(var a=0;a<e.length;a++,r++)if(e[a]!=t[r]&&!B(e[a]))if($(e[a]))n.__lp.sufix.length&&(r=t.indexOf(n.__lp.sufix[0])-1);else{if("/"!=e[r])return!1;r--}return r},p=0,m=[0],y=[];y.dynamicParams=[],function e(t){for(var r in t)if(!d){var n,o=t[r];if("__lp"!=r){var i=N(r);if(i&&!1!==(n=f(i,h,p,o,y)))if(m.push(n),p=m[m.length-1],h.length==p){var a=Array.from(y.concat(r));if(o["/"]&&(a=a.concat("/")),s.push(a),!o.__lp.wildcard&&!o.__lp.dynamicKey)return void(d=a);m.pop(),p=m[m.length-1]}else{var u=Object.keys(o);if(y.push(r),h[p])if(o.__lp.wildcard&&!o.__lp.sufix.length&&1==u.length){var c=Array.from(y);o["/"]&&(c=c.concat("/")),s.push(c)}else u.length>1&&e(o);y.pop(),m.pop(),p=m[m.length-1]}}}}(he)}if(d)return o(n,d,e,l);if(1==s.length)return o(n,s[0],e,l);if(s.length){for(var v,_,P=[],b=0;b<s.length;b++)1==s[b].length&&(v=s[b]),P.push(function(e){var t=0;"/"==(e=Array.from(e))[0]&&(t++,e.shift());var r=-1;return e.forEach(function(e,n){N(e).forEach(function(e,n){e==h[++r]&&t++})}),t}(s[b]));if(_=Math.max.apply(Math,P))return o(n,s[P.indexOf(_)],e,l);if(v)return o(n,v,e,l);U(400,e)}else U(400,e)}else U(400,"")}function Q(e){var t=ue,r=le.routes,n=[];e.target="",e._routes=[];try{e.route.every(function(o,i){if(e.target=e.target?e.target+"."+o:o,r=k([o],r),!(t=k([o],t))||!t.__lp)throw Error(H(422,e.target));o=h(e.target);var a=t.__lp;e._routes.push(o),a.queryParams&&(a.__lp.queryParams={},a.queryParams.forEach(function(t){a.__lp.queryParams[t]=e.queryParams[t]})),a.__lp.dynamicParam=e.dynamicParams[i];var s=t.__lp.__lp.linkTags;return s.length&&s.forEach(function(e){"A"===e.firstChild.tagName&&e.firstChild.setAttribute("href",se.getURL(e.getMatchedObject(!0)))}),n.push(a)})}catch(e){return U(e),!1}return{currentRoutes:n,matched:e}}function J(e){var t=new function(e){for(var t in e)-1==be.indexOf(t)&&("info"==t?this.info=deepCopyObject(e[t]):this[t]=e[t])}(e);return t.state=201,t}function B(e){return!!j(e,":")}function $(e){return!!j(e,"*")}function V(e,t){var r=Object.keys(e),n=Object.keys(t);if(r.length!=n.length)return!1;for(var o in e)if(e[o]!=t[o])return!1;return!0}function W(e){if("object"!=(void 0===e?"undefined":_typeof(e))){var t={queryParams:{},dynamicParams:[]};return Array.from(arguments).forEach(function(e,r){Array.isArray(e)?U(498,JSON.stringify(e)):0==r?t.route=e:"object"==(void 0===e?"undefined":_typeof(e))?t.queryParams=e:t.dynamicParams.push(e)}),z(t)}if(e.route)return z(e)}function z(e){if(e.route){var t={route:h(e.route),queryParams:e.queryParams||{},dynamicParams:[],fragment:e.fragment,target:"",_routes:[]},r=e.dynamicParams?Array.from(e.dynamicParams):[];try{t.route.forEach(function(e,n){t.target=t.target?t.target+"."+e:e;var o=h(t.target);t._routes.push(o);var i=k(t.route.slice(0,n+1),le.routes);if(!i)throw Error(H(400,t.target));t.dynamicParams.push(i.__lp.dynamicKey?r.shift():void 0)})}catch(e){return U(e),!1}return t}}function G(e){var t=Y.url=g(e);return P(t,X(Q(e))),t}function X(e){if(ee&&Z.running){var t=b(Z,e.matched,e.currentRoutes);if(Z.currentPromise){var r=Z.currentPromise.hook;if(102==Z.routeTrans.state&&"current"==Z.currentPromise.state&&"didTransition"!=r){Z.abort({state:308,internalAbort:!0});var n=Re.indexOf(Z.currentPromise.hook)<=5?Z.currentPromise.index:Z.currentPromise.index+1;if(t.common.length-1<=n){var o=b(re,e.matched,e.currentRoutes);t.common.length<o.common.length?(Z.runLoop.templateToRemove.length&&Z.runLoop.templateToRemove.pop(),e.prevTrans=re,t=o):Z.currentPromise.index<=t.common.length-1&&(t.executed=Z.currentPromise)}}}e.transComparison=t}else Z.abort({state:308,internalAbort:!0});return e}t._router=e;var Y,Z,ee,te,re,ne,oe,ie,ae,se=this,ue={},ce=document.location,le={queryParamOptions:{}},he={},de="route",fe=!0,pe=!1,me=!1,ye={},ve=["beforeModel","model","afterModel","redirect","renderTemplate","afterRender"],ge={getDependencies:"dependencies",getResources:"resources"},_e=["getResources","getDependencies","beforeModel","model","afterModel"];ye.getResources=ye.getDependencies=function(e,t){var r=this.currentRoutes[t],n=r[e],i=this.routeInstances[t],a=E.call(this,n,i,e,o(t));return r.__lp[ge[e]+"Loaded"]=!n,!n||this.aborted||this.paused||(r.__lp[ge[e]]=a,a&&"getDependencies"==e&&console.log("Requesting files in getDependencies will stall execution of route till download completes. Please validate files before requesting."),q.call(this,{reqType:ge[e],currentRoute:r,index:t})),M()},ye.beforeModel=ye.model=function(e,t){return M.call(this,this.currentRoutes[t][e],this.routeInstances[t],o(t))},ye.afterModel=function(e,t){var r=this.routeInstances[t];return M.call(this,this.currentRoutes[t][e],r,r.currentModel,o(t))},ye.onError=function(e,t){for(U(420,t.hook,this.routeInstances[e].routeName);e>=0&&0!=O.call(this,"onError",e,[t.error,this.routeTrans,o(e),t.hook]);e--);this.paused&&this.abort({state:t.state,internalAbort:!0})},ye.willTransition=function(e,t){return 0==O.call(ee,e,t,[Z.routeTrans])&&C(Z.runLoop.previous,e),M()},ye.beforeRouteTransition=function(){return Y&&!this.aborted&&(Y.state=a({replace:Y.replace,data:Z.routeTrans.data,matched:Z.matched}),se.beforeRouteTransition(ee&&ee.routeTrans||void 0,Z.routeTrans,s(Y)),Z.routeTrans.state=102,Y&&Z.routeTrans.data&&(Y.state.data=Z.routeTrans.data),i(Y),Y=void 0,Z.runningPromise.reject("aborted"),ae.previous=!1,Z.runLoop=T(ae),Z.run()),M()},ye.onBeforeLoad=function(){return Z.beforeLoadCalled=!0,new Promise(function(e,t){for(var r,n=1;n<=Z.matched.route.length;n++)if(r=Z.matched.route.length-n,0==O.call(Z,"onBeforeLoad",r,[o(r)])||n==Z.matched.route.length){e();break}})},ye.redirect=function(e,t){var r=this.routeInstances[t];return M.call(this,this.currentRoutes[t][e],r,r.currentModel,o(t))},ye.afterRender=function(e,t){return this.routeInstances[t].__lp.rendered=!0,new Promise(function(r,n){var i=setTimeout(function(){var i=this.routeInstances[t];M.call(this,this.currentRoutes[t][e],i,i.currentModel,o(t),i.component).then(function(e){r(e)},function(e){n(e)})}.bind(this,e,t),0);this.timeouteFns.push(i)}.bind(this))},ye.didTransition=function(e,t){return new Promise(function(r,n){var i=setTimeout(function(){ye.removeTemplate.call(this,this.runLoop.templateToRemove),0==O.call(this,e,t,[o(t),Z.routeTrans])&&C(Z.runLoop.current,e),r(),0==t&&D({state:200})}.bind(this,e,t),0);this.timeouteFns.push(i)}.bind(this))},ye.beforeExit=function(e,t){var r=ee.routeInstances[t],n=ee.currentRoutes[t][e];return M.call(this,n,r,r.currentModel,o(t,ee))},ye.renderTemplate=function(e,t){function r(e,t){t&&("object"!=(void 0===t?"undefined":_typeof(t))||Array.isArray(t)?w.call(this,!0,Error(H(203)).stack,a):e.setData(t))}function n(e,t){var r;if(t){if(!(r=t.outletName?document.querySelector(t.outletName).querySelector(e):void 0))return n(e,t.parent)}else(r=document.querySelector(e))||U(428,e);return r}var i=this.currentRoutes[t],a=this.routeInstances[t];if(this.runLoop.templateToRemove&&this.currentRoutes.length==t+1&&ye.removeTemplate.call(this,this.runLoop.templateToRemove),this.currentRoutes[t][e]){var s=E.call(this,i[e],a,e,a.currentModel,o(t));if(!this.aborted)if(ye.removeTemplate.call(this,this.runLoop.templateToRemove),re!=this&&(re=this),s&&s.outlet){a.outletName=s.outlet;var u,c=a.currentModel;if(u=n(s.outlet,a.parent))if(s.component){var l;a.component&&a.component.tagName.toLocaleLowerCase()==s.component&&a.outlet==u&&u.contains(a.component)?((l=a.component)._route=a,a.outlet=u,a.component=l,r.call(this,l,c)):(Lyte.triggerEvent("beforeTemplateDestroy",s.outlet,a),u.innerHTML="",(l=document.createElement(s.component))._route=a,a.outlet=u,a.component=l,r(l,c),u.appendChild(l))}else if(s.html){a.component=void 0,a.outlet=u,Lyte.triggerEvent("beforeTemplateDestroy",s.outlet,a),u.innerHTML=s.html;var h=u.getElementsByTagName("script");h.length&&function(e,t){for(var r=0,n=e.length;r<n;r++){for(var o=e[r],i=o.parentNode,a=document.createElement("script"),s=0,u=o.attributes.length;s<u;s++)a.setAttribute(o.attributes[s].name,o.attributes[s].value);a.innerHTML=o.innerHTML,i.appendChild(a),i.removeChild(o)}}(Array.from(h))}}else console.warn("renderTemplate hook should return either component or HTML. Rendering of HTML directly into the DOM within the renderTemplate hook is deprecated.")}return M()},ye.removeTemplate=function(e){this.routeCleared||(this.routeCleared=!0,ee&&e&&I(e),delete this.runLoop.templateToRemove,Lyte.removeFromCache())},this.configureDefaults=function(e){e=e||{},le.history="html5"==e.history,le.baseURL=e.baseURL,le.deferInit=e.deferInit||!1,le.queryParamOptions={sticky:!e.queryParamOptions||!e.queryParamOptions.hasOwnProperty("sticky")||e.queryParamOptions.sticky},this.__lp={version:"2.0.0",config:le,getDefinition:function(e,t){return"*"==e?ue:(t=t||ue,(t=k(e,t))&&t.__lp||void 0)}}},this.configureRoutes=function(e){function r(){!le.deferInit&&se.init&&(se.init(),delete se.init)}this.__lp||this.configureDefaults(),le.routes="function"==typeof e?f.call(this,e):e,"complete"===document.readyState||"interactive"===document.readyState?r():t.addEventListener("DOMContentLoaded",function(){r()})},this.init=function(e){return t.onpopstate=function(e){if(pe)pe=!1;else{var t;if(le.history){if(t=m(),Z&&Z.url==t)return}else t=y((e&&e.newURL||ce.hash).replace(/.*#/,""));ne={fromHistory:!0},e&&history.state&&(ne.data=history.state),P(t)}},le.history?m()&&t.onpopstate():(ne={fromHistory:!0},P(m())),c(),this},this.beforeRouteTransition=this.afterRouteTransition=function(){},this.checkIfSameRoute=function(e,t){if(e.route==t.route&&e.dynamicParams.length===e.dynamicParams.length&&V(e.queryParams,t.queryParams)){if(e.dynamicParams.length)for(var r=0;r<=e.dynamicParams.length;r++)return e.dynamicParams[r]==t.dynamicParams[r];return!0}return!1},this.addRoutes=function(e){console.warn("addRoutes function will be deprecated from next version"),Object.assign(le.routes,f.call(oe,e))},this.replaceWith=function(){var e=W.apply(this,arguments);if(e)return e.replace=!0,p(e)},this.transitionTo=function(){var e;if(e=W.apply(this,arguments))return p(e)},this.getURL=function(){var e,t;return(t=W.apply(this,arguments))&&(e=g(t)),le.history?v(e,!0):"#"+e},this.getRoute=function(e){var t=K(v(e),!0);return t&&(t.dynamicParams=t.dynamicParams.filter(d),t.route=t.route.join(".")),t};var Pe={get:function(e,t){return 0!=e.__lp[t+"Loaded"]}};x.prototype.run=function(){function e(e,t,r,n,o){n=n||function(){},o=o||function(e){"aborted"!=e&&U(e)},new Promise(function(n,o){"nestedForcedPromises"==t?(this.forcedRunningPromise={resolve:n,reject:o},e.call(this,this.runLoop.forceFetch,n)):(this.runningPromise={resolve:n,reject:o},e.call(this,this.runLoop,r,n))}.bind(this)).then(n,o)}function t(e,n,o){function i(e,t,r){for(var n=0;n<e.length;n++){var o=e[n];if(o.index==t)return r?void e.splice(n,1):o}}if(e&&e.beforeModel.length||e.model.length||e.afterModel.length){o=o||e.beforeModel[0];var a=this,s=this.currentRoutes[o.index],u=this.routeInstances[o.index];if(o.state="forced",Z.currentPromise=o,"beforeModel"==o.hook&&!Pe.get(u,"dependencies"))return void(this.pending.dependencies=o.index);r(o),ye[o.hook].call(this,o.hook,o.index).then(function(r){switch(o.hook){case"model":this.routeInstances[o.index].currentModel=r;break;case"afterModel":s._fetchStatus="completed",void 0!=this.pending.forceFetch&&this.pending.forceFetch==o.index&&this.run()}this.forcedRunningPromise.resolve==n&&"afterModel"!=o.hook&&(i(e[o.hook],o.index,!0),t.call(a,e,n,i(e["beforeModel"==o.hook?"model":"afterModel"],o.index)))}.bind(this)),e.beforeModel.length>1&&(i(e[o.hook],o.index,!0),t.call(this,e,n))}}function r(e){var t=e.hook,r=e.index;if("beforeRouteTransition"!=e.hook){var n="previous"==e.state?ee.currentRoutes[r]:Z.currentRoutes[r];Lyte.log(t+" of route "+n.routeName,de,"MediumOrchid")}else Lyte.log(t,de,"MediumOrchid")}function n(o,i,a){var s=o[i];if(s&&s.length){var u=s[0],c=this.currentRoutes[u.index];if(!this.aborted&&!this.paused){if("beforeModel"==u.hook&&!Pe.get(c,"dependencies"))return void(this.pending.dependencies=u.index);if("renderTemplate"==u.hook&&!Pe.get(c,"resources"))return void(this.pending.resources=u.index);if("redirect"==u.hook&&c.forceFetch&&"pending"==c._fetchStatus)return this.forceFetchRunning||(e.call(this,t,"nestedForcedPromises"),this.forceFetchRunning=!0),void(this.pending.forceFetch=u.index);u.state=i,Z.currentPromise=u,r(u),Lyte.time(u.hook+u.index),ye[u.hook].call(this,u.hook,u.index).then(function(e){Lyte.time(u.hook+u.index),"model"==u.hook&&(this.routeInstances[u.index].currentModel=e),this.runningPromise.resolve==a&&(C(o[i],u.hook,u.index),n.call(this,o,i,a))}.bind(this))}}else a&&a()}(function(){this.pending={},e.call(this,n,"nestedPromises","previous",function(){Z.beforeLoadCalled||ye.onBeforeLoad(),e.call(this,n,"nestedPromises","current")}.bind(this))}).call(this),document.title=this.title=this.routeInstances[this.routeInstances.length-1].title||document.title},r.frameQueryParams=function(e){if(e&&j(e,"=")){var t={},r=j(e,"?")?e.split("?")[1]:e;return(r=j(r,"&")?r.split(/&/g):[r]).forEach(function(e){var r=e.split("=");t[r[0]]=r[1]?decodeURIComponent(r[1]):r[1]}),t}},r.frameDynamicParams=function(e,t){if(e){var r,n=function(e){e.forEach(function(){a.shift()})},o=le.routes,i=[],a=N(e.split("?")[0]);return t.route.forEach(function(e,t,s){if((o=k([e],o)).__lp.wildcard)if(o.__lp.sufix.length){var u=a.slice(0,a.indexOf(o.__lp.sufix[0]));i.push(decodeURI(u.join("/"))),n(u.concat(o.__lp.sufix))}else i.push(decodeURI(a.join("/")));else o.__lp.dynamicKey?(r=a[o.__lp.dynamicIndex],n(N(o.__lp.path)),i.push(decodeURI(r))):(n(N(o.__lp.path)),i.push(void 0))}),i}},this.registerRoute=function(e,t,r){r&&r.mixins&&(Array.isArray(r.mixins)||(r.mixins=[r.mixins]),r.mixins.forEach(function(e){if(Lyte.Mixin.exists(e)){var r=Lyte.registeredMixins[e];if(r)for(var n in r)if("actions"==n)for(var o in r.actions)t.actions[o]=r.actions[o];else t[n]=r[n]}})),t.__lp={objPath:e.replace(/\//g,"."),linkTags:[]},t.queryParams&&(t.__lp.queryParamsDef={},t.queryParams.forEach(function(e,r){if("string"==typeof e)t.__lp.queryParamsDef[e]={sticky:le.queryParamOptions.sticky,refreshModel:!0};else{for(var n in e)t.__lp.queryParamsDef[n]={sticky:e[n].hasOwnProperty("sticky")?e[n].sticky:le.queryParamOptions.sticky,refreshModel:!e[n].hasOwnProperty("refreshModel")||e[n].refreshModel};t.queryParams[r]=n}}));var n=(e=h(e)).length-1;t.routeName=e[n],u(e,t)};var be=["runLoop","paused","currentRoutes","routeInstances","aborted","currentPromise","run","pending","matched","timeouteFns"];this.getRouteInstance=function(e){if(se&&Z&&Z.routeInstances){if("*"==e)return Z.routeInstances;e=e||Z.target;var t;return Z.routeInstances.every(function(r,n){return(r=Z.routeInstances[Z.routeInstances.length-1-n]).__lp.objPath!=e||(t=r,!1)}),t}};var Te=["getResources","getDependencies","beforeModel","model","afterModel","redirect","renderTemplate","afterRender","beforeExit"];r.initRoute=function(e){var t,r=e.matched,n=r.route.length,o=[];te=function(e,t,n){if(n){for(var i in n)if("__lp"==i){this.__lp={};for(var i in e.__lp)"rendered"!=i&&(this.__lp[i]=e.__lp[i])}else this[i]=n[i];this.component&&(this.component._route=this)}else for(var i in e)j(Te,i)||(this[i]=e[i]);this.parent=o[t-1],this.transition=Z.routeTrans,this.replaceWith=se.replaceWith,this.transitionTo=se.transitionTo,this.removeFromCache=function(e){Lyte.removeFromCache.assign(e)},this.refresh=function(e){var t={currentRoutes:Z.currentRoutes,matched:Z.matched},n=h(this.__lp.objPath).length-1,o=Array.from(r.route);if(t.transComparison={unRendered:o.splice(n),rendered:o},e&&e.refreshTemplate)for(var i=n;i<r.route.length;i++)delete Z.routeInstances[i].component;return Y={replace:!0,data:Z.data,fromHistory:!1},P(void 0,t),Z.routeTrans},this.setTitle=function(e){document.title=this.title=e},this.getQueryParams=function(){return this.__lp.queryParams||{}},this.getDynamicParam=function(){return this.__lp.dynamicParam},this.getRouteInstance=function(e){return se.getRouteInstance(e)},this.setDynamicParam=function(e){if(this.__lp.dynamicParam&&this.__lp.dynamicParam!=e){var t=Array.from(Z.matched.dynamicParams);t.splice(this.__lp.objPath.split(".").length-1,1,e);var r={route:Array.from(Z.matched.route),dynamicParams:t,queryParams:Object.assign({},Z.matched.queryParams)},n=g(r),o=Q(r);return Y={data:Z.data,url:n,fromHistory:!1},P(n,o),Z.routeTrans}},this.setQueryParams=function(e,t,r){var n={};if("object"==(void 0===e?"undefined":_typeof(e))){for(var o in e)n[o]=e[o];r=t}else n[e]=t;var i={route:Array.from(Z.matched.route),dynamicParams:Array.from(Z.matched.dynamicParams),queryParams:Object.assign({},Z.matched.queryParams,n)};if(!V(Z.matched.queryParams,i.queryParams)){var a=g(i),s=Q(i);0!=r&&i.refreshModel||(s.transComparison={rendered:i.route,unRendered:[]}),Y={data:Z.data,url:a,fromHistory:!1},P(a,s)}return Z.routeTrans},this.init&&this.init(),"undefined"!=typeof LyteComponent&&(this.throwEvent=LyteComponent.throwEvent)};for(var i=e.prevTrans,a=!0,s=0;s<n;s++){if(!(t=se.__lp.getDefinition(Z.matched._routes[s])))return!1;i&&a&&i.matched&&i.matched.route[s]==r.route[s]?o.push(new te(t,s,i.routeInstances[s])):(o[s]=new te(t,s),a=!1)}return o};var Re=["getResources","getDependencies","beforeModel","model","afterModel","redirect","renderTemplate","afterRender"];return this},t.$LR=Lyte.Router=new lyteRouter}(window);
function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function noop(){}function onDomContentForLyte(){window.isIE11Lyte||(document.body.appendChild(LyteComponent.lyteComponentsDiv),LyteComponent.needDummyComponentsDiv?document.body.appendChild(LyteComponent.dummyLyteComponentsDiv):(LyteComponent.dummyLyteComponentsDiv.remove(),LyteComponent.dummyLyteComponentsDiv=void 0));for(var e=["focus","focusin","focusout","resize","scroll","click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","change","select","submit","keydown","keypress","keyup","contextmenu"],t=0;t<e.length;t++){var n=e[t];document.body.addEventListener(n,globalEventHandler,!0)}var o=LyteComponent.toBeRegistered;if(o.length){for(var r=0;r<o.length;r++)customElements.define(o[r].name,o[r].def);LyteComponent.toBeRegistered=[]}}function getMustache(e){if(e=e&&"string"==typeof e?e.trim():e,/^{{(?=[\s]*[\w-_]+)/.test(e)){var t=e.match(/{{[a-zA-Z0-9_.[\]()]*(?![\\])}}/g);if(t&&t.length>1)return;if(!this.syntaxCheck(e)||!/{{[^}]*?(?:(?:('|")[^\1]*?\1)[^}]*?)*}}$/.test(e))return;var n=e.match(/[\w!@#$%^&*)(+=.,_-]+[\s]*[(]{0,1}(?:"([^"]|\\")*?"|'([^']|\\')*?'|[\w\s!@#$%^&*)([\]+=.,_-]*?)*?[)]{0,1}[\s]*(?=}})/g);if(n&&n.length>1)return;return n=n?n[0].trim():n}}function getHelper(e){var t=/\((?:[^)]*|(?:(?:"(?:[^"\\]|\\.)*?")|(?:'([^'\\]|\\.)*?')|[\w\s!@#$%^&*)([\]+=.,_-]*?)*?)\)$/.exec(e);if(t)return getHelperInfo(e,t)}function getHelperInfo(e,t){var n={};n.name=e.substr(0,t.index).replace(/\s/g,"");var o=getHelperArgs((t=t?t[0].trim():t).substr(1,t.length-2));return!1!==o&&(n.args=o,n)}function getHelperArgs(e){for(var t=[],n=[],o=0,r=void 0,i=0;i<e.length;i++)if(t.length||","!==e.charAt(i))"("===e.charAt(i)?"'"==r&&'"'==r||(t.push(e.charAt(i)),r=e.charAt(i)):")"===e.charAt(i)?"("===t[t.length-1]&&t.pop():"'"===e.charAt(i)&&"\\"!==e.charAt(i-1)?"'"===t[t.length-1]?t.pop():'"'!==t[t.length-1]&&(t.push(e.charAt(i)),r=e.charAt(i)):'"'===e.charAt(i)&&"\\"!==e.charAt(i-1)&&('"'===t[t.length-1]?t.pop():"'"!==t[t.length-1]&&(t.push(e.charAt(i)),r=e.charAt(i)));else{var a=e.substr(o,i-o);(a=a.trim())&&a.startsWith('"')&&a.endsWith('"')&&(a="'"+(a=a.slice(1,-1))+"'"),a=getHelperArgValue(a),n.push(a),o=i+1}var s=e.substr(o,e.length-o);return(s=s.trim())&&s.startsWith('"')&&s.endsWith('"')&&(s="'"+(s=s.slice(1,-1))+"'"),s=getHelperArgValue(s),n.push(s),n}function syntaxCheck(e){for(var t,n=[],o=0;o<e.length;o++)"'"===e[o]?"'"===t&&"\\"!==e[o-1]?(n.pop(),t=void 0):n.length||(t=e[o],n.push(t)):'"'===e[o]&&('"'===t&&"\\"!==e[o-1]?(n.pop(),t=void 0):n.length||(t=e[o],n.push(t)));return!n.length}function doCompile(e,t,n){for(var o=0;o<t.length;o++){var r=t[o],i=r.type,a=r.position,s=this.getDynamicNode(e,a);switch(i){case"text":var p=this.getMustache(s.nodeValue),l=void 0;p&&(l=this.getHelper(p));var d=this.getMustache(s.nodeValue);l?r.helperInfo=l:d&&(r.dynamicValue=d);break;case"attr":for(var c=[],m=[],u=s,f=r.attr=r.attr||{},h=0;h<u.attributes.length;h++)if(-1!==u.attributes[h].nodeValue.indexOf("{{")){var y=u.attributes[h].nodeValue,_=this.getMustache(y),v=void 0;if(_?v=this.getHelper(_):/{{.*}}/.test(y)&&!/\\{{.*}}/.test(y)&&(v=this.splitMixedText(y)),v&&("action"===v.name||"method"===v.name)&&/^(onfocus|onfocusin|onfocusout|onresize|onscroll|onclick|ondblclick|onmousedown|onmouseup|onmousemove|onmouseover|onmouseout|onchange|onselect|onsubmit|onkeydown|onkeypress|onkeyup|oncontextmenu)$/.test(u.attributes[h].name)){f[u.attributes[h].name.substr(2)]={name:u.attributes[h].name.substr(2),helperInfo:v,globalEvent:!0};var g=deepCopyObject(v.args),b=g.splice(0,1)[0];b=b.startsWith("'")?b.replace(/'/g,""):b;var C=this.getArgString(b,g);u.setAttribute(u.attributes[h].name.substr(2),n+" => "+C),c.push(u.attributes[h].name)}else if(v||_){var L={};u.attributes[h].name.startsWith("lbind:")?(c.push(u.attributes[h].name),m.push({name:u.attributes[h].name.substring(6),value:u.attributes[h].nodeValue}),L.isLbind=!0,L.name=u.attributes[h].name.substring(6)):L.name=u.attributes[h].name,v?"lbind"===v.name?(L.dynamicValue=v.args[0],L.isLbind=!0):L.helperInfo=v:L.dynamicValue=_,!0,f[L.name]=L}}if(c.length)for(var w=0;w<c.length;w++)u.removeAttribute(c[w]);if(m.length)for(var A=0;A<m.length;A++)u.setAttribute(m[A].name,m[A].value);break;case"for":case"forIn":case"component":case"registerYield":doCompile(window.isIE11Lyte?s:s.content,r.dynamicNodes,n),(window.isIE11Lyte||window.isEdgeLyte)&&(r.templateContent=s.outerHTML,s.innerHTML="");break;case"if":case"switch":var N="default";if(window.isIE11Lyte||window.isEdgeLyte){for(var x,E={},I=window.isEdgeLyte?s.content.childNodes:s.childNodes,S=0;S<I.length;S++)"TEMPLATE"===I[S].tagName&&(I[S].getAttribute("case")?E[I[S].getAttribute("case")]=I[S]:I[S].hasAttribute("default")&&(x=I[S]));for(var P in r.cases)doCompile(E[P],r.cases[P].dynamicNodes,n),E[P].remove(),r.cases[P].templateContent=E[P].outerHTML;r[N].dynamicNodes&&(doCompile(x,r[N].dynamicNodes,n),x.remove(),r[N].templateContent=x.outerHTML)}else{for(var k in r.cases)doCompile(s.content.querySelector("[case='"+LyteComponent.cssEscape(k)+"']").content,r.cases[k].dynamicNodes,n);r[N].dynamicNodes&&doCompile(s.content.querySelector("[default]").content,r[N].dynamicNodes,n)}}}}function getDynamicNode(e,t){for(var n=e,o=0;o<t.length;o++)n="TEMPLATE"!=n.tagName||window.isIE11Lyte?n.childNodes[t[o]]:n.content.childNodes[t[o]];return n}function splitMixedText(e){for(var t=[],n=0,o={name:"concat",args:[]},r=0;r<e.length;r++){var i=r;if("\\"!==e[r-1]&&"{"===e[r]&&"{"===e[++r])t.push("{{"),o.args.push("'"+e.substr(n,i-n)+"'"),n=r+1;else if("}"===e[r]&&"}"===e[++r]&&t.length){t.pop(n);var a=e.substr(n,i-n),s=this.getHelper(a);s?(a=s,o.args.push({type:"helper",value:a})):o.args.push(a),n=r+1}}return n<e.length&&o.args.push("'"+e.substr(n,e.length-n)+"'"),o}function getHelperArgValue(e){switch(e){case"undefined":return;case"true":return!0;case"false":return!1;case"null":return null;case"":return;default:return e&&e.startsWith("'")&&e.endsWith("'")?e:/\([\w\s,')(]*/.test(e)?{type:"helper",value:getHelper(e)}:isNaN(e)?e:parseInt(e)}}function deepCopyObject(e){for(var t,n,o,r,i,a,s=[{source:e,target:Object.create(Object.getPrototypeOf(e))}],p=[e],l=s[0].target,d=[l];t=s.shift();)for(n=Object.getOwnPropertyNames(t.source),o=0;o<n.length;o++)(r=Object.getOwnPropertyDescriptor(t.source,n[o])).value&&"object"==_typeof(r.value)?(i=r.value,r.value=Array.isArray(i)?[]:Object.create(Object.getPrototypeOf(i)),-1==(a=p.indexOf(i))?(p.push(i),d.push(r.value),Object.defineProperty(t.target,n[o],r),s.push({source:i,target:r.value})):(r.value=d[a],Object.defineProperty(t.target,n[o],r))):Object.defineProperty(t.target,n[o],r);return l}function getArgString(e,t){for(var n=0;n<t.length;n++)"object"===_typeof(t[n])&&(t[n]=this.getArgString(t[n].value.name,t[n].value.args));return e?e+"("+t.toString()+")":t.toString()}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};if(Lyte.registerErrorCodes({LC001:"Error while parsing custom prop handler attribute {0}. Check if the value provided is a valid JSON",LC002:"{0} Component is not compiled. Please compile using Lyte CLI",LC003:"Helper named {0} is not defined",LC004:"Action named {0} doesn't exists",LC005:"Lyte.objectUtils doesn't support {0} function",LC006:"Lyte.arrayUtils doesn't support {0} function",LC007:"Component name not specified in Lyte.Component.render",LC008:"Specified outlet {0} doesn't exists - Lyte.Component.render",LC009:"Method named {0} doesn't exists"}),window.isIE11Lyte=!1,window.isEdgeLyte=!1,window.replaceWithNeeded=!1,navigator.userAgent.match(/rv:11/)&&(window.isIE11Lyte=!0,window.action=function(){}),navigator.userAgent.match("Edge")){var s=document.createElement("div");s.innerHTML="<template><div>c</div></template>",s.querySelector("template").childNodes.length?window.isIE11Lyte=!0:window.isEdgeLyte=!0,s.remove()}if(window.isIE11Lyte||window.isEdgeLyte){var doc=document.createDocumentFragment();doc.appendChild(document.createTextNode("  dummy ")),doc.childNodes[0].replaceWith(document.createTextNode("changed")),"changed"!==doc.childNodes[0].textContent&&(window.replaceWithNeeded=!0)}Lyte.Component={},Lyte.arrayUtils=function(){return LyteComponent.arrayFunctions.apply(LyteComponent,arguments)},Lyte.objectUtils=function(){return LyteComponent.objectFunctions.apply(LyteComponent,arguments)},Lyte.Component.register=function(){LyteComponent.registerComponent.apply(LyteComponent,arguments)},Lyte.Component.registerHelper=function(){LyteComponent.registerHelper.apply(LyteComponent,arguments)},Lyte.Component.set=function(){LyteComponent.set.apply(LyteComponent,arguments)},Lyte.Component.registeredHelpers={},Lyte.Component.registeredComponents={},Lyte.Component.registerCustomPropHandler=function(e){LyteComponent.String.dasherize(e);e=LyteComponent.String.toCamelCase(e),-1===LyteComponent.customPropHandlers.indexOf(e)&&(LyteComponent.customPropHandlers.push(e),customElementPrototype.prototype[e]=function(){var t=arguments.length,n=arguments[0];if(!n){var o={};for(var r in this.component.data)if(r.startsWith(e)){var i=r.substring(e.length);o[i=LyteComponent.String.lowerCaseFirstLetter(i)]=this.component.data[r]}return o}if("string"==typeof n){if(!(t>1)){var a=e+LyteComponent.String.upperCaseFirstLetter(n);return this.component.data[a]}this.set(e+LyteComponent.String.upperCaseFirstLetter(n),arguments[1])}else if("object"===(void 0===n?"undefined":_typeof(n)))for(var s in n){var p=e+LyteComponent.String.upperCaseFirstLetter(s);this.set(p,n[s])}},LyteComponent.customPropRegex=new RegExp("^("+LyteComponent.customPropHandlers.join("|")+")"))},Lyte.Component.unregisterComponent=function(e){if(Lyte.Component.registeredComponents[e]){var t=LyteComponent._registeredComponents[e];if(t.activeInstances>0)console.warn("There are active instances of the component "+e+" and hence cannot be unregistered");else{t._properties={},t.component=null,t._mixins=null,t._actions=null,t._template=null,t._dynamicNodes=null,t._callBacks={},t._observers=[],t._data=void 0,t._methods={},t.prototype.get=noop,t.prototype.set=noop,delete Lyte.Component.registeredComponents[e];var n=document.querySelector("template[tag-name="+e+"]");n&&n.remove()}}else console.warn("Component "+e+" not yet registered")};var elementPrototype="undefined"!=typeof HTMLElement?HTMLElement:Element;document.addEventListener("change",function(e){var t=e.target||e.srcElement;if(t._attributeDetails){var n="value";"checkbox"!==t.type&&"radio"!==t.type||(n="checked");var o=[],r=t._attributeDetails[n];if(r&&r.isLbind){var i=t;if(!t._callee){for(;i&&!LyteComponent.isCustomElement(i)&&"LYTE-YIELD"!==i.tagName;){if("BODY"===i.tagName){i=null;break}i=i.parentNode}i&&"LYTE-YIELD"===i.tagName?t._callee=i._registerYield._callee:t._callee=i}var a=t._callee;t&&LyteComponent.newAddContext(t,o);var s=LyteComponent.getNew(a.component.data,r.dynamicValue);LyteComponent.set(s.context,s.lastKey,t[n]),t&&LyteComponent.newRemoveContext(t,o)}}});var globalEventHandler=function(e){var t,n=e.type,o=e.target;window.event||(t=!0,window.event=e);for(var r=!1;o.getAttribute&&!o.getAttribute(n)&&"BODY"!=o.tagName&&(!LyteComponent.hasLyteEvents(o,n)||!(r=LyteComponent.handleLyteEvents(o,e)));)o=o.parentNode;if(!r){var i=o;if(!o._callee){for(;i&&!LyteComponent.isCustomElement(i)&&"LYTE-YIELD"!==i.tagName;){if("BODY"===i.tagName){i=null;break}i=i.parentNode}i&&"LYTE-YIELD"===i.tagName?o._callee=i._registerYield._callee:o._callee=i===o?void 0:i}if(o._evBoundEvents&&o._evBoundEvents[n]){o._callee?o._callee.constructor._actions:o.constructor._actions;var a=o._evBoundEvents[n],s=Lyte.deepCopyObject(a);s.args.shift(),LyteComponent.throwAction.call(o,o,n,s,void 0,void 0,o,e)}else if(o.getAttribute&&o.getAttribute(n)){o._callee.constructor._actions,o.getAttribute(n).split(" => ")[1];var p=o._boundEvents[n],l=Lyte.deepCopyObject(p);l.args.shift(),LyteComponent.throwAction.call(o._callee,o._callee,n,l,void 0,void 0,o,e)}if("LABEL"===o.tagName){var d=o.querySelector("input");if(d&&d.getAttribute(n)){o._callee.constructor._actions,d.getAttribute(n).split(" => ")[1];var c=o._boundEvents[n],m=Array.from(c.args),u=Object.assign({},c);m.shift(),u.args=m,LyteComponent.throwAction.call(o._callee,o._callee,n,u,void 0,void 0,d,e)}}t&&(window.event=void 0)}},LyteYield=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,HTMLElement),_createClass(t,[{key:"disconnectedCallback",value:function(){if(!LyteComponent.ignoreDisconnect){var e=[];LyteComponent.newAddContext(this,e),LyteComponent.removeSelectedBindingDeep(this._properties,this.component.data);var t=this._registerYield;if(t){var n=[];LyteComponent.newAddContext(t,n);for(var o in this._dynamicProperty)if(this._dynamicProperty[o].isActualNode)this._dynamicProperty[o].isActualNode._helperNodes.delete(this);else{var r=t._callee.getProperty(o)._helperNodes;r&&r.delete(this)}this._dynamicProperty={};for(var i=0;i<this._helpers.length;i++)t._callee.removeHelpers(this._helpers[i]);this._helpers=[],LyteComponent.newRemoveContext(t,n),LyteComponent.newRemoveContext(this,e)}}}},{key:"getProperty",value:function(e){var t=e.split("."),n=this;n._properties[t[0]]||(n._properties[t[0]]={}),n=n._properties[t[0]],Object.defineProperty(n,"_path",{enumerable:!1,value:t[0]});for(var o=1;o<t.length;o++)n[t[o]]||(n[t[o]]={},Object.defineProperty(n[t[o]],"_path",{enumerable:!1,value:n._path+"."+t[o]})),n=n[t[o]];return n}}]),t}();customElements.define("lyte-yield",LyteYield);var customElementPrototype=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(!Lyte.Component.registeredComponents[e.localName])return _possibleConstructorReturn(e);e.constructor.activeInstances++,e.component=new e.constructor.component,e.data={},e._properties={},e.component.methods={},e.component.data={};var n=e.constructor._data?e.constructor._data():{};for(var o in n)e.component.data[o]=n[o].default;e.component.data.errors={},e.component.__data=n;for(var r in e.constructor._methods)e.component.methods[r]=e.constructor._methods[r];return Object.defineProperty(e.component.data,"__component__",{value:e,configurable:!0,writable:!0,enumerable:!1}),e.component.$node=e,e.callback("constructor"),e._actions=e._actions?e._actions:{},e._callee=e._callee||e.getCallee(e.parentNode),e}return _inherits(t,elementPrototype),_createClass(t,[{key:"getMethods",value:function(e){return this.component.getMethods(e)}},{key:"setMethods",value:function(e,t){return this.component.setMethods(e,t)}},{key:"getData",value:function(e){return this.component.getData(e)}},{key:"setData",value:function(e,t){return this.component.setData(e,t)}},{key:"getCallee",value:function(e){for(;e&&!LyteComponent.isCustomElement(e)&&"LYTE-YIELD"!==e.tagName;){if("BODY"===e.tagName){e=null;break}e=e.parentNode}return e&&"LYTE-YIELD"===e.tagName?e._registerYield._callee:this===e?void 0:e}},{key:"afterConnected",value:function(){for(var e=this.constructor._observedAttributes,t=0;t<e.length;t++){var n=e[t],o=this.getProperty(n);Object.defineProperty(o,"__fromComponent",{value:!0,enumerable:!1})}if(this.getProperty("errors"),this._initProperties){var r=this._initProperties;for(var i in r)!this.component.__data[i]||this.component.__data[i].type===LyteComponent.getDataType(r[i])||void 0===r[i]&&"boolean"!==this.component.__data[i].type?this.component.data[i]=r[i]:this.component.data[i]=LyteComponent.typeCast(r[i],this.component.__data[i].type);this._initProperties=void 0}if(this._initMethods){var a=this._initMethods;for(var s in a)this.component.methods[s]=a[s];this._initMethods=void 0}this.callback("init"),this.onCallBack("init"),this.registerYields(),this.component.data.lyteUnbound&&(LyteComponent.unbound=!0);return this.renderNodes(this.constructor._template.content,this.constructor._dynamicNodes,void 0,void 0,void 0,void 0,this.constructor._templateContent)}},{key:"getDynamicNode",value:function(e,t){for(var n=e,o=0;o<t.length;o++)n="TEMPLATE"!=n.tagName||window.isIE11Lyte?n.childNodes[t[o]]:n.content.childNodes[t[o]];return n}},{key:"renderNodes",value:function(e,t,n,o,r,i,a){o=o||{};var s=void 0;if(window.isIE11Lyte||window.isEdgeLyte){var p=document.createElement("div");p.innerHTML=a,s=p.childNodes[0],window.timer++,this.constructor.splitTextNodes(s)}else s=e.cloneNode(!0,"lyte");for(var l=[],d=[],c=void 0,m=0;m<t.length;m++){var u=t[m],f=u.type,h=u.position,y=s;if(y=this.getDynamicNode(y,h),"componentDynamic"===f)o.node?y._contextSwitchInfo=o:n&&(y._contextSwitchInfo=n._contextSwitchInfo);else if("text"===f)this.bindNode(y,void 0,n,o,t[m],d,r);else if("attr"===f){if(y._attributeDetails=u.attr,"LYTE-YIELD"===y.nodeName){y._callee=this,y.component={},y.component.data={},Object.defineProperty(y.component.data,"__component__",{value:y,configurable:!0,writable:!0,enumerable:!1}),y._properties={};for(var _=0;_<y.attributes.length;_++){var v=y.attributes[_];"is"!==v.nodeName&&"yield-name"!==v.nodeName&&(y._properties[LyteComponent.String.toCamelCase(v.nodeName)]={})}}var g=[];for(var b in u.attr){var C=u.attr[b],L=b;if(C&&(C.dynamicValue||C.helperInfo))if(o.node?y._contextSwitchInfo=o:n&&(y._contextSwitchInfo=n._contextSwitchInfo),C.globalEvent){y._boundEvents=y._boundEvents||{};var w=C.helperInfo.args[0],A=void 0;w.startsWith('"')||w.startsWith("'")?A=w.substring(1,w.length-1):(console.warn("Deprecation warning. Action name "+w+" must be in quotes"),A=w),y._boundEvents[L]={name:A,args:C.helperInfo.args}}else{y.hasAttribute(L)||y.setAttribute(L,"{{dummy}}");var N=this.bindNode(y.attributes.getNamedItem(L),g,n,o,C,void 0,r);N!==y.attributes.getNamedItem(L)&&(y._removedAttributes=y._removedAttributes||{},y._removedAttributes[L]=N)}}u.attr&&Object.keys(u.attr).length&&(y._callee=this);for(var x=0;x<g.length;x++)y.removeAttribute(g[x])}else if(/^(for|forIn|component)$/.test(f)){o.node?y._contextSwitchInfo=o:n&&(y._contextSwitchInfo=n._contextSwitchInfo),y._dynamicNodes=u.dynamicNodes,(window.isIE11Lyte||window.isEdgeLyte)&&(y._templateContent=u.templateContent);var E=void 0;switch(f){case"for":E=this.updateForHelper(y,{type:"default"},o.node?o:void 0,r);break;case"forIn":E=this.updateForInHelper(y,{type:"default"},o.node?o:void 0,r);break;case"component":E=this.updateDynamicComponent(y,!1,o.node?o:void 0,r)}E&&l.push(E)}else if(/^(if|switch)$/.test(f)){y._cases=u.cases,y._default=u.default,o.node?y._contextSwitchInfo=o:n&&(y._contextSwitchInfo=n._contextSwitchInfo);var I=this.updateSwitchHelper(f,y,o.node?o:void 0,void 0,r);if(I){l.push(I);if(I.toAppendMain.querySelector("template[is=break]")){y._isStopped="break",s=this.constructor.getTrimmedContent(s,u.position,void 0),c=u.position;break}if(I.toAppendMain.querySelector("template[is=continue]")){y._isStopped="continue",s=this.constructor.getTrimmedContent(s,u.position,void 0);break}}}else"registerYield"===f?(y._dynamicNodes=u.dynamicNodes,(window.isIE11Lyte||window.isEdgeLyte)&&(y._templateContent=u.templateContent),o.node?y._contextSwitchInfo=o:n&&(y._contextSwitchInfo=n._contextSwitchInfo),y._callee=this):"insertYield"===f&&(o.node?y._contextSwitchInfo=o:n&&(y._contextSwitchInfo=n._contextSwitchInfo),y.component=y.component||{data:{}},y._properties=y._properties||{},this.updateYield(y,!1,o.node?o:void 0))}for(var S=0;S<d.length;S++){var P=d[S].dynamicPositions,k=P.initialNode,O=P.dynamicNodeValue,j=O.childNodes.length;j||(O.appendChild(document.createTextNode("")),j=1);var B=O.childNodes[0];if(window.replaceWithNeeded&&"#document-fragment"===k.parentNode.nodeName){for(;O.childNodes.length;)k.parentNode.insertBefore(O.childNodes[0],k);k.remove()}else k.replaceWith.apply(k,O.childNodes);d[S].dynamicPositions={startingNode:B,length:j}}return c&&((i=i||{}).stop=!0),n?o.type?(n._helpers[o.itemIndex]=l,(window.isIE11Lyte||window.isEdgeLyte)&&(s=this.constructor.createDocFragment1(s)),s):(n._helpers=l,(window.isIE11Lyte||window.isEdgeLyte)&&(s=this.constructor.createDocFragment1(s)),s):(this.executeBlockHelpers(l),(window.isIE11Lyte||window.isEdgeLyte)&&(s=this.constructor.createDocFragment1(s)),s)}},{key:"executeBlockHelpers",value:function(e,t){for(var n=0;n<e.length;n++)e[n].lastNode.parentNode.insertBefore(e[n].toAppendMain,e[n].lastNode),e[n]=e[n].lastNode}},{key:"updateBlockHelpers",value:function(e,t){for(var n=0;n<e.length;n++)switch(e[n].getAttribute("is")){case"for":this.updateForHelper(e[n],{type:"default"},t);break;case"if":this.updateSwitchHelper("if",e[n],t);break;case"forIn":this.updateForInHelper(e[n],{type:"default"},t);break;case"switch":this.updateSwitchHelper("switch",e[n],t);break;case"component":this.updateDynamicComponent(e[n],!1,t);break;case"insertYield":break;case"yield":case"registerYield":t&&(e[n]._contextSwitchInfo=t);break;default:"LYTE-YIELD"===e[n].tagName&&this.updateYield(e[n],!1,t)}}},{key:"attributeChangedCallback",value:function(e,t,n){if(!this.constructor._observedMethodAttributes||!this.constructor._observedMethodAttributes[e]){var o=LyteComponent.String.toCamelCase(e),r=LyteComponent.customPropHandlers.indexOf(o);if(-1===r){if(t!==n){var i=this.attributes.getNamedItem(e);if(i&&i.__lyteIgnore)this.attributes.getNamedItem(e).__lyteIgnore=!1;else{var a=this.component.__data[o].type;if("string"!==a){var s={attr:e,tagName:this.tagName};if(n=LyteComponent.typeCast(n,a,s),s.isError)return void console.warn("data type of the value provided for attribute "+e+" of "+this.tagName+" is not valid")}this.component.data[o]!==n&&this.set(o,n)}}}else{var p=LyteComponent.customPropHandlers[r],l=n;if(l)try{l=JSON.parse(l);for(var d in l){var c=p+LyteComponent.String.upperCaseFirstLetter(d);this.set(c,l[d])}}catch(t){Lyte.error("LC001",e)}}}}},{key:"removeHelpersSpecificIndex",value:function(e,t){if(e._helpers[t])for(var n=0;n<e._helpers[t].length;n++)this.removeHelpers(e._helpers[t][n]);if(e._forContent[t]){for(var o=0;o<e._forContent[t].length;o++)e._forContent[t][o].remove();e._items[t]={_dynamicProperty:{},itemProperty:{},indexProperty:{}}}}},{key:"removeHelpers",value:function(e,t){var n="delete",o=[];if(LyteComponent.newAddContext(e,o),e._forContent)if("for"===e.getAttribute("is")){if(e._helpers)for(var r=0;r<e._helpers.length;r++){for(var i=0;i<e._helpers[r].length;i++)this.removeHelpers(e._helpers[r][i]);e._helpers[r]=[]}for(var a=0;a<e._forContent.length;a++)for(var s=0;s<e._forContent[a].length;s++)e._forContent[a][s].remove();var p=e.getAttribute("item");if(e._items.length){for(var l=e._items[0].itemProperty,d=0;d<e._items.length;d++){var c=e._items[d]._dynamicProperty;for(var m in c){var u=this.getProperty(m);u._helperNodes&&u._helperNodes[n](e)}}if(l)for(var f=0;f<e._items.length;f++)this.removeBindings(_defineProperty({},p,e._items[f].itemProperty),_defineProperty({},p,e._attributes.items[f]))}t||e._actualBinding&&(e._attributes.items&&e._attributes.items._bindings&&e._actualBinding._createdBinding&&e._attributes.items._bindings[n](e._actualBinding),e._actualBinding._forHelpers&&e._actualBinding._forHelpers[n](e),e._removedAttributes&&e._removedAttributes.items&&!e._removedAttributes.items.helperValue&&e._removedAttributes.items._multipleProperty&&e._removedAttributes.items._multipleProperty[0].actProp._forHelpers[n](e)),e._items=[]}else{if(e._helpers)for(var h=Object.keys(e._helpers),y=0;y<h.length;y++){for(var _=0;_<e._helpers[h[y]].length;_++)this.removeHelpers(e._helpers[h[y]][_]);e._helpers[h[y]]=[]}for(var v in e._forContent)for(var g=0;g<e._forContent[v].length;g++)e._forContent[v][g].remove();var b=e._items,C=e.getAttribute("key");for(var L in b){var w=b[L],A=w.itemProperty,N=w._dynamicProperty;for(var x in N){var E=this.getProperty(x);E._helperNodes&&E._helperNodes[n](e)}A&&this.removeBindings(_defineProperty({},C,e._items[L].itemProperty),_defineProperty({},C,e._attributes.object[L]))}t||(e._actualBinding&&(e._attributes.object&&e._attributes.object._bindings&&e._actualBinding._createdBinding&&e._attributes.object._bindings[n](e._actualBinding),e._actualBinding._forHelpers&&e._actualBinding._forHelpers[n](e)),e._removedAttributes.items&&!e._removedAttributes.items.helperValue&&e._removedAttributes.items._multipleProperty&&e._removedAttributes.items._multipleProperty[0].actProp._forHelpers[n](e),e._propBindingObject&&e._attributes.object&&e._attributes.object._bindings&&e._attributes.object._bindings[n](e._propBindingObject)),e._items={}}else if(e._caseContent||e._yieldContent){if(e._helpers){for(var I=0;I<e._helpers.length;I++)this.removeHelpers(e._helpers[I]);e._helpers=[]}if(e._caseContent){for(var S=0;S<e._caseContent.length;S++)e._caseContent[S].remove();for(var P in e._dynamicProperty)if(e._dynamicProperty[P].isActualNode)e._dynamicProperty[P].isActualNode._helperNodes[n](e);else{var k=this.getProperty(P)._helperNodes;k&&k[n](e)}e._dynamicProperty={}}else{for(var O=0;O<e._yieldContent.length;O++)e._yieldContent[O].remove();e._dynamicProperty={}}}else if(e._renderedComponent){e._renderedComponent[e._currentComponent]&&e._renderedComponent[e._currentComponent].remove();for(var j in e._renderedComponent)e._renderedComponent[j]=null}LyteComponent.newRemoveContext(e,o)}},{key:"updateYield",value:function(e,t,n){e._callee||(e._callee=this);var o=e._callee._yields[e.getAttribute("yield-name")];if(o){e._registerYield=o;var r=o._callee||e._callee._callee;if(!r)return e.appendChild(o.content.cloneNode(!0,"lyte")),void(e._helpers=[]);o._callee||(o._callee=r),e._dynamicProperty=e._dynamicProperty||{};var i={},a=[];LyteComponent.newAddContext(o,a),Object.keys(e._properties).forEach(function(t){i[t]={},i[t].value=r.component.data[t],i[t].property=r._properties[t],r._properties[t]=e._properties[t],r.component.data[t]=e.component.data[t]});var s=r.renderNodes(o.content,o._dynamicNodes,e,{node:e},!0,void 0,o._templateContent);e.component.data.lyteUnbound||LyteComponent.establishBindings(e._properties,e.component.data),r.executeBlockHelpers(e._helpers),Object.keys(e._properties).forEach(function(e){r.component.data[e]=i[e].value,r._properties[e]=i[e].property}),LyteComponent.newRemoveContext(o,a),e.appendChild(s)}}},{key:"updateDynamicComponent",value:function(e,t,n,o){var r=void 0;e._callee=this;var i=e.hasAttribute("lyte-keep-alive");e._renderedComponent=e._renderedComponent||{},e._contextSwitchInfo=n||e._contextSwitchInfo,e._dynamicProperty=e._dynamicProperty||{};var a=e.getAttribute("component-name")||(e._attributes?e._attributes["component-name"]:void 0);if(a){var s=void 0,p=!1;if(t?(i&&(LyteComponent.ignoreDisconnect=!0),e._renderedComponent[e._currentComponent]&&e._renderedComponent[e._currentComponent].remove(),LyteComponent.ignoreDisconnect=!1,i||(e._dynamicProperty={}),e._renderedComponent[a]&&i?s=e._renderedComponent[a]:(s=document.createElement(a),p=!0)):(s=document.createElement(a),p=!0),!i&&e._currentComponent&&(e._renderedComponent[e._currentComponent]=null),p){for(var l=0;l<e.attributes.length;l++)"is"!==e.attributes[l].name&&"component-name"!==e.attributes[l].name&&"lyte-keep-alive"!==e.attributes[l].name&&s.setAttribute(e.attributes[l].name,e.attributes[l].value);if(e._attributes)for(var d in e._attributes)"component-name"!==d&&s.setData(LyteComponent.String.toCamelCase(d),e._attributes[d]);var c=this.renderNodes(e.content,e._dynamicNodes,e,void 0,o,void 0,e._templateContent);s.appendChild(c)}return p&&(s._toRegEvnts=e._toRegEvnts),t?e.parentNode.insertBefore(s,e):r={toAppendMain:s,lastNode:e},e._renderedComponent[a]=s,e._currentComponent=a,s._callee=this,s._actions=e._actions,s.setMethods(e._initMethods),s._attributeDetails=e._attributeDetails,s._boundEvents=e._boundEvents,r}}},{key:"updateForHelper",value:function(e,t,n,o){if(e._callee=this,e._attributes=e._attributes||{},"update"===t.type&&e._currentItems===e._attributes.items)return{};e._contextSwitchInfo=n||e._contextSwitchInfo;var r=e.getAttribute("index");r||(e.setAttribute("index","index"),r="index");var i=e.getAttribute("item");i||(e.setAttribute("item","item"),i="item");var a=this.component.data[i],s=this.component.data[r],p=this._properties[i],l=this._properties[r];this._properties[i]=this._properties[r]={};var d=e._attributes.items,c=e.content,m=e._dynamicNodes,u=e;e._items||(e._items=[]);var f=void 0,h=void 0,y=t.firstIndex,_=t.secondIndex,v=t.thirdIndex,g=!1,b=LyteComponent.unbound;if(e.hasAttribute("unbound")&&(g=!0,LyteComponent.unbound=!0),t)switch(t.type){case"remove":f=y;for(var C=y,L=_;L>0;L--,C++)this.removeHelpersSpecificIndex(e,C);for(var w=y+_;w<e._items.length;w++)e._items[w]._contextSwitchInfo.itemIndex=e._items[w]._contextSwitchInfo.itemIndex-_;e._items.splice(y,_),e._helpers.splice(y,_),e._forContent.splice(y,_);break;case"insert":h=y,f=_,e._forContent[y]&&(u=e._forContent[y][0]);for(var A=[],N=[],x=[],E=_,I=y;E>0;E--,I++)A.push([]),N.push({}),x.push([]);e._helpers.splice.apply(e._helpers,[y,0].concat(A)),e._items.splice.apply(e._items,[y,0].concat(N));for(var S=y+_;S<e._items.length;S++)e._items[S]._contextSwitchInfo.itemIndex=e._items[S]._contextSwitchInfo.itemIndex+_;e._forContent.splice.apply(e._forContent,[y,0].concat(x));break;case"replace":h=y,f=_,this.removeHelpersSpecificIndex(e,y);document.createDocumentFragment();e._forContent[y+1]&&(u=e._forContent[y+1][0]);for(var P=[],k=[],O=[],j=_,B=y;j>0;j--,B++)P.push([]),O.push([]),k.push({});e._helpers.splice.apply(e._helpers,[y,1].concat(P)),e._items.splice.apply(e._items,[y,1].concat(k));for(var D=y+_;D<e._items.length;D++)e._items[D]._contextSwitchInfo.itemIndex=e._items[D]._contextSwitchInfo.itemIndex+_-1;e._forContent.splice.apply(e._forContent,[y,1].concat(O));break;case"splice":h=y,f=_;for(var H=v,T=0;H>0;H--,T++)this.removeHelpersSpecificIndex(e,y+T);document.createDocumentFragment();e._forContent[y+v]&&(u=e._forContent[y+v][0]);for(var M=[],Y=[],V=[],F=_,R=y;F>0;F--,R++)M.push([]),V.push([]),Y.push({});e._helpers.splice.apply(e._helpers,[y,v].concat(M)),e._items.splice.apply(e._items,[y,v].concat(Y));for(var W=y+_;W<e._items.length;W++)e._items[W]._contextSwitchInfo.itemIndex=e._items[W]._contextSwitchInfo.itemIndex+_-v;e._forContent.splice.apply(e._forContent,[y,v].concat(V));break;case"update":e.getAttribute("item");for(var $=0;$<e._items.length;$++)this.removeHelpersSpecificIndex(e,$);e._items=[];case"default":e._forContent=[],e._helpers=[],h=0,f=d?d.length:0;break;default:Lyte.error("Error in updateForHelper")}for(u||(u=e);u!==e&&"TEMPLATE"===u.tagName;){switch(u.getAttribute("is")){case"for":case"forIn":u=u._forContent[0][0]||u;break;case"if":case"switch":u=u._caseContent[0]||u;break;case"component":u=u._renderedComponent[u._currentComponent]||u}}var q=void 0;if("remove"!==t.type){for(var z=document.createDocumentFragment(),J=h,U=f;U>0;J++,U--){e._helpers[J]=[],e._items[J]={_dynamicProperty:{},itemProperty:{},indexProperty:{}},this.component.data[i]=d[J],this.component.data[r]=J,this._properties[i]={},this._properties[r]={};var G={itemValue:i,itemIndex:J,type:"for",node:e,indexValue:r};e._items[J]._contextSwitchInfo=G;var K={},X=this.renderNodes(c,m,e,G,o,K,e._templateContent);if(e._items[J].itemProperty=this.getProperty(i),e._items[J].indexProperty=this.getProperty(r),LyteComponent.unbound||LyteComponent.establishBindings(_defineProperty({},i,e._items[J].itemProperty),_defineProperty({},i,e._attributes.items[J])),e._forContent[J]=Array.from(X.childNodes),this.executeBlockHelpers(e._helpers[J]),z.appendChild(X),K.stop)break}g&&(LyteComponent.unbound=b),"default"===t.type?q={toAppendMain:z,lastNode:u}:u.parentNode.insertBefore(z,u),!g&&e._removedAttributes&&e._removedAttributes.items&&!e._removedAttributes.items.helperValue&&e._removedAttributes.items._multipleProperty&&LyteComponent.establishBindings({items:e._removedAttributes.items._multipleProperty[0].actProp},{items:d})}for(var Z=f;Z<e._items.length;Z++)e._items[Z].indexProperty&&LyteComponent.affectChanges(e._items[Z].indexProperty);return this.component.data[i]=a,this.component.data[r]=s,this._properties[i]=p,this._properties[r]=l,e._currentItems=d,q}},{key:"updateForInHelper",value:function(e,t,n,o){var r=this;if(e._callee=this,e._attributes=e._attributes||{},"update"===t.type&&e._currentObject===e._attributes.object)return{};n=n||e._contextSwitchInfo,e._contextSwitchInfo=n;var i=e.getAttribute("key");i||(i="key",e.setAttribute("key","key"));var a=e.getAttribute("value");a||(a="value",e.setAttribute("value","value"));var s=r.component.data[i],p=r.component.data[a],l=r._properties[i],d=r._properties[a];r._properties[i]=r._properties[a]={};var c=e._attributes.object,m=e.content,u=e._dynamicNodes,f=e,h=[];e._items||(e._items={});var y=!1,_=LyteComponent.unbound;if(e.hasAttribute("unbound")&&(y=!0,LyteComponent.unbound=!0),t)switch(t.type){case"delete":this.removeHelpersSpecificIndex(e,t.property);var v=e._keysArray.indexOf(t.property);v>-1&&e._keysArray.splice(v,1),delete e._propBindingObject[t.property];break;case"add":h=[t.property],e._keysArray.push(t.property);break;case"update":e._keysArray.forEach(function(t,n,o){this.removeHelpersSpecificIndex(e,t)},this),e._keysArray=h=c?Object.keys(c):[],e._items={},e._propBindingObject={};break;case"default":e._forContent={},e._helpers={},e._keysArray=h=c?Object.keys(c):[];break;default:Lyte.error("Error in updateForHelper")}var g=void 0;if(!c){var b=document.createDocumentFragment();"default"!==t.type?f.parentNode.insertBefore(b,f):g={toAppendMain:b,lastNode:f}}if(c&&"remove"!==t.type){var C=document.createDocumentFragment();e._propBindingObject=e._propBindingObject||{},h.forEach(function(t,n,s){e._helpers[t]=[],e._items[t]={_dynamicProperty:{},itemProperty:{}},r.component.data[i]=t,r.component.data[a]=c[t],r._properties[i]={},r._properties[a]={};var p={itemIndex:t,itemValue:a,keyValue:i,type:"forIn",node:e};e._items[t]._contextSwitchInfo=p;var l=this.renderNodes(m,u,e,p,o,void 0,e._templateContent);e._items[t].itemProperty=this.getProperty(a),e._propBindingObject[t]=e._items[t].itemProperty,e._forContent[t]=Array.from(l.childNodes),this.executeBlockHelpers(e._helpers[t]),C.appendChild(l)},this),LyteComponent.unbound||(e._attributes.object._bindings||Object.defineProperty(e._attributes.object,"_bindings",{value:new Set,enumerable:!1,writable:!0,configurable:!0}),e._attributes.object._bindings.add(e._propBindingObject),LyteComponent.establishBindings(e._propBindingObject,e._attributes.object)),y&&(LyteComponent.unbound=_),"default"!==t.type?f.parentNode.insertBefore(C,f):g={toAppendMain:C,lastNode:f}}return r.component.data[i]=s,r.component.data[a]=p,r._properties[i]=l,r._properties[a]=d,e._currentObject=c,g}},{key:"updateSwitchHelper",value:function(e,t,n,o,r){var i=t;t._callee||(t._callee=this),n=n||t._contextSwitchInfo,t._contextSwitchInfo=n,t._dynamicProperty=t._dynamicProperty?t._dynamicProperty:{};var a=void 0,s=void 0;if(""===t.getAttribute("value")||t.getAttribute("value")?s=t.getAttribute("value"):t._attributes&&(s=t._attributes.value),!t._currentCase||s!==t._currentCase){if(s)a="if"===e?"true":s.toString();else if("if"===e)a="false";else switch(s){case void 0:a="undefined";break;case null:a="null";break;case!1:a="false";break;case"":a='""'}if(a!==t._currentCase){t._currentCase=a;var p=t._cases[a],l=void 0;if(!p&&(p=t._default,l=window.isIE11Lyte||window.isEdgeLyte?p.templateContent:t.content.querySelector("[default]"),t._isDefault=!0,!l)){t._caseContent&&t._caseContent.length&&this.removeHelpers(t),t._caseContent=[];var d=document.createTextNode("");if(t._caseContent.push(d),t._currentCaseName=a,o)return void i.parentNode.insertBefore(d,t);var c=document.createDocumentFragment();return c.append(d),{lastNode:i,toAppendMain:c}}t._caseContent&&t._caseContent.length&&this.removeHelpers(t);var m=p,u=a,f=void 0;f=l||(window.isIE11Lyte||window.isEdgeLyte?{}:t.content.querySelector("[case='"+LyteComponent.cssEscape(u)+"']"));for(var h=[];m;){var y=m.dynamicNodes,_=this.renderNodes(f.content,y,t,void 0,r,void 0,m.templateContent);if(h.push(_),!m.additional)break;m.additional.next?(f=window.isIE11Lyte||window.isEdgeLyte?{}:t.content.querySelector("[case='"+LyteComponent.cssEscape(m.additional.next)+"']"),m=t._cases[m.additional.next]):(f=window.isIE11Lyte||window.isEdgeLyte?{}:t.content.querySelector("[default]"),m=t._default)}t._caseContent=[];for(var v=document.createDocumentFragment(),g=0;g<h.length;g++)11==h[g].nodeType?t._caseContent=t._caseContent.concat(Array.from(h[g].childNodes)):t._caseContent.push(h[g]),v.append(h[g]);if(this.executeBlockHelpers(t._helpers,t),o){var b=void 0;return v.querySelector("template[is=break]")?b="break":v.querySelector("template[is=continue]")&&(b="continue"),t.parentNode.insertBefore(v,t),b}return{toAppendMain:v,lastNode:t}}}}},{key:"dummy",value:function(e,t){this.constructor._properties[boundValue].observer}},{key:"callObservers",value:function(e,t){var n=this.constructor._properties[e],o=n?n.observer:void 0;if(o)for(var r=0;r<o.length;r++)-1!==t.indexOf(".")&&o[r].path!==t||this["_"+o[r].functionName].apply(this)}},{key:"bindNode",value:function(e,t,n,o,r,i,a,s){var p=o.itemValue,l=o.itemIndex,d=o.type,c=o.indexValue,m=r.dynamicValue,u=r.helperInfo,f=void 0,h=e.ownerElement,y=[];e._callee=this;var _=!1;if(u&&Object.keys(u).length){_=!0;e.nodeName;f=e.helperValue=u;var v=[];if("action"===u.name){var g=u.args[0];u.args[0]=g.startsWith("'")?g.replace(/'/g,""):g,d?h._contextSwitchInfo=o:n&&(h._contextSwitchInfo=n._contextSwitchInfo),g=u.args.slice(0,1)[0];var b=u.args.slice(1,u.args.length),C=!1,L=e.nodeName;return-1!=L.indexOf("-")&&(C=!0),v=[h,L,C,{name:g,args:b}],void this.processHelper({name:u.name,args:v},e)}if(v=this.processArgs(this,u.args,y,void 0,e),f=this.processHelper({name:u.name,args:v},e),"unescape"===u.name){e={dynamicPositions:{initialNode:e,dynamicNodeValue:f},_callee:e._callee,helperValue:e.helperValue},f=void 0,i.push(e)}}else{u={},e.syntaxValue=m;var w=[];f=LyteComponent.get(this.component.data,m,w),y.push(w)}2===e.nodeType&&("string"!=typeof f&&(LyteComponent.isCustomElement(e.ownerElement,!0)||"boolean"==typeof f)||LyteComponent.isControlHelper(e.ownerElement))&&(e={nodeName:e.nodeName,ownerElement:h,nodeType:2,nodeValue:e.nodeValue,_callee:this,syntaxValue:e.syntaxValue,helperValue:e.helperValue,_attributeDetails:e._attributeDetails});var A=void 0;if("unbound"!==u.name&&!LyteComponent.unbound){var N=void 0;n&&(N=d?n._items[l]._dynamicProperty:n._dynamicProperty);for(var x=0;x<y.length;x++){for(var E=y[x],I=0;I<E.length;I++){var S=this.getProperty(E[I]);if(n){var P=E[I].search(/\W/),k=void 0;(k=-1!==P?E[I].substring(0,P):E[I])===p||k===c||o.node&&o.node._properties&&o.node._properties[k]?(e._contextSwitchInfo=o,S._dynamicNodes||(S._dynamicNodes=[],Object.defineProperty(S,"_dynamicNodes",{value:[],enumerable:!1,writable:!0,configurable:!0})),S._dynamicNodes.push(e),k!==c&&(A=S)):(S._helperNodes||Object.defineProperty(S,"_helperNodes",{value:new Set,writable:!0,enumerable:!1,configurable:!0}),S._helperNodes.add(n),N[E[I]]?N[E[I]].push(e):(N[E[I]]=[]).push(e))}else S._dynamicNodes||Object.defineProperty(S,"_dynamicNodes",{value:[],enumerable:!1,writable:!0,configurable:!0}),S._dynamicNodes.push(e);if(h&&"TEMPLATE"===h.tagName&&/^(for|forIn)$/.test(h.getAttribute("is"))&&!_){var O=h.getAttribute("is");("for"===O&&"items"===e.nodeName||"forIn"===O&&"object"===e.nodeName)&&(S._forHelpers||Object.defineProperty(S,"_forHelpers",{value:new Set,enumerable:!1,writable:!0,configurable:!0}),e.ownerElement._actualBinding=S,S._forHelpers.add(e.ownerElement))}a&&LyteComponent.establishSelectedBinding(S,this.component.data,this)}E.length>1&&(e._multipleProperty=e._multipleProperty||[],e._multipleProperty.push({dynamicProp:A?void 0:N,actProp:this.getProperty(E[0]),helperNode:n,dynamicValues:E}))}}if(f="boolean"===!(void 0===f||_typeof(f))&&"number"===!(void 0===f||_typeof(f))?f||"":f,2===e.nodeType){var j=e._parentNode?e._parentNode:e.ownerElement;if(j.tagName)j.getAttribute("is");var B=LyteComponent.isCustomElement(j,!0);B&&(j.set?j.set(LyteComponent.String.toCamelCase(e.nodeName),f):(j._initProperties=j._initProperties||{},j._initProperties[LyteComponent.String.toCamelCase(e.nodeName)]=f));var D=f;if(B&&"string"!=typeof f&&!s)j._attributes=j._attributes||{},j._attributes[e.nodeName]=f,"TEMPLATE"===j.nodeName&&_&&f&&("for"===j.getAttribute("is")&&"items"===e.nodeName||"forIn"===j.getAttribute("is")&&"object"===e.nodeName&&!LyteComponent.unbound)&&(f._bindings||Object.defineProperty(f,"_bindings",{value:new Set,enumerable:!1,writable:!0,configurable:!0}),e.ownerElement._actualBinding={_forHelpers:(new Set).add(j),_createdBinding:!0},f._bindings.add(e.ownerElement._actualBinding)),t.push(e.nodeName);else if("boolean"==typeof f)j._attributes=e.ownerElement._attributes||{},j._attributes[e.nodeName]=f,f?j.setAttribute(e.nodeName,""):t.push(e.nodeName);else if(f="object"===(void 0===f?"undefined":_typeof(f))?"undefined"!=typeof Record&&f instanceof Record?JSON.stringify(f.$.toJSON()):JSON.stringify(f):void 0===f?"":f,LyteComponent.isControlHelper(e.ownerElement))j._attributes=e.ownerElement._attributes||{},j._attributes[e.nodeName]=f,t.push(e.nodeName);else{var H=void 0===f?"":f;"style"===e.nodeName?e.ownerElement.setAttribute("style",H):e.nodeValue=H}"LYTE-YIELD"===j.tagName&&(j.component.data[LyteComponent.String.toCamelCase(e.nodeName)]=D),/^(INPUT|TEXTAREA|SELECT)$/.test(j.nodeName)&&("value"===e.nodeName?j.value=void 0===f?"":f:"checked"===e.nodeName&&(j.checked=f))}else e.nodeValue=void 0===f?"":f;return e}},{key:"debounce",value:function(e,t){var n;return function(){var o=this,r=arguments;n&&clearTimeout(n),n=setTimeout(function(){e.apply(o,r),n=null},t||100)}}},{key:"getProperty",value:function(e){var t=e.split("."),n=this;n._properties[t[0]]||(n._properties[t[0]]={}),n=n._properties[t[0]],Object.defineProperty(n,"_path",{enumerable:!1,value:t[0]});for(var o=1;o<t.length;o++)n[t[o]]||(n[t[o]]={},Object.defineProperty(n[t[o]],"_path",{enumerable:!1,value:n._path+"."+t[o]})),n=n[t[o]];return n}},{key:"updateNode",value:function(e,t){var n=[],o=void 0;if(e._multipleProperty)for(var r=0;r<e._multipleProperty.length;r++)if(e._multipleProperty[r]&&e._multipleProperty[r].dynamicValues.lastIndexOf(t)>0){n[r]=!1;var i=void 0;if((o=e._multipleProperty[r]).dynamicProp){if(n[r]=o,i=o.dynamicProp[o.actProp._path]){var a=i.indexOf(e);i.splice(a,1)}var s=o.helperNode;if(0===i.length)if("if"===s.getAttribute("is"))o.actProp._helperNodes.delete(s),delete o.dynamicProp[o.actProp._path];else if(delete o.dynamicProp[o.actProp._path],s._items){for(var p=!0,l=0;l<s._items.length;l++)if(s._items[l]._dynamicProperty&&s._items[l]._dynamicProperty[o.actProp._path]){p=!1;break}p&&o.actProp._helperNodes.delete(s)}}if(!n[r]&&(n[r]="dynamicNodes",i=o.actProp._dynamicNodes)){var d=i.indexOf(e);i.splice(d,1),i.length||delete o.actProp._dynamicNodes}}if(e.syntaxValue||e.helperValue){var c=void 0,m=void 0;if(e._contextSwitchInfo||2===e.nodeType&&e.ownerElement._contextSwitchInfo){c=e._contextSwitchInfo||e.ownerElement._contextSwitchInfo;var u=[];LyteComponent.changeContext(c.node,u,c)}else if("LYTE-YIELD"===e.tagName&&e._callee._contextSwitchInfo){m=!0,c=e._callee._contextSwitchInfo;u=[];LyteComponent.changeContext(c.node,u,c,!0)}var f=void 0,h=[];if(e.helperValue){var y=f=e.helperValue;if(f=this.processHelper({name:y.name,args:this.processArgs(this,y.args,h)},e),"unescape"===y.name){for(var _=e.dynamicPositions,v=_.startingNode,g=_.length;g>1;){var b=v.nextSibling;v.remove(),v=b,g--}var C=f.childNodes.length;C||(f.appendChild(document.createTextNode("")),C=1);var L=f.childNodes[0];v.replaceWith.apply(v,f.childNodes);var w={startingNode:L,length:C};e.dynamicPositions=w,f=void 0}}else{var A=e.syntaxValue,N=void 0;-1===A.indexOf(".")&&-1===A.indexOf("[")||(N=A,A=A.substring(0,A.indexOf(".")));var x=N?LyteComponent.get(this.component.data,N,h):this.component.data[A];f="boolean"===!(void 0===x||_typeof(x))&&"number"===!(void 0===x||_typeof(x))?x||"":x}if(h[0]instanceof Array||(h=[h]),n)for(r=0;r<n.length;r++)if(n[r]){var E=e._multipleProperty[r],I=this.getProperty(h[r][0]),S=this.getProperty(h[r][0].substring(0,h[r][0].indexOf("."))),P=this.getData(h[r][0].substring(0,h[r][0].indexOf(".")));if("dynamicNodes"===n[r])I._dynamicNodes||Object.defineProperty(I,"_dynamicNodes",{value:[],enumerable:!1,writable:!0,configurable:!0}),I._dynamicNodes.push(e);else{I._helperNodes||Object.defineProperty(I,"_helperNodes",{value:new Set,writable:!0,enumerable:!1,configurable:!0}),I._helperNodes.add(E.helperNode);var k=E.dynamicProp;k[I._path]?k[I._path].push(e):(k[I._path]=[]).push(e)}LyteComponent.establishBindings(S,P),e._multipleProperty[r].actProp=I,e._multipleProperty[r].dynamicValues=h[r]}if(2===e.nodeType){var O=[],j=e._parentNode?e._parentNode:e.ownerElement;if("TEMPLATE"===j.tagName&&"component"===j.getAttribute("is")&&"component-name"!==e.nodeName){if(j.hasAttribute("lyte-keep-alive"))for(var B in j._renderedComponent)O.push(j._renderedComponent[B]);else O.push(j._renderedComponent[j.getAttribute("component-name")])}O.push(j);for(var D=0;D<O.length;D++){var H=O[D];if(H.set?H.set(LyteComponent.String.toCamelCase(e.nodeName),f,!0):(H._initProperties=H._initProperties||{},H._initProperties[LyteComponent.String.toCamelCase(e.nodeName)]=f),"LYTE-YIELD"===H.tagName&&H.component.data&&e.nodeName&&H.component.data[e.nodeName]!==f&&LyteComponent.set(H.component.data,LyteComponent.String.toCamelCase(e.nodeName),f,void 0,H),H._attributes=H._attributes||{},LyteComponent.isCustomElement(H,!0)&&"string"!=typeof f&&void 0!==f){if("TEMPLATE"===e.ownerElement.nodeName){if(e.helperValue&&("for"===e.ownerElement.getAttribute("is")&&"items"===e.nodeName||"forIn"===e.ownerElement.getAttribute("is")&&"object"===e.nodeName)){var T=e.ownerElement._attributes[e.nodeName],M=f;LyteComponent.removeSelectedBindingDeep(e.ownerElement._actualBinding,T),M&&(M._bindings||Object.defineProperty(M,"_bindings",{enumerable:!1,writable:!0,value:new Set,configurable:!0}),M._bindings.add(e.ownerElement._actualBinding),LyteComponent.establishBindings(e.ownerElement._actualBinding,M)),"object"===e.nodeName&&LyteComponent.removeSelectedBindingDeep(e.ownerElement._propBindingObject,T)}H.removeAttribute(e.nodeName)}}else if("boolean"==typeof f)H._attributes=H._attributes||{},H._attributes[e.nodeName]=f,f?H.setAttribute(e.nodeName,""):H.removeAttribute(e.nodeName);else{var Y=void 0===(f="object"===(void 0===f?"undefined":_typeof(f))?"undefined"!=typeof Record&&f instanceof Record?JSON.stringify(f.$.toJSON()):JSON.stringify(f):f)?"":f;"style"===e.nodeName?e.ownerElement.setAttribute("style",Y):e.nodeValue=Y}H._attributes[e.nodeName]=f,/^(INPUT|TEXTAREA|SELECT)$/.test(H.nodeName)&&("value"===e.nodeName?H.value=void 0===f?"":f:"checked"===e.nodeName&&(H.checked=f));var V=H._isStopped,F=void 0;switch(H.getAttribute("is")){case"for":this.updateForHelper(H,{type:"update"});break;case"if":F=this.updateSwitchHelper("if",H,void 0,!0,!0);break;case"forIn":this.updateForInHelper(H,{type:"update"});break;case"switch":this.updateSwitchHelper("switch",H,void 0,!0,!0);break;case"component":"component-name"===e.nodeName&&this.updateDynamicComponent(H,"update")}var R=void 0;V&&V!==F?R=F?"break"===F?"MS":"SM":"break"===V?"SM":"SS":"break"===F?R="MS":"continue"===F&&(R="SS"),R&&this.handleBreak(H._contextSwitchInfo,R)}}else e.nodeValue=void 0===f?"":f;c&&LyteComponent.removeContext(c.node,u,c,m)}}},{key:"handleBreak",value:function(e,t){if(e){for(var n=e.node,o=e.itemIndex,r=(n.getAttribute("item"),e.node._forContent),i="M"===t[0]?r.length:o+1,a=o;a<i;a++){for(var s=r[a],p=0;p<s.length;p++)s[p].remove(),(s[p]._forContent||s[p]._caseContent)&&this.removeHelpers(s[p]);r[a]=[],LyteComponent.removeSelectedBindingDeep(n._items[a].itemProperty,n._attributes.items[a]),n._helpers[a]=[],n._items[a]={_dynamicProperty:{},itemProperty:{},indexProperty:{}}}var l=n._attributes.items.length;"M"===t[1]?this.updateForHelper(n,{firstIndex:o,secondIndex:l-o,type:"replace"},void 0,{}):this.updateForHelper(n,{firstIndex:o,secondIndex:1,type:"replace"},void 0,{})}}},{key:"createCustomEvent",value:function(e,t,n){var o=new CustomEvent(e);t._actions[e]=o,t._actions[e].processAction=n}},{key:"isEmptyString",value:function(e){return!("string"==typeof e)||""===e}},{key:"processArgs",value:function(e,t,n,o,r){n=n||[],t=Array.isArray(t)?Array.from(t):t;for(var i=0;i<t.length;i++)if(this.isEmptyString(t[i]))t[i]&&t[i].type&&this.internalHelpers(e,t,i,n,o,r);else if(t[i].startsWith("'")&&t[i].endsWith("'"))t[i]=t[i].substr(1,t[i].length-2);else{t[i]=t[i].trim();var a=[];"event"===t[i]&&o?t[i]=o:"this"===t[i]&&r?t[i]=2===r.nodeType?r.ownerElement:r:t[i]=LyteComponent.get(e.component.data,t[i],a),n.push(a)}return t}},{key:"internalHelpers",value:function(e,t,n,o,r,i){var a=t[n].value,s=this.processHelper({name:a.name,args:this.processArgs(e,a.args,o,r,i)});t[n]=s}},{key:"processHelper",value:function(e,t){var n=[];if("method"===e.name&&n.push(this,t),"lbind"===e.name&&n.push(t.ownerElement),Lyte.Component.registeredHelpers[e.name])return Lyte.Component.registeredHelpers[e.name].apply(this,n.concat(e.args));Lyte.error("LC003",e.name)}},{key:"getActionProperty",value:function(e){var t=this._properties;return t?t[e].value:void 0}},{key:"hasInternalBindings",value:function(e){return e.match(/[(]{1}[^)]+[)]{1}/)}},{key:"getArgValues",value:function(e,t){for(var n=[],o=0;o<e.length;o++)n.push(t[e[o]].value);return n}},{key:"createEventListeners",value:function(e,t,n){var o=this;if(e._callee=this,!/^(focus|focusin|focusout|resize|scroll|click|dblclick|mousedown|mouseup|mousemove|mouseover|mouseout|change|select|submit|keydown|keypress|keyup|contextmenu)$/.test(t)){var r=t.substr(2),i=(e.getAttribute(r),function(r){var i;window.event||(window.event=r,i=!0),LyteComponent.throwAction.call(o,o,t.substr(2),n,void 0,void 0,e,r),i&&(window.event=void 0)});Lyte.Component.registeredComponents[e.localName]&&!e.component||"TEMPLATE"===e.tagName&&"component"===e.getAttribute("is")?(e._toRegEvnts=e._toRegEvnts||{},e._toRegEvnts[t.substr(2)]={listener:i,attrVal:this.tagName.toLowerCase()+" => "+n.name}):(e.setAttribute(r,this.tagName.toLowerCase()+" => "+n.name),e.addEventListener(t.substr(2),i)),e.hasAttribute(t)&&(e[t]=void 0),e.removeAttribute(t)}}},{key:"registerYields",value:function(){this._yields={};for(var e=this.querySelectorAll("template[is=registerYield],template[is=yield]"),t=0;t<e.length;t++){var n=void 0;e[t].hasAttribute("from-parent")&&this._callee&&(n=this._callee._yields[e[t].getAttribute("yield-name")])?this._yields[e[t].getAttribute("yield-name")]=n:this._yields[e[t].getAttribute("yield-name")]=e[t]}}},{key:"connectedCallback",value:function(){if(!this.hasAttribute("lyte-rendered")&&Lyte.Component.registeredComponents[this.localName]){var e=this.constructor._templateAttributes;if(e&&e.attr)for(var t in e.attr){var n=e.attr[t];if(!this.hasAttribute(n.name)&&!this.component.data.hasOwnProperty(n.name)||n.globalEvent)if(n.globalEvent){this._evBoundEvents=this._evBoundEvents||{};var o=n.helperInfo.args[0],r=void 0;o.startsWith('"')||o.startsWith("'")?r=o.substring(1,o.length-1):(console.warn("Deprecation warning. Action name should be in quotes"),r=o),this._evBoundEvents[n.name]={name:r,args:n.helperInfo.args,from:"component"};var i=this.getAttribute(n.name),a=this.constructor._template.getAttribute(n.name);this.setAttribute(n.name,a+(i?" ; "+i:""))}else n.from="component",n.staticValue?this.setAttribute(e.attr[t].name,n.staticValue):(this.setAttribute(e.attr[t].name,"{{dummy}}"),this.bindNode(this.attributes.getNamedItem(e.attr[t].name),[],void 0,{},e.attr[t],void 0,void 0,!0))}for(var s in this._toRegEvnts)this.addEventListener(s,this._toRegEvnts[s].listener),this.hasAttribute(s)?this.setAttribute(s,this.getAttribute(s)+" ; "+this._toRegEvnts[s].attrVal):this.setAttribute(s,this._toRegEvnts[s].attrVal);this._toRegEvnts={};var p=this.afterConnected();LyteComponent.unbound||(LyteComponent.establishObserverBindings.call(this,this.constructor._observers),Object.defineProperty(this.component,"_bindings",{enumerable:!1,writable:!0,configurable:!0,value:new Set}),this.component._bindings.add(this._properties),LyteComponent.establishBindings(this._properties,this.component.data)),LyteComponent.unbound=!1,this.appendChild(p),this.setAttribute("lyte-rendered","");var l=new CustomEvent("onReady");this.dispatchEvent(l),this.callback("didConnect"),this.onCallBack("didConnect")}}},{key:"onCallBack",value:function(e){var t=this.constructor._callBacks[e];if(t)for(var n=0;n<t.length;n++)try{t[n].value.call(this.component)}catch(e){Lyte.error(e)}}},{key:"callback",value:function(e){var t,n=this.component[e];if(n){arguments.length>1&&(t=Array.from(arguments)).splice(0,1);try{n.apply(this.component,t||[])}catch(e){Lyte.error(e)}}}},{key:"establishObserverBindings",value:function(){for(var e=this.constructor._observers,t=0;t<e.length;t++)for(var n=e[t].properties,o=0;o<n.length;o++){var r=void 0,i=!1;-1!==n[o].indexOf(".[]")?(i=!0,r=this.getProperty(n[o].substring(0,n[o].indexOf(".[]")))):r=this.getProperty(n[o]),r._observers||Object.defineProperty(r,"_observers",{value:new Set,enumerable:!1,writable:!0,configurable:!0}),r._observers.add({callee:this,observer:e[t],isArrayObserver:i})}}},{key:"removeBindings",value:function(e,t){for(var n in e){var o=t[n];o&&o._bindings&&o._bindings.delete(e[n]),"object"===_typeof(e[n])&&o&&this.removeBindings(e[n],o)}}},{key:"disconnectedCallback",value:function(){if(!LyteComponent.ignoreDisconnect){this.component._bindings=null,LyteComponent.removeSelectedBindingDeep(this._properties,this.component.data);for(var e in this._properties)this._properties[e]={};this.callback("didDestroy"),this.onCallBack("didDestroy");var t=this;setTimeout(function(){t.component&&(t.component.$node=null,t.component.__data=null,t.component.data.__component__=null,t.component.data=null,t.component=null,t=null)},0),this.constructor.activeInstances--}}}],[{key:"getArrayIndex",value:function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n}},{key:"getTrimmedContent",value:function(e,t,n){var o=e;if(n){t=[];for(var r=n.parentNode;t.unshift(this.getArrayIndex(r.childNodes,n)),r=r.parentNode,n=n.parentNode,r;);}for(var i=0;i<t.length;i++){for(var a=e.childNodes.length-1;a>t[i];a--)e.childNodes[a].remove();e=e.childNodes[t[i]]}return o}},{key:"updateValue",value:function(e,t,n){for(var o=t.split("."),r=e,a=0;a<o.length-1;a++)r=r[o[a]];r[o[i]]=n}},{key:"createDocFragment",value:function(e){for(var t=e.cloneNode(!0,"lyte").childNodes,n=document.createDocumentFragment(),o=t.length,r=0;r<o;r++)n.appendChild(t[0]);return n}},{key:"createDocFragment1",value:function(e){if(window.isEdgeLyte)return e.content;for(var t=e.childNodes,n=document.createDocumentFragment(),o=t.length,r=0;r<o;r++)n.appendChild(t[0]);return n}},{key:"_registerComponent",value:function(e,t){var n=LyteComponent.lyteComponentsDiv,o=Lyte.$.assetsDiv;if(this._template&&"string"==typeof this._template){this._template.replace(/\\'/g,"'");var r=document.createElement("div");for(r.innerHTML=this._template;r.firstChild;)"STYLE"===r.firstChild.nodeName?o.appendChild(r.firstChild):n.appendChild(r.firstChild)}else document.querySelector("template[tag-name='"+e+"']")&&n.appendChild(document.querySelector("template[tag-name='"+e+"']"));if(this._template=n.querySelector("template[tag-name='"+e+"']"),this._template){LyteComponent.needDummyComponentsDiv&&LyteComponent.dummyLyteComponentsDiv.appendChild(this._template.cloneNode(!0)),this._template&&this._template.content;var i=window.isIE11Lyte?this._template:this._template.content;if(this.splitTextNodes(i),this._dynamicNodes||(Lyte.Compile.getDynamicNodes?this._dynamicNodes=Lyte.Compile.getDynamicNodes(e).dynamicNodes:Lyte.error("LC002",e)),this._dynamicNodes){doCompile(i,this._dynamicNodes,e),window.isEdgeLyte?this._templateContent=this._template.outerHTML:window.isIE11Lyte&&(this._templateContent=i.outerHTML),this._templateAttributes=this._templateAttributes||{type:"attr",attr:{},position:[]};var a=[this._templateAttributes];if(doCompile(this._template,a,e),this._templateAttributes=a[0],this._templateAttributes&&this._templateAttributes.attr){var s=this._template.attributes;try{for(var p=0;p<s.length;p++)this._templateAttributes.attr[s[p].name]||"tag-name"===s[p].name||"use-strict"===s[p].name||(this._templateAttributes.attr[s[p].name]={name:s[p].name,staticValue:s[p].value})}catch(e){Lyte.error("Error with templateAttributes. ")}}}}}},{key:"splitTextNodes",value:function(e){if(e&&e.childNodes&&e.childNodes.length)for(var t=e.childNodes.length-1;t>=0;t--)this.splitTextNodes(e.childNodes[t]);if("TEMPLATE"!==e.tagName||window.isIE11Lyte||this.splitTextNodes(e.content),e.nodeType===e.TEXT_NODE){var n=e.nodeValue;if(n){var o=n.match(/{{[^}]*?(?:(?:('|")[^\1]*?\1)[^}]*?)*}}/g);if(!o)return;for(var r=[],i=0;i<o.length;i++){var a=n.indexOf(o[i]),s=a+o[i].length;a&&r.push(document.createTextNode(n.substring(0,a))),r.push(document.createTextNode(n.substring(a,s))),n=n.substring(s)}if((n.trim()||!e.nextSibling||3!==e.nextSibling.nodeType||e.nextSibling.nodeValue.trim())&&r.push(document.createTextNode(n)),window.replaceWithNeeded&&"#document-fragment"===e.parentNode.nodeName){for(var p=0;p<r.length;p++)e.parentNode.insertBefore(r[p],e);e.remove()}else e.replaceWith.apply(e,r)}}}},{key:"observedAttributes",get:function(){for(var e=[],t=0;t<this._observedAttributes.length;t++)e[t]=LyteComponent.String.dasherize(this._observedAttributes[t]);return LyteComponent.customPropHandlers.forEach(function(t,n){e.push(LyteComponent.String.dasherize(t))}),e}}]),t}();Function.prototype.on=function(){return{type:"callBack",value:"observer"===this.type?this.value:this,properties:arguments,observes:"observer"===this.type?this:void 0}},Function.prototype.observes=function(){return{type:"observer",value:this,properties:arguments,on:Function.prototype.on}},Function.prototype.computed=function(){return{type:"computed",value:this,properties:arguments}};var LyteComponent={customPropRegex:"",customPropHandlers:[],_registeredComponents:{},toBeRegistered:[],throwEvent:function(e){var t=this.$node?this.$node:this,n=t._actions?t._actions[e]:void 0,o=[];if(arguments.length>1)for(var r=1;r<arguments.length;r++)o.push(arguments[r]);LyteComponent.throwAction.call(t,t._callee,e,void 0,!0,o,t),this.$node&&t.dispatchEvent(n||new CustomEvent(e,{detail:o}))},throwAction:function(e,t,n,o,r,i,a,s){var p=void 0;if(this._route&&o)p=(e=this._route).actions||(e.actions={});else if(this.routeName){var l=this.parent;l&&(p=l.component?(e=l.component).constructor._actions:(e=l).actions||(e.actions={}))}else e&&(p=e.constructor._actions);if(e){n=n||(this._actions&&this._actions[t]?this._actions[t].processAction:void 0);var d=r||[];if(n){var c=[];if(i&&LyteComponent.newAddContext(i,c),d.splice.apply(d,[0,0].concat(this.processArgs(e,n.args,void 0,a,i))),i&&LyteComponent.newRemoveContext(i,c),p[n.name])if(o)p[n.name].apply(this._callee.component,d),s=!0;else{var m=i.parentNode,u=p[n.name].apply(this.component,d);if(s=!0,!1!==u&&!a.cancelBubble)if(n.from&&i.getAttribute(a.type)&&i._boundEvents&&i._boundEvents[a.type]){i._callee.constructor._actions;var f=i._boundEvents[a.type],h=Lyte.deepCopyObject(f);h.args.shift(),LyteComponent.throwAction.call(i._callee,i._callee,a.type,h,void 0,void 0,i,a,s)}else{if(LyteComponent.hasLyteEvents(i,t)){u=!LyteComponent.handleLyteEvents(i,a)}if(!1===u)return;if(LyteComponent.isCustomElement(i)&&(e=m),m){for(var y=void 0;m&&!m.getAttribute(t)&&"BODY"!=m.tagName&&(!LyteComponent.hasLyteEvents(m,t)||!(y=LyteComponent.handleLyteEvents(m,a)));)m=m.parentNode;if(y||!m||"BODY"===m.tagName)return;if(m._callee||(m._callee=m.getCallee?m.getCallee(m):this.getCallee(m)),m&&a.type===t&&!a.cancelBubble)if(m._evBoundEvents&&m._evBoundEvents[t]){var _=m._evBoundEvents[t],v=Lyte.deepCopyObject(_);v.args.shift(),LyteComponent.throwAction.call(m._callee,m._callee,t,v,void 0,void 0,m,a,s)}else if(m&&m._boundEvents&&m._boundEvents[t]){var g=m._boundEvents[t],b=Lyte.deepCopyObject(g);b.args.shift(),LyteComponent.throwAction.call(m._callee,m._callee,t,b,void 0,void 0,m,a,s)}}}}else Lyte.error("LC004",n.name)}else if(o){var C=p[t]||p[LyteComponent.String.toCamelCase(t)]||p[LyteComponent.String.dasherize(t)];if(C){var L=LyteComponent.isCustomElement(e)?e.component:e;s=!0,!1!==C.apply(L,d)&&LyteComponent.throwAction.call(e,e._callee,t,n,o,r,void 0,void 0,s)}else LyteComponent.throwAction.call(e,e._callee,t,n,o,r,void 0,void 0,s)}}else s||console.warn("Nothing handled the action "+t+".")},processHelperArgs:function(){},isControlHelper:function(e){return"TEMPLATE"===e.tagName&&e.getAttribute("is")&&"component"!==e.getAttribute("is")},isCustomElement:function(e,t){return"TEMPLATE"===e.tagName&&t||e.nodeName&&-1!==e.nodeName.indexOf("-")&&(Lyte.Component.registeredComponents[e.localName]||"LYTE-YIELD"===e.tagName)},componentSet:function(e,t,n,o){(n||this.get(e)!==t)&&LyteComponent.set(this.data,e,t,void 0,o)},componentGet:function(e){return e?LyteComponent.get(this.data,e):this.data},nodeGet:function(e){return e?this.component.get(e):this.component.data},nodeSet:function(e,t,n){this.component.set(e,t,void 0,n)},registerComponent:function(e,t,n){function o(){}if(Lyte.Component.registeredComponents[e])console.warn("Component "+e+" already registered");else{var r=void 0;LyteComponent._registeredComponents[e]?r=LyteComponent._registeredComponents[e]:((r=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,customElementPrototype),t}())._properties={},r.activeInstances=0,r.prototype.get=this.nodeGet,r.prototype.set=this.nodeSet,r.prototype.throwAction=this.throwAction);var i=[];(n=n||{}).mixins&&n.mixins.forEach(function(e){i.push(Lyte.registeredMixins[e])}),r.component=o,o.prototype.set=this.componentSet,o.prototype.get=this.componentGet,o.prototype.throwEvent=this.throwEvent,o.prototype.executeMethod=LyteComponent.executeMethod,o.prototype.getData=LyteComponent.componentGetData,o.prototype.setData=LyteComponent.componentSetData,o.prototype.getMethods=LyteComponent.componentGetMethods,o.prototype.setMethods=LyteComponent.componentSetMethods,r._mixins=n.mixins;for(var a=i.length,s={},p={},l={},d=0;d<a;d++)for(var c in i[d])"actions"===c?Object.assign(s,i[d][c]):"methods"===c?Object.assign(p,i[d][c]):l[c]=i[d][c];t=Object.assign(l,t),r._actions=Object.assign({},s,t.actions),r._template=t._template,delete t._template,r._dynamicNodes=t._dynamicNodes,delete t._dynamicNodes,r._templateAttributes=t._templateAttributes,delete t._templateAttributes,r._callBacks={},r._observers=[];var m=t.data?t.data:void 0,u=Object.assign({},p,t.methods);r._observedAttributes=t._observedAttributes||[],r._observedMethodAttributes=t._observedMethodAttributes||{},delete t._observedAttributes,delete t._observedMethodAttributes,delete t.data,delete t.methods;for(var f in t)if("observer"===t[f].type)r._observers.push(t[f]);else if("callBack"===t[f].type){for(var h=t[f].properties,y=0;y<h.length;y++)r._callBacks[h[y]]||(r._callBacks[h[y]]=[]),r._callBacks[h[y]].push(t[f]);t[f].observes&&r._observers.push(t[f].observes)}else o.prototype[f]=t[f];r._data=m,r._methods=u,r._registerComponent(e,r),Lyte.Component.registeredComponents[e]=!0,LyteComponent._registeredComponents[e]||("complete"===document.readyState||"interactive"===document.readyState?customElements.define(e,r):LyteComponent.toBeRegistered.push({name:e,def:r})),LyteComponent._registeredComponents[e]=r}},registerHelper:function(e,t){Lyte.Component.registeredHelpers[e]=t},registerMixin:function(e,t){Lyte.Mixin.register.call(Lyte,e,t)},typeCast:function(e,t,n){if(null===e)return"boolean"!==t&&void 0;try{switch(t){case"string":return"object"===(void 0===e?"undefined":_typeof(e))?JSON.stringify(e):e.toString();case"number":var o=+e;if(isNaN(o))throw"TypeCast exception";return o;case"array":case"object":return JSON.parse(e);case"boolean":return!(!e&&""!==e||"false"===e);default:return e}}catch(t){return n&&(n.isError=!0),e}},getDataType:function(e){var t=void 0===e?"undefined":_typeof(e);return"object"===t&&e instanceof Array?"array":t},update:function(e,t,n,o,r,i,a,s){var p=e.__component__,l=!0;if(!r)if(r=e[t],e.hasOwnProperty(t)||e instanceof Array||LyteComponent.objectFunctions(e,"add",t,n,!0),p&&"LYTE-YIELD"!==p.tagName){var d=void 0,c=p.component.__data[t];if(c&&(d=c.type)&&(l=!c.hideAttr,d===LyteComponent.getDataType(n)||void 0===n&&"boolean"!==d||(n=LyteComponent.typeCast(n,d))),n===r)return;var m=Lyte.validate(e,t,n,p.component);if(m)return LyteComponent.set(p.component.data.errors,t,m),void p.callback("onError",t,m);p.component.data.errors[t]&&Lyte.objectUtils(p.component.data.errors,"delete",t),e[t]=n}else e[t]=n;var u=!!p,f=LyteComponent.String.dasherize(t);if(p&&a&&("string"==typeof n&&p.getAttribute(f)!==n||p.hasAttribute(f))&&(!LyteComponent.customPropRegex.exec(t)||p.hasAttribute(f))&&l)if("object"===(void 0===n?"undefined":_typeof(n))){var h=JSON.stringify(n);p.attributes.getNamedItem(f).__lyteIgnore=!0,p.setAttribute(f,h)}else{var y=LyteComponent.typeCast(n,"string");if(p.getAttribute(f)!==y){var _=p.attributes.getNamedItem(f);_&&(_.__lyteIgnore=!0),y=y||"",p.setAttribute(f,y)}}if(n&&"string"!=typeof n&&"boolean"!=typeof n&&"number"!=typeof n){if(r&&"object"===(void 0===r?"undefined":_typeof(r))&&r._bindings){if(n._bindings||Object.defineProperty(n,"_bindings",{enumerable:!1,writable:!0,value:new Set,configurable:!0}),p&&p.component.data===e&&-1===t.indexOf(".")){var v=p.getProperty(t);if(this.removeSelectedBindingDeep(v,r),n._bindings.add(v),this.establishBindings(v,n),v._forHelpers)for(var g=v._forHelpers.toArrayLyte(),b=0;b<g.length;b++){var C=g[b];C._propBindingObject&&this.removeSelectedBindingDeep(C._propBindingObject,r)}this.affectChanges(v,void 0,r,i,e[t])}else if(e._bindings)for(var L=e._bindings.toArrayLyte(),w=0;w<L.length;w++){var A=L[w][t];if(A){if(this.removeSelectedBindingDeep(A,r),n._bindings.add(A),this.establishBindings(A,n),A._forHelpers)for(var N=A._forHelpers.toArrayLyte(),x=0;x<N.length;x++){var E=N[x];E._propBindingObject&&this.removeSelectedBindingDeep(E._propBindingObject,r)}this.affectChanges(A,void 0,r,i,e[t])}}}else if(e._bindings){n._bindings||Object.defineProperty(n,"_bindings",{enumerable:!1,writable:!0,value:new Set,configurable:!0});for(var I=e._bindings.toArrayLyte(),S=0;S<I.length;S++){var P=I[S];P[t]&&(n._bindings.add(P[t]),this.establishBindings(P[t],n),this.affectChanges(P[t],void 0,r,i,e[t]))}}}else{if(r&&"object"===(void 0===r?"undefined":_typeof(r))&&r._bindings)for(var k=e._bindings.toArrayLyte(),O=0;O<k.length;O++){var j=k[O];if(j[t]&&(this.removeSelectedBindingDeep(j[t],r),j[t]._forHelpers))for(var B=j[t]._forHelpers.toArrayLyte(),D=0;D<B.length;D++){var H=B[D];H._propBindingObject&&this.removeSelectedBindingDeep(H._propBindingObject,r)}}if(e._bindings)for(var T=e._bindings.toArrayLyte(),M=0;M<T.length;M++){var Y=T[M];Y[t]&&this.affectChanges(Y[t],void 0,r,i,e[t])}}if(u&&!s&&p._attributeDetails&&p._callee){var V=p._attributeDetails[LyteComponent.String.dasherize(t)],F=void 0;if(V&&V.isLbind&&(F=V.dynamicValue),F){var R=void 0;p._contextSwitchInfo&&(R=[],LyteComponent.changeContext(p._contextSwitchInfo.node,R,p._contextSwitchInfo));var W=LyteComponent.getNew(p._callee.component.data,F),$=!1;W.context===p._callee.component.data?p._callee._properties[W.lastKey]&&p._callee._properties[W.lastKey].__fromComponent&&($=!0):$=!0,$&&LyteComponent.set(W.context,W.lastKey,n),R&&LyteComponent.removeContext(p._contextSwitchInfo.node,R,p._contextSwitchInfo)}}},set:function(e,t,n,o,r){if("string"!=typeof t||e[t]!==n){var i=-1,a=t;if(t instanceof Object||(i=t.lastIndexOf(".")),-1!==i){var s=t.substring(0,i);t=t.substring(i+1),e=LyteComponent.get(e,s)}var p=[];if(e._setterScope)var l=e._setterScope;if(a=a===t?a:void 0,t instanceof Object)if(Lyte.isRecord(e)&&!o){for(var d in t)Array.isArray(e[d])?p.push({key:d,oldValue:e[d].slice(0)}):p.push({key:d,oldValue:e[d]});var c=store.$.setData(e.$,t);if(c.$.isError)return c;for(var m=0;m<p.length;m++)LyteComponent.update(e,p[m].key,e[p[m].key],o,void 0===p[m].oldValue?null:p[m].oldValue,l,a,r)}else for(var u in t)LyteComponent.update(e,u,t[u],o,void 0,l,a,r);else if(Lyte.isRecord(e)&&!o){e[t];var f=e.$.model.fieldList[t];!(f=f?f.type:void 0)||void 0===n&&"boolean"!==f||f===LyteComponent.getDataType(n)||(n=LyteComponent.typeCast(n,f));var h=store.$.setData(e.$,t,n);if(h.$.isError)return h}else LyteComponent.update(e,t,n,o,void 0,l,a,r)}},newAddContext:function(e,t){var n="LYTE-YIELD"===e.tagName;!e._contextSwitchInfo||n&&"LYTE-YIELD"===e._contextSwitchInfo.node.tagName?n&&e._callee._contextSwitchInfo&&LyteComponent.changeContext(e._callee._contextSwitchInfo.node,t,e._callee._contextSwitchInfo,!0):LyteComponent.changeContext(e._contextSwitchInfo.node,t,e._contextSwitchInfo,n)},newRemoveContext:function(e,t){var n="LYTE-YIELD"===e.tagName;!e._contextSwitchInfo||n&&"LYTE-YIELD"===e._contextSwitchInfo.node.tagName?n&&e._callee._contextSwitchInfo&&LyteComponent.removeContext(e._callee._contextSwitchInfo.node,t,e._callee._contextSwitchInfo,!0):LyteComponent.removeContext(e._contextSwitchInfo.node,t,e._contextSwitchInfo,n)},changeContext:function(e,t,n,o){if(n){var r="LYTE-YIELD"===e.tagName;!e._contextSwitchInfo||r&&"LYTE-YIELD"===e._contextSwitchInfo.node.tagName?("LYTE-YIELD"===e.tagName||o)&&e._callee&&e._callee._contextSwitchInfo&&LyteComponent.changeContext(e._callee._contextSwitchInfo.node,t,e._callee._contextSwitchInfo):LyteComponent.changeContext(e._contextSwitchInfo.node,t,e._contextSwitchInfo,"LYTE-YIELD"===e.tagName||o);var i=void 0,a=void 0;if(n.type){if("for"===n.type){if(i=e.getAttribute("index"),a=e.getAttribute("item"),0===e._items.length)return}else if(i=e.getAttribute("key"),a=e.getAttribute("value"),0===Object.keys(e._items).length)return;var s=e._callee,p=s.component.data[a],l=s.component.data[i],d=s._properties[a],c=s._properties[i],m="for"===n.type?e._attributes.items:e._attributes.object;s.component.data[a]=m[n.itemIndex],s.component.data[i]=n.itemIndex,s._properties[a]=e._items[n.itemIndex].itemProperty,s._properties[i]={};var u={initialItemValue:p,initialIndexValue:l,initialItemProp:d,initialIndexProp:c};t.push(u)}else{var f={},h=e._registerYield._callee;Object.keys(n.node._properties).forEach(function(e){f[e]={},f[e].value=h.component.data[e],f[e].property=h._properties[e],h._properties[e]=n.node._properties[e],h.component.data[e]=n.node.component.data[e]}),t.push(f)}}},removeContext:function(e,t,n,o){if(n){var r="LYTE-YIELD"===e.tagName;!e._contextSwitchInfo||r&&"LYTE-YIELD"===e._contextSwitchInfo.node.tagName?("LYTE-YIELD"===e.tagName||o)&&e._callee&&e._callee._contextSwitchInfo&&LyteComponent.removeContext(e._callee._contextSwitchInfo.node,t,e._callee._contextSwitchInfo):LyteComponent.removeContext(e._contextSwitchInfo.node,t,e._contextSwitchInfo,"LYTE-YIELD"===e.tagName||o);var i=void 0,a=void 0;if(n.type){if("for"===n.type){if(i=e.getAttribute("index"),a=e.getAttribute("item"),0===e._items.length)return}else if(i=e.getAttribute("key"),a=e.getAttribute("value"),0===Object.keys(e._items).length)return;var s=e._callee,p=(e._attributes.items,t.shift());s.component.data[a]=p.initialItemValue,s.component.data[i]=p.initialIndexValue,s._properties[a]=p.initialItemProp,s._properties[i]=p.initialIndexProp}else{var l=e._registerYield._callee,d=t.shift();Object.keys(n.node._properties).forEach(function(e){l.component.data[e]=d[e].value,l._properties[e]=d[e].property})}}},objectFunctions:function(){var e=arguments[0],t=arguments[1],n=arguments[2],o=arguments[3],r=arguments[4];if("add"!==t||r){var i={};if(i.type=t,i.property=n,/^(add|delete)$/.test(t)){var a=e._bindings;if("delete"===t&&LyteComponent.set(e,n,void 0),a)for(var s=a.toArrayLyte(),p=0;p<s.length;p++){var l=s[p]._forHelpers;if(l)for(var d=l.toArrayLyte(),c=0;c<d.length;c++){var m=d[c],u=(m.getAttribute("key"),[]);"add"===t&&LyteComponent.newAddContext(m,u),m._callee.updateForInHelper(m,i),"add"===t&&LyteComponent.newRemoveContext(m,u)}}"delete"===t&&delete e[n]}else Lyte.error("LC005",t)}else LyteComponent.set(e,n,o)},arrayFunctions:function(){var e=arguments[0],t=arguments[1];if(!/^(replaceAt|removeAt|shift)$/.test(t)||e.length){var n=arguments[2];switch(t){case"replaceAt":var o=parseInt(arguments[2]);if(o>e.length)return console.warn("index provided for replaceAt is greater than array length"),[];var r=arguments[3];r instanceof Array||(r=[r]);var i=e.splice.apply(e,[o,1].concat(r)),a={firstIndex:o,secondIndex:r.length,type:"replace"};if(e._bindings)for(var s=e._bindings.toArrayLyte(),p=0;p<s.length;p++){var l=s[p];if(l._forHelpers)for(var d=l._forHelpers.toArrayLyte(),c=0;c<d.length;c++){var m=d[c];if(!m.hasAttribute("unbound")){for(var u=o+i.length,f=m.getAttribute("item"),h=o,y=0;h<u;h++,y++)LyteComponent.removeSelectedBindingDeep(_defineProperty({},f,m._items[h].itemProperty),_defineProperty({},f,i[y]));var _=[];LyteComponent.newAddContext(m,_),m._callee.updateForHelper(m,a),LyteComponent.newRemoveContext(m,_)}}for(var v in l){var g=parseInt(v);if(!isNaN(g)&&g>=a.firstIndex){var b=g-a.firstIndex,C=void 0;if(C=b<=a.thirdIndex?i[b]:e[a.firstIndex-1+a.secondIndex+b],this.removeSelectedBindingDeep(l[v],C),l[v]._forHelpers)for(var L=l[v]._forHelpers.toArrayLyte(),w=0;w<L.length;w++){var A=L[w];A._propBindingObject&&this.removeSelectedBindingDeep(A._propBindingObject,C)}e[g]&&"object"===_typeof(e[g])&&(e[g]._bindings||Object.defineProperty(e[g],"_bindings",{enumerable:!1,writable:!0,value:new Set,configurable:!0}),this.establishBindings({dummy:l[v]},{dummy:e[g]})),this.affectChanges(l[v])}}}return LyteComponent.callArrayObservers(e,{type:"array",insertedItems:r,index:o}),i[0];case"splice":var N=parseInt(arguments[2]);if(N>e.length)return console.warn("index provided for replaceAt is greater than array length"),[];var x=arguments[3],E=arguments[4];E instanceof Array||(E=[E]);var I=e.splice.apply(e,[N,x].concat(E)),S={firstIndex:N,secondIndex:E.length,thirdIndex:x,type:"splice"};if(e._bindings)for(var P=e._bindings.toArrayLyte(),k=0;k<P.length;k++){var O=P[k];if(O._forHelpers)for(var j=O._forHelpers.toArrayLyte(),B=0;B<j.length;B++){var D=j[B];if(!D.hasAttribute("unbound")){for(var H=N+I.length,T=D.getAttribute("item"),M=N,Y=0;M<H;M++,Y++)LyteComponent.removeSelectedBindingDeep(_defineProperty({},T,D._items[M].itemProperty),_defineProperty({},T,I[Y]));var V=[];LyteComponent.newAddContext(D,V),D._callee.updateForHelper(D,S),LyteComponent.newRemoveContext(D,V)}}for(var F in O){var R=parseInt(F);if(!isNaN(R)&&R>=S.firstIndex){var W=R-S.firstIndex,$=void 0;if($=W<=S.thirdIndex?I[W]:e[S.firstIndex-S.thirdIndex+S.secondIndex+W],this.removeSelectedBindingDeep(O[F],$),O[F]._forHelpers){var q=O[F]._forHelpers.toArrayLyte();for(w=0;w<q.length;w++){var z=q[w];z._propBindingObject&&this.removeSelectedBindingDeep(z._propBindingObject,$)}}e[R]&&"object"===_typeof(e[R])&&(e[R]._bindings||Object.defineProperty(e[R],"_bindings",{enumerable:!1,writable:!0,value:new Set,configurable:!0}),this.establishBindings({dummy:O[F]},{dummy:e[R]})),this.affectChanges(O[F])}}}return LyteComponent.callArrayObservers(e,{type:"array",index:N,insertedItems:E,removedItems:I}),I;case"push":var J=arguments[2];J instanceof Array||(J=[J]),LyteComponent.arrayFunctions(e,"insertAt",e.length,J);break;case"pop":return LyteComponent.arrayFunctions(e,"remove",e.length-1)[0];case"shift":case"shiftObject":return LyteComponent.arrayFunctions(e,"remove",0)[0];case"removeAt":case"remove":var U=parseInt(arguments[2]);if(U>e.length)return console.warn("index provided for removeAt is greater than array length"),[];var G=arguments[3]?parseInt(arguments[3]):1,K={firstIndex:U,secondIndex:G,type:"remove"},X=e.splice(U,G);if(e._bindings)for(var Z=e._bindings.toArrayLyte(),Q=0;Q<Z.length;Q++){var ee=Z[Q];if(ee._forHelpers)for(var te=ee._forHelpers.toArrayLyte(),ne=0;ne<te.length;ne++){var oe=te[ne];if(!oe.hasAttribute("unbound")){for(var re=U+X.length,ie=oe.getAttribute("item"),ae=U,se=0;ae<re;ae++,se++)LyteComponent.removeSelectedBindingDeep(_defineProperty({},ie,oe._items[ae].itemProperty),_defineProperty({},ie,X[se]));var pe=[];LyteComponent.newAddContext(oe,pe),oe._callee.updateForHelper(oe,K),LyteComponent.newRemoveContext(oe,pe)}}for(var le in ee){var de=parseInt(le);if(!isNaN(de)&&de>=K.firstIndex){var ce=de-K.firstIndex,me=void 0;if(me=ce<K.secondIndex?X[ce]:e[K.firstIndex-K.secondIndex+ce],this.removeSelectedBindingDeep(ee[le],me),ee[le]._forHelpers){var ue=ee[le]._forHelpers.toArrayLyte();for(w=0;w<ue.length;w++){var fe=ue[w];fe._propBindingObject&&this.removeSelectedBindingDeep(fe._propBindingObject,me)}}e[de]&&"object"===_typeof(e[de])&&(e[de]._bindings||Object.defineProperty(e[de],"_bindings",{enumerable:!1,writable:!0,value:new Set,configurable:!0}),this.establishBindings({dummy:ee[le]},{dummy:e[de]})),this.affectChanges(ee[le])}}}return LyteComponent.callArrayObservers(e,{type:"array",removedItems:X,index:U}),X;case"removeObject":n=[n];case"removeObjects":n instanceof Array||(n=[n]);for(var he=0;he<n.length;he++){var ye=e.indexOf(n[he]);-1!==ye&&LyteComponent.arrayFunctions(e,"removeAt",ye)}break;case"unshift":case"unshiftObject":case"unshiftObjects":var _e=arguments[2];_e instanceof Array||(_e=[_e]),LyteComponent.arrayFunctions(e,"insertAt",0,_e);break;case"insertAt":var ve=parseInt(arguments[2]),ge=arguments[3],be=ge.length;ge instanceof Array||(ge=[ge]);for(var Ce=ve;Ce>e.length;Ce--)ge.unshift(void 0),ve--;var Le={firstIndex:ve,secondIndex:ge.length,type:"insert"};if(e.splice.apply(e,[ve,0].concat(ge)),e._bindings)for(var we=e._bindings.toArrayLyte(),Ae=0;Ae<we.length;Ae++){var Ne=we[Ae];if(Ne._forHelpers)for(var xe=Ne._forHelpers.toArrayLyte(),Ee=0;Ee<xe.length;Ee++)if(!xe[Ee].hasAttribute("unbound")){var Ie=xe[Ee],Se=[];LyteComponent.newAddContext(Ie,Se),Ie._callee.updateForHelper(Ie,Le),LyteComponent.newRemoveContext(Ie,Se)}for(var Pe in Ne){var ke=parseInt(Pe);if(!isNaN(ke)&&ke>=Le.firstIndex){if(this.removeSelectedBindingDeep(Ne[Pe],e[ke+Le.secondIndex]),Ne[Pe]._forHelpers){var Oe=Ne[Pe]._forHelpers.toArrayLyte();for(w=0;w<Oe.length;w++){var je=Oe[w];je._propBindingObject&&this.removeSelectedBindingDeep(je._propBindingObject,oldObject)}}e[ke]&&"object"===_typeof(e[ke])&&(e[ke]._bindings||Object.defineProperty(e[ke],"_bindings",{enumerable:!1,writable:!0,value:new Set,configurable:!0}),this.establishBindings({dummy:Ne[Pe]},{dummy:e[ke]})),this.affectChanges(Ne[Pe])}}}var Be=parseInt(arguments[2]);LyteComponent.callArrayObservers(e,{type:"array",insertedItems:arguments[3]instanceof Array?arguments[0].slice(Be,Be+be):[arguments[3]],index:Be});break;case"concat":LyteComponent.arrayFunctions(e,"insertAt",e.length,arguments[2]);break;default:return void Lyte.error("LC006",t)}}else console.warn(t+" operation cannot be performed on empty array")},callArrayObservers:function(e,t){if(e._bindings)for(var n=e._bindings.toArrayLyte(),o=0;o<n.length;o++){var r=n[o],i=n[o]._path;if(r._observers)for(var a=r._observers.toArrayLyte(),s=0;s<a.length;s++){var p=a[s];p.isArrayObserver&&(t&&(t.item=i),p.observer.value.call(p.callee&&p.callee.component?p.callee.component:e._setterScope?e._setterScope:window,t))}r.length&&this.affectChanges(r.length)}},establishUpdateBindings:function(e,t,n){for(var o=e.toArrayLyte(),r=0;r<o.length;r++){var i=o[r];i[t]&&(n._bindings||Object.defineProperty(n,"_bindings",{value:new Set,enumerable:!1,configurable:!0,writable:!0}),n._bindings.add(i[t]),this.establishBindings(i[t],n))}},establishSelectedBinding:function(e,t,n){if(e)for(var o=e._path.split("."),r=n.getProperty(o[0]),i=t[o[0]],a=0;a<o.length&&(i&&"object"===(void 0===i?"undefined":_typeof(i)));a++)i._bindings||Object.defineProperty(i,"_bindings",{enumerable:!1,configurable:!0,writable:!0,value:new Set}),i._bindings.add(r),r=r[o[a+1]],i=i[o[a+1]]},establishBindings:function(e,t){if(e._helperNodes)for(var n=e._path,o=e._helperNodes.toArrayLyte(),r=0;r<o.length;r++){var i=o[r]._dynamicProperty?o[r]._dynamicProperty[n]:void 0;if(i)for(var a=0;a<i.length;a++){var s=i[a].ownerElement;if(s&&"TEMPLATE"===s.tagName&&"for"===s.getAttribute("is")&&s._items){s.getAttribute("item");for(var p=0;p<s._items.length;p++){var l=t[p],d=s.getAttribute("item");l&&"object"===_typeof(s._items[p])&&this.establishBindings(s._items[p].itemProperty,_defineProperty({},d,l))}}}}for(var c in e){var m=t[c];m&&"string"!=typeof m&&"number"!=typeof m&&"boolean"!=typeof m?(m._bindings||Object.defineProperty(m,"_bindings",{value:new Set,enumerable:!1,writable:!0,configurable:!0}),m._bindings.add(e[c]),"object"===_typeof(e[c])&&this.establishBindings(e[c],m)):(t._bindings||Object.defineProperty(t,"_bindings",{value:new Set,enumerable:!1,writable:!0,configurable:!0}),t._bindings.add(e))}},removeSelectedBindingDeep:function(e,t){if(t){t._bindings&&(t._bindings.delete(e),t._bindings.size||delete t._bindings);for(var n in e){var o=t[n];o&&o._bindings&&(o._bindings.delete(e[n]),o._bindings.size||delete o._bindings),"object"===_typeof(e[n])&&o&&this.removeSelectedBindingDeep(e[n],o)}if(e._forHelpers)for(var r=e._forHelpers.toArrayLyte(),i=0;i<r.length;i++){var a=r[i];if("for"===a.getAttribute("is")){a.getAttribute("item");for(var s=a._attributes.items,p=a._items,l=0;l<p.length;l++)this.removeSelectedBindingDeep(p[l].itemProperty,s[l])}else a._propBindingObject&&t._bindings&&(t._bindings.delete(a._propBindingObject),t._bindings.size||delete t._bindings,this.removeSelectedBindingDeep(a._propBindingObject,t))}}},removeAllBindings:function(e,t){for(var n in e)t[n]&&t[n]._bindings&&(t[n]._bindings.delete(e[n]),t[n]._bindings.size||delete t[n]._bindings),t[n]&&"string"!=typeof t[n]&&LyteComponent.removeAllBindings(e[n],t[n])},affectChanges:function(e,t,n,o,r){if(e._dynamicNodes)for(var i=0;i<e._dynamicNodes.length;i++)e._dynamicNodes[i]._callee.updateNode(e._dynamicNodes[i],e._path);var a=e._path;if(e._helperNodes)for(var s=[],p=e._helperNodes.toArrayLyte(),l=0;l<p.length;l++)if(e._helperNodes.has(p[l]))if("for"===p[l].getAttribute("is")&&p[l]._items){var d=[];LyteComponent.newAddContext(p[l],d);for(var c=p[l].getAttribute("index"),m=p[l].getAttribute("item"),u=p[l]._callee,f=u.component.data[m],h=u.component.data[c],y=u._properties[m],_=u._properties[c],v=p[l]._attributes.items,g=0;g<p[l]._items.length;g++)if(u.component.data[m]=v[g],u.component.data[c]=g,u._properties[m]=p[l]._items[g].itemProperty,p[l]._items[g]._dynamicProperty[a]){s=p[l]._items[g]._dynamicProperty[a];for(var b=0;b<s.length;b++)s[b]._callee.updateNode(s[b],a)}u.component.data[m]=f,u.component.data[c]=h,u._properties[m]=y,u._properties[c]=_,LyteComponent.newRemoveContext(p[l],d)}else if("forIn"===p[l].getAttribute("is")&&p[l]._items){var C=[];LyteComponent.newAddContext(p[l],C);var L=p[l].getAttribute("key"),w=p[l].getAttribute("value"),A=p[l]._callee,N=A.component.data[w],x=A.component.data[L],E=A._properties[w],I=A._properties[L],S=p[l]._attributes.object;for(var P in p[l]._items)if(A.component.data[w]=S[P],A.component.data[L]=P,A._properties[w]=p[l]._items[P].itemProperty,p[l]._items[P]._dynamicProperty[a]){s=p[l]._items[P]._dynamicProperty[a];for(var k=0;k<s.length;k++)s[k]._callee.updateNode(s[k],a)}A.component.data[w]=N,A.component.data[L]=x,A._properties[w]=E,A._properties[L]=I,LyteComponent.newRemoveContext(p[l],C)}else{s=p[l]._dynamicProperty[e._path]||[];var O=[];LyteComponent.newAddContext(p[l],O);for(var j=0;j<s.length;j++)s[j]._callee.updateNode(s[j],e._path);LyteComponent.newRemoveContext(p[l],O)}if(e._observers)for(var B=e._observers.toArrayLyte(),D=0;D<B.length;D++){var H=B[D];H.observer.value.call(H.callee&&H.callee.component?H.callee.component:o||window,{type:"change",oldValue:n,newValue:r,item:e._path})}if(Array.isArray(e))for(var T=0;T<e.length;T++)for(var M in e[T])this.affectChanges(e[T][M],!0,n?n[T]?n[T][M]:n[T]:n,o,r?r[T]?r[T][M]:r[T]:r);else for(var Y in e)this.affectChanges(e[Y],!0,n?n[Y]:n,o,r?r[Y]:r)},getDynamicData:function(e,t){var n=this;return t.forEach(function(t,o){if(Array.isArray(t)){if(void 0===e)return;var r=LyteComponent.getDynamicData.call(n,n.component.data,t);if(void 0===r)return;e=e[r]}else{if(void 0===e)return;e=e[t]}}),e},get:function(e,t,n){n||(n=[]);try{var o=t.match(/([^[\]]+|\[\])/g),r=e;n.push(o[0]);for(var i=o[0].split("."),a=0;a<i.length;a++)e=e[i[a]];for(var s=1;s<o.length;s++){var p=o[s];if(p.startsWith(".")){for(var l=p.substring(1).split("."),d=0;d<l.length;d++)e=e[l[d]];n[n.length-1]=n[n.length-1]+p}else if(p.startsWith("'")||p.startsWith('"')||!isNaN(p))isNaN(p)?n[n.length-1]=n[0]+"."+p.substring(1,p.length-1):n[n.length-1]=n[0]+"."+p,e=e[p.substring(1,p.length-1)];else{n.length;var c=this.get(r,p,n);n[0]=n[0]+"."+c,e=e[c]}}return e}catch(e){return}},getNew:function(e,t){try{var n=t.match(/([^[\]]+|\[\])/g),o=e,r=n[0].split(".");if(n.length<2){if(r.length<2)return{context:o,lastKey:r[0]};for(var i=0;i<r.length-1;i++)e=e[r[i]];return{context:e,lastKey:r[i]}}for(var a=0;a<r.length;a++)e=e[r[a]];for(var s=1;s<n.length-1;s++){var p=n[s];if(p.startsWith("."))for(var l=p.substring(1).split("."),d=0;d<l.length;d++)e=e[l[d]];else if(p.startsWith("'")||p.startsWith('"')||!isNaN(p))e=e[p.substring(1,p.length-1)];else{e=e[this.get(o,p)]}}var c=n[s];if(c.startsWith(".")){for(var m=c.substring(1).split("."),u=0;u<m.length-1;u++)e=e[m[u]];c=m[u]}else c=c.startsWith("'")||c.startsWith('"')||!isNaN(c)?c.substring(1,c.length-1):this.get(o,c);return{context:e,lastKey:c}}catch(e){return}},componentGetData:function(e){return e?this.get(e):this.data},componentSetData:function(e,t){if("string"==typeof e)this.set(e,t);else if(e instanceof Object)for(var n in e)this.set(n,e[n])},componentGetMethods:function(e){return e?this.methods[e]:this.methods},componentSetMethods:function(e,t){if("string"==typeof e)this.methods[e]=t;else if(e instanceof Object)for(var n in e)this.methods[n]=e[n]},render:function(e,t,n){if(e){var o=document.createElement(e);if(t&&o.setData(t),n){var r=document.querySelector(n);r?(r.appendChild(o),o._callee=o.getCallee(r)):Lyte.error("LC008",n)}return o}Lyte.error("LC007")},String:{upperCaseFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},lowerCaseFirstLetter:function(e){return e.charAt(0).toLowerCase()+e.slice(1)},toCamelCase:function(e){return e.replace(/(-\w)/g,function(e){return e[1].toUpperCase()})},dasherize:function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}},appendChild:function(e,t){LyteComponent.ignoreDisconnect=!0,e.appendChild(t),LyteComponent.ignoreDisconnect=!1},replaceWith:function(){var e=Array.from(arguments),t=e.shift();LyteComponent.ignoreDisconnect=!0,t.replaceWith.apply(t,e),LyteComponent.ignoreDisconnect=!1},insertBefore:function(e,t){LyteComponent.ignoreDisconnect=!0,e.parentNode.insertBefore(t,e||null),LyteComponent.ignoreDisconnect=!1},insertAfter:function(){var e=Array.from(arguments),t=e.shift();LyteComponent.ignoreDisconnect=!0,t.after.apply(t,e),LyteComponent.ignoreDisconnect=!1},executeMethod:function(){var e=Array.prototype.slice.call(arguments,1),t=LyteComponent.String.toCamelCase(arguments[0]);if(this.methods[t])return this.methods[t].apply(this,e);Lyte.error("LC009",t)},establishObserverBindings:function(e,t,n){var o=this;t&&(o=t);for(var r=0;r<e.length;r++)for(var i=e[r].properties,a=0;a<i.length;a++){var s=void 0,p=!1;-1!==i[a].indexOf(".[]")?(p=!0,s=LyteComponent.getProperty.call(this,i[a].substring(0,i[a].indexOf(".[]")),t,n)):s=LyteComponent.getProperty.call(this,i[a],t,n),s._observers||Object.defineProperty(s,"_observers",{value:new Set,enumerable:!1,writable:!0,configurable:!0}),s._observers.add({callee:o,observer:e[r],isArrayObserver:p})}},getProperty:function(e,t,n){var o=e.split("."),r=this;t?(r=n,n[o[0]]||(n[o[0]]={}),r=n[o[0]]):(r._properties[o[0]]||(r._properties[o[0]]={}),r=r._properties[o[0]]),Object.defineProperty(r,"_path",{enumerable:!1,value:o[0]});for(var i=1;i<o.length;i++)r[o[i]]||(r[o[i]]={},Object.defineProperty(r[o[i]],"_path",{enumerable:!1,value:r._path+"."+o[i]})),r=r[o[i]];return r},getProperData:function(e){var t=e.dataType,n=e.attr,o=e.newValue,r=e.tagName;switch(t){case"boolean":o=!(!o||"false"===o);break;case"object":try{(o=JSON.parse(o))instanceof Object||console.warn("data type of the value provided for attribute "+n+" of "+r+" is not valid")}catch(e){return void console.warn("attribute "+n+" is not a valid JSON string.")}break;case"array":try{(o=JSON.parse(o))instanceof Array||console.warn("data type of the value provided for attribute "+n+" of "+r+" is not valid")}catch(e){return void console.warn("attribute "+n+" is not a valid JSON string.")}break;case"number":var i=+o;if(o!==i+"")return void console.warn("data type of the value provided for attribute "+n+" of "+r+" is not valid");o=i}return e.newValue=o,!0},cssEscape:function(e){return e?e.replace(/['"]/g,"\\$&"):e}};Lyte.Component.render=LyteComponent.render,LyteComponent.lyteComponentsDiv=document.createElement("div"),LyteComponent.lyteComponentsDiv.setAttribute("id","lyte-components-div"),LyteComponent.dummyLyteComponentsDiv=document.createElement("div"),LyteComponent.dummyLyteComponentsDiv.setAttribute("id","dummy-lyte-components-div"),Set.prototype.toArrayLyte=function(){return"Set"===this.constructor.name?Array.from(this):Array.from(this._values)},"complete"===document.readyState||"interactive"===document.readyState?onDomContentForLyte():document.addEventListener("DOMContentLoaded",function(e){onDomContentForLyte()},!0),LyteComponent.registerHelper("unbound",function(e){return e}),LyteComponent.registerHelper("action",function(e,t,n,o){n?(e._actions=e._actions?e._actions:{},e._actions[t]||(this.createCustomEvent(t,e,o),e.removeAttribute(t))):this.createEventListeners(e,t,o)}),LyteComponent.registerHelper("lbind",function(e){return this.getData(e)}),LyteComponent.registerHelper("method",function(e,t,n){arguments[0],t=arguments[1],n=arguments[2];var o=arguments[0].component,r=t?t.ownerElement:null,i=arguments[1].nodeName;t=null;var a=Array.prototype.slice.call(arguments,3),s=function(){var e=Array.from(arguments),t=a.concat(e);return o.methods[n].apply(o,t)};if(!r)return s;r.set?r.component.methods[LyteComponent.String.toCamelCase(i)]=s:r.setMethods(LyteComponent.String.toCamelCase(i),s)}),LyteComponent.registerHelper("unescape",function(e){var t=document.createElement("div");return t.innerHTML=e,t}),LyteComponent.registerHelper("debugger",function(){}),LyteComponent.registerHelper("log",function(){console.log.apply(window,Array.from(arguments))}),LyteComponent.registerHelper("ifEquals",function(e,t){return e===t}),LyteComponent.registerHelper("if",function(e,t,n){return e?t:n}),LyteComponent.registerHelper("negate",function(e){return!e}),LyteComponent.registerHelper("ifNotEquals",function(e,t){return e!==t}),LyteComponent.registerHelper("concat",function(){for(var e="",t=arguments.length,n=0;n<t;n++)void 0!=arguments[n]&&(e+=arguments[n]);return e}),Object.defineProperty(HTMLElement.prototype,"setData",{enumerable:!1,value:function(e,t){if(this._initProperties=this._initProperties||{},"string"==typeof e)this._initProperties[e]=t;else if(e instanceof Object)for(var n in e)this._initProperties[n]=e[n]}}),Object.defineProperty(HTMLElement.prototype,"setMethods",{enumerable:!1,value:function(e,t){if(this._initMethods=this._initMethods||{},"string"==typeof e)this._initMethods[e]=t;else if(e instanceof Object)for(var n in e)this._initMethods[n]=e[n]}}),LyteComponent.registerHelper("expHandlers",function(e,t,n){if("++"==t){if("postfix"==n)return e++;if("prefix"==n)return++e}else if("--"==t){if("postfix"==n)return e--;if("prefix"==n)return--e}else{if("=="==t||"==="==t)return e==n;if("!="==t||"!=="==t)return e!=n;if("&&"==t)return e&&n;if("||"==t)return e||n;if("+"==t&&n)return e+n;if("-"==t&&n)return e-n;if("*"==t)return e*n;if("/"==t)return e/n;if("%"==t)return e%n;if("<"==t)return e<n;if(">"==t)return e>n;if("<="==t)return e<=n;if(">="==t)return e>=n;if("|"==t)return e|n;if("&"==t)return e&n;if("!"==t)return!e;if("-"==t&&!n)return-e;if("="==t)return e=n;if("+="==t)return e+=n;if("-="==t)return e-=n;if("*="==t)return e*=n;if("/="==t)return e/=n}}),Lyte.Component.register("lyte-event-listener",{_template:'<template tag-name="lyte-event-listener"></template>',_dynamicNodes:[],_observedAttributes:["eventName"],init:function(){var e=this,t=Lyte.addEventListener(this.get("eventName"),function(){var t=Array.prototype.slice.call(arguments);t.splice(0,0,"on-fire"),e.throwEvent.apply(e,t)});this.regId=t},data:function(){return{eventName:Lyte.attr("string")}},didDestroy:function(){Lyte.removeEventListener(this.regId)}}),Lyte.Component.registerCustomPropHandler("ltProp"),LyteComponent.addLyteEventListener=function(e,t,n,o){e._lyteEvents=e._lyteEvents||{},e._lyteEvents[t]=e._lyteEvents[t]||[];return t+"-"+e._lyteEvents[t].push({func:n,fromEventListener:!0,context:o})},LyteComponent.removeLyteEventListener=function(e,t){if(t){var n=t.split("-"),o=(n[0],parseInt(n[1]));e._lyteEvents&&e._lyteEvents[n[0]]&&!isNaN(o)?e._lyteEvents[n[0]][n[1]-1]={}:Lyte.error("Invalid listenerId / listener is not available")}else Lyte.error("No listenerId provided")},LyteComponent.hasLyteEvents=function(e,t){return!(!e._lyteEvents||!e._lyteEvents[t])},LyteComponent.handleLyteEvents=function(e,t){for(var n,o=e._lyteEvents[t.type],r=0;r<o.length;r++)if(o[r].func&&(!1===o[r].func.call(o[r].context?o[r].context:window,t)||t.cancelBubble)){n=!0;break}return n&&t.stopPropagation(),n};
function Adapter(e,r,t){var o=this;r&&r.mixins&&r.mixins.length&&r.mixins.forEach(function(e){var r=Lyte.registeredMixins[e];for(var t in r)o[t]=r[t]});for(key in e)this[key]=e[key];if(this.__extendedBy=[],store.adapter.__toAddSuper&&store.adapter.__toAddSuper.hasOwnProperty(t)){for(var a=store.adapter.__toAddSuper[t],s=0;s<a.length;s++){var i=store.adapter[a[s]];"adapter"==i.is&&(i.$super=this,this.__extendedBy.push(a[s]))}delete store.adapter.__toAddSuper[t]}Object.defineProperty(this,"extends",{enumerable:!1,value:function(e){store.$.extendCallback.call(this,store,"adapter",e)}}),Object.defineProperty(this,"is",{value:"adapter",enumerable:!1}),Object.defineProperty(this,"__name",{value:t,enumerable:!1})}function Serializer(e,r,t){for(key in e)this[key]=e[key];var o=this;if(r&&r.mixins&&r.mixins.length&&r.mixins.forEach(function(e){var r=Lyte.registeredMixins[e];for(var t in r)o[t]=r[t]}),this.__extendedBy=[],store.serializer.__toAddSuper&&store.serializer.__toAddSuper.hasOwnProperty(t)){for(var a=store.serializer.__toAddSuper[t],s=0;s<a.length;s++){var i=store.serializer[a[s]];"serializer"==i.is&&(i.$super=this,this.__extendedBy.push(a[s]))}delete store.serializer.__toAddSuper[t]}Object.defineProperty(this,"extends",{enumerable:!1,value:function(e){store.$.extendCallback.call(this,store,"serializer",e)}}),Object.defineProperty(this,"is",{value:"serializer",enumerable:!1}),Object.defineProperty(this,"__name",{value:t,enumerable:!1})}Lyte.registerErrorCodes({LD01:"Primary key value might be missing in the response data that is received, {0}",LD02:"{0} not present, {0}",LD03:"Cannot set the error {0} for {1}",LD04:"No such record to merge, {0}",LD05:"Model( {0} ) of related property - {1} not found in model - {2}",LD06:"Backward relation not present in {0} for the property {1} in model( {2} )",LD07:"{0} type not handled in handleArrayOperations",LD08:"{0} {1} will be deprecated from next version {2}",LD09:"deserializeKey cannot be processed for payload with more than two keys. Please use payloadKey callback instead or try modifying the same in normalizeResponse callback"});var $Record=function(){Object.assign(this,{inIDB:!1,isModified:!1,isNew:!1,isDeleted:!1,isError:!1,events:[],validatedOnCreate:!0,error:{}})},Record=function(e,r){Object.assign(this,r),Object.defineProperties(this,{$:{enumerable:!1,writable:!0,value:new $Record}});var t=store.modelFor(e);Object.defineProperties(this.$,{model:{enumerable:!1,value:t},record:{enumerable:!1,value:this},_attributes:{enumerable:!1,value:{},writable:!0},isDirty:{enumerable:!1,value:function(){var e=[];if(this.record.$.isModified)return!0;var r=this.model.relations;for(var t in r)for(var o=r[t],a=0;a<o.length;a++){var t=o[a];if(t.opts&&t.opts.serialize&&"record"===t.opts.serialize){var s=t.relKey,i=t.relType,n=this.record[s];if("belongsTo"===i&&n&&n.$&&n.$.isModified)e.push(s);else if("hasMany"===i&&n)for(var d=0;d<n.length;d++)n[d]&&n[d].$&&n[d].$.isModified&&e.push(s)}}return e.length?e:!1}},undoStack:{enumerable:!1,value:[],writable:!0},redoStack:{enumerable:!1,value:[],writable:!0}});var o=store.$.saveParent;o&&this!==o&&Object.defineProperty(this.$,"parent",{value:o,enumerable:!1});{var a=t.fieldList;new error1}for(var s in a){var i=a[s];if("relation"!=i.type){var n=r[s];(void 0==n||""===n||null==n)&&i.hasOwnProperty("default")&&(this[s]=i.default)}}var d=t._properties;Object.keys(d).length&&(this._bindings||Object.defineProperty(this,"_bindings",{value:new Set,enumerable:!1,writable:!0}),this._bindings.add(d),store.$.establishObserverBindings(this,d))};Object.defineProperties($Record.prototype,{get:{enumerable:!1,value:function(e){return this.record[e]}},set:{enumerable:!1,value:function e(r,e){if(this.isDeleted)store.$.setRecordError(this,this.model._primaryKey,"ERR17");else if("undefined"!=typeof LyteComponent){var t;if("string"==typeof r&&this.record[r]!==e)t=LyteComponent.set(this.record,r,e);else if("object"==typeof r){for(key in r)this.record[key]===r[key]&&delete r[key];t=LyteComponent.set(this.record,r,e)}if(t&&t.$&&t.$.isError)return t}else store.$.setData(this,r,e);return this.record}},getDirtyAttributes:{enumerable:!1,value:function(){var e=this._attributes,r=[];if(Object.keys(e).length)for(var t in e)r.push(t);return r}},rollBackAttributes:{enumerable:!1,value:function(e){Array.isArray(e)||(e=[e]);for(var r=this.record,t=[],o=this.model,a=0;a<e.length;a++){var s=e[a];if(this._attributes.hasOwnProperty(s)){var i=o.fieldList[s],n=this._attributes[s];"relation"==i.type?store.$.rollBackRecordsArray(n,r,o,i):"undefined"!=typeof LyteComponent?LyteComponent.set(r,s,n):r[s]=n,t.push(s),delete this._attributes[s],store.$.clearRecordError(this,s)}}if(Object.keys(this._attributes).length||(this.isModified=!1,this.isNew||store.$.deleteFromArray(o.dirty,this.get(o._primaryKey))),t.length>0){var d=[r,t];this.emit("change",d),o.emit("change",d)}}},rollBack:{enumerable:!1,value:function(){var e=this.model,r=e._primaryKey;if(this.isDeleted){var t=store.$.getIndex(e._deleted,r,this.get(r));store.$.rollBackDelete(e,t)}else this.isNew?store.$.rollBackNew(e,this.record,r):this.isModified?this.rollBackAttributes(this.getDirtyAttributes()):this.isError&&store.$.clearRecordError(this);store.$.removeOnSave(this.model._name,this.record[r])}},deleteRecord:{enumerable:!1,value:function(){var e=this.model,r=this.record,t=e._primaryKey;store.$.removeFromStore(e,r[t])}},destroyRecord:{enumerable:!1,value:function(e,r){return this.deleteRecord(),this.save(e,r,"destroyRecord")}},addEventListener:{enumerable:!1,value:function(e,r){return store.$.eventListeners.add(this,e,r)}},removeEventListener:{enumerable:!1,value:function(e){store.$.eventListeners.remove(this,e)}},emit:{enumerable:!1,value:function(e,r){store.$.eventListeners.emit(this,e,r)}},triggerAction:{enumerable:!1,value:function(e,r,t){var o=this.model,a=o.actions,s=a?a[e]:void 0;return s?store.adapter.$.handleAction(e,o,this.record,r,t):Promise.reject({code:"ERR18",message:Lyte.errorCodes.ERR18,data:e})}},save:{enumerable:!1,value:function(e,r,t,o){var a=this.model,s=this.record,i=this.isDirty(),n=t&&t.validateOnSave;if(this.isDeleted){if(!this.isNew)return store.adapter.$.del(a._name,s,!0,o,e,r);store.adapter.$.handleResponse(void 0,s,s,void 0,void 0,a)}else{if(this.isNew){var d=a.fieldList,l=this;for(var c in d){var u=s[c],h=d[c];if("relation"!=h.type){if(!this.validatedOnCreate||n)if(h.mandatory&&(null==u||void 0==u||""===u||Array.isArray(u)&&0==u.length))store.$.setRecordError(l,c,{code:"ERR02",message:Lyte.errorCodes.ERR02});else for(var f in h){var y=Lyte.checkProperty(f,s[c],c,h[f]);if(1!=y){store.$.setError(l,c,y);break}}Lyte.Transform[h.type]&&Lyte.Transform[h.type].serialize&&(s[c]=Lyte.Transform[h.type].serialize(s[c]))}}return l&&l.isError&&Object.keys(l.error).length>0?Promise.reject(l.record):store.adapter.$.create(a._name,s,!0,e,r)}if(this.isModified||i&&i.length){var p={};if(t&&n)for(var c in d){var u=s[c],h=d[c];if("relation"!=h.type)if(h.mandatory&&(null==u||void 0==u||""===u||Array.isArray(u)&&0==u.length))store.$.setRecordError(s.$,c,{code:"ERR02",message:Lyte.errorCodes.ERR02});else for(var f in h){var y=Lyte.checkProperty(f,s[c],c,h[f]);if(1!=y){store.$.setError(l,c,y);break}}}if(t&&!t.ignoreError&&s&&s.$&&s.$.isError)return Promise.reject(s.$.error);for(var c in this._attributes)p[c]=Lyte.Transform[a.fieldList[c].type]&&Lyte.Transform[a.fieldList[c].type].serialize?Lyte.Transform[a.fieldList[c].type].serialize(s[c]):s[c];for(var v=0;v<i.length;v++)p[i[v]]=s[i[v]];var m=a._primaryKey;return p[m]=s.$.get(m),store.adapter.$.put(a._name,p,s,!0,e,r)}}return Promise.resolve()}},getInitialValues:{enumerable:!1,value:function(e){var r=!1;e?(Array.isArray(e)||(e=[e]),r=!0):e=this.getDirtyAttributes();for(var t={},o=this.record,a=0;a<e.length;a++)if(void 0!=o[e]&&o[e[a]].add){t[e[a]]=o[e[a]].slice(0);for(var s=this._attributes[e[a]],i=o[e[a]].model._primaryKey,n=s.length-1;n>=0;n--)if("added"==s[n]._type)for(var d=0;d<s[n].records.length;d++){var l=store.$.getIndex(t[e[a]],i,s[n].records[d][i]);-1!=l&&t[e[a]].splice(l,1)}else if("removed"==s[n]._type)for(var d=s[n].records.length-1;d>=0;d--)t[e[a]].splice(s[n]._indices[d],1,s[n].records[d]);else"changed"==s[n]._type&&(t[e[a]]=s[n].records)}else t[e[a]]=this._attributes[e[a]];return r?t[e[0]]:t}},toJSON:{enumerable:!1,value:function(e){return Object.assign({},store.$.toJSON(this.model._name,this.record,e?"idb":!0))}},undo:{enumerable:!1,value:function(){var e,r=this.undoStack.pop(),t={};if(r){for(var o in r){var e=r[o];"update"==e._type?e.val?store.$.setData(this,o,e.val,t):e.records&&store.$.setData(this,o,e.records,t):"propAdd"==e._type?"undefined"!=typeof LyteComponent?(t[o]={type:"propDelete",val:this.record[o]},LyteComponent.objectFunction(this.record,"delete",o)):delete this.record[o]:"added"==e._type?this.record.$.get(o).remove(e.records,void 0,t):"removed"==e._type&&(store.$.rollBackRecordsArray([e],this.record,this.model,this.model.fieldList[o]),e._type="added",t[o]=e)}this.redoStack.push(t)}}},redo:{enumerable:!1,value:function(){var e,r=this.redoStack.pop(),t={};if(r){for(var o in r){var e=r[o];"update"==e._type?e.val?store.$.setData(this,o,e.val,t):e.records&&store.$.setData(this,o,e.records,t):"propDelete"==e._type?(t[o]={type:"propAdd"},store.$.setData(this,o,e.val,t)):"added"==e._type?this.record.$.get(o).remove(e.records,void 0,t):"removed"==e._type&&(store.$.rollBackRecordsArray([e],this.record,this.model,this.model.fieldList[o]),e._type="added",t[o]=e)}this.undoStack.push(t)}}}});var Model=function(e,r){Object.assign(this,{_name:e,_primaryKey:"id",fieldList:{id:{type:"string",primaryKey:!0,defined:!1}},relations:{},_properties:{},data:[],dirty:[],_deleted:[],events:{}});var t=[];for(var o in r)store.$.registerField(this,o,r[o],t);"undefined"!=typeof LyteComponent&&LyteComponent.establishObserverBindings(t,!0,this._properties),store.$.defineArrayUtils(this.data),store.$.defineUtilsFor(this.data,this),Object.defineProperty(this,"extends",{enumerable:!1,value:store.$.extendModel})};Model.prototype.addEventListener=function(e,r){return store.$.eventListeners.add(this,e,r)},Model.prototype.removeEventListener=function(e){store.$.eventListeners.remove(this,e)},Model.prototype.emit=function(e,r){store.$.eventListeners.emit(this,e,r)},Model.prototype.on=function(e,r){return this.addEventListener(e,r)};var store={model:{},$:{request:{},toRelate:{},idbQueue:[],idbQ:{},idbQ2:{},checkWithQp:function(e,r){var t=-1;return e=e||[],e.forEach(function(e,o){var a=e.qP||{},s=r.qP||{};if(a==s)return void(t=o);var i=Object.keys(a).length,n=Object.keys(s).length,d=0;if(i==n){for(var l in a)a[l]==s[l]&&d++;return d==i?void(t=o):void 0}}),t},handleCachedResponse:function(e,r){var t=store.$.cachedBatch=store.$.cachedBatch||{},o=t[e]||[],a=0;return o.forEach(function(e){r.splice(e.ind+a++,0,e.data)}),delete t[e],r},addToCachedBatch:function(e){var r=store.$.currentBatch,t=store.$.cachedBatch=store.$.cachedBatch||{},o=t[r]=t[r]||[],a=store.$.batch[r]||[],s=a.length;o.push({ind:s,data:e})},establishToRelated:function(e,r){console.time("establishToRelated");var t=e.$.model,o={};r.forEach(function(r){var a=store.peekRecord(r.model,r.pkVal);if(a){var s=a.$.model;store.$.getRelations(s,r.key,t,o),store.$.establishLink(o.forward,o.backward,a,e)}}),console.timeEnd("establishToRelated")},checkObjAndAddToArr:function(e,r,t){var o=t.length,a=-1;return e.forEach(function(e,s){var i=0;for(var n in t)e[n]==r[n]&&i++;return i==o?void(a=s):void 0}),-1==a&&e.push(r),a},addToRelate:function(e,r,t,o){var a=t.forward.relatedTo,s=store.$.toRelate[a]=store.$.toRelate[a]||{},i=s[o]=s[o]||[],n=r[r.$.model._primaryKey],d={model:e,pkVal:n,key:t.forward.relKey};this.checkObjAndAddToArr(i,d,["record","key"])},addOnSave:function(e,r,t,o,a,s){store.$.onSave=store.$.onSave||{};var i=store.$.onSave[e]=store.$.onSave[e]||{},n=i[r[a]]=i[r[a]]||{},d=r[t]||[];"belongsTo"==o.relType&&(d=Array.isArray(r[t])?r[t]:[r[t]]),d.forEach(function(e){var r=n[o.relKey]=n[o.relKey]||[];store.$.checkAndAddToArray(r,e[s])})},addToIDBonSave:function(e,r){var t=store.model[e],o=t.fieldList,a=store.$.onSave?store.$.onSave[e]:void 0;if(a){var s=store.model[e]._primaryKey,i=r&&s?a[r[s]]:void 0;if(i){for(var n in i){var d=i[n],l=o[n].relatedTo;d.forEach(function(e){var r=store.peekRecord(l,e),t=r.$.parent;if(Lyte.isRecord(t)){var o=t.$.model,a=o._name,s=o._primaryKey;store.$.checkAndAddToIDBQ(a,"updateRecord",store.peekRecord(a,t[s]).$.toJSON(!0))}else store.$.checkAndAddToIDBQ(l,"updateRecord",store.peekRecord(l,e).$.toJSON(!0))})}store.$.removeOnSave(e,r[s])}}},removeOnSave:function(e,r){var t=store.$.onSave?store.$.onSave[e]:void 0;t&&t[r]&&delete t[r]},checkAndAddToIDBQ:function(e,r,t){var o={model:e,type:r,data:t},a=store.$.idbQ2[e]=store.$.idbQ2[e]||[];a.push(o)},checkAndRemoveKey:function(e,r,t){for(var o in e){var a=r[o];a&&"relation"==a.type&&(t&&!this.checkPresenceInArray(t,o)?delete e[o]:this.removeNotNeededKeys(a.relatedTo,e[o]))}},removeNotNeededKeys:function(e,r){var t=store.model[e],o=t.fieldList,a=t.idb?t.idb.deserializeKeys:void 0;if(t){var s=this;Array.isArray(r)?r.forEach(function(e){s.checkAndRemoveKey(e,o,a)}):this.checkAndRemoveKey(r,o,a)}return r},idbQ2Push:function(e,r,t,o,a){try{var s=store.model[e];if(s.hasOwnProperty("idb")){r=Lyte.deepCopyObject(r);var i={model:e,type:o},n=(s._primaryKey,store.$.idbQ2[e]=store.$.idbQ2[e]||[]);switch(o){case"action":return void delete n[o];case"update":case"create":i.data=[],r.forEach(function(e){i.data.push(Lyte.isRecord(e)?e.$.toJSON():e)});break;case"updateRecord":case"createRecord":i.data=r;break;case"delete":i.data=r;break;case"destroyRecord":case"deleteRecord":i.id=r;break;case"findRecord":i.key=a;case"findAll":r[e]=this.removeNotNeededKeys(e,r[e]),i.queryParams=t,i.data=r;break;case"pushPayload":r=this.removeNotNeededKeys(e,r),i.data=r}n.push(i)}}catch(d){console.log("Error while adding to IDBQueue ",d)}},isEmpty:function(e){return void 0!=e&&""!==e&&null!=e?!1:!0},registerField:function(e,r,t,o){if("observer"==t.type)o.push(t);else if("callBack"==t.type){t.observes&&o.push(t.observes);for(var a=t.properties,s=0;s<a.length;s++)"didLoad"===a[s]||"init"===a[s]?(e.didLoad||(e.didLoad=[]),e.didLoad.push(t.value)):("add"===a[s]||"change"===a[s])&&e.on(a[s],t.value);"didLoad"==r&&(e.didLoad||(e.didLoad=[]),e.didLoad.push(t.value))}else"didLoad"==r?(e.didLoad||(e.didLoad=[]),e.didLoad.push(t)):Object.keys(t).length&&(t.primaryKey&&(0==e.fieldList.id.defined&&delete e.fieldList.id,e._primaryKey=r),e.fieldList[r]=t);"relation"===t.type&&(t.relKey=r,e.relations[t.relatedTo]||(e.relations[t.relatedTo]=[]),e.relations[t.relatedTo].push(e.fieldList[r]))},setError:function(e,r,t){e.$.hasOwnProperty("error")?"undefined"!=typeof LyteComponent?LyteComponent.set(e.$.error,r,t):e.$.error[r]=t:Lyte.error("LD03",e,r)},unregisterCallback:function(e,r){var t=store[e][r];if(!t)return void Lyte.error(e," not present - ",r);var o=t.__extendedBy;o.forEach(function(r){store.$.unregisterCallback(e,r)}),t.$super&&t.$super.__extendedBy.splice(t.$super.__extendedBy.indexOf(r)),delete store[e][r]},eventListeners:{add:function(e,r,t){return e.events=e.events||{},e.events[r]=e.events[r]||[],e.events[r].push({f:t}),r+"-"+(e.events[r].length-1)},remove:function(e,r){var t;if(r)if(/^(add|remove|change)$/.test(r))t=r,e.events&&e.events[t]?delete e.events[t]:void 0;else{var o=r?r.split("-"):void 0;if(o){var a=e.events[o[0]];a&&o[1]&&(a[o[1]]=null)}}else{var s=e.events;for(var i in s)s&&s[i]?delete s[i]:void 0}},emit:function(e,r,t){for(var o=e.events&&e.events[r]?e.events[r]:[],a=0;a<o.length;a++)o[a]?o[a].f.apply(null,t):void 0}},extendCallback:function(e,r,t){var o,a=e[r];return t&&"string"==typeof t&&(o=a[t],o||(a.__toAddSuper=a.__toAddSuper||{},a.__toAddSuper.hasOwnProperty(t)||(a.__toAddSuper[t]=[]),a.__toAddSuper[t].push(this.__name))),o&&o.is==r&&!this.$super&&(this.$super=o,o.__extendedBy.push(this.__name)),this},extendModel:function(e){if(e&&store.model[e]){var r=Object.assign({},store.model[e].fieldList);for(var t in r)"relation"==r[t].type&&delete r[t];this.fieldList=Object.assign(this.fieldList,r);var o=this._name;store.model[o].extend=e,store.model[e].extendedBy=store.model[e].extendedBy||{},store.model[e].extendedBy[o]=!0,!store.adapter[o]&&store.adapter[e]&&(store.adapter[o]=store.adapter[e]),!store.serializer[o]&&store.serializer[e]&&(store.serializer[o]=store.serializer[e])}},establishObserverBindings:function(e,r,t){t||(t=e);for(key in r)!(e[key]instanceof Object)||e[key]._bindings&&e[key]._setterScope?e._setterScope||Object.defineProperty(e,"_setterScope",{value:e,enumerable:!1}):(e[key]._bindings||Object.defineProperty(e[key],"_bindings",{value:new Set,enumerable:!1,writable:!0}),t&&!e[key]._setterScope&&Object.defineProperty(e[key],"_setterScope",{value:t,enumerable:!1}),e[key]._bindings.add(r[key]),Object.keys(r[key]).length&&this.establishObserverBindings(e[key],r[key],e))},setData:function(e,r,t,o){var a={emit:!1,attr:[],oldRec:{}};if(r instanceof Object)for(var s in r)this.setValue(e,s,r[s],a);else this.setValue(e,r,t,a);if(a.emit){var i=[e.record,a.attr];if(e.emit("change",i),e.model.emit("change",i),store.emit("change",[e.model._name,e.record,a.attr]),o)for(var s in a.oldRec)o[s]=a.oldRec[s];else e.undoStack.push(a.oldRec)}return e.record},setValue:function(e,r,t,o){var a,s,i=e.model,n=i._primaryKey;if(r!=i._primaryKey){var d=i.fieldList[r],l=e.record;if(d)if(!d.mandatory||void 0!=t&&null!=t&&""!==t){if(d.relType){var c,u={},h=store.modelFor(d.relatedTo),f=h._primaryKey;if(this.getRelations(i,d.relKey,h,u),l[r]&&"hasMany"==d.relType?(c=[],l[r].forEach(function(e){c.push(e[f])}),store.$.addOnSave(i._name,l,r,d,n,f),this.toDemolishLink(i,l,u.forward),l[r].splice(0,l[r].length)):l[r]&&"belongsTo"==d.relType&&(c=l[r][f],store.$.addOnSave(i._name,l,r,d,n,f),this.toDemolishLink(i,l,u.forward),l[r]=void 0),Array.isArray(t)){if("belongsTo"==d.relType)return this.revertToOldVal(l,r,c,u),void store.$.setRecordError(e,r,"ERR21",t)}else t=[t];for(var y=h,p=y._primaryKey,v=y.fieldList[p].type,m=[],$=0;$<t.length;$++)if(void 0!=t[$]){var g=t[$],b=t[$]&&t[$]._type?t[$]._type:d.relatedTo;if(typeof t[$]==v){if(g=store.peekRecord(t[$]._type?t[$]._type:d.relatedTo,t[$]),void 0==g)this.addToRelate(i._name,l,u,t[$]);else if(g.$&&g.$.isError){m.push({code:"ERR15",message:Lyte.errorCodes.ERR15,error:Object.assign({},g)});continue}}else if("object"==typeof t[$]){if(g.$&&g.$.isError){m.push({code:"ERR15",message:Lyte.errorCodes.ERR15,error:Object.assign({},g)});continue}if(!Lyte.isRecord(g)&&(g=this.newRecord(b,t[$]),g.$.isError)){m.push({code:"ERR15",data:t[$],message:Lyte.errorCodes.ERR15,error:Object.assign({},g)});continue}}var R=this.establishLink(u.forward,u.backward,l,g);1!=R?m.push({code:R,data:t[$],message:Lyte.errorCodes[R]}):store.$.addOnSave(i._name,l,r,d,n,f)}if(m.length&&m.length==t.length)return this.revertToOldVal(l,r,c,u),void("belongsTo"==d.relType?store.$.setRecordError(e,r,m[0]):store.$.setRecordError(e,r,m));m.length>1?store.$.setRecordError(e,r,m):store.$.clearRecordError(e,r),l.$._attributes.hasOwnProperty(r)||(l.$._attributes[r]=[]),l.$._attributes[r].push({_type:"changed",records:c}),o.emit=!0,o.attr.push(r);var k={};k.records=c,k._type="update",o.oldRec[r]=k;var L=l.$.getInitialValues(r),R=!0;if(L&&Array.isArray(l[r])&&L.length==l[r].length){R=!1;for(var $=0;$<L.length;$++)if(!store.$.compareRecords(L[$],l[r][$],p)){R=!0;break}}R||delete l.$._attributes[r]}else if(t!==l[r]){for(var _ in d){var A=Lyte.checkProperty(_,t,r,d[_]);if(1!=A)return void store.$.setRecordError(e,r,A,t)}var O=l.$._attributes[r];l.$._attributes.hasOwnProperty(r)?("object"==typeof t&&store.adapter.$.compareObjects(O,t)||O==t)&&delete l.$._attributes[r]:l.$._attributes[r]=this.createCopy(l[r]),s=l.hasOwnProperty(r),a=l[r],"undefined"!=typeof LyteComponent?LyteComponent.set(l,r,t,!0):l[r]=t,o.emit=!0,o.attr.push(r),store.$.clearRecordError(e,r);var k={};k._type="update",k.val=a,s||(k.type="propAdd"),o.oldRec[r]=k}else if(t===l[r]&&l.$.isError&&l.$.error[r]){var w=!0;for(var _ in d){var A=Lyte.checkProperty(_,t,r,d[_]);1!=A&&(w=!1)}w&&store.$.clearRecordError(e,r)}}else store.$.setRecordError(e,r,"ERR02");else s=l.hasOwnProperty(r),a=l[r],"undefined"!=typeof LyteComponent?LyteComponent.set(l,r,t,!0):l[r]=t;Object.keys(l.$._attributes).length?(e.isModified=!0,this.checkAndAddToArray(i.dirty,l[i._primaryKey])):(e.isModified=!1,e.isNew||this.deleteFromArray(i.dirty,l[i._primaryKey]))}else store.$.setRecordError(e,r,"ERR01",t)},checkForCorrectRelation:function(e,r){var t=e.relatedTo;return Lyte.isRecord(r)?e.opts&&e.opts.polymorphic?r.$.model.extend?e.relatedTo===r.$.model.extend:!1:e&&r?t===r.$.model._name:!1:!1},removeKeys:function(e,r){for(var t in r)if(e.hasOwnProperty(t)){var o=e[t];("belongsTo"===o.type||"hasMany"===o.type&&r[t])&&this.removeNotDefinedKeys(o.relatedTo,r[t],o.opts&&o.opts.polymorphic?!0:void 0)}else delete r[t]},removeNotDefinedKeys:function(e,r,t){var o=e.fieldList;if(Array.isArray(r))for(var a=0;a<r.length;a++){var s=r[a];this.removeKeys(t&&Lyte.isRecord(s)?s.$.model.fieldList:o,s)}else this.removeKeys(t&&Lyte.isRecord(r)?r.$.model.fieldList:o,r)},add:function(e,r,t){var o=this.record,a=o.$.model,s=this.key,i=a.fieldList[s],n={};store.$.getRelations(a,i.relKey,store.modelFor(i.relatedTo),n),Array.isArray(e)||(e=[e]);for(var d=store.modelFor(n.forward.relatedTo),l=d._primaryKey,c=[],u=[],h=0;h<e.length;h++){var f=e[h];if("object"!=typeof f||Lyte.isRecord(f)){if(d.fieldList[l].type.toLowerCase()==typeof f){if(this.polymorphic&&!r){c.push({code:"ERR22",data:e[h],message:Lyte.errorCodes.ERR22});continue}f=store.peekRecord(r?r:n.forward.relatedTo,f)}}else f=store.$.newRecord(f._type?f._type:r?r:i.relatedTo,f);var y=f&&f._type?f._type:r?r:void 0;if(void 0==f)c.push({code:"ERR13",data:e[h],message:Lyte.errorCodes.ERR13});else if(f.$&&f.$.isError)c.push({code:"ERR15",data:e[h],message:Lyte.errorCodes.ERR15,error:f});else if(Lyte.isRecord(f)&&!store.$.hasDuplicateRelation(f,o[s],l,y)){var p=store.$.establishLink(n.forward,n.backward,o,f);1!=p?c.push({code:p,data:e[h],message:Lyte.errorCodes[p]}):u.push(f)}}if(u.length){o.$._attributes[s]||(o.$._attributes[s]=[]),o.$._attributes[s].push({_type:"added",records:u}),store.$.emit("change",o,[s]),store.$.hasRecordsArrayChanged(o,s)?(o.$.isModified=!0,store.$.checkAndAddToArray(a.dirty,o[a._primaryKey])):(o.$.isModified=!1,delete o.$._attributes[s],o.$.isNew||store.$.deleteFromArray(a.dirty,o[a._primaryKey]));var v={_type:"added",records:u};if(t)t[s]=v;else{var m={};m[s]=v,o.$.undoStack.push(m)}}return c.length>0?store.$.setRecordError(o.$,s,c):store.$.clearRecordError(o.$,s),o},remove:function(e,r,t){var o=this.record,a=o.$.model,s=this.key,i=a.fieldList[s],n={};store.$.getRelations(a,i.relKey,store.modelFor(i.relatedTo),n),Array.isArray(e)||(e=[e]);for(var d,l=store.modelFor(n.forward.relatedTo),c=l._primaryKey,u=[],h=[],f=[],y=0;y<e.length;y++){if(l.fieldList[c].type.toLowerCase()==typeof e[y]){if(1==this.polymorphic&&!r){u.push({code:"ERR22",data:e[y],message:Lyte.errorCodes.ERR22});continue}d=store.peekRecord(r?r:n.forward.relatedTo,e[y])}else Lyte.isRecord(e[y])&&(d=e[y]);var p=d&&d._type?d._type:r?r:void 0;if(d){var v=store.$.getIndex(o[s],c,d.$.get(c),p);store.$.demolishLink(d,c,store.peekRecord(n.backward.relatedTo,o[a._primaryKey]),n.forward.relKey),store.$.demolishLink(o,a._primaryKey,store.peekRecord(p?p:n.forward.relatedTo,d[c]),n.backward.relKey),h.push(d),f.push(v)}}if(h.length){o.$._attributes[s]?store.$.hasRecordsArrayChanged(o,s)?o.$._attributes[s].push({_type:"removed",records:h,_indices:f}):(o.$.isModified=!1,delete o.$._attributes[s],o.$.isNew||store.$.deleteFromArray(a.dirty,o[a._primaryKey])):(o.$._attributes[s]=[{_type:"removed",records:h,_indices:f}],o.$.isModified=!0,store.$.checkAndAddToArray(a.dirty,o[a._primaryKey])),store.$.emit("change",o,[s]);var m={_type:"removed",records:h,_indices:f};if(t)t[s]=m;else{var $={};$[s]=m,o.$.undoStack.push($)}}u.length>0?store.$.setRecordError(o.$,s,u):store.$.clearRecordError(o.$,s)},filter:function(e,r,t){var o=0;for(var a in r)e[a]===r[a]&&o++;return o===t?!0:void 0},filterBy:function(e){for(var r=Object.keys(e).length,t=[],o=0;o<this.length;o++)store.$.filter(this[o],e,r)&&t.push(this[o]);return t.filterBy||(store.$.defineArrayUtils(t),store.$.defineUtilsFor(t,this.model)),t},removeSelfCircularReference:function(e,r,t,o){var a=store.modelFor(e),s=a.fieldList,i=a._primaryKey,n=a.extend?!0:!1;store.$.recStack[e]=store.$.recStack[e]||[];store.$.checkAndAddToArray(store.$.recStack[e],r[i]);for(var d in r){var l,c,u=s[d],h="create"==o&&a._primaryKey==d?!0:!1;if(h)delete r[d];else if(!u&&n&&(l=store.modelFor(a.extend),u=l.fieldList[d],c=!0),r[d]&&u&&"relation"==u.type){var f=store.modelFor(u.relatedTo);if(void 0==f)continue;var y=u.relKey,p={};c?this.getRelations(l,u.relKey,store.modelFor(u.relatedTo),p):this.getRelations(a,y,f,p);var v=u.opts,m=v?v.serialize:void 0,$=r[y],i=a._primaryKey,g=r[i],b=v?v.polymorphic:void 0,R=f._primaryKey;if("idb"==t)Array.isArray($)?$.forEach(function(e,r){Lyte.isRecord(e)&&e.$.inIDB?$[r]=e[R]:store.$.checkPresenceInArray(store.$.recStack[u.relatedTo],e[R])?$[r]=e[R]:(store.$.removeBackwardRel(e,p,i,g,!0),store.$.removeSelfCircularReference(f._name,e,t))}):$&&Lyte.isRecord($)&&(Lyte.isRecord($)&&$.$.inIDB?r[y]=$[R]:this.checkPresenceInArray(store.$.recStack[u.relatedTo],$[R])?r[y]=$[R]:(this.removeBackwardRel($,p,i,g,!0),this.removeSelfCircularReference(f._name,$,t)));else if(t||"id"==m)Array.isArray($)?r[y]=b?this.polymorphicToJSON(u,$):$.map(function(e){return e[i]}):$&&Lyte.isRecord($)&&(r[y]=b?this.polymorphicToJSON(u,$):$[R]);else if("record"===m)if(Array.isArray($)){$=Array.from($);for(var k=0;k<$.length;k++)$[k]&&Lyte.isRecord($[k])&&(this.removeBackwardRel($[k],p,i,g),this.removeSelfCircularReference(f._name,$[k],t))}else $&&Lyte.isRecord($)&&(this.removeBackwardRel($,p,i,g),this.removeSelfCircularReference(f._name,$,t));else delete r[y]}}},removeBackwardRel:function(e,r,t,o,a){if(a)return void delete e[r.backward.relKey];var s=e[r.backward.relKey];if(Array.isArray(s)){for(var i=0;i<s.length;i++)if(s[i][t]===o)return s.splice(i,1),void(0==s.length&&delete e[r.backward.relKey])}else s&&Lyte.isRecord(s)&&s[t]==o&&delete e[r.backward.relKey]},polymorphicToJSON:function(e,r){var t=e.opts;if(t&&t.polymorphic){if(Array.isArray(r)){var o=[];return r.forEach(function(e){o.push(store.$.polyToJSON(e))}),o}return store.$.polyToJSON(r)}},polyToJSON:function(e){var r=e?e._type:void 0,t=store.modelFor(r),o=t?t._primaryKey:void 0,a={};return a[o]=e[o],a._type=e._type,a},toJSON:function(e,r,t,o){var a;if(store.$.recStack={},Array.isArray(r)){for(var s=[],i=0;i<r.length;i++)a=Lyte.deepCopyObject(r[i]),this.removeSelfCircularReference(e,a,t,o),"idb"==t&&this.removeNotNeededKeys(e,a),s.push(a);return s}return("object"==typeof r||Lyte.isRecord(r))&&(a=Lyte.deepCopyObject(r),this.removeSelfCircularReference(e,a,t,o),"idb"==t&&this.removeNotNeededKeys(e,a)),store.$.recStack={},a},deepCopyObject:function(e){for(var r,t,o,a,s,i,n=[{source:e,target:Object.create(Object.getPrototypeOf(e))}],d=[e],l=n[0].target,c=[l];r=n.shift();)for(t=Object.getOwnPropertyNames(r.source),o=0;o<t.length;o++)a=Object.getOwnPropertyDescriptor(r.source,t[o]),a.value&&"object"==typeof a.value?(s=a.value,a.value=Array.isArray(s)?[]:Object.create(Object.getPrototypeOf(s)),i=d.indexOf(s),-1==i?(d.push(s),c.push(a.value),Object.defineProperty(r.target,t[o],a),n.push({source:s,target:a.value})):(a.value=c[i],Object.defineProperty(r.target,t[o],a))):Object.defineProperty(r.target,t[o],a);return l},createCopy:function(e){if(Array.isArray(e)){if(e.save){for(var r=[],t=0;t<e.length;t++){var o=Lyte.deepCopyObject(e[t]);r.push(o)}return r}}else if(e&&(Lyte.isRecord(e)||"object"==typeof e))return Lyte.deepCopyObject(e);return e},compareRecords:function(e,r,t,o){if(Lyte.isRecord(e)&&Lyte.isRecord(r)&&t){var a=e.$.get(t),s=r.$.get(t);return o&&e._type&&o!==e._type?!1:a===s}return!1},hasRecordInArray:function(e,r,t,o){if(Lyte.isRecord(r)&&t)for(var a=0;a<e.length;a++)if((!o||e[a]._type===o)&&this.compareRecords(e[a],r,t))return!0;return!1},hasDuplicateRelation:function(e,r,t,o){return Array.isArray(r)?this.hasRecordInArray(r,e,t,o):r&&Lyte.isRecord(r)?this.compareRecords(e,r,t,o):!1},checkPresenceInArray:function(e,r){return e&&e.some(function(e){return e===r})},checkAndAddToArray:function(e,r){return this.checkPresenceInArray(e,r)?-1:void e.push(r)},deleteFromArray:function(e,r){for(var t=0;t<e.length;t++)e[t]==r&&e.splice(t,1)},generateRandomPk:function(e,r,t,o){var a=r[t]=Math.floor(1e5*Math.random()+1);for("string"==o&&(r[t]=a.toString());this.isDuplicateRecord(e.data,r,t);){var a=r[t]=Math.floor(1e5*Math.random()+1);"string"==o&&(r[t]=a.toString())}},newRecord:function(e,r,t){var o=store.modelFor(e);if(void 0==o)return new error1("id",{code:"ERR19",data:e,message:Lyte.errorCodes.ERR19,data:e});void 0==r&&(r={});var a=o.fieldList,s={},i=new error1,n=o._primaryKey;if(r[n])this.isDuplicateRecord(o.data,r,n)&&store.$.setError(i,n,{code:"ERR16",data:s[n],message:Lyte.errorCodes.ERR16});else{var d=a[n].type;this.generateRandomPk(o,r,n,d)}for(var l in a){var c=a[l];"hasMany"==c.relType&&(s[l]=[]);var u=r[l];if("relation"!=c.type)if(void 0==u||""==u||null==u)c.hasOwnProperty("default")&&(s[l]=c.default),c.mandatory&&store.$.isEmpty(s[l])&&!t&&store.$.setError(i,l,{code:"ERR02",message:Lyte.errorCodes.ERR02}),c.pattern&&!t&&(new RegExp(c.pattern).test(u)||store.$.setError(i,l,{code:"ERR08",message:Lyte.errorCodes.ERR08,expected:c.pattern}));else if(!t)for(var h in c){var f=Lyte.checkProperty(h,u,l,c[h],r);if(1!=f){store.$.setError(i,l,f);break}}}for(var y in r)s[y]=r[y];s=new Record(e,s);var p=o.relations;for(var v in p)for(var m=p[v],$=0;$<m.length;$++)if(s&&s[m[$].relKey]){var g=r[m[$].relKey];s[m[$].relKey]=void 0;var c=m[$],b={},f=this.getRelations(o,c.relKey,store.modelFor(c.relatedTo),b);if(1!=f){store.$.setError(i,c.relKey,{code:f,data:m,message:Lyte.errorCodes[f]});continue}var R=store.modelFor(c.relatedTo),k=R.fieldList[R._primaryKey].type;if(Array.isArray(g)){if("belongsTo"==m[$].relType){store.$.setError(i,c.relKey,{code:"ERR21",data:g,message:Lyte.errorCodes.ERR21});continue}}else g=[g];i[c.relKey]=[];for(var L=0;L<g.length;L++){var _=void 0;g[L]&&Lyte.isRecord(g[L])?_=g[L]:g[L]&&typeof g[L]==k.toLowerCase()?_=store.peekRecord(c.relatedTo,g[L]):g[L]&&"object"==typeof g[L]&&(_=this.newRecord(c.relatedTo,g[L])),_&&_.$&&_.$.isError?store.$.setError(i,c.relKey,{code:"ERR15",data:g[L],message:Lyte.errorCodes.ERR15,error:Object.assign({},_)}):_&&_.$&&!_.$.isError&&(f=this.establishLink(b.forward,b.backward,s,_),1!=f&&store.$.setError(i,c.relKey,{code:f,data:g[L],message:Lyte.errorCodes[f]}))}if(0==i[c.relKey].length&&delete i[c.relKey],"hasMany"==m[$].relType){var A=m[$].relKey;void 0==s[A]&&(s[A]=[]),s[A].add||(m[$].opts&&m[$].opts.polymorphic&&Object.defineProperty(s[A],"polymorphic",{enumerable:!1,value:!0}),store.$.defineArrayUtils(s[A]),store.$.defineUtilsFor(s[A],store.modelFor(m[$].relatedTo),s,A),store.$.definePolymorphicUtils(s[A]))}}if(i&&i.$&&Object.keys(i.$.error).length>0)return i;s.$.isNew=!0;var O=store.$.toRelate[o._name],w=s[n];if(O&&O.hasOwnProperty(w)&&(store.$.establishToRelated(s,O[w]),delete O[w]),o.didLoad)for(var S=o.didLoad,$=0;$<S.length;$++)S[$].apply(s);return this.handleArrayOperations(o.data,"push",s),this.checkAndAddToArray(o.dirty,s[o._primaryKey]),o.emit("add",[s]),store.emit("add",[o._name,s]),t&&(s.$.validatedOnCreate=!1),s},toInsertData:function(e,r,t){var o=store.modelFor(e),a=this.insertIntoStore(o,r[e],t,!0);return delete o.rel,a},insertIntoStore:function(e,r,t,o){var a;if(Array.isArray(r)){a=[];for(var s=0;s<r.length;s++)a[s]=this.insertIntoStore(e,r[s],t,o),a[s]&&a[s].$&&a[s].$.isError&&(a.$=a.$||Object.defineProperty(a,"$",{enumerable:!1,value:{}}),a.$.isError=!0)}else if(r&&Object.keys(r).length){var i=e;if(r._type&&e.extendedBy&&(i=e.extendedBy[r._type]?store.modelFor(r._type):void 0),Lyte.isRecord(r))return void 0;
if(this.isDuplicateRecord(i.data,r,i._primaryKey))a=this.validateAndMerge(i,r);else{var n=new Record(i._name,r),d=i._primaryKey,l=store.$.toRelate[i._name],c=n[d];l&&l.hasOwnProperty(c)&&(store.$.establishToRelated(n,l[c]),delete l[c]),t&&(store.$.saveParent=n);var u=store.$.recStack=store.$.recStack||{},h=u[e._name]=u[e._name]||{};h[n[e._primaryKey]]=n,a=this.validateAndPush(i,n)}t&&(store.$.saveParent=void 0),o&&(store.$.recStack={})}return a},removeFromStore:function(e,r,t){var o=e.data;if(0!=o.length){Array.isArray(r)||(r=[r]);for(var a=e._primaryKey,s=0;s<r.length;s++){var i=this.getIndex(o,a,r[s]);if(-1!=i){Object.keys(e.relations).length&&this.toDemolishRelation(e,i);var n;n=this.handleArrayOperations(o,"removeAt",void 0,i,1),n&&!t&&(n[0].$.isDeleted=!0,(n[0].$.isNew||n[0].$.isModified)&&store.$.deleteFromArray(e.dirty,n[0][a]),e._deleted.push(n[0]),e.emit("remove",[n[0]]),store.emit("remove",[e._name,n[0]]))}}}},getIndex:function(e,r,t,o){for(var a=0;e&&a<e.length;a++)if((!o||e[a]._type===o)&&e[a][r]==t)return a;return-1},isDuplicateRecord:function(e,r,t){return e.length?e.some(function(e){return r[t]==e[t]?!0:void 0}):!1},validateAndPush:function(e,r){e.rel||(e.rel={});var t=e._primaryKey;if(!r.hasOwnProperty(t))return new error1(t,{code:"ERR23",data:r,message:Lyte.errorCodes.ERR23});if(r=this.validateJSON(e,r),!r.$.isError){if(e.didLoad)for(var o=e.didLoad,a=0;a<o.length;a++)o[a].apply(r);this.isDuplicateRecord(e.data,r,t)?this.mergeData(store.peekRecord(e._name,r[t]),r):(this.handleArrayOperations(e.data,"push",r),e.emit("add",[r]),store.emit("add",[e._name,r]))}return r},validateAndMerge:function(e,r){e.rel||(e.rel={});var t=e._primaryKey,o=store.peekRecord(e._name,r[t]);if(!o||!Lyte.isRecord(o))return Lyte.error("LD04",r),!1;var a=this.mergeData(o,r);if(o=this.validateJSON(e,o,Object.keys(r),a),!o.$.isError&&e.didLoad)for(var s=e.didLoad,i=0;i<s.length;i++)s[i].apply(o);return o},mergeData:function(e,r){if(e&&r){var t,o=e.$.model,a=(o._primaryKey,{}),s={};for(var i in r)if(t=o.fieldList[i]){if("relation"!=t.type)"undefined"!=typeof LyteComponent?LyteComponent.set(e,i,r[i],!0):e[i]=r[i],a[i]=t;else if(t&&"relation"==t.type)switch(this.compareRelations(e,r,i,t)){case 0:var n={};store.$.getRelations(e.$.model,i,store.modelFor(e.$.model.fieldList[i].relatedTo),n),this.toDemolishLink(e.$.model,e,n.forward),"undefined"!=typeof LyteComponent?LyteComponent.set(e,i,r[i],!0):e[i]=r[i],a[i]=t;break;case 1:break;case 2:this.mergeData(e[i],r[i]);break;case 3:a[i]=t,s[i]=r[i]}}else"undefined"!=typeof LyteComponent?LyteComponent.set(e,i,r[i],!0):e[i]=r[i];return{toValidate:a,toPartialAdd:s}}},compareRelations:function(e,r,t,o){var a=store.modelFor(o.relatedTo)._primaryKey;if("belongsTo"==o.relType)return this.compareRecordWithObj(e[t],r[t],a);for(var s=r[t].length,i=0,n=1,d=0;s>d;d++){var l=r[t][d],c=this.getIndex(e[t],a,"object"==typeof l?l[a]:l);if(-1!=c){var u=this.compareRecordWithObj(e[t][c],l,a);(1==u||2==u)&&i++,2==u?this.mergeData(e[t][c],l):0==u&&(n=0)}else n=0}return 0==n?i>0&&i==e[t].length?3:0:i<e[t].length?0:1},compareRecordWithObj:function(e,r,t){if(!e)return 0;var o=e.$.model,a=o.fieldList;if(!Lyte.isRecord(e))return 0;var s=o.fieldList[t];if(typeof r==s.type)return e[t]==r?1:0;if("object"==typeof r){if(e[t]!=r[t])return 0;for(var i in r){var s=a[i];if(s){if("relation"==s.type){var n=this.compareRelations(e,r,i,s);if(1==n)continue;return 0}if(e[i]!=r[i])return 2}}return 1}return 0},validateJSON:function(e,r,t,o){var a=o?o.toValidate:void 0,s=a&&Object.keys(a).length?a:e.fieldList,i=e.extend?!0:!1;for(var n in r)if(!t||-1!=t.indexOf(n)){var d=s[n];if(d){if("relation"==d.type&&r[n]){var l=o&&o.toPartialAdd?o.toPartialAdd[n]:void 0,c=this.handleRelation(n,e,d,r,l);if(1!=c)return new error1(n,{code:c,data:r,message:Lyte.errorCodes[c]});"hasMany"!=d.relType||r[n].add||(store.$.defineArrayUtils(r[n]),store.$.definePolymorphicUtils(r[n]),store.$.defineUtilsFor(r[n],e,r,n))}else if(d.type){var u=d;void 0==r[n]&&u.default&&(r[n]=u.default),r[n]&&Lyte.Transform.hasOwnProperty(u.type)&&Lyte.Transform[u.type].hasOwnProperty("deserialize")&&(r[n]=Lyte.Transform[u.type].deserialize(r[n]))}}else if(i){var h=store.modelFor(e.extend),f=h.fieldList[n];if(f&&"relation"==f.type){var l=o&&o.toPartialAdd?o.toPartialAdd[n]:void 0,c=this.handleRelation(n,h,f,r,l);if(1!=c)return new error1(n,{code:c,data:r,message:Lyte.errorCodes[c]});"hasMany"!=f.relType||r[n].add||(store.$.defineArrayUtils(r[n]),store.$.definePolymorphicUtils(r[n]),store.$.defineUtilsFor(r[n],h,r,n))}}}return r},handleRelation:function(e,r,t,o,a){var s={};if(r.rel.hasOwnProperty(e))s=r.rel[e];else{var i=this.getRelations(r,e,store.modelFor(t.relatedTo),s);if(i!==!0)return i;r.rel[e]=s}return this.solveRelation(s,r,store.modelFor(t.relatedTo),e,o,a)},getRelations:function(e,r,t,o){return void 0==t?(Lyte.error("LD05",e.fieldList[r].relatedTo,r,e._name),"ERR11"):(o.forward=e.fieldList[r],o.backward=this.getBackwardRel(e,o.forward,t),void 0===o.backward?(Lyte.error("LD06",t._name,r,e._name),"ERR25"):!0)},getBackwardRel:function(e,r,t){var o,a;if(r.opts){if(o=r.opts.inverse,a=r.opts.polymorphic,null===o)return null;if(a){var s=t.extendedBy;if(s)for(var i in s){var n=store.modelFor(i);if(n.relations[e._name]){t=n;break}}}}var d;if(o&&""!=o)d=o;else{var l=t.relations[e._name],c=store.modelFor(e.extend);!l&&c&&t.relations[c._name]&&t.relations[c._name].opts&&t.relations[c._name].opts.polymorphic&&(l=t.relations[c._name]),d=l&&1==l.length?l[0].relKey:void 0}if(!d){var u=t.relations[e._name],h=store.modelFor(e.extend);if(!u&&h&&t.relations[h._name]&&t.relations[h._name].opts&&t.relations[h._name].opts.polymorphic&&(u=t.relations[h._name]),u)for(var f=0;f<u.length;f++)if(u[f]&&u[f].opts&&u[f].opts.inverse===r.relKey){d=u[f].relKey;break}}return d?t.fieldList[d]:void 0},solveRelation:function(e,r,t,o,a,s){var i=e.backward,n=e.forward;if(!i&&(n.relatedTo===r._name&&(i=n),void 0===i))return"ERR12";if(s)d=s;else{if(a[o]&&(a[o].add||Lyte.isRecord(a[o])))return!0;if(Array.isArray(a[o])){if("belongsTo"==n.relType)return"ERR21"}else a[o]=[a[o]];var d=a[o].splice(0,a[o].length);"belongsTo"==n.relType&&(a[o]=void 0)}for(var l=0;l<d.length;l++){var c;if(typeof d[l]==t.fieldList[t._primaryKey].type?c=store.peekRecord(t._name,d[l])||(store.$.recStack&&store.$.recStack[t._name]?store.$.recStack[t._name][d[l]]:void 0):"object"!=typeof d[l]||Lyte.isRecord(d[l])||(c=this.insertIntoStore(t,d[l])),c&&c.$&&c.$.isError){a.$.isError=!0;var u={code:"ERR24",message:Lyte.errorCodes.ERR24,data:a,error:c.$.error};"undefined"!=typeof LyteComponent?LyteComponent.set(a.$.error,o,u):a.$.error[o]=u}else c?this.hasDuplicateRelation(c,a[o],t._primaryKey,d[l]._type)||this.establishLink(n,i,a,c):this.addToRelate(r._name,a,e,d[l])}return!0},establishLink:function(e,r,t,o,a){if(!o)return"ERR13";if(!this.checkForCorrectRelation(e,o))return"ERR14";var s=e.relKey,i=o._type;if("belongsTo"==e.relType)t[s]!==o&&("undefined"!=typeof LyteComponent?LyteComponent.set(t,s,o,!0):t[s]=o);else if("hasMany"===e.relType){if(t[s]||("undefined"!=typeof LyteComponent?LyteComponent.set(t,s,[],!0):t[s]=[]),!t[s].model){var n=o.$.model;i&&(Object.defineProperty(t[s],"polymorphic",{enumerable:!1,value:!0}),n=store.modelFor(n.extend)),store.$.establishObserverBindings(t,t.$.model._properties),store.$.defineArrayUtils(t[s]),store.$.definePolymorphicUtils(t[s]),store.$.defineUtilsFor(t[s],n,t,s)}this.hasDuplicateRelation(o,t[s],e?store.modelFor(e.relatedTo)._primaryKey:void 0,i)||(void 0!=a?"undefined"!=typeof LyteComponent?LyteComponent.arrayFunctions(t[s],"insertAt",a,o):t[s].splice(a,0,o):this.handleArrayOperations(t[s],"push",o))}if(e==r)return!0;if(null===r)return o.hasOwnProperty(d)&&delete o[d],!0;var d=r.relKey,l=o.$.model;return this.checkForCorrectRelation(r,t)?("belongsTo"==r.relType?(void 0!=o[d]&&o[r.relKey]!==t&&this.toDemolishLink(l,o,r),o[d]!==t&&("undefined"!=typeof LyteComponent?LyteComponent.set(o,d,t,!0):o[d]=t)):"hasMany"===r.relType&&(o[d]||("undefined"!=typeof LyteComponent?LyteComponent.set(o,d,[],!0):o[d]=[]),o[d].model||(store.$.defineArrayUtils(o[d]),store.$.definePolymorphicUtils(o[d]),store.$.defineUtilsFor(o[d],t.$.model,o,d)),this.hasDuplicateRelation(t,o[d],r?store.modelFor(r.relatedTo)._primaryKey:void 0,i)||this.handleArrayOperations(o[d],"push",t)),!0):"ERR14"},toDemolishRelation:function(e,r){var t=e.data[r],o=e.relations;for(var a in o)for(var s=o[a],i=0;i<s.length;i++){var n=s[i];t[n.relKey]&&this.toDemolishLink(e,t,n)}},toDemolishLink:function(e,r,t){var o=r[t.relKey],a=e._primaryKey,s=store.modelFor(t.relatedTo),i=(s._primaryKey,t.relatedTo,this.getBackwardRel(e,t,s));if(null!==i)if(Array.isArray(o))for(var n=0;n<o.length;n++)this.demolishLink(r,a,o[n],i.relKey);else Lyte.isRecord(o)&&this.demolishLink(r,a,o,i.relKey)},demolishLink:function(e,r,t,o){{var a=t[o];t.$.model}if(Array.isArray(a)){var s=this.getIndex(a,r,e[r],e._type);-1!=s&&this.handleArrayOperations(t[o],"removeAt",void 0,s,1)}else a&&("object"==typeof a||Lyte.isRecord(a))&&delete t[o]},rollBackRecordsArray:function(e,r,t,o){var a={},s=t._primaryKey,i=store.modelFor(o.relatedTo)._primaryKey;store.$.getRelations(t,o.relKey,store.modelFor(o.relatedTo),a);for(var n=e.length-1;n>=0;n--){var d=e[n].records;if("added"==e[n]._type)for(var l=0;l<d.length;l++){var c=d[l];this.demolishLink(c,i,r,a.forward.relKey),this.demolishLink(r,s,c,a.backward.relKey)}else if("removed"==e[n]._type)for(var l=d.length-1;l>=0;l--){var c=d[l];this.establishLink(a.forward,a.backward,r,c,e[n]._indices[l])}else if("changed"==e[n]._type){var u=r[o.relKey];for(Array.isArray(u)||(u=[u]);u.length;){var c=u[0];if(this.demolishLink(c,i,r,a.forward.relKey),this.demolishLink(r,s,c,a.backward.relKey),"belongsTo"==a.forward.relType)break}Array.isArray(d)||(d=[d]);for(var l=0;l<d.length;l++){var c=d[l];"string"==typeof c&&(c=store.peekRecord(a.forward.relatedTo,c)),this.establishLink(a.forward,a.backward,r,c)}}}},sortBy:function(e,r){var t=store.$.mapBy.call(this,e),o=this.model,a=o.fieldList[e];a&&"string"==a.type?(t.sort(),"desc"==r&&t.reverse()):(t.sort(function(e,r){return e-r}),"desc"==r&&t.sort(function(e,r){return r-e}));for(var s=this.slice(0),i=[],n=0;n<t.length;n++)if(void 0!=t[n]){var d=store.$.getIndex(s,e,t[n]);i.push(s[d]),s.splice(d,1)}return s.length>0&&(i="desc"==r?i.concat(s):s.concat(i)),store.$.defineArrayUtils(i),store.$.defineUtilsFor(i,this.model),i},mapBy:function(e){return this.map(function(r){return r.$.get(e)})},revertToOldVal:function(e,r,t,o){if(void 0!=t&&0!=t.length){Array.isArray(t)||(t=[t]);for(var a=0;a<t.length;a++)this.establishLink(o.forward,o.backward,e,t[a])}},rollBackDelete:function(e,r){var t=e._deleted,o=t.splice(r,1)[0],a=e._primaryKey;o.$.isDeleted=!1,this.handleArrayOperations(e.data,"push",o);var s=e.relations;if(s)for(var i in s){var n=s[i]||[],d=this;n.forEach(function(r){var t,a,s=r.relKey;o.hasOwnProperty(s)&&(a=store.modelFor(r.relatedTo),t=d.getBackwardRel(e,r,a)),d.establishLink(r,t,o,o[s])})}(o.$.isNew||o.$.isModified)&&this.checkAndAddToArray(e.dirty,o[e._primaryKey]),store.$.clearRecordError(o.$,a,"ERR17"),e.emit("add",[o]),store.emit("add",[e._name,o])},rollBackNew:function(e,r,t){var o=this.getIndex(e.data,t,r[t]);this.handleArrayOperations(e.data,"removeAt",void 0,o,1),r.$.isNew=!1,e.emit("delete",[r]),store.emit("delete",[e._name,r]),this.deleteFromArray(e.dirty,r[t])},emit:function(e,r,t,o){r.$.emit(e,[r,t,o]),r.$.model.emit(e,[r,t,o]),store.emit(e,[r.$.model._name,r,t,o])},hasRecordsArrayChanged:function(e,r){var t=e.$.getInitialValues(r),o=!0,a=e.$.model._primaryKey;if(t&&t.length==e[r].length){o=!1;for(var s=0;s<t.length;s++)if(!this.compareRecords(t[s],e[r][s],a))return!0}return o},setRecordError:function(e,r,t,o){e.isError=!0;var a=t;"object"==typeof a?"undefined"!=typeof LyteComponent?LyteComponent.set(e.error,r,a):e.error[r]=a:(a={code:t,message:Lyte.errorCodes[t]},"undefined"!=typeof LyteComponent?LyteComponent.set(e.error,r,a):e.error[r]=a,o&&("undefined"!=typeof LyteComponent?LyteComponent.set(e.error[r],"value",o):e.error[r].value=o)),store.$.emit("error",e.record,r,a)},clearRecordError:function(e,r,t){if(t)e.error.code==t&&("undefined"!=typeof LyteComponent?Lyte.objectUtils(e.error,"delete",r):delete e.error[r]);else if(r)"undefined"!=typeof LyteComponent?Lyte.objectUtils(e.error,"delete",r):delete e.error[r];else if("undefined"!=typeof LyteComponent)for(var o in e.error)Lyte.objectUtils(e.error,"delete",o);else e.error={};0==Object.keys(e.error).length&&(e.isError=!1)},cacheQuery:function(e,r,t){store.model.cachedQueries=store.model.cachedQueries||{},store.model.cachedQueries[e]=store.model.cachedQueries[e]||[],store.model.cachedQueries[e].push({queryParams:r,data:t})},cacheRecordQuery:function(e,r,t,o){store.model.cachedRecordQueries=store.model.cachedRecordQueries||{},store.model.cachedRecordQueries[e]=store.model.cachedRecordQueries[e]||{},store.model.cachedRecordQueries[e][r]=store.model.cachedRecordQueries[e][r]||[],store.model.cachedRecordQueries[e][r].push({queryParams:t,data:o})},handleArrayOperations:function(e,r,t,o,a){if("undefined"!=typeof Lyte.arrayUtils)switch(r){case"push":Lyte.arrayUtils(e,r,t);break;case"removeAt":return Lyte.arrayUtils(e,r,o,a);default:Lyte.error("LD07",r)}else switch(r){case"push":e.push(t);break;case"removeAt":return e.splice(o,a);default:Lyte.error("LD07",r)}},defineArrayUtils:function(e){Object.defineProperties(e,{filterBy:{enumerable:!1,value:store.$.filterBy},sortBy:{enumerable:!1,value:store.$.sortBy},mapBy:{enumerable:!1,value:store.$.mapBy}})},definePolymorphicUtils:function(e){Object.defineProperties(e,{add:{enumerable:!1,value:store.$.add},remove:{enumerable:!1,value:store.$.remove}})},defineUtilsFor:function(e,r,t,o){r&&Object.defineProperty(e,"model",{enumerable:!1,value:r}),t&&Object.defineProperty(e,"record",{enumerable:!1,writable:!0,value:t}),o&&Object.defineProperty(e,"key",{enumerable:!1,value:o})}}};store.adapter={$:{getFromAdapter:function(e,r){for(var t=e?e[r]:void 0;void 0==t;)if(e&&e.$super)e=e.$super,t=e?e[r]:void 0;else{if(e=store.adapter.application,!e||!e.hasOwnProperty(r)){switch(r){case"host":t=window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.host;break;case"namespace":t="";break;case"actionNamespace":t="action";break;case"batchNamespace":t="batch";break;default:t=void 0}break}t=e[r]}return t},buildURL:function(e,r,t,o,a,s,i,n){var d=store.adapter[t],l=this.getFromAdapter(d,"host"),c="";store.$.makeBatch||void 0!=l&&(c+=l,"/"!=l[l.length-1]&&(c+="/"));var u=this.getFromAdapter(d,"namespace");if(c+=""!=u&&"/"!=u[u.length-1]?u+"/":u,"batch"!=e&&(c+=t,o&&(c+="/"+o)),"action"==e){c+="/"+this.getFromAdapter(d,"actionNamespace");var h=store.modelFor(t).actions,f=h[i].endPoint?h[i].endPoint:i;c+="/"+f}else"batch"==e&&(c+=this.getFromAdapter(store.adapter.application,"batchNamespace"));s||(s={});var y,p=this.getCallBackScope(t,"headersForRequest"),v={method:r?r:""};if(p&&(y=this.constructArgs(e,s,n,i,o),v.headers=this.callBack(p,y)),p=this.getCallBackScope(t,"buildURL"),p&&(y=this.constructArgs(t,e,s,a,c,i,n,o),c=this.callBack(p,y)),p=this.getCallBackScope(t,"methodForRequest"),p&&(y=this.constructArgs(r,e,s,n,i,o),v.method=this.callBack(p,y)),!store.$.makeBatch&&Object.keys(s).length){c+="?";var m=0;for(var o in s)0!=m&&(c+="&"),c+=o+"="+encodeURIComponent(s[o]),m++}return d&&1==d.withCredentials&&(v.withCredentials=!0),v.url=c,v.qP=s,v},getCallBackScope:function(e,r){for(var t,o=store.adapter[e],a=store.adapter.application;void 0==t;){if(o&&o[r]&&"function"==typeof o[r])return{scope:o,func:o[r]};if(!o||!o.$super)return a&&a[r]&&"function"==typeof a[r]?{scope:a,func:a[r]}:void 0;o=o.$super}},callBack:function(e,r){return callbackValue=e.func.apply(e.scope,r)},constructArgs:function(){for(var e=arguments,r=[],t=0;t<e.length;t++)r.push(e[t]);return r},get:function(e,r,t,o,a,s){var i=store.modelFor(r),n=store.$.makeBatch;if(i){if("findAll"==e&&o&&store.model.cachedQueries&&store.model.cachedQueries[r]){for(var d,l=store.model.cachedQueries[r],c=0;c<l.length;c++){var u=l[c].queryParams;if(this.compareObjects(u,o,!0)){d=[l[c].data,"cache"];break}}if(d)return new Promise(function(e){n&&store.$.addToCachedBatch(d),e(d)})}else if("findRecord"==e&&o&&store.model.cachedRecordQueries&&store.model.cachedRecordQueries[r]&&store.model.cachedRecordQueries[r][t]){for(var d,l=store.model.cachedRecordQueries[r][t],c=0;c<l.length;c++){var u=l[c].queryParams;if(this.compareObjects(u,o,!0)){d=[l[c].data,"cache"];break}}if(d)return new Promise(function(e){n&&store.$.addToCachedBatch(d),e(d)})}else{var h=this.getCallBackScope(r,"findRecord"==e?"reloadRecord":"reloadAll");if(h){var f;if("findRecord"==e?f=store.peekRecord(r,t):"findAll"==e&&(f=store.peekAll(r)),!this.callBack(h,[f,o])){var y={};return y[r]=f,new Promise(function(e){n&&store.$.addToCachedBatch(y),e([y,"cache"],"success",void 0,!0)})}}}var p,v,m=this.buildURL(e,"GET",r,t,void 0,o,void 0,s),$=this;return new Promise(function(a,i){p=a,v=i;var d,l=store.modelFor(r),c=l.idb,u=$.getFromAdapter(store.adapter[r],"processRequest"),h=!0;if(u){h=!1;var f=$.callGeneric(e,r,void 0,void 0,s);f instanceof Promise?f.then(function(o){o=JSON.parse(""==o?"{}":o),d=$.getResponse(o,r,e,t,m),a([d])},function(e){i(e)}):h=!0}var y=[r,e,t,m,a,i,"get"];n?store.adapter.$.constructBatch.apply(store.adapter.$,y).then(function(o){var s=o.content;store.adapter.$.getSuccess(r,e,t,m,void 0,a,s,o),a(s)},function(){store.adapter.$.sendXHR.apply(store.adapter.$,y).then(function(o){store.adapter.$.getSuccess(r,e,t,m,o,a)},function(o){store.adapter.$.getFailure(r,e,t,m,o,i)})}):c?store.adapter.$.getFromIDB(c,r,e,o,t,m).then(function(s){var n,d=store.serializer.$.getCallBackScope(r,"idbResponse");d&&(n=$.constructArgs(r,e,o,t,s),s=$.callBack(d,n)),0==s?store.adapter.$.sendXHR.apply(store.adapter.$,y).then(function(o){store.adapter.$.getSuccess(r,e,t,m,o,a)},function(o){store.adapter.$.getFailure(r,e,t,m,o,i)}):store.adapter.$.getSuccess(r,e,t,m,void 0,a,s)},function(){store.adapter.$.sendXHR.apply(store.adapter.$,y).then(function(o){store.adapter.$.getSuccess(r,e,t,m,o,a)},function(o){store.adapter.$.getFailure(r,e,t,m,o,i)})}):h&&store.adapter.$.sendXHR.apply(store.adapter.$,y).then(function(o){store.adapter.$.getSuccess(r,e,t,m,o,a)},function(o){store.adapter.$.getFailure(r,e,t,m,o,i)})})}return Promise.reject({code:"ERR19",message:Lyte.errorCodes.ERR19,data:r})},constructBatch:function(e,r,t,o){return new Promise(function(e,r){var t=store.$.currentBatch,a=store.$.batch[t]=store.$.batch[t]||[],s=store.$.batchPromise[t]=store.$.batchPromise[t]||[],i={};i.method=o.method,i.uri="/"+o.url,i.parameters=o.qP,i.content="string"==typeof o.data?JSON.parse(o.data):void 0,a.push(i),s.push({resolve:e,reject:r})})},getFromIDB:function(e,r,t,o,a){return new Promise(function(s,i){if(worker){var n=e.queryCache?"getCachedData":"findAll"==t?"getAll":"get",d={resolve:s,reject:i,type:n,model:r,req:t,key:a};"getCachedData"==n&&(d.queryParams=o),LyteIDB.postMessage(d)}else i()})},sendXHR:function(e,r,t,o){return new Promise(function(a,s){var i=new XMLHttpRequest;i.open(o.method,o.url,!0);for(var n in o.headers)i.setRequestHeader(n,o.headers[n]);i.withCredentials=o.withCredentials?!0:!1,store.emit("beforeRequest",[i,e,r,t]),i.send(o.data),i.onreadystatechange=function(){return 4==i.readyState?(store.emit("afterRequest",[i,e,r,t]),"2"==i.status.toString()[0]||"3"==i.status.toString()[0]?a(i):s(i)):void 0}})},getSuccess:function(e,r,t,o,a,s,i,n){var d,l,c,u=i,h=a;if(h&&(u=h.responseText,u=JSON.parse(""==u?"{}":u)),n&&(l=n.index,c=n.batch,h=n.resp),h&&store.adapter&&store.adapter[e]){var f,y=this.getCallBackScope(e,"parseResponse");y&&(f=this.constructArgs(r,e,h,u),u=this.callBack(y,f))}d=this.getResponse(u,e,r,t,o,a);var p=a?[d,a.statusText,a]:void 0!=l?[d,"batch",{index:l,batch:c}]:[d];s(p)},getFailure:function(e,r,t,o,a,s){var i,n,d=this.getCallBackScope(e,"parseResponse");d&&(i=this.constructArgs(r,e,a),n=this.callBack(d,i)),s(a)},getResponse:function(e,r,t,o,a,s){e=store.serializer.$.normalizeResponse(r,t,e,o,s?s.status:s,a.headers);var i,n=store.serializer.$.getCallBackScope(r,"extractMeta"),d=e;if("object"!=typeof d&&(d=JSON.parse(d)),n){i=this.constructArgs(d,r,t);var l=this.callBack(n,i);store.$.isEmpty(l)||(d.meta=l)}var c=Object.keys(d),u=c.length;if(u){if(n=store.serializer.$.getCallBackScope(r,"payloadKey")){i=this.constructArgs(r,t);var h=this.callBack(n,i);if(h&&h!=r){var f=d[h];d[r]=f,delete d[h]}}if(n=store.serializer.$.getCallBackScope(r,"deserializeKey")){Lyte.warn("LD08","deserializeKey","callback","Please use payloadKey callback instead"),u>2&&Lyte.error("LD09");var y=0;2==u&&"meta"==c[0]&&(y=1),i=this.constructArgs(r,t);var p=this.callBack(n,i),v=d[c[y]];delete d[c[y]],d[p]=v}store.serializer.$.normalize(r,t,d,o,s?s.status:s,a.headers)}return d},create:function(e,r,t,o,a){var s=t?"createRecord":"create",i=this.buildURL(s,"POST",e,void 0,r,a,void 0,o),n=store.$.toJSON(e,r,void 0,"create");return store.$.removeNotDefinedKeys(store.modelFor(e),n),this.sendingData(e,n,i,s,o,r),this.handleRequest(i,e,r,s,n,o)},put:function(e,r,t,o,a,s){var i=o?"updateRecord":"update",n=this.buildURL(i,"PATCH",e,o?r[store.modelFor(e)._primaryKey]:void 0,r,s,void 0,a),d=store.$.toJSON(e,r);return store.$.removeNotDefinedKeys(store.modelFor(e),d),this.sendingData(e,d,n,i,a,t),this.handleRequest(n,e,t,i,d,a)},del:function(e,r,t,o,a,s){var i=o||"deleteRecord",n=store.modelFor(e)._primaryKey,d=this.buildURL(i,"DELETE",e,t?r[n]:void 0,r,s,void 0,a),l=[];t||(l=r.map(function(e){return e[n]}));var c=t?r?r[n]:void 0:l;return this.sendingData(e,c,d,i,a,r),this.handleRequest(d,e,r,i,c,a)},sendingData:function(e,r,t,o,a,s){var i=store.serializer.$.getCallBackScope(e,"serializeKey"),n=e,d={};if(i){var l=this.constructArgs(e,o,a);n=this.callBack(i,l)}n?(Array.isArray(r)||"object"==typeof r||Lyte.isRecord(r))&&(d[n]=r):d=r;var i=store.serializer.$.getCallBackScope(e,"serialize");if(i){var l=this.constructArgs(o,d,s,a,e);d=this.callBack(i,l)}"deleteRecord"!==o&&"destroyRecord"!==o?t.data=d:i&&d&&void 0!==d&&null!==d&&""!==d&&(t.data=d)},handleAction:function(e,r,t,o,a){var s;t&&Lyte.isRecord(t)&&(s=t.$.get(r._primaryKey));var i=r._name,n="action",d=this.buildURL(n,"POST",r._name,s,t,a,e,o),l=store.serializer.$.getCallBackScope(r._name,"serialize");if(l){var c=this.constructArgs(e,void 0,t,o,i);d.data=this.callBack(l,c)}return this.handleRequest(d,r._name,void 0,n,void 0,o)},handleRequest:function(e,r,t,o,a,s){!e.data||"object"!=typeof e.data&&!Lyte.isRecord(e.data)&&!Array.isArray(e.data)||e.data instanceof FormData||(e.data=JSON.stringify(e.data));var i,n=this;return new Promise(function(a,d){var l=n.getFromAdapter(store.adapter[r],"processRequest"),c=!0,u=store.$.makeBatch;if(l){c=!1;var h,f=n.callGeneric(o,r,e.data,t,s);f instanceof Promise?f.then(function(s){s=JSON.parse(""==s?"{}":s),h=n.genericResponse(s,r,o,t,e),0==h&&d("Data is not in the format as store expects in "+r+" for type- "+o),a(h)},function(e){d(e)}):c=!0}if(u)store.adapter.$.constructBatch(r,o,key,e).then(function(s){var n=s.content;store.adapter.$.handleSuccess(r,o,i,t,e,a,n,s),a(n)},function(){store.adapter.$.handleFailure(r,o,i,d)});else if(c){var y=[r,o,key,e,a,d,"other",t];store.adapter.$.sendXHR.apply(store.adapter.$,y).then(function(s){store.adapter.$.handleSuccess(r,o,s,t,e,a)},function(e){store.adapter.$.handleFailure(r,o,e,d)})}})},handleSuccess:function(e,r,t,o,a,s,i,n){var d,l,c,u,i=i?i:t.responseText;if(i=""==i?JSON.parse("{}"):"string"==typeof i?JSON.parse(i):i,t&&(l=t),n&&(c=n.index,u=n.batch,l=n.resp),l&&store.adapter&&store.adapter[e]){var h,f=this.getCallBackScope(e,"parseResponse");f&&(h=this.constructArgs(r,e,l,i),i=this.callBack(f,h))}d=this.genericResponse(i,e,r,o,a,t),0==d?reject("Response is not in the format as store expects in model, "+e+" for type "+r):(void 0!=c&&(store.$.batchResponse[u][c]=d),"action"!=r&&this.updateIDB(e,r,o),s(d))},handleFailure:function(e,r,t,o){if(t){var a,s=this.getCallBackScope(e,"parseResponse");s&&(a=this.constructArgs(r,e,t),resp=this.callBack(s,a))}o(t)},updateIDB:function(e,r,t){t&&!Array.isArray(t)&&(t=[t]);var o=store.$.idbQ2[e]=store.$.idbQ2[e]||[];if(t)switch(r){case"update":case"updateRecord":t.forEach(function(r){if(r&&Lyte.isRecord(r)){var t=store.model[e],a=t.relations,s=r.$.parent;if(s){var i=s.$.model._name,n=store.$.idbQ2[i]=store.$.idbQ2[i]||[];n.push({type:"updateRecord",model:i,data:s.$.toJSON(!0)})}else o.push({type:"updateRecord",model:e,data:r.$.toJSON(!0)});store.adapter.$.updateRelationsIDB(r,a),store.$.addToIDBonSave(e,r)}});break;case"delete":case"deleteRecord":case"destroyRecord":var a,s,i,n=store.modelFor(e)._primaryKey;t.forEach(function(r){if(r&&Lyte.isRecord(r)){var t=store.model[e],d=t.relations;a=r.$.parent,a?(s=a.$.model._name,i=store.$.idbQ2[s]=store.$.idbQ2[s]||[],i.push({type:"updateRecord",model:a.$.model._name,data:a.$.toJSON(!0)})):o.push({type:"deleteRecord",model:e,key:r[n]}),store.adapter.$.updateRelationsIDB(r,d),store.$.removeOnSave(e,r[n])}});break;case"create":case"createRecord":t.forEach(function(r){if(r&&Lyte.isRecord(r)){var t=store.model[e],a=t.relations;o.push({type:"createRecord",model:e,data:r.$.toJSON(!0)}),store.adapter.$.updateRelationsIDB(r,a),store.$.addToIDBonSave(e,r)}})}},updateRelationsIDB:function(e,r){for(var t in r){var o=r[t];o.forEach(function(r){var t=r.relKey,o=r.relatedTo,a=store.$.idbQ2[o]=store.$.idbQ2[o]||[],s=e[t];s&&(Array.isArray(s)?s.forEach(function(e){Lyte.isRecord(e)&&!e.$.parent&&e.$.inIDB&&a.push({type:"updateRecord",model:o,data:e.$.toJSON(!0)})}):Lyte.isRecord(s)&&!s.$.parent&&s.$.inIDB&&a.push({type:"updateRecord",model:o,data:s.$.toJSON(!0)}))})}},callGeneric:function(e,r,t,o,a){var s,i=this.getCallBackScope(r,"processRequest");if(i){var n=this.constructArgs(e,r,t,o,a);s=this.callBack(i,n)}return s},genericResponse:function(e,r,t,o,a,s){var i,n,d=e;if(i=store.serializer.$.getCallBackScope(r,"extractMeta")){n=this.constructArgs(d,r,t);var l=this.callBack(i,n);store.$.isEmpty(l)||(d.meta=l)}if(d&&"action"!=t){if(d=store.serializer.$.buildJSON(r,t,d,Lyte.isRecord(o)?o[store.modelFor(r)._primaryKey]:void 0,s?s.status:s,a.headers),i=store.serializer.$.getCallBackScope(r,"payloadKey")){n=this.constructArgs(r,t);var c=this.callBack(i,n);if(c&&c!=r){var u=d[c];d[r]=u,delete d[c]}}var h=Object.keys(d),f=h.length;if(i=store.serializer.$.getCallBackScope(r,"deserializeKey")){Lyte.warn("LD08","deserializeKey","callback","Please use payloadKey callback instead"),f>2&&Lyte.error("LD09");var y=0;"meta"==h[0]&&(y=1);var n=this.constructArgs(r,t),p=this.callBack(i,n),v=d[h[y]];delete d[h[y]],d[p]=v}this.handleResponse(a,o,d[r],s?s.statusText:s,s,store.modelFor(r))}return d},checkResponse:function(e,r,t,o){var a;if(e.$.isNew){e.hasOwnProperty(o)&&t.hasOwnProperty(o)&&(a=e[o],"undefined"!=typeof LyteComponent?LyteComponent.set(e,o,t[o],!0):e[o]=t[o]);var s=store.$.validateAndMerge(r,t);e.$.isNew=!1,0==s&&Lyte.error("LD01",t)}if(e.$.isModified&&(a=e[o],e.$.isModified=!1,e.$._attributes={},!e.$.isDeleted&&t)){var s=store.$.validateAndMerge(r,t);0==s&&Lyte.error("LD01",t)}if(r.dirty.length&&store.$.deleteFromArray(r.dirty,a),e.$.isDeleted){e.$.isDeleted=!1;var i=r._deleted,n=store.$.getIndex(i,o,e[o]);r._deleted.splice(n,1)}for(var d=e.$.isDirty(),l=0;l<d.length;l++){var c=e[d[l]];if(Array.isArray(c))for(var u=0;u<c.length;u++)c[u].$.isModified=!1;else Lyte.isRecord(c)&&(c.$.isModified=!1)}store.$.clearRecordError(e.$)},handleResponse:function(e,r,t,o,a,s){var i=s._primaryKey;if(Array.isArray(r))for(var n=0;n<r.length;n++)ret=this.checkResponse(r[n],s,Array.isArray(t)?t[n]:t,i);else this.checkResponse(r,s,t,i)},compareObjects:function(e,r,t){if(!(e instanceof Object&&r instanceof Object))return!1;if(Object.keys(e).length!=Object.keys(r).length)return!1;for(var o in e){var a=e[o],s=r[o];if(t&&Array.isArray(a)&&Array.isArray(s)){for(var i=a.length,n=0;i>n;n++)if(a[n]!=s[n])return!1}else if(void 0==s||a!=s)return!1}return!0},handleBatchPromise:function(e){var r=e.response,t=e.batch;scope=store.serializer.$.getCallBackScope("application","normalizeResponse"),scope&&(args=this.constructArgs(void 0,"batch",e.response),r=this.callBack(scope,args));var o=r.batch_requests;o.forEach(function(e,r){var o=store.$.batchPromise[t][r],a=e.status.toString()[0];"2"==a?o.resolve({content:e.content,index:r,batch:t,resp:e}):("4"==a||"5"==a)&&o.reject()}),delete store.$.batch[t],delete store.$.batchPromise[t]}}},Object.defineProperty(store.adapter,"extends",{enumerable:!1,value:function(e,r,t){if(e){if(store.adapter.hasOwnProperty(e))throw new Error("Adapter with name - "+e+" -  already exists");return store.adapter[e]=new Adapter(r,t,e),store.adapter[e]}}}),store.serializer={$:{getCallBackScope:function(e,r){for(var t,o=store.serializer[e],a=store.serializer.application;void 0==t;){if(o&&o[r]&&"function"==typeof o[r])return{scope:o,func:o[r]};if(!o||!o.$super)return a&&a[r]&&"function"==typeof a[r]?{scope:a,func:a[r]}:void 0;o=o.$super}},buildJSON:function(e,r,t,o,a,s){var i=this.getCallBackScope(e,"normalizeResponse"),n=t;if(i){var d=store.adapter.$.constructArgs(e,r,n,o,a,s);n=store.adapter.$.callBack(i,d)}var l,c=!1;if(/^(findRecord|findAll)$/.test(r)||n[e]){if(l=n[e],c=!0,i=this.getCallBackScope(e,"normalize"))if(Array.isArray(l))for(var u=0;u<l.length;u++){var d=store.adapter.$.constructArgs(e,r,l[u]);l[u]=store.adapter.$.callBack(i,d)}else{var d=store.adapter.$.constructArgs(e,r,l);l=store.adapter.$.callBack(i,d)}n[e]=l}return n},normalizeResponse:function(e,r,t,o,a,s){var i=this.getCallBackScope(e,"normalizeResponse"),n=t;if(i){var d=store.adapter.$.constructArgs(e,r,n,o,a,s);n=store.adapter.$.callBack(i,d)}return n},normalize:function(e,r,t){var o=t,a=!1;(/^(findRecord|findAll)$/.test(r)||o[e])&&(o=o[e],a=!0);var s=this.getCallBackScope(e,"normalize");if(s)if(Array.isArray(o))for(var i=0;i<o.length;i++){var n=store.adapter.$.constructArgs(e,r,o[i]);o[i]=store.adapter.$.callBack(s,n)}else{var n=store.adapter.$.constructArgs(e,r,o);o=store.adapter.$.callBack(s,n)}a&&(t={},t[e]=o)}}},Object.defineProperty(store.serializer,"extends",{enumerable:!1,value:function(e,r,t){if(store.serializer.hasOwnProperty(e))throw new Error("Serializer with name - "+e+" -  already exists");return store.serializer[e]=new Serializer(r,t,e),store.serializer[e]}}),Object.defineProperties(store,{triggerUpdate:{enumerable:!1,value:function(e,r,t,o,a){var s={},i=store.peekRecord(e,r);if(i){var n=i.$.model,d=n._primaryKey,l=t||Object.keys(n.fieldList);return l.forEach(function(e){s[e]=i[e]}),s[d]=i[d],store.adapter.$.put(e,s,i,!0,a,o)}return Promise.reject("No such record found")}},batch:{enumerable:!1,value:function(e){return new Promise(function(r,t){store.$.makeBatch=!0,store.$.batch=store.$.batch||{},store.$.batchPromise=store.$.batchPromise||{};var o=void 0===store.$.currentBatch?Object.keys(store.$.batch).length:store.$.currentBatch+1,a=store.$.currentBatch=o;try{e()}catch(s){throw store.$.makeBatch=!1,s}store.$.makeBatch=!1;var i={batch:store.$.batch[a]},n=store.adapter.$.buildURL("batch","POST","application"),d=i.batch;if(store.$.isEmpty(d)||d=={}){if(store.$.cachedBatch&&store.$.cachedBatch[a]&&store.$.cachedBatch[a].length){var l=store.$.handleCachedResponse(a,[]);return r(l)}return r()}var c=store.serializer.$.getCallBackScope("application","serialize");if(c){var u=store.adapter.$.constructArgs("batch",i);i=store.adapter.$.callBack(c,u)}var h=new XMLHttpRequest;h.open("POST",n.url,!0);for(var f in n.headers)h.setRequestHeader(f,n.headers[f]);h.withCredentials=n.withCredentials?!0:!1,h.send(JSON.stringify(i)),h.onreadystatechange=function(){if(4==h.readyState)if("2"==h.status.toString()[0]||"3"==h.status.toString()[0]){var e=JSON.parse(h.responseText);store.$.batchResponse=store.$.batchResponse||{},store.$.batchResponse[a]=[],store.adapter.$.handleBatchPromise({response:e,batch:a,resolve:r}),setTimeout(function(){var e=store.$.handleCachedResponse(a,store.$.batchResponse[a]);
r(e),store.$.batchResponse[a]=[]},0)}else setTimeout(function(){t()},0)}})}},pushPayload:{enumerable:!1,value:function(e,r,t){var o,a=store.modelFor(e),s=r;if(t){r=store.serializer.$.buildJSON(e,"pushPayload",r);var i=store.serializer.$.getCallBackScope(e,"deserializeKey");if(o=r?Object.keys(r).length:void 0,i){Lyte.warn("LD08","deserializeKey","callback","Please use payloadKey callback instead"),o>2&&Lyte.error("LD09");var n=Object.keys(r),d=0;2==n.length&&"meta"==n[0]&&(d=1);var l=store.adapter.$.constructArgs(e,"pushPayload"),c=store.adapter.$.callBack(i,l),u=r[n[d]];delete r[n[d]],r[c]=u}s=r[e]}return store.$.idbQ2Push(e,r,void 0,"pushPayload"),r=store.$.insertIntoStore(a,s,!0),delete a.rel,r}},registerModel:{enumerable:!1,value:function(e,r,t){if(store.model.hasOwnProperty(e))throw new Error("Model with name - "+e+" - already exists");var o,a,s;if(t&&"object"==typeof t&&(o=t.extends||void 0,a=t.actions||void 0,s=t.idb||void 0),o){var i=Object.assign({},store.model[o].fieldList);for(var n in i)"relation"==i[n].type&&delete i[n];r=Object.assign(r,i)}if(store.model[e]=new Model(e,r),o&&(store.model[e].extend=o,store.model[o].extendedBy||(store.model[o].extendedBy={}),store.model[o].extendedBy[e]=!0,!store.adapter[e]&&store.adapter[o]&&(store.adapter[e]=store.adapter[o]),!store.serializer[e]&&store.serializer[o]&&(store.serializer[e]=store.serializer[o]),store.model[o].actions)){void 0==a&&(a={});for(var n in store.model[o].actions)a.hasOwnProperty(n)||(a[n]=store.model[o].actions[n])}return a&&(store.model[e].actions=a),s&&(store.model[e].idb=s),store.model[e]}},unregisterModel:{enumerable:!1,value:function(e){var r=store.modelFor(e);if(!r)return void Lyte.error("LD02","Model ",e);r.data.length&&store.unloadAll(e);var t=r.extendedBy;if(t&&Object.keys(t).length)for(var o in t)store.unregisterModel(o);var a=r.extend;if(a){var o=store.modelFor(a);delete o.extendedBy[e]}delete store.model[e]}},unregisterAdapter:{enumerable:!1,value:function(e){store.$.unregisterCallback("adapter",e)}},unregisterSerializer:{enumerable:!1,value:function(e){store.$.unregisterCallback("serializer",e)}},addField:{enumerable:!1,value:function(e,r,t,o){var a=store.modelFor(e),s=Lyte.attr(t,o),i=[];store.$.registerField(a,r,s,i)}},modelFor:{enumerable:!1,value:function(e){return store.model[e]}},createRecord:{enumerable:!1,value:function(e,r,t){return this.$.newRecord(e,r,t)}},deleteRecord:{enumerable:!1,value:function(e,r){this.$.removeFromStore(store.modelFor(e),r)}},findAll:{enumerable:!1,value:function(e,r,t,o,a){return store.adapter.$.get("findAll",e,void 0,r,t,a).then(function(){var a=arguments[0][0],s="cache"==arguments[0][1]?!0:!1,i="batch"==arguments[0][1]?arguments[0][2]:void 0,n="idb"==arguments[0][1]?!0:!1;if(o===!1)return t&&Object.keys(r).length>0&&store.$.cacheQuery(e,r,a),a;if(a&&!a.save){if(!s){n||store.$.idbQ2Push(e,a,r,"findAll");var d=store.$.toInsertData(e,a,!0);a[e]=d,a.meta&&d&&(a[e].$?a[e].meta=a.meta:Object.defineProperty(a[e],"$",{enumerable:!1,value:{meta:a.meta}})),t&&Object.keys(r).length>0&&store.$.cacheQuery(e,r,a)}return void 0!=i&&(store.$.batchResponse[i.batch][i.index]=a[e]),a[e]}return arguments},function(e){return Promise.reject(e)})}},findRecord:{enumerable:!1,value:function(e,r,t,o,a,s){return void 0==r?Promise.reject({code:"ERR20",message:Lyte.errorCodes.ERR20}):store.adapter.$.get("findRecord",e,r,t,o,s).then(function(){var s=arguments[0][0],i="cache"==arguments[0][1]?!0:!1,n="batch"==arguments[0][1]?arguments[0][2]:void 0,d="idb"==arguments[0][1]?!0:!1;if(a===!1)return"cache"!=arguments[0][1]&&o&&Object.keys(t).length>0&&store.$.cacheRecordQuery(e,r,t,s),s;if(s){if(!i){if(d||store.$.idbQ2Push(e,s,t,"findRecord",r),!Lyte.isRecord(s)){var l=store.$.toInsertData(e,s,!0);s[e]=l,s.meta&&(l.$.meta=s.meta)}"cache"!=arguments[0][1]&&o&&Object.keys(t).length>0&&store.$.cacheRecordQuery(e,r,t,s)}return void 0!=n&&(store.$.batchResponse[n.batch][n.index]=s[e]),s[e]}return arguments},function(e){return Promise.reject(e)})}},peekRecord:{enumerable:!1,value:function(e,r){var t=this.modelFor(e);if(!t)return void Lyte.error("LD02","Model ",e);var o=t.data,a=this.model[e]._primaryKey,s=o.filter(function(e){return e[a]==r?e:void 0});return s[0]?s[0]:void 0}},peekAll:{enumerable:!1,value:function(e){var r,t=this.modelFor(e);return t?r=t.data:void Lyte.error("LD02","Model ",e)}},deleteMany:{enumerable:!1,value:function(e,r){this.$.removeFromStore(store.modelFor(e),r)}},unloadRecord:{enumerable:!1,value:function(e,r){var t,o=store.peekRecord(e,r),a=store.modelFor(e);if(o){t=o[a._primaryKey],this.$.removeFromStore(a,t,!0);for(var s=0;s<a._deleted.length;s++)if(a._deleted[s].$.get(a._primaryKey)==r){a._deleted.splice(s,1);break}this.model.cachedRecordQueries&&this.model.cachedRecordQueries[e]&&this.model.cachedRecordQueries[e][r]&&(this.model.cachedRecordQueries[e][r]=[])}}},unloadAll:{enumerable:!1,value:function(e){var r=[],t=store.peekAll(e),o=this.modelFor(e);if(t)for(var a=0;a<t.length;a++)r.push(t[a][o._primaryKey]);this.$.removeFromStore(o,r,!0),this.model[e].dirty=[],this.model[e]._deleted=[],this.model.cachedQueries&&this.model.cachedQueries[e]&&(this.model.cachedQueries[e]=[])}},triggerAction:{enumerable:!1,value:function(e,r,t,o){var a=store.modelFor(e),s=a.actions,i=s?a.actions[r]:void 0;return i?store.adapter.$.handleAction(r,a,store.peekAll(e),t,o).then(function(e){return e},function(e){return Promise.reject(e)}):Promise.reject({code:"ERR18",message:Lyte.errorCodes.ERR18})}},rollBack:{enumerable:!1,value:function(e){var r=this.modelFor(e);if(void 0!=r){for(var t=r._primaryKey,o=this;r.dirty.length;){var a=o.peekRecord(e,r.dirty[0]);a&&a.$.isModified?a.$.rollBackAttributes(a.$.getDirtyAttributes()):a&&a.$.isNew&&o.$.rollBackNew(r,a,t)}for(;r._deleted.length>0;)this.$.rollBackDelete(r,0)}}},create:{enumerable:!1,value:function(e,r,t,o){var a=store.modelFor(e);if(void 0==a)return Promise.reject({code:"ERR19",message:Lyte.errorCodes.ERR19,data:e});if(r){var s=this.$.newRecord(e,r);if(s.$.isError)return Promise.reject(s)}for(var i=a.dirty,n=[],d=0;d<i.length;d++){var l=store.peekRecord(e,i[d]);l&&l.$.isNew&&n.push(l)}return n.length?store.adapter.$.create(e,n,!1,t,o):Promise.resolve()}},update:{enumerable:!1,value:function(e,r){var t=this.modelFor(e);if(void 0==t)return Promise.reject({code:"ERR19",message:Lyte.errorCodes.ERR19,data:e});var o=[],a=[],s=t._primaryKey,i=store.peekAll(e);return i.forEach(function(e){var r=e,t=r.$.isDirty();if(r&&r.$.isModified&&!r.$.isNew||t&&t.length){var i=r.$._attributes,n={};for(var d in i)n[d]=r.$.get(d);for(var l=0;l<t.length;l++)n[t[l]]=r[t[l]];n[s]=r.$.get(s),o.push(n),a.push(r)}}),o.length?store.adapter.$.put(e,o,a,!1,r):Promise.resolve()}},"delete":{enumerable:!1,value:function(e,r,t){var o=store.modelFor(e);if(void 0==o)return Promise.reject({code:"ERR19",message:Lyte.errorCodes.ERR19,data:e});r&&this.deleteRecord(e,r);for(var a=[],s=0;s<o._deleted.length;s++)o._deleted[s].$.isNew?store.adapter.$.handleResponse(void 0,o._deleted[s],o._deleted[s],void 0,void 0,o):a.push(o._deleted[s]);if(a.length){var i=(o._primaryKey,store.adapter.$.del(e,a,void 0,"delete",t));return i.then(function(e){return e},function(e){return Promise.reject(e)}),i}return Promise.resolve()}},registerAdapter:{enumerable:!1,value:store.adapter.extends},registerSerializer:{enumerable:!1,value:store.serializer.extends},clearCachedQuery:{enumerable:!1,value:function(e,r,t){var o=[];r&&"object"==typeof r?(t=r,this.model.cachedQueries&&this.model.cachedQueries[e]&&(o=this.model.cachedQueries[e])):this.model.cachedRecordQueries&&this.model.cachedRecordQueries[e]&&this.model.cachedRecordQueries[e][r]&&(o=this.model.cachedRecordQueries[e][r]);for(var a=0;a<o.length;a++)if(this.adapter.$.compareObjects(o[a].queryParams,t,!0)){o.splice(a,1);break}}},setErrorMessages:{enumerable:!1,value:function(e){Object.assign(Lyte.errorCodes,e)}},addEventListener:{enumerable:!1,value:function(e,r){return store.$.eventListeners.add(store,e,r)}},removeEventListener:{enumerable:!1,value:function(e){store.$.eventListeners.remove(store,e)}},emit:{enumerable:!1,value:function(e,r){store.$.eventListeners.emit(store,e,r)}}});var error1=function(e,r){Object.defineProperties(this,{$:{enumerable:!1,value:{isError:!0,error:{}}}}),e&&store.$.setError(this,e,r)};