function ReplaceWith(e){var t=this.parentNode,r=arguments.length,o=+(t&&"object"==typeof e);if(t){for(;r-- >o;)t&&"object"!=typeof arguments[r]&&(arguments[r]=document.createTextNode(arguments[r])),t||!arguments[r].parentNode?t.insertBefore(this.previousSibling,arguments[r]):arguments[r].parentNode.removeChild(arguments[r]);o&&t.replaceChild(this,e)}}[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(e){e.hasOwnProperty("after")||Object.defineProperty(e,"after",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),t=document.createDocumentFragment();e.forEach(function(e){var r=e instanceof Node;t.appendChild(r?e:document.createTextNode(String(e)))}),this.parentNode.insertBefore(t,this.nextSibling)}})}),Element.prototype.replaceWith||(Element.prototype.replaceWith=ReplaceWith),CharacterData.prototype.replaceWith||(CharacterData.prototype.replaceWith=ReplaceWith),DocumentType.prototype.replaceWith||(DocumentType.prototype.replaceWith=ReplaceWith),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-e.length,t)===e}),Lyte={version:"2.0.0",$:{},registeredMixins:{},Mixin:{},debug:!1,performance:!1,toBeRegistered:[]};var consoleTime=[];Lyte.$.assetsDiv=document.createElement("div"),Lyte.$.assetsDiv.setAttribute("id","lyteAssetsDiv"),document.head.appendChild(Lyte.$.assetsDiv),Lyte.registerErrorCodes=function(e){Object.assign(Lyte.errorCodes,e)},Lyte.getErrorMessage=function(e){var t=Array.from(arguments).slice(1);return Lyte.errorCodes[e]?Lyte.errorCodes[e].replace(/{(\d+)}/g,function(e,r){return t[r]}):e},Lyte.error=function(){var e=arguments[0].stack||Error(Lyte.getErrorMessage.apply(Lyte,arguments));Lyte.onerror&&Lyte.onerror.call(this,e),Lyte.triggerEvent("error",e),console.error.call(console,e)},Lyte.warn=function(){var e=arguments[0].stack||Error(Lyte.getErrorMessage.apply(Lyte,arguments));console.warn.call(console,e)},Lyte.Mixin.register=function(e,t){Lyte.registeredMixins[e]=t},Lyte.Mixin.exists=function(e){return!!Lyte.registeredMixins[e]||(Lyte.error("Mixin used before being registered."),!1)},Lyte.log=function(e,t){Lyte.debug&&console.log((t?"%c":"")+e,"color:"+t)},Lyte.time=function(e){var t;Lyte.performance&&(-1!=(t=consoleTime.indexOf(e))?(consoleTime.splice(t,1),console.timeEnd(e)):(consoleTime.push(e),console.time(e)))},Lyte.isRecord=function(e){return!!(e&&e.$&&e.$.hasOwnProperty("isModified"))},Lyte.isComponent=function(e){return!!(e&&e.$node&&e.__data)};var reqFiles={};function domContentLoaded1(){let e=Lyte.toBeRegistered;if(e.length){for(let t=0;t<e.length;t++)customElements.define(e[t].name,e[t].def);Lyte.toBeRegistered=[]}}Lyte.injectResources=function(e,t,r){var o=[],n=[];return t=t||function(){},r=r||function(){},new Promise(function(r){!function e(r,i){if(r){Array.isArray(r)||(r=[r]),r.length||i();var a=-r.length;r.forEach(function(r){"string"==typeof r?function(e,r,i){reqFiles[e]?reqFiles[e].push(i):(reqFiles[e]=[i],r&&"error"!=r.event.type?(-1!=Lyte.removeFromCache.arr.indexOf(e)&&Lyte.removeFromCache.arr.splice(Lyte.removeFromCache.arr.indexOf(e),1),c.call(r.tag,r.event,!0),i()):function(e,t){var r,i=e.split("."),a=i[i.length-1];if(r=document.createElement({js:"script",css:"link"}[a]),1==i.length)return void Lyte.error("Type of file is not specified in injectResources.");"css"==a?(r.setAttribute("href",e),r.setAttribute("type","text/css"),r.setAttribute("rel","stylesheet")):r.setAttribute("src",e);r.onerror=r.onload=function(e){"error"==e.type?n.push(e):o.push(e),t&&t.call(this,e)},document.getElementById("lyteAssetsDiv").appendChild(r)}(e,function(r){reqFiles[e].forEach(function(e){e()}),c.call(this,r),t.call(this,r)}))}(r,Lyte.injectResources.availableTags[r],function(){s()}):Array.isArray(r)?new Promise(function(t){e(r,t)}).then(function(){s()}):new Promise(function(t){e(r.parent,t)}).then(function(){new Promise(function(t){e(r.child,t)}).then(function(){s()})})})}else i();function s(){0==++a&&i()}function c(e,t){var r=this.getAttribute("src")||this.getAttribute("href");delete reqFiles[r],t||(Lyte.injectResources.availableTags[r]&&Lyte.injectResources.availableTags[r].tag.remove(),this.onerror=this.onload=void 0,Lyte.injectResources.availableTags[r]={tag:this,event:{type:e.type}})}}(e,r)}).then(function(){r(o,n)})},Lyte.injectResources.availableTags=[],Lyte.removeFromCache=function(e){Lyte.removeFromCache.assign(e),Lyte.removeFromCache.arr.length&&(Lyte.removeFromCache.arr.forEach(function(e){Lyte.injectResources.availableTags[e]&&(Lyte.injectResources.availableTags[e].tag.remove(),delete Lyte.injectResources.availableTags[e])}),Lyte.removeFromCache.arr=[])},Lyte.removeFromCache.arr=[],Lyte.removeFromCache.assign=function(e){e="*"==e?Object.keys(Lyte.injectResources.availableTags):Array.isArray(e)?e:[e],Lyte.removeFromCache.arr=Lyte.removeFromCache.arr.concat(e)},Lyte.checkProperty=function(e,t,r,o,n,i){switch(e){case"type":if(Lyte.Transform.hasOwnProperty(o)){if(Array.isArray(t)){if("array"!=Lyte.Transform[o].extends)return{code:"ERR03",message:Lyte.errorCodes.ERR03,expected:o}}else if(Lyte.Transform[o].extends!=typeof t)return{code:"ERR03",message:Lyte.errorCodes.ERR03,expected:o}}else if(void 0!==t)if(Array.isArray(t)){if("array"!=o)return{code:"ERR03",message:Lyte.errorCodes.ERR03,expected:o}}else if(o!=typeof t)return{code:"ERR03",message:Lyte.errorCodes.ERR03,expected:o};break;case"mandatory":if(void 0==t||null==t||""==t)return{code:"ERR02",message:Lyte.errorCodes.ERR02};break;case"maximum":if("number"==typeof t&&t>o)return{code:"ERR04",message:Lyte.errorCodes.ERR04,expected:o};break;case"minimum":if("number"==typeof t&&t<o)return{code:"ERR05",message:Lyte.errorCodes.ERR05,expected:o};break;case"maxLength":case"maxItems":if(t&&t.length>o)return{code:"ERR06",message:Lyte.errorCodes.ERR06,expected:o};break;case"minLength":case"minItems":if(t&&t.length<o)return{code:"ERR07",message:Lyte.errorCodes.ERR07,expected:o};break;case"pattern":if(t&&"string"==typeof t&&!new RegExp(o).test(t))return{code:"ERR08",message:Lyte.errorCodes.ERR08,expected:o};break;case"uniqueItems":if(Array.isArray(t)&&o)for(var a=[],s=0;s<t.length;s++){var c=t[s];if(-1!=a.indexOf(c))return{code:"ERR09",message:Lyte.errorCodes.ERR09};a.push(c)}break;case"constant":if(Array.isArray(t)){if(!(l=t.length==o.length&&t.every(function(e,t){return e===o[t]})))return{code:"ERR10",message:Lyte.errorCodes.ERR10,expected:o}}else if("object"==typeof t){if(!(l=store.adapter.$.compareObjects(t,o)))return{code:"ERR10",message:Lyte.errorCodes.ERR10,expected:o}}else if(t&&t!=o)return{code:"ERR10",message:Lyte.errorCodes.ERR10,expected:o};break;case"items":if(Array.isArray(t))for(s=0;s<t.length;s++)for(var e in o){if(1!=(l=Lyte.checkProperty(e,t[s],s,o[e])))return l}break;case"properties":if("object"==typeof t&&!Array.isArray(t))for(var r in t)for(var e in o){if(1!=(l=Lyte.checkProperty(e,t[r],r,o[e])))return l}break;case"validation":var l;if(1!=(l=Lyte.customValidator[o].apply(n,[r,t])))return l}return!0},Lyte.types=["string","object","number","boolean","array"],Lyte.attr=function(e,t){var r={};if(r.type=e,void 0==t&&(t={}),-1==this.types.indexOf(e)&&!Lyte.Transform.hasOwnProperty(e))throw new Error("Not a valid field type - "+e);return Object.assign(r,t),r},Lyte.defineRelation=function(e,t,r){var o={type:"relation",relType:t,relatedTo:e};return r&&(o.opts=r),o},Lyte.belongsTo=function(e,t){return this.defineRelation(e,"belongsTo",t)},Lyte.hasMany=function(e,t){return this.defineRelation(e,"hasMany",t)},Lyte.Transform={},Lyte.customValidator={},Lyte.registerDataType=function(e,t){if(this.Transform.hasOwnProperty(e))throw new Error("Custom Field Type - "+e+" -  already exists.");if(void 0==t.extends||-1==Lyte.types.indexOf(t.extends))throw new Error("Not a valid field type - "+t.extends);this.Transform[e]=t},Lyte.registerValidator=function(e,t){if(this.customValidator.hasOwnProperty(e))throw new Error("Custom Validator with name - "+e+" - already exists");this.customValidator[e]=t},Lyte.patterns={email:/^([A-Za-z0-9._%\-'+/]+@[A-Za-z0-9.-]+\.[a-zA-Z]{2,22})$/,url:/(^(ht|f)tp(s?):\/\/[0-9a-zA-Z][-.\w]*(:[0-9])*(\/?)([a-zA-Z0-9\-.?,:'/\\+=&amp;%$#_[\]@!()*;~]*)?$)/,ampm:/^(AM|PM|am|pm)$/,hour:/^(0?[0-9]|1[0-9]|2[0-4])$/,minute:/^(0?[0-9]|[1-5][0-9]|60)$/,boolean:/^(true|false|TRUE|FALSE)$/,alphaNumeric:/([a-zA-Z0-9])+/,alphabetsOnly:/([a-zA-Z])+/,numeric:/([0-9])+/,phoneNo:/^[0-9a-zA-Z+.()\-;\s]+$/},Lyte.validate=function(e,t,r,o){var n=o.__data[t],i=!1,a=n?n.type:void 0;for(var s in n)if(!0!==(i=Lyte.checkProperty(s,r,t,n[s],e,a)))return i;return!1},Lyte.registerPattern=function(e,t){this.patterns[e]=t},Lyte.errorCodes={ERR01:"Primary key cannot be modified",ERR02:"Mandatory field cannot be empty",ERR03:"Type of value does not match the specified data type",ERR04:"Value is greater than the maximum value allowed",ERR05:"Value is less than the minimum value allowed",ERR06:"Length of string/array is greater than the maximum limit allowed",ERR07:"Length of string/array is less than the minimum limit allowed",ERR08:"String does not match the specified pattern",ERR09:"Values in array are not unique",ERR10:"Value is not equal to the specified constant",ERR11:"Model of related field is not defined",ERR12:"Model of backward relation is not defined",ERR13:"Record not found",ERR14:"Model does not match the related field model",ERR15:"Error in creating a record as a relation",ERR16:"Record with primary key already exists",ERR17:"Value cannot be changed because record has been deleted",ERR18:"Action not defined",ERR19:"Model not defined",ERR20:"Key not specified",ERR21:"'belongsTo' relationship expects a single object/id",ERR22:"Type not specified for polymorphic relation",ERR23:"Primary Key value not present",ERR24:"Error while relating record",ERR25:"Backward relation not present"},Lyte.registeredGlobalEvents={},Lyte.triggerEvent=function(){var e=Array.prototype.slice.call(arguments,1),t=arguments[0],r=!1,o=this.registeredGlobalEvents[t];if(o)for(var n=0;n<o.listeners.length;n++){var i=o.listeners[n];if(i)if(!1===i.apply(this,e)){r=!0;break}}else o=this.registeredGlobalEvents[t]={listeners:[]};var a=new CustomEvent(t,{detail:e});r||document.dispatchEvent(a)},Lyte.addEventListener=function(e,t){if("function"==typeof t){var r=this.registeredGlobalEvents[e];return r||(r=this.registeredGlobalEvents[e]={listeners:[]}),e+"-"+(r.listeners.push(t)-1)}Lyte.error("Second parameter to LyteComponent.addGlobalEventListener() must be a function")},Lyte.removeEventListener=function(e){if(e){var t=e.split("-"),r=this.registeredGlobalEvents[t[0]];r&&r.listeners[t[1]]?r.listeners[t[1]]=null:Lyte.error("No such listener registered")}else Lyte.error("listener unique id not specified")},Lyte.deepCopyObject=function(e){for(var t,r,o,n,i,a,s=[{source:e,target:Array.isArray(e)?[]:Object.create(Object.getPrototypeOf(e))}],c=[e],l=s[0].target,y=[l];t=s.shift();)for(r=Object.getOwnPropertyNames(t.source),o=0;o<r.length;o++)(n=Object.getOwnPropertyDescriptor(t.source,r[o])).value&&"object"==typeof n.value?(i=n.value,n.value=Array.isArray(i)?[]:i instanceof Set?new Set:Object.create(Object.getPrototypeOf(i)),-1==(a=c.indexOf(i))?(c.push(i),y.push(n.value),Object.defineProperty(t.target,r[o],n),s.push({source:i,target:n.value})):(n.value=y[a],Object.defineProperty(t.target,r[o],n))):Object.defineProperty(t.target,r[o],n);return l},Lyte.resolvePromises=function(e){if("string"==typeof e)return e;if(Array.isArray(e))return function(e){var t=[],r=!1;if(e.every(function(e,t){return!(e instanceof Promise&&(r=!0,1))}),!r)return e;return new Promise(function(r,o){Promise.all(e).then(function(o){e.forEach(function(e,r){t[r]=o[r]}),r(t)},function(e){o(e),Lyte.error(e)})})}(e);if("object"==typeof e)return function(e){var t=[],r=[],o=Object.keys(e);if(o.forEach(function(o){var n=e[o];n instanceof Promise&&(t.push(o),r.push(n))}),r.length){var n={},i=new Promise(function(i,a){Promise.all(r).then(function(r){o.forEach(function(o){-1!=t.indexOf(o)?n[o]=r[t.indexOf(o)]:n[o]=e[o]}),i(n)},function(e){a(e),Lyte.error(e)})});return i}return e}(e)},Lyte.createCustomElement=function(e,t){var r=t.constructor;delete t.constructor,this.defProperty=function(e,t,r){var o={};r.get&&(o.get=r.get),r.set&&(o.set=r.set),Object.defineProperty(e,t,o)};class o extends HTMLElement{constructor(){super(),r&&r.apply(this,Array.from(arguments))}}var n=t.static;if(n){for(var i in n)"object"==typeof n[i]?this.defProperty(o,i,n[i]):Object.defineProperty(o,i,{value:n[i]});delete t.static}for(var i in t)"object"==typeof t[i]?this.defProperty(o.prototype,i,t[i]):Object.defineProperty(o.prototype,i,{value:t[i]});t.static=n[i],t.constructor=r,"complete"===document.readyState||"interactive"===document.readyState?customElements.define(e,o):Lyte.toBeRegistered.push({name:e,def:o})},"complete"===document.readyState||"interactive"===document.readyState?domContentLoaded1():document.addEventListener("DOMContentLoaded",function(e){domContentLoaded1()},!0);!function e(t){t.lyteRouter=function r(n){function o(e,t){return t=t||Z,{queryParams:t.routeInstances[e].__lp.queryParams,dynamicParam:t.routeInstances[e].__lp.dynamicParam}}function i(e){var r=e.replace?"replaceState":"pushState",n=e.url?le.history?N(g(e.url,!0)):"#"+N(e.url):void 0;return e.title=e.title||document.title,n?t.history[r](e.state,e.title,n):t.history[r](e.state,e.title),e}function a(e){return{meta:{matched:e.matched,index:e.replace&&history.state&&history.state.meta?history.state.meta.index:fe?history.length-1:history.length},data:e.data}}function s(e){return se.history||_(),se.history.fromHistory=!!e.fromHistory&&((se.history.index=e.state.meta.index)<history.length-1?"back":"forward"),me=!0,se.history.state=history.state?history.state.data:{},se.history.initial=fe,se.history}function u(e,t){var r=ue,n=e.length-1;e.forEach(function(e,o){n===o?r[e]?r[e].__lp=t:r[e]={__lp:t}:r[e]||(r[e]={}),r=r[e]})}function c(){class e extends HTMLElement{static get observedAttributes(){return["lt-prop-route","lt-prop-dp","lt-prop-fragment","lt-prop-qp","lt-prop","lt-prop-class","lt-prop-id","lt-prop-rel","lt-prop-title","lt-prop-style","lt-prop-target"]}attributeChangedCallback(e,t,r){if(this.hasAttribute("lyte-rendered")&&this._linkCreated){let n=this.children[0];"lt-prop"===e?(this.handleLtProp(),this.hasAttribute("lt-prop-custom")||this.setCustomAttributes(n,!0),this.pendingCallback||(this.pendingCallback=!0,setTimeout(function(){this.pendingCallback=!1,this.getMatchedObject()}.bind(this),0)),"A"===n.tagName&&this.constructHref(n)):/^(lt-prop-route|lt-prop-fragment|lt-prop-dp|lt-prop-qp)$/.test(e)?(this.getMatchedObject(),"A"===n.tagName&&this.constructHref(n,e,t,r)):this.hasAttribute("lt-prop-custom")||n.setAttribute(e.substring(8),r)}}connectedCallback(){if(this.ltProp=this.ltProp||{},this.hasAttribute("lyte-rendered"))return this._linkCreated=!0,void this.getMatchedObject();this.handleLtProp();let e;if(this.hasAttribute("lt-prop-custom")||this.ltProp.custom)this.getMatchedObject(),"A"===this.children[0].tagName&&this.constructHref(this.children[0]);else{e=document.createElement("a");let t=this.childNodes.length;for(let r=0;r<t;r++)e.appendChild(this.childNodes[0]);this.setCustomAttributes(e),this.getMatchedObject(),this.constructHref(e),this.appendChild(e)}this.setAttribute("lyte-rendered",""),LyteComponent?this._linkToEventId=LyteComponent.addLyteEventListener(this,"click",function(e){l(e,this)},this):this.addEventListener("click",l),this._linkCreated=!0}modifyLinkToTagsInRoute(e){let t=ue,r=e&&1!=e?e:this.matched.route;r?(r=h(r)).forEach(function(r){if(!(t=k(r,t))||!t.__lp)return Error(H(422,this.matched.target)),!1;var n=t.__lp.__lp;e?n.linkTags.splice(n.linkTags.indexOf(this),1):n.linkTags.push(this)}.bind(this)):U(498,"route","link-to")}disconnectedCallback(){this._linkToEventId&&!LyteComponent.ignoreDisconnect&&(this.modifyLinkToTagsInRoute(!0),LyteComponent.removeLyteEventListener(this,this._linkToEventId))}handleLtProp(){var e=this.getAttribute("lt-prop");if(e)try{var t=JSON.parse(e);this.ltProp=t}catch(e){console.warn("Error while parsing ltProp in link-to")}}setCustomAttributes(e,t){for(let t in this.ltProp)/^(id|class|style|target)$/.test(t)&&e.setAttribute(t,this.ltProp[t]);if(!t){var r=this.attributes;for(let t=0;t<r.length;t++){let n=r[t].nodeName;"lt-prop"!==n&&/^(lt-prop-id|lt-prop-class|lt-prop-style|lt-prop-target)$/.test(n)&&e.setAttribute(n.substring(8),r[t].nodeValue)}}}constructHref(e,t,r,n){let o;(o=se.getURL(this.matched))&&(e.setAttribute("href",o),t?"lt-prop-route"==t?(this.modifyLinkToTagsInRoute(r),this.modifyLinkToTagsInRoute()):(this.modifyLinkToTagsInRoute(this.matched.route),this.modifyLinkToTagsInRoute()):this.modifyLinkToTagsInRoute())}}e.prototype.getMatchedObject=function(e){let t=e?{}:this.matched?this.matched:{};t.route=this.getAttribute("lt-prop-route")||this.ltProp.route,t.fragment=this.getAttribute("lt-prop-fragment");let r=this.getAttribute("lt-prop-dp")||this.ltProp.dp||[],n=this.getAttribute("lt-prop-qp")||this.ltProp.qp||{};if(r instanceof Array)t.dynamicParams=[];else try{t.dynamicParams=JSON.parse(r)||[]}catch(e){return U(498,"dynamicParams","link-to"),void(t.dynamicParams=[])}if(n instanceof Object)t.queryParams={};else try{t.queryParams=JSON.parse(n)}catch(e){U(498,"queryParams","link-to"),t.queryParams={}}return this.matched=t},customElements.define("link-to",e)}function l(e,t){if(2==e.button||e.defaultPrevented)return;var r=t||e.currentTarget;if("A"===r.children[0].tagName&&(1==e.ctrlKey||1==e.metaKey||2==e.which||r.children[0].hasAttribute("target")&&"_self"!==r.children[0].getAttribute("target")))return;e.preventDefault();var n,o=se.getRouteInstance().transition;n=o&&se.checkIfSameRoute(r.matched,o.info)&&r.hasAttribute("lt-prop-refresh-route")?se.getRouteInstance(r.getAttribute("lt-prop-refresh-route")).refresh():se.transitionTo(r.matched);var i={};if(r.getAttribute("lt-prop-trans"))try{i=JSON.parse(r.getAttribute("lt-prop-trans"))}catch(e){U(498,"lt-prop-trans","link-to")}let a=r.getAttribute("lt-prop-td");if(a=a||i.data){if("string"==typeof a)try{a=JSON.parse(a)}catch(e){U(498,"lt-prop-td","link-to")}i.data=a}for(var s in i)n[s]=i[s]}function h(e){return e.split(".").filter(function(e){return""!=e})}function d(e){return void 0!=e}function f(e){Lyte.time("parseRouteMapping");var t={},n={},o=[],i=[];return oe={route:function(e,a,s){if("object"==typeof a)if(a.path||(a.path=N(e)),j(a.path,"?")){var u=a.path.split("?");a.defQP=r.frameQueryParams(u[1]),a.path=u[0]}else a.queryParams&&(a.defQP=a.queryParams,delete a.queryParams);else"function"==typeof a&&(s=a),a={path:N(e)};if("/"==a.path)n=k(o,he)[a.path]={__lp:{}},o.push("/");else{var c=a.path;n=k(o,he)[a.path]={__lp:{}},B(c)||$(c)?F(c).every(function(e,t,r){if(B(e))return a.dynamicKey=n.__lp.dynamicKey=e.replace(":",""),a.dynamicIndex=n.__lp.dynamicIndex=t,!1;if($(e)){a.dynamicKey=n.__lp.dynamicKey=e.replace("*",""),a.dynamicIndex=n.__lp.dynamicIndex=t,a.wildcard=n.__lp.wildcard=!0,a.sufix=n.__lp.sufix=[];for(var o=t+1;o<r.length;o++)n.__lp.sufix.push(r[o]);return!1}return!0}):a.dynamicKey=n.__lp.dynamicKey=void 0,o.push(c)}i.push(e),n.__lp.route=Array.from(i);var l=t;i.forEach(function(e,t){t+1!=i.length&&(l=l[e])}),l[e]={__lp:a},s&&s.call(this,{}),i.pop(),o.pop()}},e.call(oe,{}),Lyte.time("parseRouteMapping"),t}function p(e){if(e){if("object"==typeof e){var t;Y={replace:e.replace,title:Z?Z.title:document.title,fromHistory:!1},t=G(e),Lyte.log("Transitioning to "+e.route.join(".")+" "+t,de)}else U(498,JSON.stringify(e));return Z.routeTrans}U(499)}function m(){if(le.history){var e=y(ce.pathname+ce.search+(ce.hash||""));return e=g(e),N(e)}return N(y(ce.hash.replace(/^(#\/|#|\/)/,"")))}function y(e){return e||i({replace:!0,state:a({replace:!0,data:history.state&&history.state.data||void 0}),url:e="/"}),e}function g(e,t){var r=le.baseURL;if(r&&e){if(r=N(le.baseURL),0==e.indexOf(r)&&!t)return e.replace(r,"");if(t&&-1==e.indexOf(r))return r+e}return e}function v(e){if(e){e.route&&!Array.isArray(e.route)&&(e.route=h(e.route));var t,r=!!Z,n=ue,o=le.routes,i="";return e.route.forEach(function(t,a){r&&Z&&Z.matched.route[a]!=t&&(r=!1);var s=e.route.slice(0,a+1);if(o=k(t,o),n=k(t,n),!o&&!o.__lp)return U(422,s.join(".")),!1;var u=o.__lp.path;if(n&&n.__lp){if(n.__lp.queryParams){var c=o.__lp.defQP,l=n.__lp.__lp.queryParamsDef;for(var h in l)e.queryParams.hasOwnProperty(h)||(r&&l[h].sticky?e.queryParams[h]=n.__lp.__lp.queryParams[h]:c&&c.hasOwnProperty(h)&&(e.queryParams[h]=c[h])),l[h].refreshModel&&(e.refreshModel=!0)}}else if(c=o.__lp.defQP)for(var h in c)e.queryParams&&!e.queryParams.hasOwnProperty(h)&&(e.queryParams[h]=c[h]);if(o.__lp.dynamicKey){var d=F(u);if(!e.dynamicParams||void 0==e.dynamicParams[a])return U(499,t),!1;d[o.__lp.dynamicIndex]=encodeURI(e.dynamicParams[a]),i+=N(d.join("/"))}else i+=N(u)}.bind(this)),i="/"==i[i.length-1]&&1!=i.length?i.slice(0,-1):i,t=Object.keys(e.queryParams).filter(function(t){return void 0!=e.queryParams[t]&&t}),e.queryParams&&t.length&&(i+="?",t.forEach(function(r,n){i+=r+"="+encodeURIComponent(e.queryParams[r])+(n<t.length-1?"&":"")})),le.history&&e.fragment&&(i=i+"#"+e.fragment),S(i)}}function _(){function e(){return this}function t(e,t,r,n){i({state:{meta:n?history.state.meta:history.state.meta+1,data:e},title:t,url:r})}se.history=new e,Object.defineProperty(e.prototype,"state",{get:function(){return history.state.data},set:function(e){return me?me=!1:console.warn("setting on data will not be pushed to history. If needed, use `Lyte.Router.history.replaceState`."),e}}),e.prototype.replaceState=function(){t.apply(Array.from(arguments).push(!0))},e.prototype.pushState=function(){t.apply(Array.from(arguments))}}function P(e,t){Lyte.time("RouteTransition"),Z&&(Z.routeTrans.state&&102==Z.routeTrans.state||ee&&Z!=ee)&&(clearTimeout(ie),Z.abort({state:409,internalAbort:!0})),(t=t||(!fe&&history.state&&history.state.meta&&history.state.meta.matched?Q(history.state.meta.matched):K(e)))&&t.matched.route.length&&(t.prevTrans=t.prevTrans||ee,R(e,t),ie=setTimeout(function(){Lyte.time("constructRunLoop"),t.previous=!0,Z.runLoop=T(ae=t),Y&&Z.routeTrans.data&&(Y.data=Z.routeTrans.data),Z.running=!0,Z.run(),Lyte.time("constructRunLoop")},0))}function b(e,t,r){function n(e){var r=!0;return!i.queryParams&&!i.__lp.dynamicParam||(!i.__lp.dynamicParam||h.dynamicParams[e]==t.dynamicParams[e])&&(i.queryParams&&i.queryParams.every(function(e){return!r||!i.__lp.queryParamsDef[e].refreshModel||!t.queryParams&&!h.queryParams||t.queryParams[e]==h.queryParams[e]||(r=!1)}),r)}var o,i,a=!0,s=!0,u=[],c=[],l=[];if(e){var h=e.matched;if(t.route.forEach(function(t,d){s&&t==h.route[d]?(i=r?r[d]:se.__lp.getDefinition(t.slice(0,d)),a&&n(d)?(e.routeInstances[d].__lp.rendered?u.push(t):(a=!1,l.push(t)),c.push(t)):(a=!1,l.push(t))):(s=!1,void 0==o&&e.routeInstances[d]&&e.routeInstances[d].__lp.rendered&&(o=d),l.push(t))}),h.route.length>t.route.length){var d=t.route.length;void 0==o&&e.routeInstances[d].__lp.rendered&&(o=d)}}else l=l.concat(t.route);return{rendered:u,unRendered:l,common:c,templateToRemove:o}}function T(e){var t=e.transComparison||b(ee,e.matched,e.currentRoutes),r=[],n={beforeModel:[],model:[],afterModel:[]},i=[],a=[],s=[],u=[];if(e.previous){var c=[{hook:"beforeRouteTransition"}];if(ee){for(var l=ee.matched.route.length-1;l>=0;l--)ee.matched.route[l]&&ee.matched.route[l]!=Z.matched.route[l]&&a.push({hook:"beforeExit",index:l}),s.push({hook:"willTransition",index:l});return{previous:s.concat(a.concat(c)),current:[],forceFetch:[]}}return{previous:c,current:[],forceFetch:[]}}return t.rendered&&t.rendered.length&&t.rendered.forEach(function(e,t){Z.routeInstances[t].__lp.rendered=!0,r.push({hook:"redirect",index:t}),u.push({hook:"didTransition",index:Z.matched.route.length-t-1})}),t.unRendered&&t.unRendered.length&&t.unRendered.forEach(function(a,s){s=t.rendered.length+s,t.executed&&t.executed.index==s?"getResources"==t.executed.hook&&i.push({hook:"getDependencies",index:s}):(i.push({hook:"getResources",index:s}),i.push({hook:"getDependencies",index:s}));var c=Z.routeInstances[s];if("function"==typeof c.forceFetch?E.call(this,c.forceFetch,c,"forceFetch",o(s)):c.forceFetch)["beforeModel","model","afterModel"].forEach(function(e){n[e].push({hook:e,index:s})}),e.currentRoutes[s]._fetchStatus="pending",["redirect","renderTemplate","afterRender"].forEach(function(e){r.push({hook:e,index:s})});else{var l=!1;ge.forEach(function(e){t.executed&&t.executed.index==s?(t.executed.hook==e||l)&&("redirect"==e&&r.push({hook:e,index:s}),l?r.push({hook:e,index:s}):l=!0):r.push({hook:e,index:s})})}u.push({hook:"didTransition",index:Z.matched.route.length-s-1})}),r={previous:[],current:i.concat(r).concat(u),forceFetch:n},r.templateToRemove=ee&&ee.runLoop.templateToRemove?ee.runLoop.templateToRemove:[],void 0!=t.templateToRemove&&r.templateToRemove.push({index:t.templateToRemove,routeInstances:ee.routeInstances}),r}function R(e,t){se.__lp.trans=Z=new x(t),Z.url=e,Z.runLoop={previous:[],current:[],forceFetch:[]},Z.routeTrans=J(Z),Z.routeInstances=r.initRoute(t),ne?(Y=ne,Z.routeTrans.data=history.state?history.state.data:{},ne.replace=!0,ne=void 0):Z.routeTrans.data&&se.history.replaceState(Z.routeTrans.data)}function k(e,t){if(t)return e?(Array.isArray(e)||"string"!=typeof e||(e=h(e)),e.every(function(e){return t&&t[e]?(t=t[e],!0):t=!1}),t):t;U(H(498))}function L(e){e.runningPromise&&e.runningPromise.reject("aborted"),e.forcedRunningPromise&&e.forcedRunningPromise.reject("aborted")}function x(e){this.matched=e.matched,this.target=e.matched.target,this.timeouteFns=[],this.info={route:e.matched.target,queryParams:e.matched.queryParams,dynamicParams:e.matched.dynamicParams.filter(d)},e.matched.fragment&&(this.info.fragment=e.matched.fragment),this.currentRoutes=e.currentRoutes,this.aborted=this.paused=!1,this.abort=function(e){this.aborted||(L(this),this.timeouteFns.forEach(function(e){clearTimeout(e)}),this.aborted=!0,e||(e={state:308}),Lyte.log("Transition aborted.",de),e.internalAbort||(delete this.runLoop.templateToRemove,ee.url!=m()&&201==this.routeTrans.state&&(pe=!0,history.state&&history.state.meta&&void 0!=history.state.meta.index&&history.state.meta.index<history.length?history.go(1):history.go(-1))),D(e))}.bind(this),this.pause=function(){if(!this.paused)return Lyte.log("Transition paused.",de),L(this),this.routeTrans.state=307,this.paused=Z.currentPromise||!0,this.resume=this.routeTrans.resume=function(e){if(e=e||this,delete e.routeTrans.resume,delete e.resume,Lyte.log("Transition resumed.",de),e.paused){if(1!=e.paused){var t=e.paused.state;e.runLoop[t][0]&&e.runLoop[t][0].hook==e.paused.hook&&e.runLoop[t][0].index==e.paused.index&&C(e.runLoop[t],e.paused.hook,e.paused.index)}e.paused=!1,e.routeTrans.state=102,e.run()}}.bind(this),this.routeTrans}.bind(this)}function q(e){var t=e.reqType,r=e.currentRoute,n=e.index,o=Z.currentPromise.hook,i="dependencies"==t?"errorDependencies":"errorResources",a=this;Lyte.injectResources(r.__lp[t],function(){},function(e,s){r.__lp[t+"Loaded"]=!0,s.length?a.aborted||(a.paused||a.pause(),ye.onError.call(a,n,{state:424,error:r.__lp[i]=s,hook:o})):Z.pending&&void 0!=Z.pending[t]&&Z.pending[t]==n&&Z.run()})}function I(e){e.forEach(function(e){for(var t,r=e.routeInstances.length-1;r>=e.index;r--)delete(t=e.routeInstances[r]).__lp.rendered,t.outlet&&(t.component&&(t.component._route=void 0),Lyte.triggerEvent("beforeTemplateDestroy",t.outletName,t),t.outlet.innerHTML="")})}function A(e){return j(_e,e)}function M(e,t){if(e){var r,n=arguments,o=Z.currentPromise.hook,i=A(o),a=this;return Promise.resolve(new Promise(function(s,u){try{var c=e.apply(t,Array.from(n).slice(2));i&&c&&(c=Lyte.resolvePromises(c)),r=Promise.resolve(c)}catch(e){return void w.call(a,i,e,t)}r.then(function(e){s(e)},function(e){U(e),"model"==o&&(t.currentModel=e),w.call(a,i,e,t)})}))}return Promise.resolve()}function E(e,t,r){if(e){var n=A(r);try{return e.apply(t,Array.from(arguments).slice(3))}catch(e){return void w.call(this,n,e,t)}}}function O(e,t,r){var n;if(this.routeInstances[t].actions&&(n=this.routeInstances[t].actions[e]))try{if(0==n.apply(this.routeInstances[t],r))return!1}catch(e){return U(e),!1}}function w(e,t,r){if(Z.currentPromise){var n=Z.currentPromise.hook,o=Z.currentPromise.index;Z.pause(),U(t),e?ye.onError.call(this,o,{state:420,error:t,hook:n}):(U(420,n,r.routeName),j(["willTransition","didTransition","beforeExit"],n)?Z.resume():Z.abort({state:4,internalAbort:!0}))}}function C(e,t,r){for(var n=0;n<e.length;n++){var o=e[n];if(o.hook==t)if(void 0!=r){if(r==o.index){e.splice(n,1);break}}else e.splice(n,1),n--}}function j(e,t){return-1!=e.indexOf(t)}function D(e){if(Z.running){if(Z.running=!1,Z.routeTrans.state&&201!=Z.routeTrans.state&&(se.afterRouteTransition(Z.routeTrans),Z.routeTrans.state=e.state),fe||200==Z.routeTrans.state){if(se.__lp.prevTrans=ee=Z,Lyte.time("RouteTransition"),Lyte.log("Transition completed.",de),le.history&&Z.info.fragment){var t;(t=document.getElementById(Z.routeTrans.info.fragment))&&t.scrollIntoView&&t.scrollIntoView()}}else e.internalAbort||re==Z?se.__lp.prevTrans=ee=Z:se.__lp.trans=Z=ee;fe&&(fe=!1)}}function N(e){return"/"==e[0]?e:"/"+e}function F(e){return e.match(/[^/?]+/g)||[]}function S(e){return e=e.replace(/\/\//g,"/"),e=e.replace(/\/\?/g,"?")}function H(e,t){return"LRE "+e+": "+{400:"url '"+(t=Array.isArray(t)?t:Array.from(arguments).slice(1))[0]+"' is not defined in router.",422:"There is no route definition for the route "+t[0]+".",498:"Invalid argument "+t[0]+(t[1]?" provided in link-to.":"."),499:t[0]?"Dynamic params for the route "+t[0]+" is not provided.":"Transition tried without arguments.",420:"Error on "+t[0]+" of route "+t[1]+".",428:"There is no outlet named "+t[0]+".",203:"Data provided for component is not valid."}[e]}function U(){Lyte.error(arguments[0].stack||1==arguments.length?arguments[0]:H.apply(this,arguments))}function K(e,n){function o(e,n,o,s){var u,c,l={route:k(n,he).__lp.route,queryParams:s?r.frameQueryParams(s):{}};if(le.history&&(l.fragment=a),l.dynamicParams=r.frameDynamicParams(o,l),e)return l;var h=Q(l);return 0!=h&&(u=v(c=Lyte.deepCopyObject(h.matched)),V(c.queryParams,l.queryParams)||(ne=i({replace:!0,data:t.history.state,url:u,fromHistory:!0}))),h}if(e){var a,s=[];if(le.history){var u=e.split("#");u[1]&&(a=u[1],e=u[0])}var c=e.split("?");e=decodeURI(c[0]),e=decodeURI(c[0]);var l=c[1],h=F(e);if("/"==e){if(!k(["/"],he))return void U(400,e);s.push([e])}else{var d,f=0,p=[0],m=[];m.dynamicParams=[],g(he);function y(e,t,r,n,o){if(!n.__lp.wildcard&&!n.__lp.dynamicKey){var i;if((i=k(o,he).__lp)&&i.wildcard&&!(r+=t.slice(r).indexOf(e[0])))return!1}for(var a=0;a<e.length;a++,r++)if(e[a]!=t[r]&&!B(e[a]))if($(e[a]))n.__lp.sufix.length&&(r=t.indexOf(n.__lp.sufix[0])-1);else{if("/"!=e[r])return!1;r--}return r}function g(e){for(var t in e)if(!d){var r,n=e[t];if("__lp"!=t){var o=F(t);if(o&&!1!==(r=y(o,h,f,n,m)))if(p.push(r),f=p[p.length-1],h.length==f){var i=Array.from(m.concat(t));if(n["/"]&&(i=i.concat("/")),s.push(i),!n.__lp.wildcard&&!n.__lp.dynamicKey)return void(d=i);p.pop(),f=p[p.length-1]}else{var a=Object.keys(n);if(m.push(t),h[f])if(n.__lp.wildcard&&!n.__lp.sufix.length&&1==a.length){var u=Array.from(m);n["/"]&&(u=u.concat("/")),s.push(u)}else a.length>1&&g(n);m.pop(),p.pop(),f=p[p.length-1]}}}}}if(d)return o(n,d,e,l);if(1==s.length)return o(n,s[0],e,l);if(s.length){for(var _,P,b=[],T=0;T<s.length;T++)1==s[T].length&&(_=s[T]),b.push(R(s[T]));if(P=Math.max(...b))return o(n,s[b.indexOf(P)],e,l);if(_)return o(n,_,e,l);U(400,e);function R(e){var t=0;"/"==(e=Array.from(e))[0]&&(t++,e.shift());var r=-1;return e.forEach(function(e,n){F(e).forEach(function(e,n){e==h[++r]&&t++})}),t}}else U(400,e)}else U(400,"")}function Q(e){var t=ue,r=le.routes,n=[];e.target="",e._routes=[];try{e.route.every(function(o,i){if(e.target=e.target?e.target+"."+o:o,r=k([o],r),!(t=k([o],t))||!t.__lp)throw Error(H(422,e.target));o=h(e.target);var a=t.__lp;e._routes.push(o),a.queryParams&&(a.__lp.queryParams={},a.queryParams.forEach(function(t){a.__lp.queryParams[t]=e.queryParams[t]})),a.__lp.dynamicParam=e.dynamicParams[i];var s=t.__lp.__lp.linkTags;return s.length&&s.forEach(function(e){"A"===e.firstChild.tagName&&e.firstChild.setAttribute("href",se.getURL(e.getMatchedObject(!0)))}),n.push(a)})}catch(e){return U(e),!1}return{currentRoutes:n,matched:e}}function J(e){var t=new function(e){for(var t in e)-1==be.indexOf(t)&&("info"==t?this.info=deepCopyObject(e[t]):this[t]=e[t])}(e);return t.state=201,t}function B(e){return!!j(e,":")}function $(e){return!!j(e,"*")}function V(e,t){var r=Object.keys(e),n=Object.keys(t);if(r.length!=n.length)return!1;for(var o in e)if(e[o]!=t[o])return!1;return!0}function W(e){if("object"!=typeof e){var t={queryParams:{},dynamicParams:[]};return Array.from(arguments).forEach(function(e,r){Array.isArray(e)?U(498,JSON.stringify(e)):0==r?t.route=e:"object"==typeof e?t.queryParams=e:t.dynamicParams.push(e)}),z(t)}if(e.route)return z(e)}function z(e){if(e.route){var t={route:h(e.route),queryParams:e.queryParams||{},dynamicParams:[],fragment:e.fragment,target:"",_routes:[]},r=e.dynamicParams?Array.from(e.dynamicParams):[];try{t.route.forEach(function(e,n){t.target=t.target?t.target+"."+e:e;var o=h(t.target);t._routes.push(o);var i=k(t.route.slice(0,n+1),le.routes);if(!i)throw Error(H(400,t.target));t.dynamicParams.push(i.__lp.dynamicKey?r.shift():void 0)})}catch(e){return U(e),!1}return t}}function G(e){var t=Y.url=v(e);return P(t,X(Q(e))),t}function X(e){if(ee&&Z.running){var t=b(Z,e.matched,e.currentRoutes);if(Z.currentPromise){var r=Z.currentPromise.hook;if(102==Z.routeTrans.state&&"current"==Z.currentPromise.state&&"didTransition"!=r){Z.abort({state:308,internalAbort:!0});var n=Re.indexOf(Z.currentPromise.hook)<=5?Z.currentPromise.index:Z.currentPromise.index+1;if(t.common.length-1<=n){var o=b(re,e.matched,e.currentRoutes);t.common.length<o.common.length?(Z.runLoop.templateToRemove.length&&Z.runLoop.templateToRemove.pop(),e.prevTrans=re,t=o):Z.currentPromise.index<=t.common.length-1&&(t.executed=Z.currentPromise)}}}e.transComparison=t}else Z.abort({state:308,internalAbort:!0});return e}t._router=e;var Y,Z,ee,te,re,ne,oe,ie,ae,se=this,ue={},ce=document.location,le={queryParamOptions:{}},he={},de="route",fe=!0,pe=!1,me=!1,ye={},ge=["beforeModel","model","afterModel","redirect","renderTemplate","afterRender"],ve={getDependencies:"dependencies",getResources:"resources"},_e=["getResources","getDependencies","beforeModel","model","afterModel"];ye.getResources=ye.getDependencies=function(e,t){var r=this.currentRoutes[t],n=r[e],i=this.routeInstances[t],a=E.call(this,n,i,e,o(t));return r.__lp[ve[e]+"Loaded"]=!n,!n||this.aborted||this.paused||(r.__lp[ve[e]]=a,a&&"getDependencies"==e&&console.log("Requesting files in getDependencies will stall execution of route till download completes. Please validate files before requesting."),q.call(this,{reqType:ve[e],currentRoute:r,index:t})),M()},ye.beforeModel=ye.model=function(e,t){return M.call(this,this.currentRoutes[t][e],this.routeInstances[t],o(t))},ye.afterModel=function(e,t){var r=this.routeInstances[t];return M.call(this,this.currentRoutes[t][e],r,r.currentModel,o(t))},ye.onError=function(e,t){for(U(420,t.hook,this.routeInstances[e].routeName);e>=0&&0!=O.call(this,"onError",e,[t.error,this.routeTrans,o(e),t.hook]);e--);this.paused&&this.abort({state:t.state,internalAbort:!0})},ye.willTransition=function(e,t){return 0==O.call(ee,e,t,[Z.routeTrans])&&C(Z.runLoop.previous,e),M()},ye.beforeRouteTransition=function(){return Y&&!this.aborted&&(Y.state=a({replace:Y.replace,data:Z.routeTrans.data,matched:Z.matched}),se.beforeRouteTransition(ee&&ee.routeTrans||void 0,Z.routeTrans,s(Y)),Z.routeTrans.state=102,Y&&Z.routeTrans.data&&(Y.state.data=Z.routeTrans.data),i(Y),Y=void 0,Z.runningPromise.reject("aborted"),ae.previous=!1,Z.runLoop=T(ae),Z.run()),M()},ye.onBeforeLoad=function(){return Z.beforeLoadCalled=!0,new Promise(function(e,t){for(var r,n=1;n<=Z.matched.route.length;n++)if(r=Z.matched.route.length-n,0==O.call(Z,"onBeforeLoad",r,[o(r)])||n==Z.matched.route.length){e();break}})},ye.redirect=function(e,t){var r=this.routeInstances[t];return M.call(this,this.currentRoutes[t][e],r,r.currentModel,o(t))},ye.afterRender=function(e,t){return this.routeInstances[t].__lp.rendered=!0,new Promise(function(r,n){var i=setTimeout(function(){var i=this.routeInstances[t];M.call(this,this.currentRoutes[t][e],i,i.currentModel,o(t),i.component).then(function(e){r(e)},function(e){n(e)})}.bind(this,e,t),0);this.timeouteFns.push(i)}.bind(this))},ye.didTransition=function(e,t){return new Promise(function(r,n){var i=setTimeout(function(){ye.removeTemplate.call(this,this.runLoop.templateToRemove),0==O.call(this,e,t,[o(t),Z.routeTrans])&&C(Z.runLoop.current,e),r(),0==t&&D({state:200})}.bind(this,e,t),0);this.timeouteFns.push(i)}.bind(this))},ye.beforeExit=function(e,t){var r=ee.routeInstances[t],n=ee.currentRoutes[t][e];return M.call(this,n,r,r.currentModel,o(t,ee))},ye.renderTemplate=function(e,t){function r(e,t){t&&("object"!=typeof t||Array.isArray(t)?w.call(this,!0,Error(H(203)).stack,a):e.setData(t))}function n(e,t){var r;if(t){if(!(r=t.outletName?document.querySelector(t.outletName).querySelector(e):void 0))return n(e,t.parent)}else(r=document.querySelector(e))||U(428,e);return r}var i=this.currentRoutes[t],a=this.routeInstances[t];if(this.runLoop.templateToRemove&&this.currentRoutes.length==t+1&&ye.removeTemplate.call(this,this.runLoop.templateToRemove),this.currentRoutes[t][e]){var s=E.call(this,i[e],a,e,a.currentModel,o(t));if(!this.aborted)if(ye.removeTemplate.call(this,this.runLoop.templateToRemove),re!=this&&(re=this),s&&s.outlet){a.outletName=s.outlet;var u,c=a.currentModel;if(u=n(s.outlet,a.parent))if(s.component){var l;a.component&&a.component.tagName.toLocaleLowerCase()==s.component&&a.outlet==u&&u.contains(a.component)?((l=a.component)._route=a,a.outlet=u,a.component=l,r.call(this,l,c)):(Lyte.triggerEvent("beforeTemplateDestroy",s.outlet,a),u.innerHTML="",(l=document.createElement(s.component))._route=a,a.outlet=u,a.component=l,r(l,c),u.appendChild(l))}else if(s.html){a.component=void 0,a.outlet=u,Lyte.triggerEvent("beforeTemplateDestroy",s.outlet,a),u.innerHTML=s.html;var h=u.getElementsByTagName("script");h.length&&function(e,t){for(var r=0,n=e.length;r<n;r++){for(var o=e[r],i=o.parentNode,a=document.createElement("script"),s=0,u=o.attributes.length;s<u;s++)a.setAttribute(o.attributes[s].name,o.attributes[s].value);a.innerHTML=o.innerHTML,i.appendChild(a),i.removeChild(o)}}(Array.from(h))}}else console.warn("renderTemplate hook should return either component or HTML. Rendering of HTML directly into the DOM within the renderTemplate hook is deprecated.")}return M()},ye.removeTemplate=function(e){this.routeCleared||(this.routeCleared=!0,ee&&e&&I(e),delete this.runLoop.templateToRemove,Lyte.removeFromCache())},this.configureDefaults=function(e){e=e||{},le.history="html5"==e.history,le.baseURL=e.baseURL,le.deferInit=e.deferInit||!1,le.queryParamOptions={sticky:!e.queryParamOptions||!e.queryParamOptions.hasOwnProperty("sticky")||e.queryParamOptions.sticky},this.__lp={version:"2.0.0",config:le,getDefinition:function(e,t){return"*"==e?ue:(t=t||ue,(t=k(e,t))&&t.__lp||void 0)}}},this.configureRoutes=function(e){function r(){!le.deferInit&&se.init&&(se.init(),delete se.init)}this.__lp||this.configureDefaults(),le.routes="function"==typeof e?f.call(this,e):e,"complete"===document.readyState||"interactive"===document.readyState?r():t.addEventListener("DOMContentLoaded",function(){r()})},this.init=function(e){return t.onpopstate=function(e){if(pe)pe=!1;else{var t;if(le.history){if(t=m(),Z&&Z.url==t)return}else t=y((e&&e.newURL||ce.hash).replace(/.*#/,""));ne={fromHistory:!0},e&&history.state&&(ne.data=history.state),P(t)}},le.history?m()&&t.onpopstate():(ne={fromHistory:!0},P(m())),c(),this},this.beforeRouteTransition=this.afterRouteTransition=function(){},this.checkIfSameRoute=function(e,t){if(e.route==t.route&&e.dynamicParams.length===e.dynamicParams.length&&V(e.queryParams,t.queryParams)){if(e.dynamicParams.length)for(var r=0;r<=e.dynamicParams.length;r++)return e.dynamicParams[r]==t.dynamicParams[r];return!0}return!1},this.addRoutes=function(e){console.warn("addRoutes function will be deprecated from next version"),Object.assign(le.routes,f.call(oe,e))},this.replaceWith=function(){var e=W.apply(this,arguments);if(e)return e.replace=!0,p(e)},this.transitionTo=function(){var e;if(e=W.apply(this,arguments))return p(e)},this.getURL=function(){var e,t;return(t=W.apply(this,arguments))&&(e=v(t)),le.history?g(e,!0):"#"+e},this.getRoute=function(e){var t=K(g(e),!0);return t&&(t.dynamicParams=t.dynamicParams.filter(d),t.route=t.route.join(".")),t};var Pe={get:function(e,t){return 0!=e.__lp[t+"Loaded"]}};x.prototype.run=function(){function e(e,t,r,n,o){n=n||function(){},o=o||function(e){"aborted"!=e&&U(e)},new Promise(function(n,o){"nestedForcedPromises"==t?(this.forcedRunningPromise={resolve:n,reject:o},e.call(this,this.runLoop.forceFetch,n)):(this.runningPromise={resolve:n,reject:o},e.call(this,this.runLoop,r,n))}.bind(this)).then(n,o)}function t(e,n,o){function i(e,t,r){for(var n=0;n<e.length;n++){var o=e[n];if(o.index==t)return r?void e.splice(n,1):o}}if(e&&e.beforeModel.length||e.model.length||e.afterModel.length){o=o||e.beforeModel[0];var a=this,s=this.currentRoutes[o.index],u=this.routeInstances[o.index];if(o.state="forced",Z.currentPromise=o,"beforeModel"==o.hook&&!Pe.get(u,"dependencies"))return void(this.pending.dependencies=o.index);r(o),ye[o.hook].call(this,o.hook,o.index).then(function(r){switch(o.hook){case"model":this.routeInstances[o.index].currentModel=r;break;case"afterModel":s._fetchStatus="completed",void 0!=this.pending.forceFetch&&this.pending.forceFetch==o.index&&this.run()}this.forcedRunningPromise.resolve==n&&"afterModel"!=o.hook&&(i(e[o.hook],o.index,!0),t.call(a,e,n,i(e["beforeModel"==o.hook?"model":"afterModel"],o.index)))}.bind(this)),e.beforeModel.length>1&&(i(e[o.hook],o.index,!0),t.call(this,e,n))}}function r(e){var t=e.hook,r=e.index;if("beforeRouteTransition"!=e.hook){var n="previous"==e.state?ee.currentRoutes[r]:Z.currentRoutes[r];Lyte.log(t+" of route "+n.routeName,de,"MediumOrchid")}else Lyte.log(t,de,"MediumOrchid")}function n(o,i,a){var s=o[i];if(s&&s.length){var u=s[0],c=this.currentRoutes[u.index];if(!this.aborted&&!this.paused){if("beforeModel"==u.hook&&!Pe.get(c,"dependencies"))return void(this.pending.dependencies=u.index);if("renderTemplate"==u.hook&&!Pe.get(c,"resources"))return void(this.pending.resources=u.index);if("redirect"==u.hook&&c.forceFetch&&"pending"==c._fetchStatus)return this.forceFetchRunning||(e.call(this,t,"nestedForcedPromises"),this.forceFetchRunning=!0),void(this.pending.forceFetch=u.index);u.state=i,Z.currentPromise=u,r(u),Lyte.time(u.hook+u.index),ye[u.hook].call(this,u.hook,u.index).then(function(e){Lyte.time(u.hook+u.index),"model"==u.hook&&(this.routeInstances[u.index].currentModel=e),this.runningPromise.resolve==a&&(C(o[i],u.hook,u.index),n.call(this,o,i,a))}.bind(this))}}else a&&a()}(function(){this.pending={},e.call(this,n,"nestedPromises","previous",function(){Z.beforeLoadCalled||ye.onBeforeLoad(),e.call(this,n,"nestedPromises","current")}.bind(this))}).call(this),document.title=this.title=this.routeInstances[this.routeInstances.length-1].title||document.title},r.frameQueryParams=function(e){if(e&&j(e,"=")){var t={},r=j(e,"?")?e.split("?")[1]:e;return(r=j(r,"&")?r.split(/&/g):[r]).forEach(function(e){var r=e.split("=");t[r[0]]=r[1]?decodeURIComponent(r[1]):r[1]}),t}},r.frameDynamicParams=function(e,t){if(e){var r,n=le.routes,o=[],i=F(e.split("?")[0]);return t.route.forEach(function(e,t,s){if((n=k([e],n)).__lp.wildcard)if(n.__lp.sufix.length){var u=i.slice(0,i.indexOf(n.__lp.sufix[0]));o.push(decodeURI(u.join("/"))),a(u.concat(n.__lp.sufix))}else o.push(decodeURI(i.join("/")));else n.__lp.dynamicKey?(r=i[n.__lp.dynamicIndex],a(F(n.__lp.path)),o.push(decodeURI(r))):(a(F(n.__lp.path)),o.push(void 0))}),o;function a(e){e.forEach(function(){i.shift()})}}},this.registerRoute=function(e,t,r){r&&r.mixins&&(Array.isArray(r.mixins)||(r.mixins=[r.mixins]),r.mixins.forEach(function(e){if(Lyte.Mixin.exists(e)){var r=Lyte.registeredMixins[e];if(r)for(var n in r)if("actions"==n)for(var o in r.actions)t.actions[o]=r.actions[o];else t[n]=r[n]}})),t.__lp={objPath:e.replace(/\//g,"."),linkTags:[]},t.queryParams&&(t.__lp.queryParamsDef={},t.queryParams.forEach(function(e,r){if("string"==typeof e)t.__lp.queryParamsDef[e]={sticky:le.queryParamOptions.sticky,refreshModel:!0};else{for(var n in e)t.__lp.queryParamsDef[n]={sticky:e[n].hasOwnProperty("sticky")?e[n].sticky:le.queryParamOptions.sticky,refreshModel:!e[n].hasOwnProperty("refreshModel")||e[n].refreshModel};t.queryParams[r]=n}}));var n=(e=h(e)).length-1;t.routeName=e[n],u(e,t)};var be=["runLoop","paused","currentRoutes","routeInstances","aborted","currentPromise","run","pending","matched","timeouteFns"];this.getRouteInstance=function(e){if(se&&Z&&Z.routeInstances){if("*"==e)return Z.routeInstances;e=e||Z.target;var t;return Z.routeInstances.every(function(r,n){return(r=Z.routeInstances[Z.routeInstances.length-1-n]).__lp.objPath!=e||(t=r,!1)}),t}};var Te=["getResources","getDependencies","beforeModel","model","afterModel","redirect","renderTemplate","afterRender","beforeExit"];r.initRoute=function(e){var t,r=e.matched,n=r.route.length,o=[];te=function(e,t,n){if(n){for(var i in n)if("__lp"==i){this.__lp={};for(var i in e.__lp)"rendered"!=i&&(this.__lp[i]=e.__lp[i])}else this[i]=n[i];this.component&&(this.component._route=this)}else for(var i in e)j(Te,i)||(this[i]=e[i]);this.parent=o[t-1],this.transition=Z.routeTrans,this.replaceWith=se.replaceWith,this.transitionTo=se.transitionTo,this.removeFromCache=function(e){Lyte.removeFromCache.assign(e)},this.refresh=function(e){var t={currentRoutes:Z.currentRoutes,matched:Z.matched},n=h(this.__lp.objPath).length-1,o=Array.from(r.route);if(t.transComparison={unRendered:o.splice(n),rendered:o},e&&e.refreshTemplate)for(var i=n;i<r.route.length;i++)delete Z.routeInstances[i].component;return Y={replace:!0,data:Z.data,fromHistory:!1},P(void 0,t),Z.routeTrans},this.setTitle=function(e){document.title=this.title=e},this.getQueryParams=function(){return this.__lp.queryParams||{}},this.getDynamicParam=function(){return this.__lp.dynamicParam},this.getRouteInstance=function(e){return se.getRouteInstance(e)},this.setDynamicParam=function(e){if(this.__lp.dynamicParam&&this.__lp.dynamicParam!=e){var t=Array.from(Z.matched.dynamicParams);t.splice(this.__lp.objPath.split(".").length-1,1,e);var r={route:Array.from(Z.matched.route),dynamicParams:t,queryParams:Object.assign({},Z.matched.queryParams)},n=v(r),o=Q(r);return Y={data:Z.data,url:n,fromHistory:!1},P(n,o),Z.routeTrans}},this.setQueryParams=function(e,t,r){var n={};if("object"==typeof e){for(var o in e)n[o]=e[o];r=t}else n[e]=t;var i={route:Array.from(Z.matched.route),dynamicParams:Array.from(Z.matched.dynamicParams),queryParams:Object.assign({},Z.matched.queryParams,n)};if(!V(Z.matched.queryParams,i.queryParams)){var a=v(i),s=Q(i);0!=r&&i.refreshModel||(s.transComparison={rendered:i.route,unRendered:[]}),Y={data:Z.data,url:a,fromHistory:!1},P(a,s)}return Z.routeTrans},this.init&&this.init(),"undefined"!=typeof LyteComponent&&(this.throwEvent=LyteComponent.throwEvent)};for(var i=e.prevTrans,a=!0,s=0;s<n;s++){if(!(t=se.__lp.getDefinition(Z.matched._routes[s])))return!1;i&&a&&i.matched&&i.matched.route[s]==r.route[s]?o.push(new te(t,s,i.routeInstances[s])):(o[s]=new te(t,s),a=!1)}return o};var Re=["getResources","getDependencies","beforeModel","model","afterModel","redirect","renderTemplate","afterRender"];return this},t.$LR=Lyte.Router=new lyteRouter}(window);