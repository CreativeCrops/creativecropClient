Lyte.Component.register("crux-combo-box-dropitem",{_template:'<template tag-name="crux-combo-box-dropitem">\t<div class="scrollingDiv{{cxPropName}}" onscroll="{{action(\'onScrollDiv\',event)}}" style="overflow : auto; height: 150px;">\t\t<template is="if" value="{{showLoading}}"><template case="true">\t\t\t<span class="loadingGifDiv">\t\t\t\t<img src="/crm/CRMClient/images/crux-search-loader.svg">\t\t\t</span>\t\t</template><template case="false">\t\t\t<template is="for" items="{{systemData}}" item="item" index="index">\t\t\t\t<lyte-drop-item data-value="{{if(ifEquals(cxPropType,\'single\'),item[cxPropIdSelector],concat(cxPropPrefix,\':\',item[cxPropIdSelector]))}}" image="{{if(cxPropImageSelector,item[cxPropImageSelector],undefined)}}" name="{{item[cxPropNameSelector]}}">\t\t\t\t<template is="if" value="{{cxPropImageSelector}}"><template case="true">\t\t\t\t\t<template is="if" value="{{expHandlers(item[cxPropImageSelector],\'!\')}}"><template case="true">\t\t\t\t\t <img src="/crm/CRMClient/images/nophoto.png" class="socialimg" style="height:32px;width:32px;border-radius:3px;">\t\t\t\t\t</template><template case="false">\t\t\t\t\t\t<img src="{{item.image_link}}" class="socialimg" style="height:32px;width:32px;border-radius:3px;">\t\t\t\t\t</template></template>\t\t\t\t</template></template>\t\t\t\t<template is="if" value="{{cxPropDescriptionSelector}}"><template case="true">\t\t\t\t\t<div class="detail">\t\t\t\t\t\t<div class="primaryDetail">{{item[cxPropNameSelector]}}</div>\t\t\t\t\t\t<div class="secondaryDetail">{{item[cxPropDescriptionSelector]}}</div>\t\t\t\t\t</div>\t\t\t\t</template><template case="false">\t\t\t\t\t{{item[cxPropNameSelector]}}\t\t\t\t</template></template>\t\t\t\t</lyte-drop-item>\t\t\t</template><template is="if" value="{{expHandlers(expHandlers(expHandlers(systemData.length,\'==\',0),\'||\',showNoResult),\'||\',expHandlers(onShow,\'==\',0))}}"><template case="true">\t\t\t\t<div class="showNoResultDiv">{{cruxGetI18n(\'None\')}}</div>\t\t\t</template></template>\t\t\t<template is="if" value="{{showScrollLoading}}"><template case="true">\t\t\t\t<span class="loadingGifDiv">\t\t\t\t\t<img src="/crm/CRMClient/images/crux-search-loader.svg">\t\t\t\t</span>\t\t\t</template></template></template></template>\t</div>\t<lyte-search class="lyteSearch{{cxPropName}}" lt-prop-query-selector="{&quot;scope&quot;:&quot;.scrollingDiv{{cxPropName}}&quot;,&quot;search&quot;:&quot;lyte-drop-item:not(.lyteDropdownActive&quot;}" on-search="{{method(\'showNoResult\')}}" style="display: none;">\t\t\t</lyte-search></template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[]},false:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}}]}},default:{}},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"text",position:[1,3,0]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1]}]},{type:"attr",position:[2]},{type:"if",position:[2],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"attr",position:[4]},{type:"if",position:[4],cases:{true:{dynamicNodes:[]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"componentDynamic",position:[3]}],_observedAttributes:["cxPropIdSelector","cxPropNameSelector","cxPropImageSelector","cxPropDescriptionSelector","cxPropRequest","cxPropPrefix","cxPropExclude","currentPos","localData","pageNo","noMoreRecord","cxPropRecord","systemData","cxPropModuleName","cxPropCacheQuery","cxPropDataCache","cxPropPerPage","isSearch","cxPropSearchCount","cxPropInputValue","cxPropMinLength","cxPropSearchAction","showNoResult","onShow","cxPropType","getRequest","cxPropOptions","cxPropName","showLoading","showScrollLoading","showSearchLoading","multipleClicks"],data:function(){return{cxPropIdSelector:Lyte.attr("string",{default:"id"}),cxPropNameSelector:Lyte.attr("string",{default:"name"}),cxPropImageSelector:Lyte.attr("string"),cxPropDescriptionSelector:Lyte.attr("string"),cxPropRequest:Lyte.attr("string"),cxPropPrefix:Lyte.attr("string"),cxPropExclude:Lyte.attr("array",{default:[]}),currentPos:Lyte.attr("number",{default:0}),localData:Lyte.attr("array",{default:[]}),pageNo:Lyte.attr("number",{default:1}),noMoreRecord:Lyte.attr("boolean",{default:!0}),cxPropRecord:Lyte.attr("number",{default:50}),systemData:Lyte.attr("array",{default:[]}),cxPropModuleName:Lyte.attr("string"),cxPropCacheQuery:Lyte.attr("boolean",{default:!0}),cxPropDataCache:Lyte.attr("boolean",{default:!0}),cxPropPerPage:Lyte.attr("number",{default:200}),isSearch:Lyte.attr("boolean",{default:!1}),cxPropSearchCount:Lyte.attr("number",{default:200}),cxPropInputValue:Lyte.attr("string",{default:""}),cxPropMinLength:Lyte.attr("number",{default:2}),cxPropSearchAction:Lyte.attr("boolean",{default:!1}),showNoResult:Lyte.attr("boolean",{default:!1}),onShow:Lyte.attr("number",{default:0}),cxPropType:Lyte.attr("string"),getRequest:Lyte.attr("boolean",{default:!0}),cxPropOptions:Lyte.attr("array"),cxPropName:Lyte.attr("string"),showLoading:Lyte.attr("boolean",{default:!0}),showScrollLoading:Lyte.attr("boolean",{default:!0}),showSearchLoading:Lyte.attr("boolean",{default:!0}),multipleClicks:Lyte.attr("boolean",{default:!1})}},init:function(){this.setData("cxPropModuleName",this.getData("cxPropRequest")),void 0==this.getData("cxPropIdSelector")&&this.setData("cxPropIdSelector","id"),void 0==this.getData("cxPropNameSelector")&&this.setData("cxPropNameSelector","name"),void 0==this.getData("cxPropSearchAction")&&this.setData("cxPropSearchAction",!1),void 0!=this.getData("cxPropOptions")&&(this.setData("getRequest",!1),this.setData("systemData",this.getData("cxPropOptions"))),this.getData("getRequest")||(this.setData("showLoading",!1),this.setData("showScrollLoading",!1),this.setData("showSearchLoading",!1))},didConnect:function(){},actions:{onScrollDiv:function(t){this.getData("getRequest")&&(this.setData("showScrollLoading",!0),this.bodyScroll.call(this,"sharingUsers",t))},onClickDropitem:function(){this.checkDropitem()},clearInputField:function(){this.setData("cxPropInputValue","")}},methods:{showNoResult:function(t){0==t.length?this.setData("showNoResult",!0):this.setData("showNoResult",!1)},onInputChange:function(t,e){this.updateInputValue(t.newValue)}},getItems:function(){this.setData("isSearch",!1),this.setData("cxPropInputValue",""),this.getData("getRequest")&&(this.setData("showLoading",!0),this.constructArray.call(this,"sharingUsers",!1)),this.checkDropitem()},setCriteria:function(){return this.getData("isSearch")?{criteria:"((first_name:starts_with:"+this.getData("cxPropInputValue")+")or(last_name:starts_with:"+this.getData("cxPropInputValue")+")or(email:starts_with:"+this.getData("cxPropInputValue")+"))"}:{}},updateInputValue:function(t){if(this.setData("cxPropInputValue",t),this.getData("cxPropSearchAction")){this.setData("showSearchLoading",!0);var e=this.$node.querySelector(".scrollingDiv"+this.getData("cxPropName"));this.keyup.call(this,"sharingUsers",e,null)}else{this.$node.querySelector(".lyteSearch"+this.getData("cxPropName")).setValue(this.getData("cxPropInputValue"))}},removeNone:function(){this.setData("showNoResult",!1)},systemDataObserver:function(){this.systemDataObserverFunction()}.observes("systemData.[]"),systemDataObserverFunction:function(){this.executeMethod("changeSelected"),this.checkDropitem()},checkDropitem:function(){this.setData("onShow",0);for(var t=this.$node.querySelector(".scrollingDiv"+this.getData("cxPropName")),e=0;e<t.childElementCount;e++)"LYTE-DROP-ITEM"!=t.children[e].tagName||t.children[e].classList.contains("lyteDropdownActive")||this.setData("onShow",this.getData("onShow")+1)},loadMoreData:function(){this.setData("showScrollLoading",!1),this.setData("showLoading",!1),this.setData("showSearchLoading",!1),this.checkDropitem(),this.systemDataObserverFunction()},sendSelectedData:function(){if(this.getData("cxPropSelected")&&this.getData("cxPropSelected").length>0){var t=this.getData("cxPropSelected"),e=[];if(this.getData("getRequest")){var a=t.join(","),o=this;return store.findAll(this.getData("cxPropRequest"),{ids:a}).then(function(t){for(var a=0;a<t.length;a++)e.push({name:t[a][o.getData("cxPropNameSelector")],id:t[a][o.getData("cxPropIdSelector")],prefix:o.getData("cxPropPrefix"),image:t[a][o.getData("cxPropImageSelector")]});return e})}for(var s=0;s<this.getData("cxPropOptions").length;s++)for(var r=0;r<t.length;r++)if(this.getData("cxPropOptions")[s][this.getData("cxPropIdSelector")]==t[r]){e.push({name:this.getData("cxPropOptions")[s][this.getData("cxPropNameSelector")],id:this.getData("cxPropOptions")[s][this.getData("cxPropIdSelector")],prefix:this.getData("cxPropPrefix"),image:this.getData("cxPropOptions")[s][this.getData("cxPropImageSelector")]});break}return Promise.resolve(e)}return Promise.resolve(!1)},resetMixin:function(){this.getData("getRequest")&&(this.setData("multipleClicks",!1),this.setData("noMoreRecord",!0),this.setData("pageNo",1),this.setData("currentPos",0),this.setData("localData",[]),this.setData("systemData",[]))}},{mixins:["crux-user-utils"]});