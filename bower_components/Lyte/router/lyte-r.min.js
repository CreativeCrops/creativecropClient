function ReplaceWith(e){var t=this.parentNode,r=arguments.length,o=+(t&&"object"==typeof e);if(t){for(;r-- >o;)t&&"object"!=typeof arguments[r]&&(arguments[r]=document.createTextNode(arguments[r])),t||!arguments[r].parentNode?t.insertBefore(this.previousSibling,arguments[r]):arguments[r].parentNode.removeChild(arguments[r]);o&&t.replaceChild(this,e)}}[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(e){e.hasOwnProperty("after")||Object.defineProperty(e,"after",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),t=document.createDocumentFragment();e.forEach(function(e){var r=e instanceof Node;t.appendChild(r?e:document.createTextNode(String(e)))}),this.parentNode.insertBefore(t,this.nextSibling)}})}),Element.prototype.replaceWith||(Element.prototype.replaceWith=ReplaceWith),CharacterData.prototype.replaceWith||(CharacterData.prototype.replaceWith=ReplaceWith),DocumentType.prototype.replaceWith||(DocumentType.prototype.replaceWith=ReplaceWith),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-e.length,t)===e}),Lyte={},Lyte.version="1.0.6",Lyte.registeredMixins={},Lyte.Mixin={},Lyte.debug=!1,Lyte.performance=!1,Lyte.toBeRegistered=[];var consoleTime=[];function domContentLoaded1(){let e=Lyte.toBeRegistered;if(e.length){for(let t=0;t<e.length;t++)customElements.define(e[t].name,e[t].def);Lyte.toBeRegistered=[]}}Lyte.Mixin.register=function(e,t){Lyte.registeredMixins[e]=t},Lyte.log=function(e,t){Lyte.debug&&console.log((t?"%c":"")+e,"color:"+t)},Lyte.time=function(e){var t;Lyte.performance&&(-1!=(t=consoleTime.indexOf(e))?(consoleTime.splice(t,1),console.timeEnd(e)):(consoleTime.push(e),console.time(e)))},Lyte.isRecord=function(e){return!!(e&&e.$&&e.$.hasOwnProperty("isModified"))},Lyte.isComponent=function(e){return!!(e&&e.$node&&e.__data)},Lyte.injectResources=function(e,t,r){if(e){var o=-(e=Array.isArray(e)?e:[e]).length;e.forEach(function(e){var n,i=e.split("."),a=i[i.length-1];n=document.createElement({js:"script",css:"link"}[a]),1!=i.length?("css"==a?(n.setAttribute("href",e),n.setAttribute("type","text/css"),n.setAttribute("rel","stylesheet")):n.setAttribute("src",e),n.onerror=n.onload=function(e){o++,t&&t.call(this,e),r&&0==o&&r()},document.head.appendChild(n)):console.error("Type of file is not specified in injectResources.")})}},Lyte.checkProperty=function(e,t,r,o,n){switch(e){case"type":if(Lyte.Transform.hasOwnProperty(o)){if(Array.isArray(t)){if("array"!=Lyte.Transform[o].extends)return{code:"ERR03",message:Lyte.errorCodes.ERR03,expected:o}}else if(Lyte.Transform[o].extends!=typeof t)return{code:"ERR03",message:Lyte.errorCodes.ERR03,expected:o}}else if(Array.isArray(t)){if("array"!=o)return{code:"ERR03",message:Lyte.errorCodes.ERR03,expected:o}}else if(o!=typeof t)return{code:"ERR03",message:Lyte.errorCodes.ERR03,expected:o};break;case"maximum":if("number"==typeof t&&t>o)return{code:"ERR04",message:Lyte.errorCodes.ERR04,expected:o};break;case"minimum":if("number"==typeof t&&t<o)return{code:"ERR05",message:Lyte.errorCodes.ERR05,expected:o};break;case"maxLength":case"maxItems":if(t.length>o)return{code:"ERR06",message:Lyte.errorCodes.ERR06,expected:o};break;case"minLength":case"minItems":if(t.length<o)return{code:"ERR07",message:Lyte.errorCodes.ERR07,expected:o};break;case"pattern":if("string"==typeof t&&!new RegExp(o).test(t))return{code:"ERR08",message:Lyte.errorCodes.ERR08,expected:o};break;case"uniqueItems":if(Array.isArray(t)&&o)for(var i=[],a=0;a<t.length;a++){var s=t[a];if(-1!=i.indexOf(s))return{code:"ERR09",message:Lyte.errorCodes.ERR09};i.push(s)}break;case"constant":if(Array.isArray(t)){if(!(c=t.length==o.length&&t.every(function(e,t){return e===o[t]})))return{code:"ERR10",message:Lyte.errorCodes.ERR10,expected:o}}else if("object"==typeof t){if(!(c=store.adapter.$.compareObjects(t,o)))return{code:"ERR10",message:Lyte.errorCodes.ERR10,expected:o}}else if(t!=o)return{code:"ERR10",message:Lyte.errorCodes.ERR10,expected:o};break;case"items":if(Array.isArray(t))for(a=0;a<t.length;a++)for(var e in o){if(1!=(c=Lyte.checkProperty(e,t[a],a,o[e])))return c}break;case"properties":if("object"==typeof t&&!Array.isArray(t))for(var r in t)for(var e in o){if(1!=(c=Lyte.checkProperty(e,t[r],r,o[e])))return c}break;case"validation":var c;if(1!=(c=Lyte.customValidator[o].apply(n,[r,t])))return c}return!0},Lyte.types=["string","object","number","boolean","array"],Lyte.attr=function(e,t){if(void 0==t&&(t={}),-1==this.types.indexOf(e)&&!Lyte.Transform.hasOwnProperty(e))throw new Error("Not a valid field type - "+e);return t.type=e,t},Lyte.defineRelation=function(e,t,r){var o={type:"relation",relType:t,relatedTo:e};return r&&(o.opts=r),o},Lyte.belongsTo=function(e,t){return this.defineRelation(e,"belongsTo",t)},Lyte.hasMany=function(e,t){return this.defineRelation(e,"hasMany",t)},Lyte.Transform={},Lyte.customValidator={},Lyte.registerDataType=function(e,t){if(this.Transform.hasOwnProperty(e))throw new Error("Custom Field Type - "+e+" -  already exists.");if(void 0==t.extends||-1==Lyte.types.indexOf(t.extends))throw new Error("Not a valid field type - "+t.extends);this.Transform[e]=t},Lyte.registerValidator=function(e,t){if(this.customValidator.hasOwnProperty(e))throw new Error("Custom Validator with name - "+e+" - already exists");this.customValidator[e]=t},Lyte.patterns={email:/([A-Za-z0-9._%\-'+/]+@[A-Za-z0-9.-]+\.[a-zA-Z]{2,22})$|[\s]+/,url:/(^(ht|f)tp(s?):\/\/[0-9a-zA-Z][-.\w]*(:[0-9])*(\/?)([a-zA-Z0-9\-.?,:'/\\+=&amp;%$#_[\]@!()*;~]*)?$)/,ampm:/^(AM|PM|am|pm)$/,hour:/^(0?[0-9]|1[0-9]|2[0-4])$/,minute:/^(0?[0-9]|[1-5][0-9]|60)$/,boolean:/^(true|false|TRUE|FALSE)$/,alphaNumeric:/([a-zA-Z0-9])+/,alphabetsOnly:/([a-zA-Z])+/,numeric:/([0-9])+/,phoneNo:/^[0-9a-zA-Z+.()\-;\s]+$/},Lyte.validate=function(e,t,r,o){var n=o.__data[t],i=!1;for(var a in n)if(!0!==(i=Lyte.checkProperty(a,r,t,n[a],e)))return i;return!1},Lyte.registerPattern=function(e,t){this.patterns[e]=t},Lyte.errorCodes={ERR01:"Primary key cannot be modified",ERR02:"Mandatory field cannot be empty",ERR03:"Type of value does not match the specified data type",ERR04:"Value is greater than the maximum value allowed",ERR05:"Value is less than the minimum value allowed",ERR06:"Length of string/array is greater than the maximum limit allowed",ERR07:"Length of string/array is less than the minimum limit allowed",ERR08:"String does not match the specified pattern",ERR09:"Values in array are not unique",ERR10:"Value is not equal to the specified constant",ERR11:"Model of related field is not defined",ERR12:"Model of backward relation is not defined",ERR13:"Record not found",ERR14:"Model does not match the related field model",ERR15:"Error in creating a record as a relation",ERR16:"Record with primary key already exists",ERR17:"Value cannot be changed because record has been deleted",ERR18:"Action not defined",ERR19:"Model not defined",ERR20:"Key not specified",ERR21:"'belongsTo' relationship expects a single object/id",ERR22:"Type not specified for polymorphic relation",ERR23:"Primary Key value not present",ERR24:"Error while relating record"},Lyte.registeredGlobalEvents={},Lyte.triggerEvent=function(){var e=Array.prototype.slice.call(arguments,1),t=arguments[0],r=!1,o=this.registeredGlobalEvents[t];if(o)for(var n=0;n<o.listeners.length;n++){var i=o.listeners[n];if(i)if(!1===i.apply(this,e)){r=!0;break}}else o=this.registeredGlobalEvents[t]={listeners:[]};var a=new CustomEvent(t,{detail:e});r||document.dispatchEvent(a)},Lyte.addEventListener=function(e,t){if("function"==typeof t){var r=this.registeredGlobalEvents[e];return r||(r=this.registeredGlobalEvents[e]={listeners:[]}),e+"-"+(r.listeners.push(t)-1)}console.error("Second parameter to LyteComponent.addGlobalEventListener() must be a function")},Lyte.removeEventListener=function(e){if(e){var t=e.split("-"),r=this.registeredGlobalEvents[t[0]];r&&r.listeners[t[1]]?r.listeners[t[1]]=null:console.error("No such listener registered")}else console.error("listener unique id not specified")},Lyte.deepCopyObject=function(e){for(var t,r,o,n,i,a,s=[{source:e,target:Object.create(Object.getPrototypeOf(e))}],c=[e],d=s[0].target,l=[d];t=s.shift();)for(r=Object.getOwnPropertyNames(t.source),o=0;o<r.length;o++)(n=Object.getOwnPropertyDescriptor(t.source,r[o])).value&&"object"==typeof n.value?(i=n.value,n.value=Array.isArray(i)?[]:Object.create(Object.getPrototypeOf(i)),-1==(a=c.indexOf(i))?(c.push(i),l.push(n.value),Object.defineProperty(t.target,r[o],n),s.push({source:i,target:n.value})):(n.value=l[a],Object.defineProperty(t.target,r[o],n))):Object.defineProperty(t.target,r[o],n);return d},Lyte.resolvePromises=function(e){if(Array.isArray(e))return function(e){var t=[];return new Promise(function(r,o){Promise.all(e).then(function(o){e.forEach(function(e,r){t[r]=o[r]}),r(t)},function(e){o(e),console.error(e)})})}(e);if("object"==typeof e)return function(e){var t=[],r=[];if(Object.keys(e).forEach(function(o){t.push(o),r.push(e[o])}),r.length){var o={},n=new Promise(function(e,n){Promise.all(r).then(function(r){r.forEach(function(e,r){o[t[r]]=e}),e(o)},function(e){n(e),console.error(e)})});return n}return e}(e)},Lyte.createCustomElement=function(e,t){var r=t.constructor;delete t.constructor,this.defProperty=function(e,t,r){var o={};r.get&&(o.get=r.get),r.set&&(o.set=r.set),Object.defineProperty(e,t,o)};class o extends HTMLElement{constructor(){super(),r&&r.apply(this,Array.from(arguments))}}var n=t.static;if(n){for(var i in n)"object"==typeof n[i]?this.defProperty(o,i,n[i]):Object.defineProperty(o,i,{value:n[i]});delete t.static}for(var i in t)"object"==typeof t[i]?this.defProperty(o.prototype,i,t[i]):Object.defineProperty(o.prototype,i,{value:t[i]});t.static=n[i],t.constructor=r,"complete"===document.readyState||"interactive"===document.readyState?customElements.define(e,o):Lyte.toBeRegistered.push({name:e,def:o})},"complete"===document.readyState||"interactive"===document.readyState?domContentLoaded1():document.addEventListener("DOMContentLoaded",function(e){domContentLoaded1()},!0);Lyte.Router={definitions:{}},function e(t){function r(e){return this.routes=e,this.history="html5"==X.history,this.baseURL=X.baseURL,this.deferInit=X.deferInit||!1,this}function n(){class e extends HTMLElement{static get observedAttributes(){return["lt-prop-route","lt-prop-dp","lt-prop-qp","lt-prop","lt-prop-class","lt-prop-id","lt-prop-rel","lt-prop-title","lt-prop-style","lt-prop-target"]}attributeChangedCallback(e,t,r){if(this.hasAttribute("lyte-rendered")&&this._linkCreated){let t=this.children[0];"lt-prop"===e?(this.handleLtProp(),this.hasAttribute("lt-prop-custom")||this.setCustomAttributes(t,!0),this.getMatchedObject(),"A"===t.tagName&&this.constructHref(t)):/^(lt-prop-route|lt-prop-dp|lt-prop-qp)$/.test(e)?(this.getMatchedObject(),"A"===t.tagName&&this.constructHref(t)):this.hasAttribute("lt-prop-custom")||t.setAttribute(e.substring(8),r)}}connectedCallback(){if(this.ltProp=this.ltProp||{},this.hasAttribute("lyte-rendered"))return this._linkCreated=!0,void this.getMatchedObject();this.handleLtProp();let e;if(this.hasAttribute("lt-prop-custom")||this.ltProp.custom)this.getMatchedObject(),"A"===this.children[0].tagName&&this.constructHref(this.children[0]);else{e=document.createElement("a");let t=this.childNodes.length;for(let r=0;r<t;r++)e.appendChild(this.childNodes[0]);this.setCustomAttributes(e),this.getMatchedObject(),this.constructHref(e),this.appendChild(e)}this.setAttribute("lyte-rendered",""),this._linkCreated=!0}handleLtProp(){var e=this.getAttribute("lt-prop");if(e)try{var t=JSON.parse(e);this.ltProp=t}catch(e){console.warn("Error while parsing ltProp in link-to")}}setCustomAttributes(e,t){for(let t in this.ltProp)/^(id|class|style|target)$/.test(t)&&e.setAttribute(t,this.ltProp[t]);if(!t){var r=this.attributes;for(let t=0;t<r.length;t++){let n=r[t].nodeName;"lt-prop"!==n&&/^(lt-prop-id|lt-prop-class|lt-prop-style|lt-prop-target)$/.test(n)&&e.setAttribute(n.substring(8),r[t].nodeValue)}}}constructHref(e){let t;if(t=k(this.matched)){let r=u(t);r=K.history?s(r,!0):"#"+r,e.setAttribute("href",r)}}getMatchedObject(){let e=this.matched||{};e.route=this.getAttribute("lt-prop-route")||this.ltProp.route;let t=this.getAttribute("lt-prop-dp")||this.ltProp.dp||[],r=this.getAttribute("lt-prop-qp")||this.ltProp.qp||{};if(t instanceof Array)e.dynamicParams=[];else try{e.dynamicParams=JSON.parse(t)||[]}catch(t){console.error("Error while parsing dynamicParams in link-to."),e.dynamicParams=[]}if(r instanceof Object)e.queryParams={};else try{e.queryParams=JSON.parse(r)}catch(t){console.error("Error while parsing queryParams in link-to."),e.queryParams={}}this.matched=e}}customElements.define("link-to",e)}function o(e){Lyte.time("parseRouteMapping");var t={},n={},o=[],i=[];return this.route=function(e,a,s){if("object"==typeof a)if(a.path||(a.path=P(e)),y(a.path,"?")){var u=a.path.split("?");a.defQP=r.frameQueryParams(u[1]),a.path=u[0]}else a.queryParams&&(a.defQP=a.queryParams,delete a.queryParams);else"function"==typeof a&&(s=a),a={path:P(e)};if("/"==a.path)n=f(o,B)[a.path]={$:{}},o.push("/");else{var c=a.path;n=f(o,B)[a.path]={$:{}},I(c)||A(c)?b(c).every(function(e,t,r){if(I(e))return a.dynamicKey=n.$.dynamicKey=e.replace(":",""),a.dynamicIndex=n.$.dynamicIndex=t,!1;if(A(e)){a.dynamicKey=n.$.dynamicKey=e.replace("*",""),a.dynamicIndex=n.$.dynamicIndex=t,a.wildcard=n.$.wildcard=!0,a.sufix=n.$.sufix=[];for(var o=t+1;o<r.length;o++)n.$.sufix.push(r[o]);return!1}return!0}):a.dynamicKey=n.$.dynamicKey=void 0,o.push(c)}i.push(e),n.$.route=Array.from(i);var d=t;i.forEach(function(e,t){t+1!=i.length&&(d=d[e])}),d[e]={$:a},s&&s.call(this,{}),i.pop(),o.pop()},e.call(this,{}),Lyte.time("parseRouteMapping"),t}function i(e){if(e){H=D=void 0;var t,r;if("object"==typeof e)if(j){r=j.title;var n=j.runLoop&&j.runLoop.current&&j.runLoop.current[0]&&"redirect"==j.runLoop.current[0].hook;t=n?M(e):u(e)}else t=u(e);else console.warn("Not a valid route transition");if(w={type:e.replace?"replaceState":"pushState",url:t,title:r,fromHistory:!1},Lyte.log("Transitioning to "+t,G),!n){var o;if(!(o=x(e)))return;c(t,o)}return j.routeTrans}console.error("Transition tried without arguments.")}function a(e){return e||Z.addToHistory({type:"replaceState",title:document.title,url:e="/"}),e}function s(e,t){var r=K.baseURL;if(r&&e){if(r=P(K.baseURL),0==e.indexOf(r)&&!t)return e.replace(r,"");if(t&&-1==e.indexOf(r))return r+e}return e}function u(e){if(e){e.route&&!Array.isArray(e.route)&&(e.route=e.route.split("."));var t,r="";return e.route.forEach(function(t,n){var o,i=e.route.slice(0,n+1),a=f(i,K.routes);if(!a)return console.error('There is no url mapped for the route "'+i.join(".")+'".'),!1;var s=a.$.path;if(o=a.$.defQP)for(var u in o)e.queryParams&&!e.queryParams.hasOwnProperty(u)&&(e.queryParams[u]=o[u]);if(a.$.dynamicKey){var c=b(s);if(!e.dynamicParams||!e.dynamicParams[n])return console.error("Dynamic params for the route "+t+" is not defined."),!1;c[a.$.dynamicIndex]=encodeURI(e.dynamicParams[n]),r+=P(c.join("/"))}else r+=P(s)}),r="/"==r[r.length-1]&&1!=r.length?r.slice(0,-1):r,t=Object.keys(e.queryParams).filter(function(t){return void 0!=e.queryParams[t]&&t}),e.queryParams&&t.length&&(r+="?",t.forEach(function(n,o){r+=n+"="+encodeURIComponent(e.queryParams[n])+(o<t.length-1?"&":"")})),T(r)}}function c(e,t){Lyte.time("RouteTransition"),j&&(j.running||O&&j!=O)&&j.abort(),Q.error=!1,t||(t=R(e)),t&&t.matched.route.length&&(Lyte.time("constructRunLoop"),h(t),Lyte.time("constructRunLoop"),t.prevTrans=O,j.runLoop=d(t),setTimeout(function(){w&&j.routeTrans.data&&(w.data=j.routeTrans.data),j.run()},0))}function d(e){function t(e,t){c||(u&&u.currentRoutes&&u.currentRoutes[t]&&u.currentRoutes[t].routeName==e.routeName&&(!d||d[t]==e.routeName)&&void 0!=D&&t>=D?(m.push({hook:"redirect",index:t}),t==D&&["renderTemplate","afterRender"].forEach(function(e){var r={};r.hook=e,r.index=t,m.push(r)})):(v.push({hook:"getResources",index:t}),v.push({hook:"getDependencies",index:t}),i.forEach(function(r){var n={};n.hook=r,n.index=t,e.forceFetch&&!y(["redirect","renderTemplate","afterRender"],r)?(p.push(n),"afterModel"==r&&(e._fetchStatus="pending")):m.push(n)})))}var r,n,o,i=["beforeModel","model","afterModel","redirect","renderTemplate","afterRender"],a=e.currentRoutes,s=e.matched,u=e.decidedTrans||e.prevTrans,c=e.validateTransition,d=e.refreshRouteFrom,h=!0,f=!0,l=!0,m=[],p=[],v=[],g=[],P=[],b=[],T=[],R=s.route.length;if(d&&(d=d.split(".")).pop(),a.forEach(function(i,p){if(u){if(n=u.currentRoutes,(o=n[p])&&f&&o.routeName==i.routeName&&u.routeInstances[p]._rendered&&(!d||d[p]==i.routeName)){function y(){t(i,p),f=!1}function v(){c||(j.routeInstances[p]._rendered=!0,m.push({hook:"redirect",index:p}))}!i._queryParams&&!i._dynamicParams||e.ignore?v():(i._queryParams&&i.queryParams.forEach(function(e){(s.queryParams||u.matched.queryParams)&&s.queryParams[e]!=u.matched.queryParams[e]&&f&&y()}),i._dynamicParams&&s.dynamicParams[p]!=u.matched.dynamicParams[p]&&f&&y(),f&&v())}else if(f=!1,t(i,p),o&&(!h||o.routeName!=i.routeName))if(h=!1,T.push(o),l&&u.routeInstances[p]._rendered){if(r=p,l=!1,c)return p}else if(c)return p;R==p+1&&u.matched.route.length>R&&(l&&u.routeInstances[p+1]._rendered&&(r=void 0==r?p+1:r),T=T.concat(n.slice(p+1)))}else t(i,p);var g=a.length-p-1;b.push({hook:"didTransition",index:g})}),c)return r;if(u){e.decidedTrans&&(T=K.prevTransition.currentRoutes.slice(K.prevTransition.leavingRoutesIndex+1));var x=K.prevTransition.currentRoutes.length;K.prevTransition.currentRoutes.forEach(function(e,t){P.push({hook:"willTransition",index:x-t-1,route:e})}),T.forEach(function(e,t){var r=x-t-1;g.push({hook:"beforeExit",index:r})})}return m={previous:P.concat(g),current:v.concat(m).concat(b),forceFetch:p},m.current.removeTemplate=u&&u.runLoop&&u.runLoop.current&&u.runLoop.current.removeTemplate,void 0!=r&&(m.current.removeTemplate=m.current.removeTemplate||[],m.current.removeTemplate.push({index:r,routeInstances:u.routeInstances})),m}function h(e){K.transition=j=new l(e),j.routeTrans=L(j),j.routeInstances=r.initRoute(e.matched),U?(j.routeTrans.data=U.data,Q.beforeRouteTransition(O&&O.routeTrans||void 0,j.routeTrans,U),j.running=!0,U.data=j.routeTrans.data,U.type="replaceState",Z.addToHistory(U),U=void 0):j.routeTrans.data&&Z.addToHistory({type:"replaceState",data:j.routeTrans.data})}function f(e,t){return e.every(function(e){return t&&t[e]?(t=t[e],!0):t=!1}),t}function l(e){this.matched=e.matched,this.target=e.matched.target,this.info={route:e.matched.target,queryParams:e.matched.queryParams,dynamicParams:e.matched.dynamicParams.filter(g)},this.currentRoutes=e.currentRoutes,this.aborted=this.paused=!1,this.abort=function(){this.aborted||(this.runningPromise&&this.runningPromise.reject("aborted"),"transition"==this.constructor.name&&delete this.runLoop.current.removeTemplate,this.aborted=!0,v(this.currentPromise&&"willTransition"==this.currentPromise.hook))}.bind(this),this.pause=function(){return this.paused=j.currentPromise,this.resume=this.routeTrans.resume=function(e){(e=e||this).runningPromise&&e.runningPromise.reject("aborted"),delete e.routeTrans.resume,delete e.resume;var t=j.paused.state;e.runLoop[t][0].hook==j.paused.hook&&e.runLoop[t][0].index==j.paused.index&&e.runLoop[t].splice(0,1),e.paused=!1,e.run()}.bind(this),this.routeTrans}.bind(this)}function m(e){function t(e,n){function i(){0==++u&&n()}function a(e,t,n){V[e]?V[e].$.push({type:r,index:o,resolve:n}):(V[e]={$:[{type:r,index:o}]},t&&"error"!=t.event.type?(-1!=W.indexOf(e)&&W.splice(W.indexOf(e),1),s.call(t.tag,t.event,!0),n()):Lyte.injectResources([e],s,n))}function s(e,t){var r=this.getAttribute("src")||this.getAttribute("href");t||(z[r]&&z[r].tag.remove(),this.onerror=this.onload=void 0,z[r]={tag:this,event:{type:e.type}}),ee.set(r,e,t)}if(e){Array.isArray(e)||(e=[e]),e.length||n();var u=-e.length;e.forEach(function(e){"string"==typeof e?a(e,z[e],function(){i()}):Array.isArray(e)?new Promise(function(r){t(e,r)}).then(function(){i()}):new Promise(function(r){t(e.parent,r)}).then(function(){new Promise(function(r){t(e.child,r)}).then(function(){i()})})})}else n()}var r=e.req,n=(e.inst,j.currentPromise.hook),o=e.index,i=te(r),a=e.currentRoute;return new Promise(function(e){t(a[r],e)}).then(function(){a[r+"Loaded"]=!0,a[i]&&a[i].length?j.aborted||(j.paused||j.pause(),F(n,o,a[i])):j.pending&&void 0!=j.pending[r]&&j.pending[r]==o&&j.run()})}function p(e){e.forEach(function(e){for(var t,r=e.routeInstances.length-1;r>=e.index;r--)(t=e.routeInstances[r]).outlet&&(t.component&&(t.component._route=void 0),Lyte.triggerEvent("beforeTemplateDestroy",t.outletName,t),t.outlet.innerHTML="")})}function y(e,t){return-1!=e.indexOf(t)}function v(e){j.running&&(Lyte.time("RouteTransition"),V={},j.running=!1,Q.afterRouteTransition(j.routeTrans),t.$lr=Q.getRouteInstance(),Lyte.log("Transition completed.",G)),K.prevTransition=K.transition=e?j=O:O=j}function g(e){return void 0!=e}function P(e){return"/"==e[0]?e:"/"+e}function b(e){return e.match(/[^/?]+/g)||[]}function T(e){return e=e.replace(/\/\//g,"/"),e=e.replace(/\/\?/g,"?")}function R(e,n){function o(e,n,o,i){var a,s,c={};if(c.route=f(n,B).$.route,c.queryParams=i?r.frameQueryParams(i):{},c.dynamicParams=r.frameDynamicParams(o,c),e)return c;var d=x(c);return!Q.error&&(s=Lyte.deepCopyObject(d.matched),a=u(s),q(s.queryParams,c.queryParams)||(U=Z.addToHistory({type:"replaceState",data:t.history.state,title:document.title,url:a,fromHistory:!0})),d)}if(e){var i=[],a=e.split("?"),e=decodeURI(a[0]),s=a[1],c=b(e);if("/"==e){if(!f(["/"],B))return void console.error("url '"+e+"' is not defined in router");i.push([e])}else{var d,h=0,l=[0],m=[];m.dynamicParams=[],y(B);function p(e,t,r,n,o){if(!n.$.wildcard&&!n.$.dynamicKey){var i;if((i=f(o,B).$)&&i.wildcard&&!(r+=t.slice(r).indexOf(e[0])))return!1}for(var a=0;a<e.length;a++,r++)if(e[a]!=t[r]&&!I(e[a]))if(A(e[a]))n.$.sufix.length&&(r=t.indexOf(n.$.sufix[0])-1);else{if("/"!=e[r])return!1;r--}return r}function y(e){for(var t in e)if(!d){var r,n=e[t];if("$"!=t){var o=b(t);if(o&&!1!==(r=p(o,c,h,n,m)))if(l.push(r),h=l[l.length-1],c.length==h){var a=Array.from(m.concat(t));if(n["/"]&&(a=a.concat("/")),i.push(a),!n.$.wildcard)return void(d=a);l.pop(),h=l[l.length-1]}else{var s=Object.keys(n);if(m.push(t),c[h])if(n.$.wildcard&&!n.$.sufix.length&&1==s.length){var u=Array.from(m);n["/"]&&(u=u.concat("/")),i.push(u)}else s.length>1&&y(n);m.pop(),l.pop(),h=l[l.length-1]}}}}}if(d)return o(n,d,e,s);if(1==i.length)return o(n,i[0],e,s);if(i.length){for(var v,g,P=[],T=0;T<i.length;T++)1==i[T].length&&(v=i[T]),P.push(R(i[T]));if(g=Math.max(...P))return o(n,i[P.indexOf(g)],e,s);if(v)return o(n,v,e,s);console.error("url '"+e+"' is not defined in router");function R(e){var t=0;"/"==(e=Array.from(e))[0]&&(t++,e.shift());var r=-1;return e.forEach(function(e,n){b(e).forEach(function(e,n){e==c[++r]&&t++})}),t}}else console.error("url '"+e+"' is not defined in router")}else console.error("path is not valid")}function x(e){var t=Q.definitions,r=K.routes,n=[];return e.target="",e._routes=[],e.route.every(function(o,i){if(e.target=e.target?e.target+"."+o:o,r=f([o],r),!(t=f([o],t))||!t.$)return console.error('There is no route object for the route "'+e.target+'"'),Q.error=!0,!1;o=e.target.split("."),e._routes.push(o);var a=t.$;return a.queryParams&&(a._queryParams={},a.queryParams.forEach(function(t){a._queryParams[t]=void 0!=e.queryParams[t]?e.queryParams[t]:r.defQP&&r.defQP[t]?r.defQP[t]:void 0})),a._dynamicParams=e.dynamicParams[i],n.push(a)}),!Q.error&&{currentRoutes:n,matched:e}}function L(e){return new function(e){var t=["runLoop","paused","currentRoutes","routeInstances","aborted","currentPromise","run","pending"];for(var r in e)-1==t.indexOf(r)&&("info"==r?this.info=deepCopyObject(e[r]):this[r]=e[r])}(e)}function I(e){return!!y(e,":")}function A(e){return!!y(e,"*")}function q(e,t){var r=Object.keys(e),n=Object.keys(t);if(r.length!=n.length)return!1;for(var o in e)if(e[o]!=t[o])return!1;return!0}function E(e){if("object"!=typeof e){var t={};return t.queryParams={},t.dynamicParams=[],Array.from(arguments).forEach(function(e,r){Array.isArray(e)?console.error(JSON.stringify(e)+" is not a valid argument."):0==r?t.route=e:"object"==typeof e?t.queryParams=e:t.dynamicParams.push(e)}),k(t)}if(e.route)return k(e)}function k(e){if(e.route){var t={};t.route=e.route.split("."),t.queryParams=e.queryParams||{},t.dynamicParams=[],t.target="",t._routes=[];var r=e.dynamicParams?Array.from(e.dynamicParams):[];try{t.route.forEach(function(e,n){t.target=t.target?t.target+"."+e:e;var o=t.target.split("."),i=f(t.route.slice(0,n+1),K.routes);if(t._routes.push(o),!i)throw'There is no url mapped for the route "'+t.target+'".';t.dynamicParams.push(i.$.dynamicKey?r.shift():void 0)})}catch(e){return console.error(e),!1}return t}}function _(e,t){var r=t.route.length;return e.route.every(function(e,n){return e==t.route[n]||(r=n-1,!1)}),r}function $(e){if(O&&(e.validateTransition=!0,e.prevTrans=j,S=d(e),delete e.validateTransition,void 0==S||S>=D)){var t=_(e.matched,j.matched);t<_(e.matched,O.matched)&&(D=void 0,j.leavingRoutesIndex=t,e.decidedTrans=O)}}function M(e){var t=j.runLoop.current[0],r=u(e),n=x(e);return D=t.index,$(n),c(r,n),r}t._router=e;var w,j,O,N,H,D,S,C,K,U,F,Q=Lyte.Router,J=document.location,W=[],B={},V={},z={},G="route",X={},Y={get:function(e){var t=Q.definitions;return e.forEach(function(e){t=t[e]}),t&&t.$||void 0},set:function(e,t){var r=Q.definitions,n=e.length-1;e.forEach(function(e,o){n===o?r[e]?r[e].$=t:r[e]={$:t}:r[e]||(r[e]={}),r=r[e]})}},Z={history:!1,init:function(e,r){this.history=r,C||(C=[]),t.onpopstate=function(e){C.forEach(function(t){t(e)})},C.push(e)},addToHistory:function(e){var r;return e.fromHistory=void 0!=e.fromHistory&&e.fromHistory,e.url&&(r=K.history?P(s(e.url,!0)):"#"+P(e.url)),e.title=e.title||document.title,r?t.history[e.type](e.data,e.title,r):t.history[e.type](e.data,e.title),delete e.type,e}};Q.configureDefaults=function(e){X=e||{}},Q.removeFromCache=function(e){e="*"==e?Object.keys(z):Array.isArray(e)?e:[e],W=W.concat(e)},Q.beforeRouteTransition=Q.afterRouteTransition=function(){},Q.configureRoutes=function(e){K=this.instance=new r("function"==typeof e?o.call(this,e):e),t.addEventListener("DOMContentLoaded",function(){!K.deferInit&&Q.init&&(Q.init(),Q.init=void 0)})},Q.init=function(){K.init(),n()},document.addEventListener("click",function(e){if(2!=e.button){for(var t=e.target||e.srcElement;t&&"LINK-TO"!==t.nodeName;)t=t.parentNode;if(t){if("A"===t.children[0].tagName&&(1==e.ctrlKey||1==e.metaKey||2==e.which||t.children[0].hasAttribute("target")&&"_self"!==t.children[0].getAttribute("target")))return;e.preventDefault();var r,n=Lyte.Router.getRouteInstance().transition;r=n&&Q.checkIfSameRoute(t.matched,n.info)&&t.hasAttribute("lt-prop-refresh-route")?Q.getRouteInstance(t.getAttribute("lt-prop-refresh-route")).refresh():Q.transitionTo(t.matched);var o={};if(t.getAttribute("lt-prop-trans"))try{o=JSON.parse("lt-prop-trans")}catch(e){}if(transitionData=t.getAttribute("lt-prop-td"),transitionData=transitionData||o.data,transitionData){if("string"==typeof transitionData)try{transitionData=JSON.parse(transitionData)}catch(e){}o.data=transitionData}for(var i in o)r[i]=o[i]}}},!0),Q.checkIfSameRoute=function(e,t){if(e.route==t.route&&e.dynamicParams.length===e.dynamicParams.length&&q(e.queryParams,t.queryParams)){if(e.dynamicParams.length)for(var r=0;r<=e.dynamicParams.length;r++)return e.dynamicParams[r]==t.dynamicParams[r];return!0}return!1},Q.addRoutes=function(e){Object.assign(this.instance.routes,o.call(this,e))},Q.replaceWith=function(){var e=E.apply(this,arguments);if(e)return e.replace=!0,i(e)},Q.transitionTo=function(){var e;if(e=E.apply(this,arguments))return i(e)},Q.getURL=function(){var e,t;return(t=E.apply(this,arguments))&&(e=u(t)),K.history?s(e,!0):e},Q.getRoute=function(e){var t=R(s(e),!0);return t&&(t.dynamicParams=t.dynamicParams.filter(function(e){return void 0!==e}),t.route=t.route.join(".")),t},r.prototype.init=function(e){var t=this;return this.handler=function(e){var r;r=t.history?Q.getLocation():a((e&&e.newURL||J.hash).replace(/.*#/,"")),U={fromHistory:!0},e&&history.state&&(U.data=history.state),c(r)},Z.init(this.handler,this.history),this.history?Q.getLocation()&&this.handler():(U={fromHistory:!0},c(Q.getLocation())),this},Q.getLocation=function(){if(K.history){var e=a(J.pathname+J.search);return e=s(e),P(e)}return P(a(J.hash.replace(/^(#\/|#|\/)/,"")))};var ee={get:function(e,t){return 0!=e[t+"Loaded"]},set:function(e,t){V[e]&&(V[e].$.forEach(function(e){var r=j.currentRoutes[e.index];if(e.resolve&&e.resolve(),"error"==t.type){var n=te(e.type);r[n]?r[n].push(t):r[n]=[t]}}),delete V[e])}},te=function(e){return"_dependencies"==e?"_errorDependencies":"_errorResources"};l.prototype.run=function(){function e(e,t){return{queryParams:this.currentRoutes[e]._queryParams,dynamicParam:this.currentRoutes[e]._dynamicParams}}function t(e,t){if(e){var n=y(["getResources","getDependencies"],j.currentPromise.hook);try{return e.apply(t,Array.from(arguments).slice(2))}catch(e){return void r(n,e,t)}}}function r(e,t,r){if(j.currentPromise){var n=j.currentPromise.hook,o=j.currentPromise.index;j.currentPromise.state;j.pause(),console.error(t),e?F(n,o,t):(console.error("Error on "+n+" of route "+r.routeName),y(["willTransition","didTransition","beforeExit"],n)?j.resume():j.abort())}}function n(e,t){if(e){var n,o=arguments,i=j.currentPromise.hook,a=y(["beforeModel","model","afterModel"],i);return Promise.resolve(new Promise(function(s,u){try{n=Promise.resolve(e.apply(t,Array.from(o).slice(2)))}catch(e){return void r(a,e,t)}n.then(function(e){s(e)},function(e){console.error(e),"model"==i&&(t.currentModel=e),r(a,e,t)})}))}return Promise.resolve()}function o(e,t){for(var r=0;r<j.runLoop[e].length;r++)j.runLoop[e][r].hook==t&&(j.runLoop[e].splice(r,1),r--)}function i(e,t){if(e&&e.length){var r=e[0],n=this.currentRoutes[r.index],o=this.routeInstances[r.index];if(r.state="forced",j.currentPromise=r,"beforeModel"==r.hook&&!ee.get(o,"_dependencies"))return void(this.pending._dependencies=r.index);a(r),c[r.hook].call(this,r.hook,r.index).then(function(t){switch(r.hook){case"model":this.routeInstances[r.index].currentModel=t;break;case"afterModel":n._fetchStatus="completed",void 0!=this.pending.forceFetch&&this.pending.forceFetch==r.index&&j.run()}e.splice(0,1),i.call(this,e)}.bind(this))}}function a(e){var t=e.hook,r=e.index,n="previous"==e.state?O.currentRoutes[r]:j.currentRoutes[r];Lyte.log(t+" of route "+n.routeName,G,"MediumOrchid")}function s(e,t,r){var n=e[t];if(n&&n.length){var o=n[0],u=this.currentRoutes[o.index];this.routeInstances[o.index];if(!this.aborted&&!this.paused){if("beforeModel"==o.hook&&!ee.get(u,"_dependencies"))return void(this.pending._dependencies=o.index);if("renderTemplate"==o.hook&&!ee.get(u,"_resources"))return void(this.pending._resources=o.index);if("redirect"==o.hook&&u.forceFetch&&"pending"==u._fetchStatus)return this.forceFetchRunning||(i.call(this,this.runLoop.forceFetch),this.forceFetchRunning=!0),void(this.pending.forceFetch=o.index);o.state=t,j.currentPromise=o,a(o),Lyte.time(o.hook+o.index),c[o.hook].call(this,o.hook,o.index).then(function(i){Lyte.time(o.hook+o.index),"model"==o.hook&&(this.routeInstances[o.index].currentModel=i),n.splice(0,1),s.call(this,e,t,r)}.bind(this))}}else r&&r()}var u,c={},d=e.bind(this);c.getResources=c.getDependencies=function(e,r){var o={getDependencies:"_dependencies",getResources:"_resources"},i=this.currentRoutes[r],a=i[e],s=this.routeInstances[r],u=t(a,s,d(r));return i[o[e]+"Loaded"]=!a,!a||this.aborted||this.paused||(i[o[e]]=u,m({inst:s,currentRoute:i,req:o[e],index:r})),n()},c.beforeModel=c.model=c.afterModel=function(e,t){return n(this.currentRoutes[t][e],this.routeInstances[t],d(t))},c.afterModel=function(e,t){var r=this.routeInstances[t];return n(this.currentRoutes[t][e],r,r.currentModel,d(t))},F=c.onError=function(e,t,r){var n=j.routeInstances[t];console.error("Error on "+e+" of route "+n.routeName);for(var o,i=j.currentPromise.index;0<=i;i--)j.currentRoutes[i].actions&&(o=j.currentRoutes[i].actions.onError)&&0==o.call(j.routeInstances[i],r,j.routeTrans,d(t),e)&&(i=-1);j.paused&&j.abort()},c.redirect=function(e,t){var r=this.routeInstances[t];return n(this.currentRoutes[t][e],r,r.currentModel,d(t))},c.afterRender=function(e,t){var r=this.routeInstances[t];return r._rendered=!0,n(this.currentRoutes[t][e],r,r.currentModel,d(t),r.component)},c.willTransition=function(e,r){var i=O.currentRoutes[r];return i.actions&&(u=i.actions[e])&&0==t(u,O.routeInstances[r],j.routeTrans)&&o("previous",e),n()},c.didTransition=function(e,r){var i;return this.currentRoutes[r].actions&&(u=this.currentRoutes[r].actions[e])&&0==t(u,this.routeInstances[r],d(r))&&(i=!0,o("current",e)),!i&&r||(c.removeTemplate(j.runLoop.current.removeTemplate),v()),n()},c.beforeExit=function(t,r){var o=O.routeInstances[r];return n(O.currentRoutes[r][t],o,o.currentModel,e.call(O,r))},c.renderTemplate=function(o,i){function a(e,t){t&&("object"!=typeof t||Array.isArray(t)?r(!0,new Error("Data provided for component is not valid.").stack,d):e.setData(t))}function s(e,t){var r;if(t){if(!(r=t.outletName?document.querySelector(t.outletName).querySelector(e):void 0))return s(e,t.parent)}else(r=document.querySelector(e))||console.error("There is no outlet named "+e+".");return r}var u=this.currentRoutes[i],d=this.routeInstances[i];if(j.runLoop.current.removeTemplate&&this.currentRoutes.length==i+1&&c.removeTemplate(j.runLoop.current.removeTemplate),this.currentRoutes[i][o]){var h=t(u[o],d,d.currentModel,e.apply(this,[i]));if(h&&j.runLoop.current.removeTemplate&&c.removeTemplate(j.runLoop.current.removeTemplate),h&&h.outlet){d.outletName=h.outlet;var f,l=d.currentModel;if(f=s(h.outlet,d.parent))if(h.component){var m;d.component&&d.outlet==f&&f.contains(d.component)?((m=d.component)._route=d,d.outlet=f,d.component=m,a(m,l)):(Lyte.triggerEvent("beforeTemplateDestroy",h.outlet,d),f.innerHTML="",(m=document.createElement(h.component))._route=d,d.outlet=f,d.component=m,a(m,l),f.appendChild(m))}else if(h.html){d.component=void 0,d.outlet=f,Lyte.triggerEvent("beforeTemplateDestroy",h.outlet,d),f.innerHTML=h.html;var p=f.getElementsByTagName("script");p.length&&function(e,t){for(var r=0,n=e.length;r<n;r++){for(var o=e[r],i=o.parentNode,a=document.createElement("script"),s=0,u=o.attributes.length;s<u;s++)a.setAttribute(o.attributes[s].name,o.attributes[s].value);a.innerHTML=o.innerHTML,i.appendChild(a),i.removeChild(o)}}(Array.from(p))}}}return n()},c.removeTemplate=function(e){return O&&e&&p(e),delete j.runLoop.current.removeTemplate,W.length&&(W.forEach(function(e){z[e]&&(z[e].tag.remove(),delete z[e])}),W=[]),n()},function(){this.pending={},new Promise(function(e,t){this.runningPromise={resolve:e,reject:t},s.call(this,this.runLoop,"previous",e)}.bind(this)).then(function(){w?(Q.beforeRouteTransition(H&&H.routeTrans||O&&O.routeTrans||void 0,j.routeTrans,w),j.running=!0,w.data=j.routeTrans.data,Z.addToHistory(w),w=void 0):j.routeTrans.data&&Z.addToHistory({data:j.routeTrans.data,type:"replaceState"}),s.call(this,this.runLoop,"current")}.bind(this),function(e){"aborted"!=e&&(console.error(e),console.log("Promise is rejected"))})}.call(this),document.title=this.title=this.routeInstances[this.routeInstances.length-1].title||document.title},r.frameQueryParams=function(e){if(e&&y(e,"=")){var t={},r=y(e,"?")?e.split("?")[1]:e;return(r=y(r,"&")?r.split(/&/g):[r]).forEach(function(e){var r=e.split("=");t[r[0]]=r[1]?decodeURIComponent(r[1]):r[1]}),t}},r.frameDynamicParams=function(e,t){if(e){var r,n=K.routes,o=[],i=b(e.split("?")[0]);return t.route.forEach(function(e,t,s){if((n=f([e],n)).$.wildcard)if(n.$.sufix.length){var u=i.slice(0,i.indexOf(n.$.sufix[0]));o.push(decodeURI(u.join("/"))),a(u.concat(n.$.sufix))}else o.push(decodeURI(i.join("/")));else n.$.dynamicKey?(r=i[n.$.dynamicIndex],a(b(n.$.path)),o.push(decodeURI(r))):(a(b(n.$.path)),o.push(void 0))}),o;function a(e){e.forEach(function(){i.shift()})}}},Q.registerRoute=function(e,t,r){r&&r.mixins&&(Array.isArray(r.mixins)||(r.mixins=[r.mixins]),r.mixins.forEach(function(e){var r=Lyte.registeredMixins[e];if(r)for(var n in r)t[n]=r[n]})),t._objPath=e.replace(/\//g,".");var n=(e=e.split(".")).length-1;t.routeName=e[n],Y.set(e,t)},Q.getRouteInstance=function(e){if(this.instance&&j&&j.routeInstances){if("*"==e)return j.routeInstances;e=e||j.target;var t;return j.routeInstances.every(function(r,n){return(r=j.routeInstances[j.routeInstances.length-1-n])._objPath!=e||(t=r,!1)}),t}},r.initRoute=function(e){var t,r=e.route.length,n=[],o=["getResources","getDependencies","beforeModel","model","afterModel","redirect","renderTemplate","afterRender","beforeExit"];N=function(e,t,r){if(r){for(var i in r)y(["_queryParams","_dynamicParams","_rendered"],i)?this[i]=e[i]:this[i]=r[i];this.component&&(this.component._route=this)}else for(var i in e)y(o,i)||(this[i]=e[i]);this.parent=n[t-1],this.transition=j.routeTrans,this.replaceWith=Q.replaceWith,this.transitionTo=Q.transitionTo,this.refresh=function(){j.abort();var e={currentRoutes:j.currentRoutes,matched:j.matched,refreshRouteFrom:this._objPath};return w={type:"replaceState",data:j.data,title:document.title,fromHistory:!1},c(void 0,e),j.routeTrans},this.setTitle=function(e){document.title=this.title=e},this.getQueryParams=function(){return this._queryParams},this.getDynamicParam=function(){return this._dynamicParams},this.getRouteInstance=function(e){return Q.getRouteInstance(e)},this.setQueryParams=function(e,t,r){var n={},o={};if("object"==typeof e){for(var i in e)n[i]=e[i];r=t}else n[e]=t;if(o.route=Array.from(j.matched.route),o.dynamicParams=Array.from(j.matched.dynamicParams),o.queryParams=Object.assign({},j.matched.queryParams,n),!q(j.matched.queryParams,o.queryParams)){var a=u(o),s=x(o);s.ignore=0==r,w={type:"pushState",data:j.data,url:a,title:document.title,fromHistory:!1},c(a,s)}return j.routeTrans},this.init&&this.init(),"undefined"!=typeof LyteComponent&&(this.throwEvent=LyteComponent.throwEvent)};for(var i=H||O,a=!0,s=0;s<r;s++){if(!(t=Y.get(j.matched._routes[s])))return!1;i&&a&&i.matched&&i.matched.route[s]==e.route[s]?n.push(new N(t,s,i.routeInstances[s])):(n[s]=new N(t,s),a=!1)}return n}}(window);