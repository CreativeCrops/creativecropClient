function ReplaceWith(e){var t=this.parentNode,r=arguments.length,o=+(t&&"object"==typeof e);if(t){for(;r-- >o;)t&&"object"!=typeof arguments[r]&&(arguments[r]=document.createTextNode(arguments[r])),t||!arguments[r].parentNode?t.insertBefore(this.previousSibling,arguments[r]):arguments[r].parentNode.removeChild(arguments[r]);o&&t.replaceChild(this,e)}}[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(e){e.hasOwnProperty("after")||Object.defineProperty(e,"after",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),t=document.createDocumentFragment();e.forEach(function(e){var r=e instanceof Node;t.appendChild(r?e:document.createTextNode(String(e)))}),this.parentNode.insertBefore(t,this.nextSibling)}})}),Element.prototype.replaceWith||(Element.prototype.replaceWith=ReplaceWith),CharacterData.prototype.replaceWith||(CharacterData.prototype.replaceWith=ReplaceWith),DocumentType.prototype.replaceWith||(DocumentType.prototype.replaceWith=ReplaceWith),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-e.length,t)===e});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Lyte={},Lyte.version="1.0.6",Lyte.registeredMixins={},Lyte.Mixin={},Lyte.debug=!1,Lyte.performance=!1,Lyte.toBeRegistered=[];var consoleTime=[];function domContentLoaded1(){var e=Lyte.toBeRegistered;if(e.length){for(var t=0;t<e.length;t++)customElements.define(e[t].name,e[t].def);Lyte.toBeRegistered=[]}}Lyte.Mixin.register=function(e,t){Lyte.registeredMixins[e]=t},Lyte.log=function(e,t){Lyte.debug&&console.log((t?"%c":"")+e,"color:"+t)},Lyte.time=function(e){var t;Lyte.performance&&(-1!=(t=consoleTime.indexOf(e))?(consoleTime.splice(t,1),console.timeEnd(e)):(consoleTime.push(e),console.time(e)))},Lyte.isRecord=function(e){return!!(e&&e.$&&e.$.hasOwnProperty("isModified"))},Lyte.isComponent=function(e){return!!(e&&e.$node&&e.__data)},Lyte.injectResources=function(e,t,r){if(e){var o=-(e=Array.isArray(e)?e:[e]).length;e.forEach(function(e){var n,i=e.split("."),a=i[i.length-1];n=document.createElement({js:"script",css:"link"}[a]),1!=i.length?("css"==a?(n.setAttribute("href",e),n.setAttribute("type","text/css"),n.setAttribute("rel","stylesheet")):n.setAttribute("src",e),n.onerror=n.onload=function(e){o++,t&&t.call(this,e),r&&0==o&&r()},document.head.appendChild(n)):console.error("Type of file is not specified in injectResources.")})}},Lyte.checkProperty=function(e,t,r,o,n){switch(e){case"type":if(Lyte.Transform.hasOwnProperty(o)){if(Array.isArray(t)){if("array"!=Lyte.Transform[o].extends)return{code:"ERR03",message:Lyte.errorCodes.ERR03,expected:o}}else if(Lyte.Transform[o].extends!=(void 0===t?"undefined":_typeof(t)))return{code:"ERR03",message:Lyte.errorCodes.ERR03,expected:o}}else if(Array.isArray(t)){if("array"!=o)return{code:"ERR03",message:Lyte.errorCodes.ERR03,expected:o}}else if(o!=(void 0===t?"undefined":_typeof(t)))return{code:"ERR03",message:Lyte.errorCodes.ERR03,expected:o};break;case"maximum":if("number"==typeof t&&t>o)return{code:"ERR04",message:Lyte.errorCodes.ERR04,expected:o};break;case"minimum":if("number"==typeof t&&t<o)return{code:"ERR05",message:Lyte.errorCodes.ERR05,expected:o};break;case"maxLength":case"maxItems":if(t.length>o)return{code:"ERR06",message:Lyte.errorCodes.ERR06,expected:o};break;case"minLength":case"minItems":if(t.length<o)return{code:"ERR07",message:Lyte.errorCodes.ERR07,expected:o};break;case"pattern":if("string"==typeof t&&!new RegExp(o).test(t))return{code:"ERR08",message:Lyte.errorCodes.ERR08,expected:o};break;case"uniqueItems":if(Array.isArray(t)&&o)for(var i=[],a=0;a<t.length;a++){var s=t[a];if(-1!=i.indexOf(s))return{code:"ERR09",message:Lyte.errorCodes.ERR09};i.push(s)}break;case"constant":if(Array.isArray(t)){if(!(c=t.length==o.length&&t.every(function(e,t){return e===o[t]})))return{code:"ERR10",message:Lyte.errorCodes.ERR10,expected:o}}else if("object"==(void 0===t?"undefined":_typeof(t))){if(!(c=store.adapter.$.compareObjects(t,o)))return{code:"ERR10",message:Lyte.errorCodes.ERR10,expected:o}}else if(t!=o)return{code:"ERR10",message:Lyte.errorCodes.ERR10,expected:o};break;case"items":if(Array.isArray(t))for(a=0;a<t.length;a++)for(var e in o){if(1!=(c=Lyte.checkProperty(e,t[a],a,o[e])))return c}break;case"properties":if("object"==(void 0===t?"undefined":_typeof(t))&&!Array.isArray(t))for(var r in t)for(var e in o){if(1!=(c=Lyte.checkProperty(e,t[r],r,o[e])))return c}break;case"validation":var c;if(1!=(c=Lyte.customValidator[o].apply(n,[r,t])))return c}return!0},Lyte.types=["string","object","number","boolean","array"],Lyte.attr=function(e,t){if(void 0==t&&(t={}),-1==this.types.indexOf(e)&&!Lyte.Transform.hasOwnProperty(e))throw new Error("Not a valid field type - "+e);return t.type=e,t},Lyte.defineRelation=function(e,t,r){var o={type:"relation",relType:t,relatedTo:e};return r&&(o.opts=r),o},Lyte.belongsTo=function(e,t){return this.defineRelation(e,"belongsTo",t)},Lyte.hasMany=function(e,t){return this.defineRelation(e,"hasMany",t)},Lyte.Transform={},Lyte.customValidator={},Lyte.registerDataType=function(e,t){if(this.Transform.hasOwnProperty(e))throw new Error("Custom Field Type - "+e+" -  already exists.");if(void 0==t.extends||-1==Lyte.types.indexOf(t.extends))throw new Error("Not a valid field type - "+t.extends);this.Transform[e]=t},Lyte.registerValidator=function(e,t){if(this.customValidator.hasOwnProperty(e))throw new Error("Custom Validator with name - "+e+" - already exists");this.customValidator[e]=t},Lyte.patterns={email:/([A-Za-z0-9._%\-'+/]+@[A-Za-z0-9.-]+\.[a-zA-Z]{2,22})$|[\s]+/,url:/(^(ht|f)tp(s?):\/\/[0-9a-zA-Z][-.\w]*(:[0-9])*(\/?)([a-zA-Z0-9\-.?,:'/\\+=&amp;%$#_[\]@!()*;~]*)?$)/,ampm:/^(AM|PM|am|pm)$/,hour:/^(0?[0-9]|1[0-9]|2[0-4])$/,minute:/^(0?[0-9]|[1-5][0-9]|60)$/,boolean:/^(true|false|TRUE|FALSE)$/,alphaNumeric:/([a-zA-Z0-9])+/,alphabetsOnly:/([a-zA-Z])+/,numeric:/([0-9])+/,phoneNo:/^[0-9a-zA-Z+.()\-;\s]+$/},Lyte.validate=function(e,t,r,o){var n=o.__data[t],i=!1;for(var a in n)if(!0!==(i=Lyte.checkProperty(a,r,t,n[a],e)))return i;return!1},Lyte.registerPattern=function(e,t){this.patterns[e]=t},Lyte.errorCodes={ERR01:"Primary key cannot be modified",ERR02:"Mandatory field cannot be empty",ERR03:"Type of value does not match the specified data type",ERR04:"Value is greater than the maximum value allowed",ERR05:"Value is less than the minimum value allowed",ERR06:"Length of string/array is greater than the maximum limit allowed",ERR07:"Length of string/array is less than the minimum limit allowed",ERR08:"String does not match the specified pattern",ERR09:"Values in array are not unique",ERR10:"Value is not equal to the specified constant",ERR11:"Model of related field is not defined",ERR12:"Model of backward relation is not defined",ERR13:"Record not found",ERR14:"Model does not match the related field model",ERR15:"Error in creating a record as a relation",ERR16:"Record with primary key already exists",ERR17:"Value cannot be changed because record has been deleted",ERR18:"Action not defined",ERR19:"Model not defined",ERR20:"Key not specified",ERR21:"'belongsTo' relationship expects a single object/id",ERR22:"Type not specified for polymorphic relation",ERR23:"Primary Key value not present",ERR24:"Error while relating record"},Lyte.registeredGlobalEvents={},Lyte.triggerEvent=function(){var e=Array.prototype.slice.call(arguments,1),t=arguments[0],r=!1,o=this.registeredGlobalEvents[t];if(o)for(var n=0;n<o.listeners.length;n++){var i=o.listeners[n];if(i)if(!1===i.apply(this,e)){r=!0;break}}else o=this.registeredGlobalEvents[t]={listeners:[]};var a=new CustomEvent(t,{detail:e});r||document.dispatchEvent(a)},Lyte.addEventListener=function(e,t){if("function"==typeof t){var r=this.registeredGlobalEvents[e];return r||(r=this.registeredGlobalEvents[e]={listeners:[]}),e+"-"+(r.listeners.push(t)-1)}console.error("Second parameter to LyteComponent.addGlobalEventListener() must be a function")},Lyte.removeEventListener=function(e){if(e){var t=e.split("-"),r=this.registeredGlobalEvents[t[0]];r&&r.listeners[t[1]]?r.listeners[t[1]]=null:console.error("No such listener registered")}else console.error("listener unique id not specified")},Lyte.deepCopyObject=function(e){for(var t,r,o,n,i,a,s=[{source:e,target:Object.create(Object.getPrototypeOf(e))}],c=[e],l=s[0].target,d=[l];t=s.shift();)for(r=Object.getOwnPropertyNames(t.source),o=0;o<r.length;o++)(n=Object.getOwnPropertyDescriptor(t.source,r[o])).value&&"object"==_typeof(n.value)?(i=n.value,n.value=Array.isArray(i)?[]:Object.create(Object.getPrototypeOf(i)),-1==(a=c.indexOf(i))?(c.push(i),d.push(n.value),Object.defineProperty(t.target,r[o],n),s.push({source:i,target:n.value})):(n.value=d[a],Object.defineProperty(t.target,r[o],n))):Object.defineProperty(t.target,r[o],n);return l},Lyte.resolvePromises=function(e){if(Array.isArray(e))return function(e){var t=[];return new Promise(function(r,o){Promise.all(e).then(function(o){e.forEach(function(e,r){t[r]=o[r]}),r(t)},function(e){o(e),console.error(e)})})}(e);if("object"==(void 0===e?"undefined":_typeof(e)))return function(e){var t=[],r=[];if(Object.keys(e).forEach(function(o){t.push(o),r.push(e[o])}),r.length){var o={},n=new Promise(function(e,n){Promise.all(r).then(function(r){r.forEach(function(e,r){o[t[r]]=e}),e(o)},function(e){n(e),console.error(e)})});return n}return e}(e)},Lyte.createCustomElement=function(e,t){var r=t.constructor;delete t.constructor,this.defProperty=function(e,t,r){var o={};r.get&&(o.get=r.get),r.set&&(o.set=r.set),Object.defineProperty(e,t,o)};var o=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r&&r.apply(e,Array.from(arguments)),e}return _inherits(t,HTMLElement),t}(),n=t.static;if(n){for(var i in n)"object"===_typeof(n[i])?this.defProperty(o,i,n[i]):Object.defineProperty(o,i,{value:n[i]});delete t.static}for(var i in t)"object"===_typeof(t[i])?this.defProperty(o.prototype,i,t[i]):Object.defineProperty(o.prototype,i,{value:t[i]});t.static=n[i],t.constructor=r,"complete"===document.readyState||"interactive"===document.readyState?customElements.define(e,o):Lyte.toBeRegistered.push({name:e,def:o})},"complete"===document.readyState||"interactive"===document.readyState?domContentLoaded1():document.addEventListener("DOMContentLoaded",function(e){domContentLoaded1()},!0);"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();Lyte.Router={definitions:{}},function e(t){function r(e){return this.routes=e,this.history="html5"==X.history,this.baseURL=X.baseURL,this.deferInit=X.deferInit||!1,this}function n(){var e=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,HTMLElement),_createClass(t,[{key:"attributeChangedCallback",value:function(e,t,r){if(this.hasAttribute("lyte-rendered")&&this._linkCreated){var n=this.children[0];"lt-prop"===e?(this.handleLtProp(),this.hasAttribute("lt-prop-custom")||this.setCustomAttributes(n,!0),this.getMatchedObject(),"A"===n.tagName&&this.constructHref(n)):/^(lt-prop-route|lt-prop-dp|lt-prop-qp)$/.test(e)?(this.getMatchedObject(),"A"===n.tagName&&this.constructHref(n)):this.hasAttribute("lt-prop-custom")||n.setAttribute(e.substring(8),r)}}},{key:"connectedCallback",value:function(){if(this.ltProp=this.ltProp||{},this.hasAttribute("lyte-rendered"))return this._linkCreated=!0,void this.getMatchedObject();this.handleLtProp();var e=void 0;if(this.hasAttribute("lt-prop-custom")||this.ltProp.custom)this.getMatchedObject(),"A"===this.children[0].tagName&&this.constructHref(this.children[0]);else{e=document.createElement("a");for(var t=this.childNodes.length,r=0;r<t;r++)e.appendChild(this.childNodes[0]);this.setCustomAttributes(e),this.getMatchedObject(),this.constructHref(e),this.appendChild(e)}this.setAttribute("lyte-rendered",""),this._linkCreated=!0}},{key:"handleLtProp",value:function(){var e=this.getAttribute("lt-prop");if(e)try{var t=JSON.parse(e);this.ltProp=t}catch(e){console.warn("Error while parsing ltProp in link-to")}}},{key:"setCustomAttributes",value:function(e,t){for(var r in this.ltProp)/^(id|class|style|target)$/.test(r)&&e.setAttribute(r,this.ltProp[r]);if(!t)for(var n=this.attributes,o=0;o<n.length;o++){var i=n[o].nodeName;"lt-prop"!==i&&/^(lt-prop-id|lt-prop-class|lt-prop-style|lt-prop-target)$/.test(i)&&e.setAttribute(i.substring(8),n[o].nodeValue)}}},{key:"constructHref",value:function(e){var t=void 0;if(t=q(this.matched)){var r=u(t);r=K.history?s(r,!0):"#"+r,e.setAttribute("href",r)}}},{key:"getMatchedObject",value:function(){var e=this.matched||{};e.route=this.getAttribute("lt-prop-route")||this.ltProp.route;var t=this.getAttribute("lt-prop-dp")||this.ltProp.dp||[],r=this.getAttribute("lt-prop-qp")||this.ltProp.qp||{};if(t instanceof Array)e.dynamicParams=[];else try{e.dynamicParams=JSON.parse(t)||[]}catch(t){console.error("Error while parsing dynamicParams in link-to."),e.dynamicParams=[]}if(r instanceof Object)e.queryParams={};else try{e.queryParams=JSON.parse(r)}catch(t){console.error("Error while parsing queryParams in link-to."),e.queryParams={}}this.matched=e}}],[{key:"observedAttributes",get:function(){return["lt-prop-route","lt-prop-dp","lt-prop-qp","lt-prop","lt-prop-class","lt-prop-id","lt-prop-rel","lt-prop-title","lt-prop-style","lt-prop-target"]}}]),t}();customElements.define("link-to",e)}function o(e){Lyte.time("parseRouteMapping");var t={},n={},o=[],i=[];return this.route=function(e,a,s){if("object"==(void 0===a?"undefined":_typeof(a)))if(a.path||(a.path=P(e)),y(a.path,"?")){var u=a.path.split("?");a.defQP=r.frameQueryParams(u[1]),a.path=u[0]}else a.queryParams&&(a.defQP=a.queryParams,delete a.queryParams);else"function"==typeof a&&(s=a),a={path:P(e)};if("/"==a.path)n=h(o,B)[a.path]={$:{}},o.push("/");else{var c=a.path;n=h(o,B)[a.path]={$:{}},_(c)||k(c)?b(c).every(function(e,t,r){if(_(e))return a.dynamicKey=n.$.dynamicKey=e.replace(":",""),a.dynamicIndex=n.$.dynamicIndex=t,!1;if(k(e)){a.dynamicKey=n.$.dynamicKey=e.replace("*",""),a.dynamicIndex=n.$.dynamicIndex=t,a.wildcard=n.$.wildcard=!0,a.sufix=n.$.sufix=[];for(var o=t+1;o<r.length;o++)n.$.sufix.push(r[o]);return!1}return!0}):a.dynamicKey=n.$.dynamicKey=void 0,o.push(c)}i.push(e),n.$.route=Array.from(i);var d=t;i.forEach(function(e,t){t+1!=i.length&&(d=d[e])}),d[e]={$:a},s&&s.call(this,{}),i.pop(),o.pop()},e.call(this,{}),Lyte.time("parseRouteMapping"),t}function i(e){if(e){C=S=void 0;var t,r;if("object"==(void 0===e?"undefined":_typeof(e)))if(j){r=j.title;var n=j.runLoop&&j.runLoop.current&&j.runLoop.current[0]&&"redirect"==j.runLoop.current[0].hook;t=n?w(e):u(e)}else t=u(e);else console.warn("Not a valid route transition");if(O={type:e.replace?"replaceState":"pushState",url:t,title:r,fromHistory:!1},Lyte.log("Transitioning to "+t,G),!n){var o;if(!(o=x(e)))return;c(t,o)}return j.routeTrans}console.error("Transition tried without arguments.")}function a(e){return e||Z.addToHistory({type:"replaceState",title:document.title,url:e="/"}),e}function s(e,t){var r=K.baseURL;if(r&&e){if(r=P(K.baseURL),0==e.indexOf(r)&&!t)return e.replace(r,"");if(t&&-1==e.indexOf(r))return r+e}return e}function u(e){if(e){e.route&&!Array.isArray(e.route)&&(e.route=e.route.split("."));var t,r="";return e.route.forEach(function(t,n){var o,i=e.route.slice(0,n+1),a=h(i,K.routes);if(!a)return console.error('There is no url mapped for the route "'+i.join(".")+'".'),!1;var s=a.$.path;if(o=a.$.defQP)for(var u in o)e.queryParams&&!e.queryParams.hasOwnProperty(u)&&(e.queryParams[u]=o[u]);if(a.$.dynamicKey){var c=b(s);if(!e.dynamicParams||!e.dynamicParams[n])return console.error("Dynamic params for the route "+t+" is not defined."),!1;c[a.$.dynamicIndex]=encodeURI(e.dynamicParams[n]),r+=P(c.join("/"))}else r+=P(s)}),r="/"==r[r.length-1]&&1!=r.length?r.slice(0,-1):r,t=Object.keys(e.queryParams).filter(function(t){return void 0!=e.queryParams[t]&&t}),e.queryParams&&t.length&&(r+="?",t.forEach(function(n,o){r+=n+"="+encodeURIComponent(e.queryParams[n])+(o<t.length-1?"&":"")})),T(r)}}function c(e,t){Lyte.time("RouteTransition"),j&&(j.running||M&&j!=M)&&j.abort(),Q.error=!1,t||(t=R(e)),t&&t.matched.route.length&&(Lyte.time("constructRunLoop"),f(t),Lyte.time("constructRunLoop"),t.prevTrans=M,j.runLoop=d(t),setTimeout(function(){O&&j.routeTrans.data&&(O.data=j.routeTrans.data),j.run()},0))}function d(e){function t(e,t){c||(u&&u.currentRoutes&&u.currentRoutes[t]&&u.currentRoutes[t].routeName==e.routeName&&(!d||d[t]==e.routeName)&&void 0!=S&&t>=S?(p.push({hook:"redirect",index:t}),t==S&&["renderTemplate","afterRender"].forEach(function(e){var r={};r.hook=e,r.index=t,p.push(r)})):(v.push({hook:"getResources",index:t}),v.push({hook:"getDependencies",index:t}),i.forEach(function(r){var n={};n.hook=r,n.index=t,e.forceFetch&&!y(["redirect","renderTemplate","afterRender"],r)?(m.push(n),"afterModel"==r&&(e._fetchStatus="pending")):p.push(n)})))}var r,n,o,i=["beforeModel","model","afterModel","redirect","renderTemplate","afterRender"],a=e.currentRoutes,s=e.matched,u=e.decidedTrans||e.prevTrans,c=e.validateTransition,d=e.refreshRouteFrom,f=!0,h=!0,l=!0,p=[],m=[],v=[],g=[],P=[],b=[],T=[],R=s.route.length;if(d&&(d=d.split(".")).pop(),a.forEach(function(i,m){if(u){if(n=u.currentRoutes,(o=n[m])&&h&&o.routeName==i.routeName&&u.routeInstances[m]._rendered&&(!d||d[m]==i.routeName)){var y=function(){t(i,m),h=!1},v=function(){c||(j.routeInstances[m]._rendered=!0,p.push({hook:"redirect",index:m}))};!i._queryParams&&!i._dynamicParams||e.ignore?v():(i._queryParams&&i.queryParams.forEach(function(e){(s.queryParams||u.matched.queryParams)&&s.queryParams[e]!=u.matched.queryParams[e]&&h&&y()}),i._dynamicParams&&s.dynamicParams[m]!=u.matched.dynamicParams[m]&&h&&y(),h&&v())}else if(h=!1,t(i,m),o&&(!f||o.routeName!=i.routeName))if(f=!1,T.push(o),l&&u.routeInstances[m]._rendered){if(r=m,l=!1,c)return m}else if(c)return m;R==m+1&&u.matched.route.length>R&&(l&&u.routeInstances[m+1]._rendered&&(r=void 0==r?m+1:r),T=T.concat(n.slice(m+1)))}else t(i,m);var g=a.length-m-1;b.push({hook:"didTransition",index:g})}),c)return r;if(u){e.decidedTrans&&(T=K.prevTransition.currentRoutes.slice(K.prevTransition.leavingRoutesIndex+1));var x=K.prevTransition.currentRoutes.length;K.prevTransition.currentRoutes.forEach(function(e,t){P.push({hook:"willTransition",index:x-t-1,route:e})}),T.forEach(function(e,t){var r=x-t-1;g.push({hook:"beforeExit",index:r})})}return p={previous:P.concat(g),current:v.concat(p).concat(b),forceFetch:m},p.current.removeTemplate=u&&u.runLoop&&u.runLoop.current&&u.runLoop.current.removeTemplate,void 0!=r&&(p.current.removeTemplate=p.current.removeTemplate||[],p.current.removeTemplate.push({index:r,routeInstances:u.routeInstances})),p}function f(e){K.transition=j=new l(e),j.routeTrans=L(j),j.routeInstances=r.initRoute(e.matched),U?(j.routeTrans.data=U.data,Q.beforeRouteTransition(M&&M.routeTrans||void 0,j.routeTrans,U),j.running=!0,U.data=j.routeTrans.data,U.type="replaceState",Z.addToHistory(U),U=void 0):j.routeTrans.data&&Z.addToHistory({type:"replaceState",data:j.routeTrans.data})}function h(e,t){return e.every(function(e){return t&&t[e]?(t=t[e],!0):t=!1}),t}function l(e){this.matched=e.matched,this.target=e.matched.target,this.info={route:e.matched.target,queryParams:e.matched.queryParams,dynamicParams:e.matched.dynamicParams.filter(g)},this.currentRoutes=e.currentRoutes,this.aborted=this.paused=!1,this.abort=function(){this.aborted||(this.runningPromise&&this.runningPromise.reject("aborted"),"transition"==this.constructor.name&&delete this.runLoop.current.removeTemplate,this.aborted=!0,v(this.currentPromise&&"willTransition"==this.currentPromise.hook))}.bind(this),this.pause=function(){return this.paused=j.currentPromise,this.resume=this.routeTrans.resume=function(e){(e=e||this).runningPromise&&e.runningPromise.reject("aborted"),delete e.routeTrans.resume,delete e.resume;var t=j.paused.state;e.runLoop[t][0].hook==j.paused.hook&&e.runLoop[t][0].index==j.paused.index&&e.runLoop[t].splice(0,1),e.paused=!1,e.run()}.bind(this),this.routeTrans}.bind(this)}function p(e){function t(e,n){function i(){0==++u&&n()}function a(e,t,n){V[e]?V[e].$.push({type:r,index:o,resolve:n}):(V[e]={$:[{type:r,index:o}]},t&&"error"!=t.event.type?(-1!=W.indexOf(e)&&W.splice(W.indexOf(e),1),s.call(t.tag,t.event,!0),n()):Lyte.injectResources([e],s,n))}function s(e,t){var r=this.getAttribute("src")||this.getAttribute("href");t||(z[r]&&z[r].tag.remove(),this.onerror=this.onload=void 0,z[r]={tag:this,event:{type:e.type}}),ee.set(r,e,t)}if(e){Array.isArray(e)||(e=[e]),e.length||n();var u=-e.length;e.forEach(function(e){"string"==typeof e?a(e,z[e],function(){i()}):Array.isArray(e)?new Promise(function(r){t(e,r)}).then(function(){i()}):new Promise(function(r){t(e.parent,r)}).then(function(){new Promise(function(r){t(e.child,r)}).then(function(){i()})})})}else n()}var r=e.req,n=(e.inst,j.currentPromise.hook),o=e.index,i=te(r),a=e.currentRoute;return new Promise(function(e){t(a[r],e)}).then(function(){a[r+"Loaded"]=!0,a[i]&&a[i].length?j.aborted||(j.paused||j.pause(),F(n,o,a[i])):j.pending&&void 0!=j.pending[r]&&j.pending[r]==o&&j.run()})}function m(e){e.forEach(function(e){for(var t,r=e.routeInstances.length-1;r>=e.index;r--)(t=e.routeInstances[r]).outlet&&(t.component&&(t.component._route=void 0),Lyte.triggerEvent("beforeTemplateDestroy",t.outletName,t),t.outlet.innerHTML="")})}function y(e,t){return-1!=e.indexOf(t)}function v(e){j.running&&(Lyte.time("RouteTransition"),V={},j.running=!1,Q.afterRouteTransition(j.routeTrans),t.$lr=Q.getRouteInstance(),Lyte.log("Transition completed.",G)),K.prevTransition=K.transition=e?j=M:M=j}function g(e){return void 0!=e}function P(e){return"/"==e[0]?e:"/"+e}function b(e){return e.match(/[^/?]+/g)||[]}function T(e){return e=e.replace(/\/\//g,"/"),e=e.replace(/\/\?/g,"?")}function R(e,n){function o(e,n,o,i){var a,s,c={};if(c.route=h(n,B).$.route,c.queryParams=i?r.frameQueryParams(i):{},c.dynamicParams=r.frameDynamicParams(o,c),e)return c;var d=x(c);return!Q.error&&(s=Lyte.deepCopyObject(d.matched),a=u(s),I(s.queryParams,c.queryParams)||(U=Z.addToHistory({type:"replaceState",data:t.history.state,title:document.title,url:a,fromHistory:!0})),d)}if(e){var i=[],a=e.split("?"),e=decodeURI(a[0]),s=a[1],c=b(e);if("/"==e){if(!h(["/"],B))return void console.error("url '"+e+"' is not defined in router");i.push([e])}else{var d,f=function(e,t,r,n,o){if(!n.$.wildcard&&!n.$.dynamicKey){var i;if((i=h(o,B).$)&&i.wildcard&&!(r+=t.slice(r).indexOf(e[0])))return!1}for(var a=0;a<e.length;a++,r++)if(e[a]!=t[r]&&!_(e[a]))if(k(e[a]))n.$.sufix.length&&(r=t.indexOf(n.$.sufix[0])-1);else{if("/"!=e[r])return!1;r--}return r},l=0,p=[0],m=[];m.dynamicParams=[],function e(t){for(var r in t)if(!d){var n,o=t[r];if("$"!=r){var a=b(r);if(a&&!1!==(n=f(a,c,l,o,m)))if(p.push(n),l=p[p.length-1],c.length==l){var s=Array.from(m.concat(r));if(o["/"]&&(s=s.concat("/")),i.push(s),!o.$.wildcard)return void(d=s);p.pop(),l=p[p.length-1]}else{var u=Object.keys(o);if(m.push(r),c[l])if(o.$.wildcard&&!o.$.sufix.length&&1==u.length){var h=Array.from(m);o["/"]&&(h=h.concat("/")),i.push(h)}else u.length>1&&e(o);m.pop(),p.pop(),l=p[p.length-1]}}}}(B)}if(d)return o(n,d,e,s);if(1==i.length)return o(n,i[0],e,s);if(i.length){for(var y,v,g=[],P=0;P<i.length;P++)1==i[P].length&&(y=i[P]),g.push(function(e){var t=0;"/"==(e=Array.from(e))[0]&&(t++,e.shift());var r=-1;return e.forEach(function(e,n){b(e).forEach(function(e,n){e==c[++r]&&t++})}),t}(i[P]));if(v=Math.max.apply(Math,g))return o(n,i[g.indexOf(v)],e,s);if(y)return o(n,y,e,s);console.error("url '"+e+"' is not defined in router")}else console.error("url '"+e+"' is not defined in router")}else console.error("path is not valid")}function x(e){var t=Q.definitions,r=K.routes,n=[];return e.target="",e._routes=[],e.route.every(function(o,i){if(e.target=e.target?e.target+"."+o:o,r=h([o],r),!(t=h([o],t))||!t.$)return console.error('There is no route object for the route "'+e.target+'"'),Q.error=!0,!1;o=e.target.split("."),e._routes.push(o);var a=t.$;return a.queryParams&&(a._queryParams={},a.queryParams.forEach(function(t){a._queryParams[t]=void 0!=e.queryParams[t]?e.queryParams[t]:r.defQP&&r.defQP[t]?r.defQP[t]:void 0})),a._dynamicParams=e.dynamicParams[i],n.push(a)}),!Q.error&&{currentRoutes:n,matched:e}}function L(e){return new function(e){var t=["runLoop","paused","currentRoutes","routeInstances","aborted","currentPromise","run","pending"];for(var r in e)-1==t.indexOf(r)&&("info"==r?this.info=deepCopyObject(e[r]):this[r]=e[r])}(e)}function _(e){return!!y(e,":")}function k(e){return!!y(e,"*")}function I(e,t){var r=Object.keys(e),n=Object.keys(t);if(r.length!=n.length)return!1;for(var o in e)if(e[o]!=t[o])return!1;return!0}function A(e){if("object"!=(void 0===e?"undefined":_typeof(e))){var t={};return t.queryParams={},t.dynamicParams=[],Array.from(arguments).forEach(function(e,r){Array.isArray(e)?console.error(JSON.stringify(e)+" is not a valid argument."):0==r?t.route=e:"object"==(void 0===e?"undefined":_typeof(e))?t.queryParams=e:t.dynamicParams.push(e)}),q(t)}if(e.route)return q(e)}function q(e){if(e.route){var t={};t.route=e.route.split("."),t.queryParams=e.queryParams||{},t.dynamicParams=[],t.target="",t._routes=[];var r=e.dynamicParams?Array.from(e.dynamicParams):[];try{t.route.forEach(function(e,n){t.target=t.target?t.target+"."+e:e;var o=t.target.split("."),i=h(t.route.slice(0,n+1),K.routes);if(t._routes.push(o),!i)throw'There is no url mapped for the route "'+t.target+'".';t.dynamicParams.push(i.$.dynamicKey?r.shift():void 0)})}catch(e){return console.error(e),!1}return t}}function E(e,t){var r=t.route.length;return e.route.every(function(e,n){return e==t.route[n]||(r=n-1,!1)}),r}function $(e){if(M&&(e.validateTransition=!0,e.prevTrans=j,H=d(e),delete e.validateTransition,void 0==H||H>=S)){var t=E(e.matched,j.matched);t<E(e.matched,M.matched)&&(S=void 0,j.leavingRoutesIndex=t,e.decidedTrans=M)}}function w(e){var t=j.runLoop.current[0],r=u(e),n=x(e);return S=t.index,$(n),c(r,n),r}t._router=e;var O,j,M,N,C,S,H,D,K,U,F,Q=Lyte.Router,J=document.location,W=[],B={},V={},z={},G="route",X={},Y={get:function(e){var t=Q.definitions;return e.forEach(function(e){t=t[e]}),t&&t.$||void 0},set:function(e,t){var r=Q.definitions,n=e.length-1;e.forEach(function(e,o){n===o?r[e]?r[e].$=t:r[e]={$:t}:r[e]||(r[e]={}),r=r[e]})}},Z={history:!1,init:function(e,r){this.history=r,D||(D=[]),t.onpopstate=function(e){D.forEach(function(t){t(e)})},D.push(e)},addToHistory:function(e){var r;return e.fromHistory=void 0!=e.fromHistory&&e.fromHistory,e.url&&(r=K.history?P(s(e.url,!0)):"#"+P(e.url)),e.title=e.title||document.title,r?t.history[e.type](e.data,e.title,r):t.history[e.type](e.data,e.title),delete e.type,e}};Q.configureDefaults=function(e){X=e||{}},Q.removeFromCache=function(e){e="*"==e?Object.keys(z):Array.isArray(e)?e:[e],W=W.concat(e)},Q.beforeRouteTransition=Q.afterRouteTransition=function(){},Q.configureRoutes=function(e){K=this.instance=new r("function"==typeof e?o.call(this,e):e),t.addEventListener("DOMContentLoaded",function(){!K.deferInit&&Q.init&&(Q.init(),Q.init=void 0)})},Q.init=function(){K.init(),n()},document.addEventListener("click",function(e){if(2!=e.button){for(var t=e.target||e.srcElement;t&&"LINK-TO"!==t.nodeName;)t=t.parentNode;if(t){if("A"===t.children[0].tagName&&(1==e.ctrlKey||1==e.metaKey||2==e.which||t.children[0].hasAttribute("target")&&"_self"!==t.children[0].getAttribute("target")))return;e.preventDefault();var r,n=Lyte.Router.getRouteInstance().transition;r=n&&Q.checkIfSameRoute(t.matched,n.info)&&t.hasAttribute("lt-prop-refresh-route")?Q.getRouteInstance(t.getAttribute("lt-prop-refresh-route")).refresh():Q.transitionTo(t.matched);var o={};if(t.getAttribute("lt-prop-trans"))try{o=JSON.parse("lt-prop-trans")}catch(e){}if(transitionData=t.getAttribute("lt-prop-td"),transitionData=transitionData||o.data,transitionData){if("string"==typeof transitionData)try{transitionData=JSON.parse(transitionData)}catch(e){}o.data=transitionData}for(var i in o)r[i]=o[i]}}},!0),Q.checkIfSameRoute=function(e,t){if(e.route==t.route&&e.dynamicParams.length===e.dynamicParams.length&&I(e.queryParams,t.queryParams)){if(e.dynamicParams.length)for(var r=0;r<=e.dynamicParams.length;r++)return e.dynamicParams[r]==t.dynamicParams[r];return!0}return!1},Q.addRoutes=function(e){Object.assign(this.instance.routes,o.call(this,e))},Q.replaceWith=function(){var e=A.apply(this,arguments);if(e)return e.replace=!0,i(e)},Q.transitionTo=function(){var e;if(e=A.apply(this,arguments))return i(e)},Q.getURL=function(){var e,t;return(t=A.apply(this,arguments))&&(e=u(t)),K.history?s(e,!0):e},Q.getRoute=function(e){var t=R(s(e),!0);return t&&(t.dynamicParams=t.dynamicParams.filter(function(e){return void 0!==e}),t.route=t.route.join(".")),t},r.prototype.init=function(e){var t=this;return this.handler=function(e){var r;r=t.history?Q.getLocation():a((e&&e.newURL||J.hash).replace(/.*#/,"")),U={fromHistory:!0},e&&history.state&&(U.data=history.state),c(r)},Z.init(this.handler,this.history),this.history?Q.getLocation()&&this.handler():(U={fromHistory:!0},c(Q.getLocation())),this},Q.getLocation=function(){if(K.history){var e=a(J.pathname+J.search);return e=s(e),P(e)}return P(a(J.hash.replace(/^(#\/|#|\/)/,"")))};var ee={get:function(e,t){return 0!=e[t+"Loaded"]},set:function(e,t){V[e]&&(V[e].$.forEach(function(e){var r=j.currentRoutes[e.index];if(e.resolve&&e.resolve(),"error"==t.type){var n=te(e.type);r[n]?r[n].push(t):r[n]=[t]}}),delete V[e])}},te=function(e){return"_dependencies"==e?"_errorDependencies":"_errorResources"};l.prototype.run=function(){function e(e,t){return{queryParams:this.currentRoutes[e]._queryParams,dynamicParam:this.currentRoutes[e]._dynamicParams}}function t(e,t){if(e){var n=y(["getResources","getDependencies"],j.currentPromise.hook);try{return e.apply(t,Array.from(arguments).slice(2))}catch(e){return void r(n,e,t)}}}function r(e,t,r){if(j.currentPromise){var n=j.currentPromise.hook,o=j.currentPromise.index;j.currentPromise.state;j.pause(),console.error(t),e?F(n,o,t):(console.error("Error on "+n+" of route "+r.routeName),y(["willTransition","didTransition","beforeExit"],n)?j.resume():j.abort())}}function n(e,t){if(e){var n,o=arguments,i=j.currentPromise.hook,a=y(["beforeModel","model","afterModel"],i);return Promise.resolve(new Promise(function(s,u){try{n=Promise.resolve(e.apply(t,Array.from(o).slice(2)))}catch(e){return void r(a,e,t)}n.then(function(e){s(e)},function(e){console.error(e),"model"==i&&(t.currentModel=e),r(a,e,t)})}))}return Promise.resolve()}function o(e,t){for(var r=0;r<j.runLoop[e].length;r++)j.runLoop[e][r].hook==t&&(j.runLoop[e].splice(r,1),r--)}function i(e,t){if(e&&e.length){var r=e[0],n=this.currentRoutes[r.index],o=this.routeInstances[r.index];if(r.state="forced",j.currentPromise=r,"beforeModel"==r.hook&&!ee.get(o,"_dependencies"))return void(this.pending._dependencies=r.index);a(r),c[r.hook].call(this,r.hook,r.index).then(function(t){switch(r.hook){case"model":this.routeInstances[r.index].currentModel=t;break;case"afterModel":n._fetchStatus="completed",void 0!=this.pending.forceFetch&&this.pending.forceFetch==r.index&&j.run()}e.splice(0,1),i.call(this,e)}.bind(this))}}function a(e){var t=e.hook,r=e.index,n="previous"==e.state?M.currentRoutes[r]:j.currentRoutes[r];Lyte.log(t+" of route "+n.routeName,G,"MediumOrchid")}function s(e,t,r){var n=e[t];if(n&&n.length){var o=n[0],u=this.currentRoutes[o.index];this.routeInstances[o.index];if(!this.aborted&&!this.paused){if("beforeModel"==o.hook&&!ee.get(u,"_dependencies"))return void(this.pending._dependencies=o.index);if("renderTemplate"==o.hook&&!ee.get(u,"_resources"))return void(this.pending._resources=o.index);if("redirect"==o.hook&&u.forceFetch&&"pending"==u._fetchStatus)return this.forceFetchRunning||(i.call(this,this.runLoop.forceFetch),this.forceFetchRunning=!0),void(this.pending.forceFetch=o.index);o.state=t,j.currentPromise=o,a(o),Lyte.time(o.hook+o.index),c[o.hook].call(this,o.hook,o.index).then(function(i){Lyte.time(o.hook+o.index),"model"==o.hook&&(this.routeInstances[o.index].currentModel=i),n.splice(0,1),s.call(this,e,t,r)}.bind(this))}}else r&&r()}var u,c={},d=e.bind(this);c.getResources=c.getDependencies=function(e,r){var o={getDependencies:"_dependencies",getResources:"_resources"},i=this.currentRoutes[r],a=i[e],s=this.routeInstances[r],u=t(a,s,d(r));return i[o[e]+"Loaded"]=!a,!a||this.aborted||this.paused||(i[o[e]]=u,p({inst:s,currentRoute:i,req:o[e],index:r})),n()},c.beforeModel=c.model=c.afterModel=function(e,t){return n(this.currentRoutes[t][e],this.routeInstances[t],d(t))},c.afterModel=function(e,t){var r=this.routeInstances[t];return n(this.currentRoutes[t][e],r,r.currentModel,d(t))},F=c.onError=function(e,t,r){var n=j.routeInstances[t];console.error("Error on "+e+" of route "+n.routeName);for(var o,i=j.currentPromise.index;0<=i;i--)j.currentRoutes[i].actions&&(o=j.currentRoutes[i].actions.onError)&&0==o.call(j.routeInstances[i],r,j.routeTrans,d(t),e)&&(i=-1);j.paused&&j.abort()},c.redirect=function(e,t){var r=this.routeInstances[t];return n(this.currentRoutes[t][e],r,r.currentModel,d(t))},c.afterRender=function(e,t){var r=this.routeInstances[t];return r._rendered=!0,n(this.currentRoutes[t][e],r,r.currentModel,d(t),r.component)},c.willTransition=function(e,r){var i=M.currentRoutes[r];return i.actions&&(u=i.actions[e])&&0==t(u,M.routeInstances[r],j.routeTrans)&&o("previous",e),n()},c.didTransition=function(e,r){var i;return this.currentRoutes[r].actions&&(u=this.currentRoutes[r].actions[e])&&0==t(u,this.routeInstances[r],d(r))&&(i=!0,o("current",e)),!i&&r||(c.removeTemplate(j.runLoop.current.removeTemplate),v()),n()},c.beforeExit=function(t,r){var o=M.routeInstances[r];return n(M.currentRoutes[r][t],o,o.currentModel,e.call(M,r))},c.renderTemplate=function(o,i){function a(e,t){t&&("object"!=(void 0===t?"undefined":_typeof(t))||Array.isArray(t)?r(!0,new Error("Data provided for component is not valid.").stack,d):e.setData(t))}function s(e,t){var r;if(t){if(!(r=t.outletName?document.querySelector(t.outletName).querySelector(e):void 0))return s(e,t.parent)}else(r=document.querySelector(e))||console.error("There is no outlet named "+e+".");return r}var u=this.currentRoutes[i],d=this.routeInstances[i];if(j.runLoop.current.removeTemplate&&this.currentRoutes.length==i+1&&c.removeTemplate(j.runLoop.current.removeTemplate),this.currentRoutes[i][o]){var f=t(u[o],d,d.currentModel,e.apply(this,[i]));if(f&&j.runLoop.current.removeTemplate&&c.removeTemplate(j.runLoop.current.removeTemplate),f&&f.outlet){d.outletName=f.outlet;var h,l=d.currentModel;if(h=s(f.outlet,d.parent))if(f.component){var p;d.component&&d.outlet==h&&h.contains(d.component)?((p=d.component)._route=d,d.outlet=h,d.component=p,a(p,l)):(Lyte.triggerEvent("beforeTemplateDestroy",f.outlet,d),h.innerHTML="",(p=document.createElement(f.component))._route=d,d.outlet=h,d.component=p,a(p,l),h.appendChild(p))}else if(f.html){d.component=void 0,d.outlet=h,Lyte.triggerEvent("beforeTemplateDestroy",f.outlet,d),h.innerHTML=f.html;var m=h.getElementsByTagName("script");m.length&&function(e,t){for(var r=0,n=e.length;r<n;r++){for(var o=e[r],i=o.parentNode,a=document.createElement("script"),s=0,u=o.attributes.length;s<u;s++)a.setAttribute(o.attributes[s].name,o.attributes[s].value);a.innerHTML=o.innerHTML,i.appendChild(a),i.removeChild(o)}}(Array.from(m))}}}return n()},c.removeTemplate=function(e){return M&&e&&m(e),delete j.runLoop.current.removeTemplate,W.length&&(W.forEach(function(e){z[e]&&(z[e].tag.remove(),delete z[e])}),W=[]),n()},function(){this.pending={},new Promise(function(e,t){this.runningPromise={resolve:e,reject:t},s.call(this,this.runLoop,"previous",e)}.bind(this)).then(function(){O?(Q.beforeRouteTransition(C&&C.routeTrans||M&&M.routeTrans||void 0,j.routeTrans,O),j.running=!0,O.data=j.routeTrans.data,Z.addToHistory(O),O=void 0):j.routeTrans.data&&Z.addToHistory({data:j.routeTrans.data,type:"replaceState"}),s.call(this,this.runLoop,"current")}.bind(this),function(e){"aborted"!=e&&(console.error(e),console.log("Promise is rejected"))})}.call(this),document.title=this.title=this.routeInstances[this.routeInstances.length-1].title||document.title},r.frameQueryParams=function(e){if(e&&y(e,"=")){var t={},r=y(e,"?")?e.split("?")[1]:e;return(r=y(r,"&")?r.split(/&/g):[r]).forEach(function(e){var r=e.split("=");t[r[0]]=r[1]?decodeURIComponent(r[1]):r[1]}),t}},r.frameDynamicParams=function(e,t){if(e){var r,n=function(e){e.forEach(function(){a.shift()})},o=K.routes,i=[],a=b(e.split("?")[0]);return t.route.forEach(function(e,t,s){if((o=h([e],o)).$.wildcard)if(o.$.sufix.length){var u=a.slice(0,a.indexOf(o.$.sufix[0]));i.push(decodeURI(u.join("/"))),n(u.concat(o.$.sufix))}else i.push(decodeURI(a.join("/")));else o.$.dynamicKey?(r=a[o.$.dynamicIndex],n(b(o.$.path)),i.push(decodeURI(r))):(n(b(o.$.path)),i.push(void 0))}),i}},Q.registerRoute=function(e,t,r){r&&r.mixins&&(Array.isArray(r.mixins)||(r.mixins=[r.mixins]),r.mixins.forEach(function(e){var r=Lyte.registeredMixins[e];if(r)for(var n in r)t[n]=r[n]})),t._objPath=e.replace(/\//g,".");var n=(e=e.split(".")).length-1;t.routeName=e[n],Y.set(e,t)},Q.getRouteInstance=function(e){if(this.instance&&j&&j.routeInstances){if("*"==e)return j.routeInstances;e=e||j.target;var t;return j.routeInstances.every(function(r,n){return(r=j.routeInstances[j.routeInstances.length-1-n])._objPath!=e||(t=r,!1)}),t}},r.initRoute=function(e){var t,r=e.route.length,n=[],o=["getResources","getDependencies","beforeModel","model","afterModel","redirect","renderTemplate","afterRender","beforeExit"];N=function(e,t,r){if(r){for(var i in r)y(["_queryParams","_dynamicParams","_rendered"],i)?this[i]=e[i]:this[i]=r[i];this.component&&(this.component._route=this)}else for(var i in e)y(o,i)||(this[i]=e[i]);this.parent=n[t-1],this.transition=j.routeTrans,this.replaceWith=Q.replaceWith,this.transitionTo=Q.transitionTo,this.refresh=function(){j.abort();var e={currentRoutes:j.currentRoutes,matched:j.matched,refreshRouteFrom:this._objPath};return O={type:"replaceState",data:j.data,title:document.title,fromHistory:!1},c(void 0,e),j.routeTrans},this.setTitle=function(e){document.title=this.title=e},this.getQueryParams=function(){return this._queryParams},this.getDynamicParam=function(){return this._dynamicParams},this.getRouteInstance=function(e){return Q.getRouteInstance(e)},this.setQueryParams=function(e,t,r){var n={},o={};if("object"==(void 0===e?"undefined":_typeof(e))){for(var i in e)n[i]=e[i];r=t}else n[e]=t;if(o.route=Array.from(j.matched.route),o.dynamicParams=Array.from(j.matched.dynamicParams),o.queryParams=Object.assign({},j.matched.queryParams,n),!I(j.matched.queryParams,o.queryParams)){var a=u(o),s=x(o);s.ignore=0==r,O={type:"pushState",data:j.data,url:a,title:document.title,fromHistory:!1},c(a,s)}return j.routeTrans},this.init&&this.init(),"undefined"!=typeof LyteComponent&&(this.throwEvent=LyteComponent.throwEvent)};for(var i=C||M,a=!0,s=0;s<r;s++){if(!(t=Y.get(j.matched._routes[s])))return!1;i&&a&&i.matched&&i.matched.route[s]==e.route[s]?n.push(new N(t,s,i.routeInstances[s])):(n[s]=new N(t,s),a=!1)}return n}}(window);
function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function noop(){}function onDomContentForLyte(){window.isIE11Lyte||(document.body.appendChild(LyteComponent.lyteComponentsDiv),LyteComponent.needDummyComponentsDiv?document.body.appendChild(LyteComponent.dummyLyteComponentsDiv):(LyteComponent.dummyLyteComponentsDiv.remove(),LyteComponent.dummyLyteComponentsDiv=void 0)),document.head.appendChild(LyteComponent.styleDiv);for(var e=["focus","focusin","focusout","resize","scroll","click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave","change","select","submit","keydown","keypress","keyup","contextmenu"],t=0;t<e.length;t++){var n=e[t];document.body.addEventListener(n,globalEventHandler,!0)}var o=LyteComponent.toBeRegistered;if(o.length){for(var r=0;r<o.length;r++)customElements.define(o[r].name,o[r].def);LyteComponent.toBeRegistered=[]}}function getMustache(e){if(e=e&&"string"==typeof e?e.trim():e,/^{{(?=[\s]*[\w-_]+)/.test(e)){var t=e.match(/{{[a-zA-Z0-9_.[\]()]*(?![\\])}}/g);if(t&&t.length>1)return;if(!this.syntaxCheck(e)||!/{{[^}]*?(?:(?:('|")[^\1]*?\1)[^}]*?)*}}$/.test(e))return;var n=e.match(/[\w!@#$%^&*)(+=.,_-]+[\s]*[(]{0,1}(?:"([^"]|\\")*?"|'([^']|\\')*?'|[\w\s!@#$%^&*)([\]+=.,_-]*?)*?[)]{0,1}[\s]*(?=}})/g);if(n&&n.length>1)return;return n=n?n[0].trim():n}}function getHelper(e){var t=/\((?:[^)]*|(?:(?:"(?:[^"\\]|\\.)*?")|(?:'([^'\\]|\\.)*?')|[\w\s!@#$%^&*)([\]+=.,_-]*?)*?)\)$/.exec(e);if(t)return getHelperInfo(e,t)}function getHelperInfo(e,t){var n={};n.name=e.substr(0,t.index).replace(/\s/g,"");var o=getHelperArgs((t=t?t[0].trim():t).substr(1,t.length-2));return!1!==o&&(n.args=o,n)}function getHelperArgs(e){for(var t=[],n=[],o=0,r=void 0,i=0;i<e.length;i++)if(t.length||","!==e.charAt(i))"("===e.charAt(i)?"'"==r&&'"'==r||(t.push(e.charAt(i)),r=e.charAt(i)):")"===e.charAt(i)?"("===t[t.length-1]&&t.pop():"'"===e.charAt(i)&&"\\"!==e.charAt(i-1)?"'"===t[t.length-1]?t.pop():'"'!==t[t.length-1]&&(t.push(e.charAt(i)),r=e.charAt(i)):'"'===e.charAt(i)&&"\\"!==e.charAt(i-1)&&('"'===t[t.length-1]?t.pop():"'"!==t[t.length-1]&&(t.push(e.charAt(i)),r=e.charAt(i)));else{var a=e.substr(o,i-o);(a=a.trim())&&a.startsWith('"')&&a.endsWith('"')&&(a="'"+(a=a.slice(1,-1))+"'"),a=getHelperArgValue(a),n.push(a),o=i+1}var s=e.substr(o,e.length-o);return(s=s.trim())&&s.startsWith('"')&&s.endsWith('"')&&(s="'"+(s=s.slice(1,-1))+"'"),s=getHelperArgValue(s),n.push(s),n}function syntaxCheck(e){for(var t,n=[],o=0;o<e.length;o++)"'"===e[o]?"'"===t&&"\\"!==e[o-1]?(n.pop(),t=void 0):n.length||(t=e[o],n.push(t)):'"'===e[o]&&('"'===t&&"\\"!==e[o-1]?(n.pop(),t=void 0):n.length||(t=e[o],n.push(t)));return!n.length}function doCompile(e,t,n){for(var o=0;o<t.length;o++){var r=t[o],i=r.type,a=r.position,s=this.getDynamicNode(e,a);switch(i){case"text":var l=this.getMustache(s.nodeValue),p=void 0;l&&(p=this.getHelper(l));var c=this.getMustache(s.nodeValue);p?r.helperInfo=p:c&&(r.dynamicValue=c);break;case"attr":for(var d=[],m=[],u=s,f=r.attr=r.attr||{},h=0;h<u.attributes.length;h++)if(-1!==u.attributes[h].nodeValue.indexOf("{{")){var y=u.attributes[h].nodeValue,_=this.getMustache(y),v=void 0;if(_?v=this.getHelper(_):/{{.*}}/.test(y)&&!/\\{{.*}}/.test(y)&&(v=this.splitMixedText(y)),v&&("action"===v.name||"method"===v.name)&&/^(onfocus|onfocusin|onfocusout|onresize|onscroll|onclick|ondblclick|onmousedown|onmouseup|onmousemove|onmouseover|onmouseout|onmouseenter|onmouseleave|onchange|onselect|onsubmit|onkeydown|onkeypress|onkeyup|oncontextmenu)$/.test(u.attributes[h].name)){f[u.attributes[h].name.substr(2)]={name:u.attributes[h].name.substr(2),helperInfo:v,globalEvent:!0};var g=deepCopyObject(v.args),b=g.splice(0,1)[0];b=b.startsWith("'")?b.replace(/'/g,""):b;var C=this.getArgString(b,g);u.setAttribute(u.attributes[h].name.substr(2),n+" => "+C),d.push(u.attributes[h].name)}else if(v||_){var L={};u.attributes[h].name.startsWith("lbind:")?(d.push(u.attributes[h].name),m.push({name:u.attributes[h].name.substring(6),value:u.attributes[h].nodeValue}),L.isLbind=!0,L.name=u.attributes[h].name.substring(6)):L.name=u.attributes[h].name,v?"lbind"===v.name?(L.dynamicValue=v.args[0],L.isLbind=!0):L.helperInfo=v:L.dynamicValue=_,!0,f[L.name]=L}}if(d.length)for(var w=0;w<d.length;w++)u.removeAttribute(d[w]);if(m.length)for(var A=0;A<m.length;A++)u.setAttribute(m[A].name,m[A].value);break;case"for":case"forIn":case"component":case"registerYield":doCompile(window.isIE11Lyte?s:s.content,r.dynamicNodes,n),(window.isIE11Lyte||window.isEdgeLyte)&&(r.templateContent=s.outerHTML,s.innerHTML="");break;case"if":case"switch":var N="default";if(window.isIE11Lyte||window.isEdgeLyte){for(var x,E={},S=window.isEdgeLyte?s.content.childNodes:s.childNodes,P=0;P<S.length;P++)"TEMPLATE"===S[P].tagName&&(S[P].getAttribute("case")?E[S[P].getAttribute("case")]=S[P]:S[P].hasAttribute("default")&&(x=S[P]));for(var I in r.cases)doCompile(E[I],r.cases[I].dynamicNodes,n),E[I].remove(),r.cases[I].templateContent=E[I].outerHTML;r[N].dynamicNodes&&(doCompile(x,r[N].dynamicNodes,n),x.remove(),r[N].templateContent=x.outerHTML)}else{for(var k in r.cases)doCompile(s.content.querySelector("[case='"+k+"']").content,r.cases[k].dynamicNodes,n);r[N].dynamicNodes&&doCompile(s.content.querySelector("[default]").content,r[N].dynamicNodes,n)}}}}function getDynamicNode(e,t){for(var n=e,o=0;o<t.length;o++)n="TEMPLATE"!=n.tagName||window.isIE11Lyte?n.childNodes[t[o]]:n.content.childNodes[t[o]];return n}function splitMixedText(e){for(var t=[],n=0,o={name:"concat",args:[]},r=0;r<e.length;r++){var i=r;if("\\"!==e[r-1]&&"{"===e[r]&&"{"===e[++r])t.push("{{"),o.args.push("'"+e.substr(n,i-n)+"'"),n=r+1;else if("}"===e[r]&&"}"===e[++r]&&t.length){t.pop(n);var a=e.substr(n,i-n),s=this.getHelper(a);s?(a=s,o.args.push({type:"helper",value:a})):o.args.push(a),n=r+1}}return n<e.length&&o.args.push("'"+e.substr(n,e.length-n)+"'"),o}function getHelperArgValue(e){switch(e){case"undefined":return;case"true":return!0;case"false":return!1;case"null":return null;case"":return;default:return e&&e.startsWith("'")&&e.endsWith("'")?e:/\([\w\s,')(]*/.test(e)?{type:"helper",value:getHelper(e)}:isNaN(e)?e:parseInt(e)}}function deepCopyObject(e){for(var t,n,o,r,i,a,s=[{source:e,target:Object.create(Object.getPrototypeOf(e))}],l=[e],p=s[0].target,c=[p];t=s.shift();)for(n=Object.getOwnPropertyNames(t.source),o=0;o<n.length;o++)(r=Object.getOwnPropertyDescriptor(t.source,n[o])).value&&"object"==_typeof(r.value)?(i=r.value,r.value=Array.isArray(i)?[]:Object.create(Object.getPrototypeOf(i)),-1==(a=l.indexOf(i))?(l.push(i),c.push(r.value),Object.defineProperty(t.target,n[o],r),s.push({source:i,target:r.value})):(r.value=c[a],Object.defineProperty(t.target,n[o],r))):Object.defineProperty(t.target,n[o],r);return p}function getArgString(e,t){for(var n=0;n<t.length;n++)"object"===_typeof(t[n])&&(t[n]=this.getArgString(t[n].value.name,t[n].value.args));return e?e+"("+t.toString()+")":t.toString()}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};if(window.Lyte||console.error("Lyte is not defined"),window.isIE11Lyte=!1,window.isEdgeLyte=!1,window.replaceWithNeeded=!1,navigator.userAgent.match(/rv:11/)&&(window.isIE11Lyte=!0,window.action=function(){}),navigator.userAgent.match("Edge")&&(window.isEdgeLyte=!0),window.isIE11Lyte||window.isEdgeLyte){var doc=document.createDocumentFragment();doc.appendChild(document.createTextNode("  dummy ")),doc.childNodes[0].replaceWith(document.createTextNode("changed")),"changed"!==doc.childNodes[0].textContent&&(window.replaceWithNeeded=!0)}Lyte.Component={},Lyte.arrayUtils=function(){return LyteComponent.arrayFunctions.apply(LyteComponent,arguments)},Lyte.objectUtils=function(){return LyteComponent.objectFunctions.apply(LyteComponent,arguments)},Lyte.Component.register=function(){LyteComponent.registerComponent.apply(LyteComponent,arguments)},Lyte.Component.registerHelper=function(){LyteComponent.registerHelper.apply(LyteComponent,arguments)},Lyte.Component.set=function(){LyteComponent.set.apply(LyteComponent,arguments)},Lyte.Component.registeredHelpers={},Lyte.Component.registeredComponents={},Lyte.Component.registerCustomPropHandler=function(e){LyteComponent.String.dasherize(e);e=LyteComponent.String.toCamelCase(e),-1===LyteComponent.customPropHandlers.indexOf(e)&&(LyteComponent.customPropHandlers.push(e),customElementPrototype.prototype[e]=function(){var t=arguments.length,n=arguments[0];if(!n){var o={};for(var r in this.component.data)if(r.startsWith(e)){var i=r.substring(e.length);o[i=LyteComponent.String.lowerCaseFirstLetter(i)]=this.component.data[r]}return o}if("string"==typeof n){if(!(t>1)){var a=e+LyteComponent.String.upperCaseFirstLetter(n);return this.component.data[a]}this.set(e+LyteComponent.String.upperCaseFirstLetter(n),arguments[1])}else if("object"===(void 0===n?"undefined":_typeof(n)))for(var s in n){var l=e+LyteComponent.String.upperCaseFirstLetter(s);this.set(l,n[s])}},LyteComponent.customPropRegex=new RegExp("^("+LyteComponent.customPropHandlers.join("|")+")"))},Lyte.Component.unregisterComponent=function(e){if(Lyte.Component.registeredComponents[e]){var t=LyteComponent._registeredComponents[e];t.activeInstances>0?console.warn("There are active instances of the component "+e+" and hence cannot be unregistered"):(t._properties={},t.component=null,t._mixins=null,t._actions=null,t._template=null,t._dynamicNodes=null,t._callBacks={},t._observers=[],t._data=void 0,t._methods={},t.prototype.get=noop,t.prototype.set=noop,delete Lyte.Component.registeredComponents[e])}else console.warn("Component "+e+" not yet registered")};var elementPrototype="undefined"!=typeof HTMLElement?HTMLElement:Element;document.addEventListener("change",function(e){var t=e.target||e.srcElement;if(t._attributeDetails){var n="value";"checkbox"!==t.type&&"radio"!==t.type||(n="checked");var o=[],r=t._attributeDetails[n];if(r&&r.isLbind){var i=t;if(!t._callee){for(;i&&!LyteComponent.isCustomElement(i)&&"LYTE-YIELD"!==i.tagName;){if("BODY"===i.tagName){i=null;break}i=i.parentNode}i&&"LYTE-YIELD"===i.tagName?t._callee=i._callee._callee:t._callee=i}var a=t._callee;t&&LyteComponent.newAddContext(t,o);var s=LyteComponent.getNew(a.component.data,r.dynamicValue);LyteComponent.set(s.context,s.lastKey,t[n]),t&&LyteComponent.newRemoveContext(t,o)}}});var globalEventHandler=function(e){var t,n=e.type,o=e.target;for(window.event||(t=!0,window.event=e);o.getAttribute&&!o.getAttribute(n)&&"BODY"!=o.tagName;)o=o.parentNode;var r=o;if(!o._callee){for(;r&&!LyteComponent.isCustomElement(r)&&"LYTE-YIELD"!==r.tagName;){if("BODY"===r.tagName){r=null;break}r=r.parentNode}r&&"LYTE-YIELD"===r.tagName?o._callee=r._callee._callee:o._callee=r===o?void 0:r}if(o._evBoundEvents&&o._evBoundEvents[n]){o._callee?o._callee.constructor._actions:o.constructor._actions;var i=o._evBoundEvents[n],a=Lyte.deepCopyObject(i);a.args.shift(),LyteComponent.throwAction.call(o,o,n,a,void 0,void 0,o,e)}else if(o.getAttribute(n)){o._callee.constructor._actions,o.getAttribute(n).split(" => ")[1];var s=o._boundEvents[n],l=Lyte.deepCopyObject(s);l.args.shift(),LyteComponent.throwAction.call(o._callee,o._callee,n,l,void 0,void 0,o,e)}if("LABEL"===o.tagName){var p=o.querySelector("input");if(p.getAttribute(n)){o._callee.constructor._actions,p.getAttribute(n).split(" => ")[1];var c=o._boundEvents[n],d=Array.from(c.args),m=Object.assign({},c);d.shift(),m.args=d,LyteComponent.throwAction.call(o._callee,o._callee,n,m,void 0,void 0,p,e)}}t&&(window.event=void 0)},LyteYield=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,HTMLElement),_createClass(t,[{key:"disconnectedCallback",value:function(){if(!LyteComponent.ignoreDisconnect){var e=[];LyteComponent.newAddContext(this,e),LyteComponent.removeSelectedBindingDeep(this._properties,this.component.data);var t=this._registerYield;if(t){var n=[];LyteComponent.newAddContext(t,n);for(var o in this._dynamicProperty)this._dynamicProperty[o].isActualNode?this._dynamicProperty[o].isActualNode._helperNodes.delete(this):t._callee.getProperty(o)._helperNodes&&t._callee.getProperty(o)._helperNodes.delete(this);this._dynamicProperty={};for(var r=0;r<this._helpers.length;r++)t._callee.removeHelpers(this._helpers[r]);this._helpers=[],LyteComponent.newRemoveContext(t,n),LyteComponent.newRemoveContext(this,e)}}}},{key:"getProperty",value:function(e){var t=e.split("."),n=this;n._properties[t[0]]||(n._properties[t[0]]={}),n=n._properties[t[0]],Object.defineProperty(n,"_path",{enumerable:!1,value:t[0]});for(var o=1;o<t.length;o++)n[t[o]]||(n[t[o]]={},Object.defineProperty(n[t[o]],"_path",{enumerable:!1,value:n._path+"."+t[o]})),n=n[t[o]];return n}}]),t}();customElements.define("lyte-yield",LyteYield);var customElementPrototype=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(!Lyte.Component.registeredComponents[e.localName])return _possibleConstructorReturn(e);e.constructor.activeInstances++,e.component=new e.constructor.component,e.data={},e._properties={},e.component.methods={},e.component.data={};var n=e.constructor._data?e.constructor._data():{};for(var o in n)e.component.data[o]=n[o].default;e.component.data.errors={},e.component.__data=n;for(var r in e.constructor._methods)e.component.methods[r]=e.constructor._methods[r];return Object.defineProperty(e.component.data,"__component__",{value:e,configurable:!0,writable:!0,enumerable:!1}),e.component.$node=e,e.callback("constructor"),e._actions=e._actions?e._actions:{},e._callee=e._callee||e.getCallee(e.parentNode),e}return _inherits(t,elementPrototype),_createClass(t,[{key:"getMethods",value:function(e){return this.component.getMethods(e)}},{key:"setMethods",value:function(e,t){return this.component.setMethods(e,t)}},{key:"getData",value:function(e){return this.component.getData(e)}},{key:"setData",value:function(e,t){return this.component.setData(e,t)}},{key:"getCallee",value:function(e){for(;e&&!LyteComponent.isCustomElement(e)&&"LYTE-YIELD"!==e.tagName;){if("BODY"===e.tagName){e=null;break}e=e.parentNode}return e&&"LYTE-YIELD"===e.tagName?e._callee._callee:this===e?void 0:e}},{key:"afterConnected",value:function(){for(var e=this.constructor._observedAttributes,t=0;t<e.length;t++){var n=e[t],o=this.getProperty(n);Object.defineProperty(o,"__fromComponent",{value:!0,enumerable:!1})}if(this.getProperty("errors"),this._initProperties){var r=this._initProperties;for(var i in r)if(this.component.__data[i]&&"string"==typeof r[i]&&"string"!==this.component.__data[i].type){var a={newValue:r[i],dataType:this.component.__data[i].type,attr:i,tagName:this.tagName};LyteComponent.getProperData(a)&&(this.component.data[i]=a.newValue)}else this.component.data[i]=r[i];this._initProperties=void 0}if(this._initMethods){var s=this._initMethods;for(var l in s)this.component.methods[l]=s[l];this._initMethods=void 0}this.callback("init"),this.onCallBack("init"),this.registerYields();return this.renderNodes(this.constructor._template.content,this.constructor._dynamicNodes,void 0,void 0,void 0,void 0,this.constructor._templateContent)}},{key:"getDynamicNode",value:function(e,t){for(var n=e,o=0;o<t.length;o++)n="TEMPLATE"!=n.tagName||window.isIE11Lyte?n.childNodes[t[o]]:n.content.childNodes[t[o]];return n}},{key:"renderNodes",value:function(e,t,n,o,r,i,a){o=o||{};var s=void 0;if(window.isIE11Lyte||window.isEdgeLyte){var l=document.createElement("div");l.innerHTML=a,s=l.childNodes[0],window.timer++,this.constructor.splitTextNodes(s)}else s=e.cloneNode(!0,"lyte");for(var p=[],c=[],d=void 0,m=0;m<t.length;m++){var u=t[m],f=u.type,h=u.position,y=s;if(y=this.getDynamicNode(y,h),"componentDynamic"===f)o.node?y._contextSwitchInfo=o:n&&(y._contextSwitchInfo=n._contextSwitchInfo);else if("text"===f)this.bindNode(y,void 0,n,o,t[m],c,r);else if("attr"===f){if(y._attributeDetails=u.attr,"LYTE-YIELD"===y.nodeName){y._callee=this,y.component={},y.component.data={},Object.defineProperty(y.component.data,"__component__",{value:y,configurable:!0,writable:!0,enumerable:!1}),y._properties={};for(var _=0;_<y.attributes.length;_++){var v=y.attributes[_];"is"!==v.nodeName&&"yield-name"!==v.nodeName&&(y._properties[LyteComponent.String.toCamelCase(v.nodeName)]={})}}var g=[];for(var b in u.attr){var C=u.attr[b],L=b;if(C&&(C.dynamicValue||C.helperInfo))if(o.node?y._contextSwitchInfo=o:n&&(y._contextSwitchInfo=n._contextSwitchInfo),C.globalEvent){y._boundEvents=y._boundEvents||{};var w=C.helperInfo.args[0],A=void 0;w.startsWith('"')||w.startsWith("'")?A=w.substring(1,w.length-1):(console.warn("Deprecation warning. Action name "+w+" must be in quotes"),A=w),y._boundEvents[L]={name:A,args:C.helperInfo.args}}else{y.hasAttribute(L)||y.setAttribute(L,"{{dummy}}");var N=this.bindNode(y.getAttributeNode(L),g,n,o,C,void 0,r);N!==y.getAttributeNode(L)&&(y._removedAttributes=y._removedAttributes||{},y._removedAttributes[L]=N)}}u.attr&&Object.keys(u.attr).length&&(y._callee=this);for(var x=0;x<g.length;x++)y.removeAttribute(g[x])}else if(/^(for|forIn|component)$/.test(f)){o.node?y._contextSwitchInfo=o:n&&(y._contextSwitchInfo=n._contextSwitchInfo),y._dynamicNodes=u.dynamicNodes,(window.isIE11Lyte||window.isEdgeLyte)&&(y._templateContent=u.templateContent);var E=void 0;switch(f){case"for":E=this.updateForHelper(y,{type:"default"},o.node?o:void 0);break;case"forIn":E=this.updateForInHelper(y,{type:"default"},o.node?o:void 0);break;case"component":E=this.updateDynamicComponent(y,!1,o.node?o:void 0)}E&&p.push(E)}else if(/^(if|switch)$/.test(f)){y._cases=u.cases,y._default=u.default,o.node?y._contextSwitchInfo=o:n&&(y._contextSwitchInfo=n._contextSwitchInfo);var S=this.updateSwitchHelper(f,y,o.node?o:void 0,void 0,r);if(S){p.push(S);if(S.toAppendMain.querySelector("template[is=break]")){y._isStopped="break",s=this.constructor.getTrimmedContent(s,u.position,void 0),d=u.position;break}if(S.toAppendMain.querySelector("template[is=continue]")){y._isStopped="continue",s=this.constructor.getTrimmedContent(s,u.position,void 0);break}}}else"registerYield"===f?(y._dynamicNodes=u.dynamicNodes,(window.isIE11Lyte||window.isEdgeLyte)&&(y._templateContent=u.templateContent),o.node?y._contextSwitchInfo=o:n&&(y._contextSwitchInfo=n._contextSwitchInfo),y._callee=this):"insertYield"===f&&(o.node?y._contextSwitchInfo=o:n&&(y._contextSwitchInfo=n._contextSwitchInfo),y.component=y.component||{data:{}},y._properties=y._properties||{},this.updateYield(y,!1,o.node?o:void 0))}for(var P=0;P<c.length;P++){var I=c[P].dynamicPositions,k=I.initialNode,O=I.dynamicNodeValue,B=O.childNodes.length;B||(O.appendChild(document.createTextNode("")),B=1);var j=O.childNodes[0];if(window.replaceWithNeeded&&"#document-fragment"===k.parentNode.nodeName){for(;O.childNodes.length;)k.parentNode.insertBefore(O.childNodes[0],k);k.remove()}else k.replaceWith.apply(k,O.childNodes);c[P].dynamicPositions={startingNode:j,length:B}}return d&&((i=i||{}).stop=!0),n?o.type?(n._helpers[o.itemIndex]=p,(window.isIE11Lyte||window.isEdgeLyte)&&(s=this.constructor.createDocFragment1(s)),s):(n._helpers=p,(window.isIE11Lyte||window.isEdgeLyte)&&(s=this.constructor.createDocFragment1(s)),s):(this.executeBlockHelpers(p),(window.isIE11Lyte||window.isEdgeLyte)&&(s=this.constructor.createDocFragment1(s)),s)}},{key:"executeBlockHelpers",value:function(e,t){for(var n=0;n<e.length;n++)e[n].lastNode.parentNode.insertBefore(e[n].toAppendMain,e[n].lastNode),e[n]=e[n].lastNode}},{key:"updateBlockHelpers",value:function(e,t){for(var n=0;n<e.length;n++)switch(e[n].getAttribute("is")){case"for":this.updateForHelper(e[n],{type:"default"},t);break;case"if":this.updateSwitchHelper("if",e[n],t);break;case"forIn":this.updateForInHelper(e[n],{type:"default"},t);break;case"switch":this.updateSwitchHelper("switch",e[n],t);break;case"component":this.updateDynamicComponent(e[n],!1,t);break;case"insertYield":break;case"yield":case"registerYield":t&&(e[n]._contextSwitchInfo=t);break;default:"LYTE-YIELD"===e[n].tagName&&this.updateYield(e[n],!1,t)}}},{key:"attributeChangedCallback",value:function(e,t,n){if(!this.constructor._observedMethodAttributes||!this.constructor._observedMethodAttributes[e]){var o=LyteComponent.String.toCamelCase(e);if(isCustomProp=LyteComponent.customPropHandlers.indexOf(o),-1===isCustomProp){if(null!==n&&t!==n){var r={newValue:n,dataType:this.component.__data[o].type,attr:e,tagName:this.tagName};LyteComponent.getProperData(r)&&(n=r.newValue,this.component.data[o]!==n&&this.set(o,n))}}else{var i=LyteComponent.customPropHandlers[isCustomProp],a=n;if(a)try{a=JSON.parse(a);for(var s in a){var l=i+LyteComponent.String.upperCaseFirstLetter(s);this.set(l,a[s])}}catch(t){console.error("Error while parsing "+e)}}}}},{key:"removeHelpersSpecificIndex",value:function(e,t){if(e._helpers[t])for(var n=0;n<e._helpers[t].length;n++)this.removeHelpers(e._helpers[t][n]);if(e._forContent[t]){for(var o=0;o<e._forContent[t].length;o++)e._forContent[t][o].remove();e._items[t]={_dynamicProperty:{},itemProperty:{},indexProperty:{}}}}},{key:"removeHelpers",value:function(e,t){var n="delete",o=[];if(LyteComponent.newAddContext(e,o),e._forContent)if("for"===e.getAttribute("is")){if(e._helpers)for(var r=0;r<e._helpers.length;r++){for(var i=0;i<e._helpers[r].length;i++)this.removeHelpers(e._helpers[r][i]);e._helpers[r]=[]}for(var a=0;a<e._forContent.length;a++)for(var s=0;s<e._forContent[a].length;s++)e._forContent[a][s].remove();var l=e.getAttribute("item");if(e._items.length){var p=e._items[0].itemProperty,c=e._items[0]._dynamicProperty;for(var d in c){var m=this.getProperty(d);m._helperNodes&&m._helperNodes[n](e)}if(p)for(var u=0;u<e._items.length;u++)this.removeBindings(_defineProperty({},l,e._items[u].itemProperty),_defineProperty({},l,e._attributes.items[u]))}t||e._actualBinding&&(e._attributes.items&&e._attributes.items._bindings&&e._actualBinding._createdBinding&&e._attributes.items._bindings[n](e._actualBinding),e._actualBinding._forHelpers&&e._actualBinding._forHelpers[n](e),e._removedAttributes&&e._removedAttributes.items&&e._removedAttributes.items._multipleProperty&&e._removedAttributes.items._multipleProperty.actProp._forHelpers[n](e)),e._items=[]}else{if(e._helpers)for(var f=Object.keys(e._helpers),h=0;h<f.length;h++){for(var y=0;y<e._helpers[f[h]].length;y++)this.removeHelpers(e._helpers[f[h]][y]);e._helpers[f[h]]=[]}for(var _ in e._forContent)for(var v=0;v<e._forContent[_].length;v++)e._forContent[_][v].remove();var g=e._items,b=e.getAttribute("key");for(var C in g){var L=g[C],w=L.itemProperty,A=L._dynamicProperty;for(var N in A){var x=this.getProperty(N);x._helperNodes&&x._helperNodes[n](e)}if(w)for(var E in e._items)this.removeBindings(_defineProperty({},b,e._items[E].itemProperty),_defineProperty({},b,e._attributes.object[E]))}t||(e._actualBinding&&(e._attributes.object&&e._attributes.object._bindings&&e._actualBinding._createdBinding&&e._attributes.object._bindings[n](e._actualBinding),e._actualBinding._forHelpers&&e._actualBinding._forHelpers[n](e)),e._removedAttributes.items&&e._removedAttributes.items._multipleProperty&&e._removedAttributes.items._multipleProperty.actProp._forHelpers[n](e),e._propBindingObject&&e._attributes.object&&e._attributes.object._bindings&&e._attributes.object._bindings[n](e._propBindingObject)),e._items={}}else if(e._caseContent||e._yieldContent){if(e._helpers){for(var S=0;S<e._helpers.length;S++)this.removeHelpers(e._helpers[S]);e._helpers=[]}if(e._caseContent){for(var P=0;P<e._caseContent.length;P++)e._caseContent[P].remove();for(var I in e._dynamicProperty)e._dynamicProperty[I].isActualNode?e._dynamicProperty[I].isActualNode._helperNodes[n](e):this.getProperty(I)._helperNodes&&this.getProperty(I)._helperNodes[n](e);e._dynamicProperty={}}else{for(var k=0;k<e._yieldContent.length;k++)e._yieldContent[k].remove();e._dynamicProperty={}}}else if(e._renderedComponent){e._renderedComponent[e._currentComponent]&&e._renderedComponent[e._currentComponent].remove();for(var O in e._renderedComponent)e._renderedComponent[O]=null}LyteComponent.newRemoveContext(e,o)}},{key:"updateYield",value:function(e,t,n){e._callee||(e._callee=this);var o=e._callee._yields[e.getAttribute("yield-name")];if(o){var r=o._callee||e._callee._callee;if(r){o._callee||(o._callee=r),e._dynamicProperty=e._dynamicProperty||{};var i={},a=[];LyteComponent.newAddContext(o,a),Object.keys(e._properties).forEach(function(t){i[t]={},i[t].value=r.component.data[t],i[t].property=r._properties[t],r._properties[t]=e._properties[t],r.component.data[t]=e.component.data[t]});var s=r.renderNodes(o.content,o._dynamicNodes,e,{node:e},!0,void 0,o._templateContent);LyteComponent.establishBindings(e._properties,e.component.data),r.executeBlockHelpers(e._helpers),Object.keys(e._properties).forEach(function(e){r.component.data[e]=i[e].value,r._properties[e]=i[e].property}),LyteComponent.newRemoveContext(o,a),e.appendChild(s),e._registerYield=o}else e.appendChild(o.content.cloneNode(!0,"lyte"))}}},{key:"updateDynamicComponent",value:function(e,t,n){var o=void 0;e._callee=this;var r=e.hasAttribute("lyte-keep-alive");e._renderedComponent=e._renderedComponent||{},e._contextSwitchInfo=n||e._contextSwitchInfo,e._dynamicProperty=e._dynamicProperty||{};var i=e.getAttribute("component-name")||(e._attributes?e._attributes["component-name"]:void 0);if(i){var a=void 0,s=!1;if(t?(r&&(LyteComponent.ignoreDisconnect=!0),e._renderedComponent[e._currentComponent]&&e._renderedComponent[e._currentComponent].remove(),LyteComponent.ignoreDisconnect=!1,r||(e._dynamicProperty={}),e._renderedComponent[i]&&r?a=e._renderedComponent[i]:(a=document.createElement(i),s=!0)):(a=document.createElement(i),s=!0),!r&&e._currentComponent&&(e._renderedComponent[e._currentComponent]=null),s){for(var l=0;l<e.attributes.length;l++)"is"!==e.attributes[l].name&&"component-name"!==e.attributes[l].name&&"lyte-keep-alive"!==e.attributes[l].name&&a.setAttribute(e.attributes[l].name,e.attributes[l].value);if(e._attributes)for(var p in e._attributes)"component-name"!==p&&a.setData(LyteComponent.String.toCamelCase(p),e._attributes[p]);var c=this.renderNodes(e.content,e._dynamicNodes,e,void 0,void 0,void 0,e._templateContent);a.appendChild(c)}return s&&(a._toRegEvnts=e._toRegEvnts),t?e.parentNode.insertBefore(a,e):o={toAppendMain:a,lastNode:e},e._renderedComponent[i]=a,e._currentComponent=i,a._callee=this,a._actions=e._actions,a.setMethods(e._initMethods),a._attributeDetails=e._attributeDetails,a._boundEvents=e._boundEvents,o}}},{key:"updateForHelper",value:function(e,t,n){e._callee=this,e._attributes=e._attributes||{},e._contextSwitchInfo=n||e._contextSwitchInfo;var o=e.getAttribute("index");o||(e.setAttribute("index","index"),o="index");var r=e.getAttribute("item");r||(e.setAttribute("item","item"),r="item");var i=this.component.data[r],a=this.component.data[o],s=this._properties[r],l=this._properties[o];this._properties[r]=this._properties[o]={};var p=e._attributes.items,c=e.content,d=e._dynamicNodes,m=e;e._items||(e._items=[]);var u=void 0,f=void 0,h=t.firstIndex,y=t.secondIndex,_=t.thirdIndex;if(t)switch(t.type){case"remove":u=h;for(var v=h,g=y;g>0;g--,v++)this.removeHelpersSpecificIndex(e,v);for(var b=h+y;b<e._items.length;b++)e._items[b]._contextSwitchInfo.itemIndex=e._items[b]._contextSwitchInfo.itemIndex-y;e._items.splice(h,y),e._helpers.splice(h,y),e._forContent.splice(h,y);break;case"insert":f=h,u=y,e._forContent[h]&&(m=e._forContent[h][0]);for(var C=[],L=[],w=[],A=y,N=h;A>0;A--,N++)C.push([]),L.push({}),w.push([]);e._helpers.splice.apply(e._helpers,[h,0].concat(C)),e._items.splice.apply(e._items,[h,0].concat(L));for(var x=h+y;x<e._items.length;x++)e._items[x]._contextSwitchInfo.itemIndex=e._items[x]._contextSwitchInfo.itemIndex+y;e._forContent.splice.apply(e._forContent,[h,0].concat(w));break;case"replace":f=h,u=y,this.removeHelpersSpecificIndex(e,h);document.createDocumentFragment();e._forContent[h+1]&&(m=e._forContent[h+1][0]);for(var E=[],S=[],P=[],I=y,k=h;I>0;I--,k++)E.push([]),P.push([]),S.push({});e._helpers.splice.apply(e._helpers,[h,1].concat(E)),e._items.splice.apply(e._items,[h,1].concat(S));for(var O=h+y;O<e._items.length;O++)e._items[O]._contextSwitchInfo.itemIndex=e._items[O]._contextSwitchInfo.itemIndex+y-1;e._forContent.splice.apply(e._forContent,[h,1].concat(P));break;case"splice":f=h,u=y;for(var B=_,j=0;B>0;B--,j++)this.removeHelpersSpecificIndex(e,h+j);document.createDocumentFragment();e._forContent[h+_]&&(m=e._forContent[h+_][0]);for(var D=[],H=[],T=[],M=y,V=h;M>0;M--,V++)D.push([]),T.push([]),H.push({});e._helpers.splice.apply(e._helpers,[h,_].concat(D)),e._items.splice.apply(e._items,[h,_].concat(H));for(var Y=h+y;Y<e._items.length;Y++)e._items[Y]._contextSwitchInfo.itemIndex=e._items[Y]._contextSwitchInfo.itemIndex+y-_;e._forContent.splice.apply(e._forContent,[h,_].concat(T));break;case"update":e.getAttribute("item");for(var F=0;F<e._items.length;F++)this.removeHelpersSpecificIndex(e,F);e._items=[];case"default":e._forContent=[],e._helpers=[],f=0,u=p?p.length:0;break;default:console.error("Error in updateForHelper")}for(m||(m=e);m!==e&&"TEMPLATE"===m.tagName;){switch(m.getAttribute("is")){case"for":case"forIn":m=m._forContent[0][0]||m;break;case"if":case"switch":m=m._caseContent[0]||m;break;case"component":m=m._renderedComponent[m._currentComponent]||m}}var R=void 0;if("remove"!==t.type){for(var W=document.createDocumentFragment(),$=f,q=u;q>0;$++,q--){e._helpers[$]=[],e._items[$]={_dynamicProperty:{},itemProperty:{},indexProperty:{}},this.component.data[r]=p[$],this.component.data[o]=$,this._properties[r]={},this._properties[o]={};var z={itemValue:r,itemIndex:$,type:"for",node:e,indexValue:o};e._items[$]._contextSwitchInfo=z;var J={},G=this.renderNodes(c,d,e,z,void 0,J,e._templateContent);if(e._items[$].itemProperty=this.getProperty(r),e._items[$].indexProperty=this.getProperty(o),LyteComponent.establishBindings(_defineProperty({},r,e._items[$].itemProperty),_defineProperty({},r,e._attributes.items[$])),e._forContent[$]=Array.from(G.childNodes),this.executeBlockHelpers(e._helpers[$]),W.appendChild(G),J.stop)break}"default"===t.type?R={toAppendMain:W,lastNode:m}:m.parentNode.insertBefore(W,m),e._removedAttributes&&e._removedAttributes.items&&e._removedAttributes.items._multipleProperty&&LyteComponent.establishBindings({items:e._removedAttributes.items._multipleProperty.actProp},{items:p})}for(var U=u;U<e._items.length;U++)e._items[U].indexProperty&&LyteComponent.affectChanges(e._items[U].indexProperty);return this.component.data[r]=i,this.component.data[o]=a,this._properties[r]=s,this._properties[o]=l,R}},{key:"updateForInHelper",value:function(e,t,n){var o=this;e._callee=this,e._attributes=e._attributes||{},n=n||e._contextSwitchInfo,e._contextSwitchInfo=n;var r=e.getAttribute("key");r||(r="key",e.setAttribute("key","key"));var i=e.getAttribute("value");i||(i="value",e.setAttribute("value","value"));var a=o.component.data[r],s=o.component.data[i],l=o._properties[r],p=o._properties[i];o._properties[r]=o._properties[i]={};var c=e._attributes.object,d=e.content,m=e._dynamicNodes,u=e,f=[];if(e._items||(e._items={}),t)switch(t.type){case"delete":this.removeHelpersSpecificIndex(e,t.property);var h=e._keysArray.indexOf(t.property);h>-1&&e._keysArray.splice(h,1),delete e._propBindingObject[t.property];break;case"add":f=[t.property],e._keysArray.push(t.property);break;case"update":e._keysArray.forEach(function(t,n,o){this.removeHelpersSpecificIndex(e,t)},this),e._keysArray=f=c?Object.keys(c):[],e._items={},e._propBindingObject={};break;case"default":e._forContent={},e._helpers={},e._keysArray=f=c?Object.keys(c):[];break;default:console.error("Error in updateForHelper")}var y=void 0;if(!c){var _=document.createDocumentFragment();if("default"===t.type)return{toAppendMain:_,lastNode:u};u.parentNode.insertBefore(_,u)}if(c&&"remove"!==t.type){var v=document.createDocumentFragment();e._propBindingObject=e._propBindingObject||{},f.forEach(function(t,n,a){e._helpers[t]=[],e._items[t]={_dynamicProperty:{},itemProperty:{}},o.component.data[r]=t,o.component.data[i]=c[t],o._properties[r]={},o._properties[i]={};var s={itemIndex:t,itemValue:i,keyValue:r,type:"forIn",node:e};e._items[t]._contextSwitchInfo=s;var l=this.renderNodes(d,m,e,s,void 0,void 0,e._templateContent);e._items[t].itemProperty=this.getProperty(i),e._propBindingObject[t]=e._items[t].itemProperty,e._forContent[t]=Array.from(l.childNodes),this.executeBlockHelpers(e._helpers[t]),v.appendChild(l)},this),e._attributes.object._bindings||Object.defineProperty(e._attributes.object,"_bindings",{value:new Set,enumerable:!1,writable:!0,configurable:!0}),e._attributes.object._bindings.add(e._propBindingObject),LyteComponent.establishBindings(e._propBindingObject,e._attributes.object),"default"!==t.type?u.parentNode.insertBefore(v,u):y={toAppendMain:v,lastNode:u}}return o.component.data[r]=a,o.component.data[i]=s,o._properties[r]=l,o._properties[i]=p,y}},{key:"updateSwitchHelper",value:function(e,t,n,o,r){var i=t;t._callee||(t._callee=this),n=n||t._contextSwitchInfo,t._contextSwitchInfo=n,t._dynamicProperty=t._dynamicProperty?t._dynamicProperty:{};var a=void 0,s=void 0;if(""===t.getAttribute("value")||t.getAttribute("value")?s=t.getAttribute("value"):t._attributes&&(s=t._attributes.value),!t._currentCase||s!==t._currentCase){if(s)a="if"===e?"true":s.toString();else if("if"===e)a="false";else switch(s){case void 0:a="undefined";break;case null:a="null";break;case!1:a="false";break;case"":a='""'}if(a!==t._currentCase){t._currentCase=a;var l=t._cases[a],p=void 0;if(!l&&(l=t._default,p=window.isIE11Lyte||window.isEdgeLyte?l.templateContent:t.content.querySelector("[default]"),t._isDefault=!0,!p)){t._caseContent&&t._caseContent.length&&this.removeHelpers(t),t._caseContent=[];var c=document.createTextNode("");if(t._caseContent.push(c),t._currentCaseName=a,o)return void i.parentNode.insertBefore(c,t);var d=document.createDocumentFragment();return d.append(c),{lastNode:i,toAppendMain:d}}t._caseContent&&t._caseContent.length&&this.removeHelpers(t);var m=l,u=a,f=void 0;f=p||(window.isIE11Lyte||window.isEdgeLyte?{}:t.content.querySelector("[case='"+u+"']"));for(var h=[];m;){var y=m.dynamicNodes,_=this.renderNodes(f.content,y,t,void 0,r,void 0,m.templateContent);if(h.push(_),!m.additional)break;m.additional.next?(f=window.isIE11Lyte||window.isEdgeLyte?{}:t.content.querySelector("[case='"+m.additional.next+"']"),m=t._cases[m.additional.next]):(f=window.isIE11Lyte||window.isEdgeLyte?{}:t.content.querySelector("[default]"),m=t._default)}t._caseContent=[];for(var v=document.createDocumentFragment(),g=0;g<h.length;g++)11==h[g].nodeType?t._caseContent=t._caseContent.concat(Array.from(h[g].childNodes)):t._caseContent.push(h[g]),v.append(h[g]);if(this.executeBlockHelpers(t._helpers,t),o){var b=void 0;return v.querySelector("template[is=break]")?b="break":v.querySelector("template[is=continue]")&&(b="continue"),t.parentNode.insertBefore(v,t),b}return{toAppendMain:v,lastNode:t}}}}},{key:"dummy",value:function(e,t){this.constructor._properties[boundValue].observer}},{key:"callObservers",value:function(e,t){var n=this.constructor._properties[e],o=n?n.observer:void 0;if(o)for(var r=0;r<o.length;r++)-1!==t.indexOf(".")&&o[r].path!==t||this["_"+o[r].functionName].apply(this)}},{key:"bindNode",value:function(e,t,n,o,r,i,a,s){var l=o.itemValue,p=o.itemIndex,c=o.type,d=o.indexValue,m=r.dynamicValue,u=r.helperInfo,f=void 0,h=e.ownerElement,y=[];e._callee=this;var _=!1;if(u&&Object.keys(u).length){_=!0;e.nodeName;f=e.helperValue=u;var v=[];if("action"===u.name){var g=u.args[0];u.args[0]=g.startsWith("'")?g.replace(/'/g,""):g,c?h._contextSwitchInfo=o:n&&(h._contextSwitchInfo=n._contextSwitchInfo),g=u.args.slice(0,1)[0];var b=u.args.slice(1,u.args.length),C=!1,L=e.nodeName;return-1!=L.indexOf("-")&&(C=!0),v=[h,L,C,{name:g,args:b}],void this.processHelper({name:u.name,args:v},e)}if(v=this.processArgs(this,u.args,y),f=this.processHelper({name:u.name,args:v},e),"unescape"===u.name){e={dynamicPositions:{initialNode:e,dynamicNodeValue:f},_callee:e._callee,helperValue:e.helperValue},i.push(e)}}else{u={},e.syntaxValue=m;var w=[];f=LyteComponent.get(this.component.data,m,w),y.push(w)}2===e.nodeType&&("string"!=typeof f&&(LyteComponent.isCustomElement(e.ownerElement,!0)||"boolean"==typeof f)||LyteComponent.isControlHelper(e.ownerElement))&&(e={nodeName:e.nodeName,ownerElement:h,nodeType:2,nodeValue:e.nodeValue,_callee:this,syntaxValue:e.syntaxValue,helperValue:e.helperValue,_attributeDetails:e._attributeDetails});var A=void 0;if("unbound"!==u.name){var N=void 0;n&&(N=c?n._items[p]._dynamicProperty:n._dynamicProperty);for(var x=0;x<y.length;x++){for(var E=y[x],S=0;S<E.length;S++){var P=this.getProperty(E[S]);if(n){var I=E[S].search(/\W/),k=void 0;(k=-1!==I?E[S].substring(0,I):E[S])===l||k===d||o.node&&o.node._properties&&o.node._properties[k]?(e._contextSwitchInfo=o,P._dynamicNodes||(P._dynamicNodes=[],Object.defineProperty(P,"_dynamicNodes",{value:[],enumerable:!1,writable:!0,configurable:!0})),P._dynamicNodes.push(e),A=P):(P._helperNodes||Object.defineProperty(P,"_helperNodes",{value:new Set,writable:!0,enumerable:!1,configurable:!0}),P._helperNodes.add(n),N[E[S]]?N[E[S]].push(e):(N[E[S]]=[]).push(e))}else P._dynamicNodes||Object.defineProperty(P,"_dynamicNodes",{value:[],enumerable:!1,writable:!0,configurable:!0}),P._dynamicNodes.push(e);if(h&&"TEMPLATE"===h.tagName&&/^(for|forIn)$/.test(h.getAttribute("is"))&&!_){var O=h.getAttribute("is");("for"===O&&"items"===e.nodeName||"forIn"===O&&"object"===e.nodeName)&&(P._forHelpers||Object.defineProperty(P,"_forHelpers",{value:new Set,enumerable:!1,writable:!0,configurable:!0}),e.ownerElement._actualBinding=P,P._forHelpers.add(e.ownerElement))}a&&LyteComponent.establishSelectedBinding(P,this.component.data,this)}E.length>1&&(e._multipleProperty={dynamicProp:A?void 0:N,actProp:this.getProperty(E[0]),helperNode:n})}}if(f="boolean"===!(void 0===f||_typeof(f))&&"number"===!(void 0===f||_typeof(f))?f||"":f,2===e.nodeType){var B=e._parentNode?e._parentNode:e.ownerElement;if(B.tagName)B.getAttribute("is");var j=LyteComponent.isCustomElement(B,!0);j&&(B.set?B.set(LyteComponent.String.toCamelCase(e.nodeName),f):(B._initProperties=B._initProperties||{},B._initProperties[LyteComponent.String.toCamelCase(e.nodeName)]=f));var D=f;if(j&&"string"!=typeof f&&!s)B._attributes=B._attributes||{},B._attributes[e.nodeName]=f,"TEMPLATE"===B.nodeName&&_&&f&&("for"===B.getAttribute("is")&&"items"===e.nodeName||"forIn"===B.getAttribute("is")&&"object"===e.nodeName)&&(f._bindings||Object.defineProperty(f,"_bindings",{value:new Set,enumerable:!1,writable:!0,configurable:!0}),e.ownerElement._actualBinding={_forHelpers:(new Set).add(B),_createdBinding:!0},f._bindings.add(e.ownerElement._actualBinding)),t.push(e.nodeName);else if("boolean"==typeof f)B._attributes=e.ownerElement._attributes||{},B._attributes[e.nodeName]=f,f?B.setAttribute(e.nodeName,""):t.push(e.nodeName);else if(f="object"===(void 0===f?"undefined":_typeof(f))?"undefined"!=typeof Record&&f instanceof Record?JSON.stringify(f.$.toJSON()):JSON.stringify(f):void 0===f?"":f,LyteComponent.isControlHelper(e.ownerElement))B._attributes=e.ownerElement._attributes||{},B._attributes[e.nodeName]=f,t.push(e.nodeName);else{var H=void 0===f?"":f;"style"===e.nodeName?e.ownerElement.setAttribute("style",H):e.nodeValue=H}"LYTE-YIELD"===B.tagName&&(B.component.data[LyteComponent.String.toCamelCase(e.nodeName)]=D),/^(INPUT|TEXTAREA|SELECT)$/.test(B.nodeName)&&("value"===e.nodeName?B.value=f:"checked"===e.nodeName&&(B.checked=f))}else e.nodeValue=void 0===f?"":f;return e}},{key:"debounce",value:function(e,t){var n;return function(){var o=this,r=arguments;n&&clearTimeout(n),n=setTimeout(function(){e.apply(o,r),n=null},t||100)}}},{key:"getProperty",value:function(e){var t=e.split("."),n=this;n._properties[t[0]]||(n._properties[t[0]]={}),n=n._properties[t[0]],Object.defineProperty(n,"_path",{enumerable:!1,value:t[0]});for(var o=1;o<t.length;o++)n[t[o]]||(n[t[o]]={},Object.defineProperty(n[t[o]],"_path",{enumerable:!1,value:n._path+"."+t[o]})),n=n[t[o]];return n}},{key:"updateNode",value:function(e,t){var n=!1,o=void 0;if(e._multipleProperty&&t!==e._multipleProperty.actProp._path){n=!1;var r=void 0;if((o=e._multipleProperty).dynamicProp){if(n=o,r=o.dynamicProp[o.actProp._path]){var i=r.indexOf(e);r.splice(i,1)}var a=o.helperNode;if(0===r.length)if("if"===a.getAttribute("is"))o.actProp._helperNodes.delete(a),delete o.dynamicProp[o.actProp._path];else if(delete o.dynamicProp[o.actProp._path],a._items){for(var s=!0,l=0;l<a._items.length;l++)if(a._items[l]._dynamicProperty&&a._items[l]._dynamicProperty[o.actProp._path]){s=!1;break}s&&o.actProp._helperNodes.delete(a)}}if(!n&&(n="dynamicNodes",r=o.actProp._dynamicNodes)){var p=r.indexOf(e);r.splice(p,1),r.length||delete o.actProp._dynamicNodes}}if(e.syntaxValue||e.helperValue){var c=void 0,d=void 0;if(e._contextSwitchInfo||2===e.nodeType&&e.ownerElement._contextSwitchInfo){c=e._contextSwitchInfo||e.ownerElement._contextSwitchInfo;var m=[];LyteComponent.changeContext(c.node,m,c)}else if("LYTE-YIELD"===e.tagName&&e._callee._contextSwitchInfo){d=!0,c=e._callee._contextSwitchInfo;m=[];LyteComponent.changeContext(c.node,m,c,!0)}var u=void 0;if(e.helperValue){var f=u=e.helperValue;if(u=this.processHelper({name:f.name,args:this.processArgs(this,f.args)},e),"unescape"===f.name){for(var h=e.dynamicPositions,y=h.startingNode,_=h.length;_>1;){var v=y.nextSibling;y.remove(),y=v,_--}var g=u.childNodes.length;g||(u.appendChild(document.createTextNode("")),g=1);var b=u.childNodes[0];y.replaceWith.apply(y,u.childNodes);var C={startingNode:b,length:g};e.dynamicPositions=C}}else{var L=e.syntaxValue,w=void 0;-1===L.indexOf(".")&&-1===L.indexOf("[")||(w=L,L=L.substring(0,L.indexOf(".")));var A=[],N=w?LyteComponent.get(this.component.data,w,A):this.component.data[L];if(n){var x=this.getProperty(A[0]),E=this.getProperty(A[0].substring(0,A[0].indexOf("."))),S=this.getData(A[0].substring(0,A[0].indexOf(".")));if("dynamicNodes"===n)x._dynamicNodes||Object.defineProperty(x,"_dynamicNodes",{value:[],enumerable:!1,writable:!0,configurable:!0}),x._dynamicNodes.push(e);else{x._helperNodes||Object.defineProperty(x,"_helperNodes",{value:new Set,writable:!0,enumerable:!1,configurable:!0}),x._helperNodes.add(o.helperNode);var P=o.dynamicProp;P[x._path]?P[x._path].push(e):(P[x._path]=[]).push(e)}LyteComponent.establishBindings(E,S),e._multipleProperty.actProp=x}u="boolean"===!(void 0===N||_typeof(N))&&"number"===!(void 0===N||_typeof(N))?N||"":N}if(2===e.nodeType){var I=[],k=e._parentNode?e._parentNode:e.ownerElement;if("TEMPLATE"===k.tagName&&"component"===k.getAttribute("is")&&"component-name"!==e.nodeName){if(k.hasAttribute("lyte-keep-alive"))for(var O in k._renderedComponent)I.push(k._renderedComponent[O]);else I.push(k._renderedComponent[k.getAttribute("component-name")])}else I.push(k);for(var B=0;B<I.length;B++){var j=I[B];if(j.set?j.set(LyteComponent.String.toCamelCase(e.nodeName),u):(j._initProperties=j._initProperties||{},j._initProperties[LyteComponent.String.toCamelCase(e.nodeName)]=u),"LYTE-YIELD"===j.tagName&&j.component.data&&e.nodeName&&j.component.data[e.nodeName]!==u&&LyteComponent.set(j.component.data,LyteComponent.String.toCamelCase(e.nodeName),u,void 0,j),j._attributes=j._attributes||{},LyteComponent.isCustomElement(j,!0)&&"string"!=typeof u&&void 0!==u){if("TEMPLATE"===e.ownerElement.nodeName&&e.helperValue&&("for"===e.ownerElement.getAttribute("is")&&"items"===e.nodeName||"forIn"===e.ownerElement.getAttribute("is")&&"object"===e.nodeName)){var D=e.ownerElement._attributes[e.nodeName],H=u;LyteComponent.removeSelectedBindingDeep(e.ownerElement._actualBinding,D),H&&(H._bindings||Object.defineProperty(H,"_bindings",{enumerable:!1,writable:!0,value:new Set,configurable:!0}),H._bindings.add(e.ownerElement._actualBinding),LyteComponent.establishBindings(e.ownerElement._actualBinding,H)),"object"===e.nodeName&&LyteComponent.removeSelectedBindingDeep(e.ownerElement._propBindingObject,D)}j.removeAttribute(e.nodeName)}else if("boolean"==typeof u)j._attributes=j._attributes||{},j._attributes[e.nodeName]=u,u?j.setAttribute(e.nodeName,""):j.removeAttribute(e.nodeName);else{var T=void 0===(u="object"===(void 0===u?"undefined":_typeof(u))?"undefined"!=typeof Record&&u instanceof Record?JSON.stringify(u.$.toJSON()):JSON.stringify(u):u)?"":u;"style"===e.nodeName?e.ownerElement.setAttribute("style",T):e.nodeValue=T}j._attributes[e.nodeName]=u,/^(INPUT|TEXTAREA|SELECT)$/.test(j.nodeName)&&("value"===e.nodeName?j.value=u:"checked"===e.nodeName&&(j.checked=u));var M=j._isStopped,V=void 0;switch(j.getAttribute("is")){case"for":this.updateForHelper(j,{type:"update"});break;case"if":V=this.updateSwitchHelper("if",j,void 0,!0,!0);break;case"forIn":this.updateForInHelper(j,{type:"update"});break;case"switch":this.updateSwitchHelper("switch",j,void 0,!0,!0);break;case"component":this.updateDynamicComponent(j,"update")}var Y=void 0;M&&M!==V?Y=V?"break"===V?"MS":"SM":"break"===M?"SM":"SS":"break"===V?Y="MS":"continue"===V&&(Y="SS"),Y&&this.handleBreak(j._contextSwitchInfo,Y)}}else e.nodeValue=void 0===u?"":u;c&&LyteComponent.removeContext(c.node,m,c,d)}}},{key:"handleBreak",value:function(e,t){if(e){for(var n=e.node,o=e.itemIndex,r=(n.getAttribute("item"),e.node._forContent),i="M"===t[0]?r.length:o+1,a=o;a<i;a++){for(var s=r[a],l=0;l<s.length;l++)s[l].remove(),(s[l]._forContent||s[l]._caseContent)&&this.removeHelpers(s[l]);r[a]=[],LyteComponent.removeSelectedBindingDeep(n._items[a].itemProperty,n._attributes.items[a]),n._helpers[a]=[],n._items[a]={_dynamicProperty:{},itemProperty:{},indexProperty:{}}}var p=n._attributes.items.length;"M"===t[1]?this.updateForHelper(n,{firstIndex:o,secondIndex:p-o,type:"replace"},void 0,{}):this.updateForHelper(n,{firstIndex:o,secondIndex:1,type:"replace"},void 0,{})}}},{key:"createCustomEvent",value:function(e,t,n){var o=new CustomEvent(e);t._actions[e]=o,t._actions[e].processAction=n}},{key:"isEmptyString",value:function(e){return!("string"==typeof e)||""===e}},{key:"processArgs",value:function(e,t,n,o,r){n=n||[],t=Array.isArray(t)?Array.from(t):t;for(var i=0;i<t.length;i++)if(this.isEmptyString(t[i]))t[i]&&t[i].type&&this.internalHelpers(e,t,i,n,o,r);else if(t[i].startsWith("'")&&t[i].endsWith("'"))t[i]=t[i].substr(1,t[i].length-2);else{t[i]=t[i].trim();var a=[];o?"event"===t[i]?t[i]=o:"this"===t[i]?t[i]=r:t[i]=LyteComponent.get(e.component.data,t[i],a):t[i]=LyteComponent.get(e.component.data,t[i],a),n.push(a)}return t}},{key:"internalHelpers",value:function(e,t,n,o,r,i){var a=t[n].value,s=this.processHelper({name:a.name,args:this.processArgs(e,a.args,o,r,i)});t[n]=s}},{key:"processHelper",value:function(e,t){var n=[];if("method"===e.name&&n.push(this,t),"lbind"===e.name&&n.push(t.ownerElement),Lyte.Component.registeredHelpers[e.name])return Lyte.Component.registeredHelpers[e.name].apply(this,n.concat(e.args));console.error("helper ",e.name," is not defined")}},{key:"getActionProperty",value:function(e){var t=this._properties;return t?t[e].value:void 0}},{key:"hasInternalBindings",value:function(e){return e.match(/[(]{1}[^)]+[)]{1}/)}},{key:"getArgValues",value:function(e,t){for(var n=[],o=0;o<e.length;o++)n.push(t[e[o]].value);return n}},{key:"createEventListeners",value:function(e,t,n){var o=this;if(e._callee=this,!/^(focus|focusin|focusout|resize|scroll|click|dblclick|mousedown|mouseup|mousemove|mouseover|mouseout|mouseenter|mouseleave|change|select|submit|keydown|keypress|keyup|contextmenu)$/.test(t)){var r=t.substr(2),i=(e.getAttribute(r),function(r){var i;window.event||(window.event=r,i=!0),LyteComponent.throwAction.call(o,o,t.substr(2),n,void 0,void 0,e,r),i&&(window.event=void 0)});Lyte.Component.registeredComponents[e.localName]&&!e.component||"TEMPLATE"===e.tagName&&"component"===e.getAttribute("is")?(e._toRegEvnts=e._toRegEvnts||{},e._toRegEvnts[t.substr(2)]={listener:i,attrVal:this.tagName.toLowerCase()+" => "+n.name}):(e.setAttribute(r,this.tagName.toLowerCase()+" => "+n.name),e.addEventListener(t.substr(2),i)),e.hasAttribute(t)&&(e[t]=void 0),e.removeAttribute(t)}}},{key:"registerYields",value:function(){this._yields={};for(var e=this.querySelectorAll("template[is=registerYield],template[is=yield]"),t=0;t<e.length;t++)this._yields[e[t].getAttribute("yield-name")]=e[t]}},{key:"connectedCallback",value:function(){if(!this.hasAttribute("lyte-rendered")&&Lyte.Component.registeredComponents[this.localName]){var e=this.constructor._templateAttributes;if(e&&e.attr)for(var t in e.attr){var n=e.attr[t];if(!this.hasAttribute(n.name)&&!this.component.data.hasOwnProperty(n.name)||n.globalEvent)if(n.globalEvent){this._evBoundEvents=this._evBoundEvents||{};var o=n.helperInfo.args[0],r=void 0;o.startsWith('"')||o.startsWith("'")?r=o.substring(1,o.length-1):(console.warn("Deprecation warning. Action name should be in quotes"),r=o),this._evBoundEvents[n.name]={name:r,args:n.helperInfo.args,from:"component"};var i=this.getAttribute(n.name),a=this.constructor._template.getAttribute(n.name);this.setAttribute(n.name,a+(i?" ; "+i:""))}else n.from="component",n.staticValue?this.setAttribute(e.attr[t].name,n.staticValue):(this.setAttribute(e.attr[t].name,"{{dummy}}"),this.bindNode(this.getAttributeNode(e.attr[t].name),[],void 0,{},e.attr[t],void 0,void 0,!0))}for(var s in this._toRegEvnts)this.addEventListener(s,this._toRegEvnts[s].listener),this.hasAttribute(s)?this.setAttribute(s,this.getAttribute(s)+" ; "+this._toRegEvnts[s].attrVal):this.setAttribute(s,this._toRegEvnts[s].attrVal);this._toRegEvnts={};var l=this.afterConnected();LyteComponent.establishObserverBindings.call(this,this.constructor._observers),Object.defineProperty(this.component,"_bindings",{enumerable:!1,writable:!0,configurable:!0,value:new Set}),this.component._bindings.add(this._properties),LyteComponent.establishBindings(this._properties,this.component.data),this.appendChild(l),"CRM-STAGEBOARD"!=this.tagName&&"TEST-COMPONENT5"!==this.tagName||console.timeEnd(this.tagName),this.setAttribute("lyte-rendered","");var p=new CustomEvent("onReady");this.dispatchEvent(p),this.callback("didConnect"),this.onCallBack("didConnect")}}},{key:"onCallBack",value:function(e){var t=this.constructor._callBacks[e];if(t)for(var n=0;n<t.length;n++)try{t[n].value.call(this.component)}catch(e){console.error(e)}}},{key:"callback",value:function(e){var t=this.component[e];if(t)try{t.apply(this.component)}catch(e){console.error(e)}}},{key:"establishObserverBindings",value:function(){for(var e=this.constructor._observers,t=0;t<e.length;t++)for(var n=e[t].properties,o=0;o<n.length;o++){var r=void 0,i=!1;-1!==n[o].indexOf(".[]")?(i=!0,r=this.getProperty(n[o].substring(0,n[o].indexOf(".[]")))):r=this.getProperty(n[o]),r._observers||Object.defineProperty(r,"_observers",{value:new Set,enumerable:!1,writable:!0,configurable:!0}),r._observers.add({callee:this,observer:e[t],isArrayObserver:i})}}},{key:"removeBindings",value:function(e,t){for(var n in e){var o=t[n];o&&o._bindings&&o._bindings.delete(e[n]),"object"===_typeof(e[n])&&o&&this.removeBindings(e[n],o)}}},{key:"disconnectedCallback",value:function(){if(!LyteComponent.ignoreDisconnect){this.component._bindings=null,LyteComponent.removeSelectedBindingDeep(this._properties,this.component.data);for(var e in this._properties)this._properties[e]={};this.callback("didDestroy"),this.onCallBack("didDestroy");var t=this;setTimeout(function(){t.component.$node=null,t.component.__data=null,t.component.data.__component__=null,t.component.data=null,t.component=null,t=null},0),this.constructor.activeInstances--}}}],[{key:"getArrayIndex",value:function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n}},{key:"getTrimmedContent",value:function(e,t,n){var o=e;if(n){t=[];for(var r=n.parentNode;t.unshift(this.getArrayIndex(r.childNodes,n)),r=r.parentNode,n=n.parentNode,r;);}for(var i=0;i<t.length;i++){for(var a=e.childNodes.length-1;a>t[i];a--)e.childNodes[a].remove();e=e.childNodes[t[i]]}return o}},{key:"updateValue",value:function(e,t,n){for(var o=t.split("."),r=e,a=0;a<o.length-1;a++)r=r[o[a]];r[o[i]]=n}},{key:"createDocFragment",value:function(e){for(var t=e.cloneNode(!0,"lyte").childNodes,n=document.createDocumentFragment(),o=t.length,r=0;r<o;r++)n.appendChild(t[0]);return n}},{key:"createDocFragment1",value:function(e){if(window.isEdgeLyte)return e.content;for(var t=e.childNodes,n=document.createDocumentFragment(),o=t.length,r=0;r<o;r++)n.appendChild(t[0]);return n}},{key:"_registerComponent",value:function(e,t){var n=LyteComponent.lyteComponentsDiv,o=LyteComponent.styleDiv;if(this._template&&"string"==typeof this._template){this._template.replace(/\\'/g,"'");var r=document.createElement("div");for(r.innerHTML=this._template;r.firstChild;)"STYLE"===r.firstChild.nodeName?o.appendChild(r.firstChild):n.appendChild(r.firstChild)}else document.querySelector("template[tag-name='"+e+"']")&&n.appendChild(document.querySelector("template[tag-name='"+e+"']"));if(this._template=n.querySelector("template[tag-name='"+e+"']"),this._template){LyteComponent.needDummyComponentsDiv&&LyteComponent.dummyLyteComponentsDiv.appendChild(this._template.cloneNode(!0)),this._template&&this._template.content;var i=window.isIE11Lyte?this._template:this._template.content;if(this.splitTextNodes(i),this._dynamicNodes){if(doCompile(i,this._dynamicNodes,e),window.isEdgeLyte?this._templateContent=this._template.outerHTML:window.isIE11Lyte&&(this._templateContent=i.outerHTML),this._templateAttributes){var a=[this._templateAttributes];if(doCompile(this._template,a,e),this._templateAttributes=a[0],this._templateAttributes&&this._templateAttributes.attr){var s=this._template.attributes;try{for(var l=0;l<s.length;l++)this._templateAttributes.attr[s[l].name]||"tag-name"===s[l].name||"use-strict"===s[l].name||(this._templateAttributes.attr[s[l].name]={name:s[l].name,staticValue:s[l].value})}catch(e){console.error("Error with templateAttributes. ")}}}}else console.error("Component "+e+" is not compiled. Please compile using Lyte CLI. ")}}},{key:"splitTextNodes",value:function(e){if(e&&e.childNodes&&e.childNodes.length)for(var t=e.childNodes.length-1;t>=0;t--)this.splitTextNodes(e.childNodes[t]);if("TEMPLATE"!==e.tagName||window.isIE11Lyte||this.splitTextNodes(e.content),e.nodeType===e.TEXT_NODE){var n=e.nodeValue;if(n){var o=n.match(/{{[^}]*?(?:(?:('|")[^\1]*?\1)[^}]*?)*}}/g);if(!o)return;for(var r=[],i=0;i<o.length;i++){var a=n.indexOf(o[i]),s=a+o[i].length;a&&r.push(document.createTextNode(n.substring(0,a))),r.push(document.createTextNode(n.substring(a,s))),n=n.substring(s)}if((n.trim()||!e.nextSibling||3!==e.nextSibling.nodeType||e.nextSibling.nodeValue.trim())&&r.push(document.createTextNode(n)),window.replaceWithNeeded&&"#document-fragment"===e.parentNode.nodeName){for(var l=0;l<r.length;l++)e.parentNode.insertBefore(r[l],e);e.remove()}else e.replaceWith.apply(e,r)}}}},{key:"observedAttributes",get:function(){for(var e=[],t=0;t<this._observedAttributes.length;t++)e[t]=LyteComponent.String.dasherize(this._observedAttributes[t]);return LyteComponent.customPropHandlers.forEach(function(t,n){e.push(LyteComponent.String.dasherize(t))}),e}}]),t}();Function.prototype.on=function(){return{type:"callBack",value:"observer"===this.type?this.value:this,properties:arguments,observes:"observer"===this.type?this:void 0}},Function.prototype.observes=function(){return{type:"observer",value:this,properties:arguments,on:Function.prototype.on}},Function.prototype.computed=function(){return{type:"computed",value:this,properties:arguments}};var LyteComponent={customPropRegex:"",customPropHandlers:[],_registeredComponents:{},toBeRegistered:[],throwEvent:function(e){var t=this.$node?this.$node:this,n=t._actions?t._actions[e]:void 0,o=[];if(arguments.length>1)for(var r=1;r<arguments.length;r++)o.push(arguments[r]);LyteComponent.throwAction.call(t,t._callee,e,void 0,!0,o,t),this.$node&&t.dispatchEvent(n||new CustomEvent(e,{detail:o}))},throwAction:function(e,t,n,o,r,i,a,s){var l=void 0;if(this._route&&o)l=(e=this._route).actions||(e.actions={});else if(this.routeName){var p=this.parent;p&&(l=p.component?(e=p.component).constructor._actions:(e=p).actions||(e.actions={}))}else e&&(l=e.constructor._actions);if(e){n=n||(this._actions&&this._actions[t]?this._actions[t].processAction:void 0);var c=r||[];if(n){var d=[];if(i&&LyteComponent.newAddContext(i,d),c.splice.apply(c,[0,0].concat(this.processArgs(e,n.args,void 0,a,i))),i&&LyteComponent.newRemoveContext(i,d),l[n.name])if(o)l[n.name].apply(this._callee.component,c),s=!0;else{var m=i.parentNode;if(s=!0,!1!==l[n.name].apply(this.component,c))if(n.from&&i.getAttribute(a.type)&&i._boundEvents&&i._boundEvents[a.type]){i._callee.constructor._actions;var u=i._boundEvents[a.type],f=Lyte.deepCopyObject(u);f.args.shift(),LyteComponent.throwAction.call(i._callee,i._callee,a.type,f,void 0,void 0,i,a,s)}else if(LyteComponent.isCustomElement(i)&&(e=m),m){for(;m&&!m.getAttribute(t)&&"BODY"!=m.tagName;)m=m.parentNode;if(!m||"BODY"===m.tagName)return;if(m._callee||(m._callee=m.getCallee?m.getCallee(m):this.getCallee(m)),m&&a.type===t&&!a.cancelBubble)if(m._evBoundEvents&&m._evBoundEvents[t]){var h=m._evBoundEvents[t],y=Lyte.deepCopyObject(h);y.args.shift(),LyteComponent.throwAction.call(m._callee,m._callee,t,y,void 0,void 0,m,a,s)}else if(m&&m._boundEvents&&m._boundEvents[t]){var _=m._boundEvents[t],v=Lyte.deepCopyObject(_);v.args.shift(),LyteComponent.throwAction.call(m._callee,m._callee,t,v,void 0,void 0,m,a,s)}}}else console.error("Action named "+n.name+" doesn't exist")}else if(o){var g=l[t]||l[LyteComponent.String.toCamelCase(t)]||l[LyteComponent.String.dasherize(t)];if(g){var b=LyteComponent.isCustomElement(e)?e.component:e;s=!0,!1!==g.apply(b,c)&&LyteComponent.throwAction.call(e,e._callee,t,n,o,r,void 0,void 0,s)}else LyteComponent.throwAction.call(e,e._callee,t,n,o,r,void 0,void 0,s)}}else s||console.warn("Nothing handled the action "+t+".")},processHelperArgs:function(){},isControlHelper:function(e){return"TEMPLATE"===e.tagName&&e.getAttribute("is")&&"component"!==e.getAttribute("is")},isCustomElement:function(e,t){return"TEMPLATE"===e.tagName&&t||e.nodeName&&-1!==e.nodeName.indexOf("-")&&(Lyte.Component.registeredComponents[e.localName]||"LYTE-YIELD"===e.tagName)},componentSet:function(e,t,n){(n||this.get(e)!==t)&&LyteComponent.set(this.data,e,t,void 0,this.$node)},componentGet:function(e){return e?LyteComponent.get(this.data,e):this.data},nodeGet:function(e){return e?this.component.get(e):this.component.data},nodeSet:function(e,t){this.component.set(e,t)},registerComponent:function(e,t,n){function o(){}if(Lyte.Component.registeredComponents[e])console.warn("Component "+e+" already registered");else{var r=void 0;LyteComponent._registeredComponents[e]?r=LyteComponent._registeredComponents[e]:((r=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,customElementPrototype),t}())._properties={},r.activeInstances=0,r.prototype.get=this.nodeGet,r.prototype.set=this.nodeSet,r.prototype.throwAction=this.throwAction);var i=[];(n=n||{}).mixins&&n.mixins.forEach(function(e){i.push(Lyte.registeredMixins[e])}),r.component=o,o.prototype.set=this.componentSet,o.prototype.get=this.componentGet,o.prototype.throwEvent=this.throwEvent,o.prototype.executeMethod=LyteComponent.executeMethod,o.prototype.getData=LyteComponent.componentGetData,o.prototype.setData=LyteComponent.componentSetData,o.prototype.getMethods=LyteComponent.componentGetMethods,o.prototype.setMethods=LyteComponent.componentSetMethods,r._mixins=n.mixins;for(var a=i.length,s=0;s<a;s++)for(var l in i[s])o.prototype[l]=i[s][l];r._actions=t.actions?t.actions:{},r._template=t._template,delete t._template,r._dynamicNodes=t._dynamicNodes,delete t._dynamicNodes,r._templateAttributes=t._templateAttributes,delete t._templateAttributes,r._callBacks={},r._observers=[];var p=t.data?t.data:void 0,c=t.methods?t.methods:{};r._observedAttributes=t._observedAttributes||[],r._observedMethodAttributes=t._observedMethodAttributes||{},delete t._observedAttributes,delete t._observedMethodAttributes,delete t.data,delete t.methods;for(var d in t)if("observer"===t[d].type)r._observers.push(t[d]);else if("callBack"===t[d].type){for(var m=t[d].properties,u=0;u<m.length;u++)r._callBacks[m[u]]||(r._callBacks[m[u]]=[]),r._callBacks[m[u]].push(t[d]);t[d].observes&&r._observers.push(t[d].observes)}else o.prototype[d]=t[d];r._data=p,r._methods=c,r._registerComponent(e,r),Lyte.Component.registeredComponents[e]=!0,LyteComponent._registeredComponents[e]||("complete"===document.readyState||"interactive"===document.readyState?customElements.define(e,r):LyteComponent.toBeRegistered.push({name:e,def:r})),LyteComponent._registeredComponents[e]=r}},registerHelper:function(e,t){Lyte.Component.registeredHelpers[e]=t},registerMixin:function(e,t){Lyte.Mixin.register.call(Lyte,e,t)},update:function(e,t,n,o,r,i,a){var s=e.__component__;if(!r)if(r=e[t],e.hasOwnProperty(t)||e instanceof Array||LyteComponent.objectFunctions(e,"add",t,n,!0),s&&"LYTE-YIELD"!==s.tagName){var l=Lyte.validate(e,t,n,s.component);if(l)return void LyteComponent.set(s.component.data.errors,t,l);s.component.data.errors[t]&&Lyte.objectUtils(s.component.data.errors,"delete",t),e[t]=n}else e[t]=n;var p=!!s;if(s&&a&&"string"==typeof n&&s.getAttribute(LyteComponent.String.dasherize(t))!==n){var c=LyteComponent.String.dasherize(t);LyteComponent.customPropRegex.exec(t)&&!s.hasAttribute(c)||s.setAttribute(LyteComponent.String.dasherize(t),n)}if(n&&"string"!=typeof n&&"boolean"!=typeof n&&"number"!=typeof n){if(r&&"object"===(void 0===r?"undefined":_typeof(r))&&r._bindings){if(n._bindings||Object.defineProperty(n,"_bindings",{enumerable:!1,writable:!0,value:new Set,configurable:!0}),s&&s.component.data===e&&-1===t.indexOf(".")){var d=s.getProperty(t);if(this.removeSelectedBindingDeep(d,r),n._bindings.add(d),this.establishBindings(d,n),d._forHelpers)for(var m=d._forHelpers.toArrayLyte(),u=0;u<m.length;u++){var f=m[u];f._propBindingObject&&this.removeSelectedBindingDeep(f._propBindingObject,r)}this.affectChanges(d,void 0,r,i,e[t])}else if(e._bindings)for(var h=e._bindings.toArrayLyte(),y=0;y<h.length;y++){var _=h[y][t];if(_){if(this.removeSelectedBindingDeep(_,r),n._bindings.add(_),this.establishBindings(_,n),_._forHelpers)for(var v=_._forHelpers.toArrayLyte(),g=0;g<v.length;g++){var b=v[g];b._propBindingObject&&this.removeSelectedBindingDeep(b._propBindingObject,r)}this.affectChanges(_,void 0,r,i,e[t])}}}else if(e._bindings){n._bindings||Object.defineProperty(n,"_bindings",{enumerable:!1,writable:!0,value:new Set,configurable:!0});for(var C=e._bindings.toArrayLyte(),L=0;L<C.length;L++){var w=C[L];w[t]&&(n._bindings.add(w[t]),this.establishBindings(w[t],n),this.affectChanges(w[t],void 0,r,i,e[t]))}}}else{if(r&&"object"===(void 0===r?"undefined":_typeof(r))&&r._bindings)for(var A=e._bindings.toArrayLyte(),N=0;N<A.length;N++){var x=A[N];if(x[t]&&(this.removeSelectedBindingDeep(x[t],r),x[t]._forHelpers))for(var E=x[t]._forHelpers.toArrayLyte(),S=0;S<E.length;S++){var P=E[S];P._propBindingObject&&this.removeSelectedBindingDeep(P._propBindingObject,r)}}if(e._bindings)for(var I=e._bindings.toArrayLyte(),k=0;k<I.length;k++){var O=I[k];O[t]&&this.affectChanges(O[t],void 0,r,i,e[t])}}if(p&&s._attributeDetails&&s._callee){var B=s._attributeDetails[LyteComponent.String.dasherize(t)],j=void 0;if(B&&B.isLbind&&(j=B.dynamicValue),j){var D=void 0;s._contextSwitchInfo&&(D=[],LyteComponent.changeContext(s._contextSwitchInfo.node,D,s._contextSwitchInfo));var H=LyteComponent.getNew(s._callee.component.data,j),T=!1;H.context===s._callee.component.data?s._callee._properties[H.lastKey]&&s._callee._properties[H.lastKey].__fromComponent&&(T=!0):T=!0,T&&LyteComponent.set(H.context,H.lastKey,n,void 0,s._callee),D&&LyteComponent.removeContext(s._contextSwitchInfo.node,D,s._contextSwitchInfo)}}},set:function(e,t,n,o){if("string"!=typeof t||e[t]!==n){var r=-1,i=t;if(t instanceof Object||(r=t.lastIndexOf(".")),-1!==r){var a=t.substring(0,r);t=t.substring(r+1),e=LyteComponent.get(e,a)}var s=[];if(e._setterScope)var l=e._setterScope;if(i=i===t?i:void 0,t instanceof Object)if(Lyte.isRecord(e)&&!o){for(var p in t)Array.isArray(e[p])?s.push({key:p,oldValue:e[p].slice(0)}):s.push({key:p,oldValue:e[p]});var c=store.$.setData(e.$,t);if(c.$.isError)return c;for(var d=0;d<s.length;d++)LyteComponent.update(e,s[d].key,e[s[d].key],o,void 0===s[d].oldValue?null:s[d].oldValue,l,i)}else for(var m in t)LyteComponent.update(e,m,t[m],o,void 0,l,i);else if(Lyte.isRecord(e)&&!o){e[t];var u=store.$.setData(e.$,t,n);if(u.$.isError)return u}else LyteComponent.update(e,t,n,o,void 0,l,i)}},newAddContext:function(e,t){var n="LYTE-YIELD"===e.tagName;e._contextSwitchInfo?LyteComponent.changeContext(e._contextSwitchInfo.node,t,e._contextSwitchInfo,n):n&&e._callee._contextSwitchInfo&&LyteComponent.changeContext(e._callee._contextSwitchInfo.node,t,e._callee._contextSwitchInfo,!0)},newRemoveContext:function(e,t){var n="LYTE-YIELD"===e.tagName;e._contextSwitchInfo?LyteComponent.removeContext(e._contextSwitchInfo.node,t,e._contextSwitchInfo,n):n&&e._callee._contextSwitchInfo&&LyteComponent.removeContext(e._callee._contextSwitchInfo.node,t,e._callee._contextSwitchInfo,!0)},changeContext:function(e,t,n,o){if(n){e._contextSwitchInfo?LyteComponent.changeContext(e._contextSwitchInfo.node,t,e._contextSwitchInfo,"LYTE-YIELD"===e.tagName||o):("LYTE-YIELD"===e.tagName||o)&&e._callee&&e._callee._contextSwitchInfo&&LyteComponent.changeContext(e._callee._contextSwitchInfo.node,t,e._callee._contextSwitchInfo);var r=void 0,i=void 0;if(n.type){if("for"===n.type){if(r=e.getAttribute("index"),i=e.getAttribute("item"),0===e._items.length)return}else if(r=e.getAttribute("key"),i=e.getAttribute("value"),0===Object.keys(e._items).length)return;var a=e._callee,s=a.component.data[i],l=a.component.data[r],p=a._properties[i],c=a._properties[r],d="for"===n.type?e._attributes.items:e._attributes.object;a.component.data[i]=d[n.itemIndex],a.component.data[r]=n.itemIndex,a._properties[i]=e._items[n.itemIndex].itemProperty,a._properties[r]={};var m={initialItemValue:s,initialIndexValue:l,initialItemProp:p,initialIndexProp:c};t.push(m)}else{var u={},f=e._callee._callee;Object.keys(n.node._properties).forEach(function(e){u[e]={},u[e].value=f.component.data[e],u[e].property=f._properties[e],f._properties[e]=n.node._properties[e],f.component.data[e]=n.node.component.data[e]}),t.push(u)}}},removeContext:function(e,t,n,o){if(n){e._contextSwitchInfo?LyteComponent.removeContext(e._contextSwitchInfo.node,t,e._contextSwitchInfo,"LYTE-YIELD"===e.tagName||o):("LYTE-YIELD"===e.tagName||o)&&e._callee&&e._callee._contextSwitchInfo&&LyteComponent.removeContext(e._callee._contextSwitchInfo.node,t,e._callee._contextSwitchInfo);var r=void 0,i=void 0;if(n.type){if("for"===n.type){if(r=e.getAttribute("index"),i=e.getAttribute("item"),0===e._items.length)return}else if(r=e.getAttribute("key"),i=e.getAttribute("value"),0===Object.keys(e._items).length)return;var a=e._callee,s=(e._attributes.items,t.shift());a.component.data[i]=s.initialItemValue,a.component.data[r]=s.initialIndexValue,a._properties[i]=s.initialItemProp,a._properties[r]=s.initialIndexProp}else{var l=e._callee._callee,p=t.shift();Object.keys(n.node._properties).forEach(function(e){l.component.data[e]=p[e].value,l._properties[e]=p[e].property})}}},objectFunctions:function(){var e=arguments[0],t=arguments[1],n=arguments[2],o=arguments[3],r=arguments[4];if("add"!==t||r){var i={};if(i.type=t,i.property=n,/^(add|delete)$/.test(t)){var a=e._bindings;if("delete"===t&&LyteComponent.set(e,n,void 0),a)for(var s=a.toArrayLyte(),l=0;l<s.length;l++){var p=s[l]._forHelpers;if(p)for(var c=p.toArrayLyte(),d=0;d<c.length;d++){var m=c[d],u=(m.getAttribute("key"),[]);"add"===t&&LyteComponent.newAddContext(m,u),m._callee.updateForInHelper(m,i),"add"===t&&LyteComponent.newRemoveContext(m,u)}}"delete"===t&&delete e[n]}else console.error("No such function exists in objectFunctions")}else LyteComponent.set(e,n,o)},arrayFunctions:function(){var e=arguments[0],t=arguments[1];if(!/^(replaceAt|removeAt|shift)$/.test(t)||e.length)switch(t){case"replaceAt":var n=parseInt(arguments[2]);if(n>e.length)return console.warn("index provided for replaceAt is greater than array length"),[];var o=arguments[3];o instanceof Array||(o=[o]);var r=e.splice.apply(e,[n,1].concat(o)),i={firstIndex:n,secondIndex:o.length,type:"replace"};if(e._bindings)for(var a=e._bindings.toArrayLyte(),s=0;s<a.length;s++){var l=a[s];if(l._forHelpers)for(var p=l._forHelpers.toArrayLyte(),c=0;c<p.length;c++){for(var d=p[c],m=n+r.length,u=d.getAttribute("item"),f=n,h=0;f<m;f++,h++)LyteComponent.removeSelectedBindingDeep(_defineProperty({},u,d._items[f].itemProperty),_defineProperty({},u,r[h]));var y=[];LyteComponent.newAddContext(d,y),d._callee.updateForHelper(d,i),LyteComponent.newRemoveContext(d,y)}for(var _ in l){var v=parseInt(_);if(!isNaN(v)&&v>=i.firstIndex){var g=v-i.firstIndex,b=void 0;if(b=g<=i.thirdIndex?r[g]:e[i.firstIndex-1+i.secondIndex+g],this.removeSelectedBindingDeep(l[_],b),l[_]._forHelpers)for(var C=l[_]._forHelpers.toArrayLyte(),L=0;L<C.length;L++){var w=C[L];w._propBindingObject&&this.removeSelectedBindingDeep(w._propBindingObject,b)}e[v]&&"object"===_typeof(e[v])&&(e[v]._bindings||Object.defineProperty(e[v],"_bindings",{enumerable:!1,writable:!0,value:new Set,configurable:!0}),this.establishBindings({dummy:l[_]},{dummy:e[v]})),this.affectChanges(l[_])}}}return LyteComponent.callArrayObservers(e,{type:"array",insertedItems:o,index:n}),r[0];case"splice":var A=parseInt(arguments[2]);if(A>e.length)return console.warn("index provided for replaceAt is greater than array length"),[];var N=arguments[3],x=arguments[4];x instanceof Array||(x=[x]);var E=e.splice.apply(e,[A,N].concat(x)),S={firstIndex:A,secondIndex:x.length,thirdIndex:N,type:"splice"};if(e._bindings)for(var P=e._bindings.toArrayLyte(),I=0;I<P.length;I++){var k=P[I];if(k._forHelpers)for(var O=k._forHelpers.toArrayLyte(),B=0;B<O.length;B++){for(var j=O[B],D=A+E.length,H=j.getAttribute("item"),T=A,M=0;T<D;T++,M++)LyteComponent.removeSelectedBindingDeep(_defineProperty({},H,j._items[T].itemProperty),_defineProperty({},H,E[M]));var V=[];LyteComponent.newAddContext(j,V),j._callee.updateForHelper(j,S),LyteComponent.newRemoveContext(j,V)}for(var Y in k){var F=parseInt(Y);if(!isNaN(F)&&F>=S.firstIndex){var R=F-S.firstIndex,W=void 0;if(W=R<=S.thirdIndex?E[R]:e[S.firstIndex-S.thirdIndex+S.secondIndex+R],this.removeSelectedBindingDeep(k[Y],W),k[Y]._forHelpers){var $=k[Y]._forHelpers.toArrayLyte();for(L=0;L<$.length;L++){var q=$[L];q._propBindingObject&&this.removeSelectedBindingDeep(q._propBindingObject,W)}}e[F]&&"object"===_typeof(e[F])&&(e[F]._bindings||Object.defineProperty(e[F],"_bindings",{enumerable:!1,writable:!0,value:new Set,configurable:!0}),this.establishBindings({dummy:k[Y]},{dummy:e[F]})),this.affectChanges(k[Y])}}}return LyteComponent.callArrayObservers(e,{type:"array",index:A,insertedItems:x,removedItems:E}),E;case"push":var z=arguments[2];z instanceof Array||(z=[z]),LyteComponent.arrayFunctions(e,"insertAt",e.length,z);break;case"pop":return LyteComponent.arrayFunctions(e,"remove",e.length-1)[0];case"shift":case"shiftObject":return LyteComponent.arrayFunctions(e,"remove",0)[0];case"removeAt":case"remove":var J=parseInt(arguments[2]);if(J>e.length)return console.warn("index provided for removeAt is greater than array length"),[];var G=arguments[3]?parseInt(arguments[3]):1,U={firstIndex:J,secondIndex:G,type:"remove"},K=e.splice(J,G);if(e._bindings)for(var X=e._bindings.toArrayLyte(),Z=0;Z<X.length;Z++){var Q=X[Z];if(Q._forHelpers)for(var ee=Q._forHelpers.toArrayLyte(),te=0;te<ee.length;te++){for(var ne=ee[te],oe=J+K.length,re=ne.getAttribute("item"),ie=J,ae=0;ie<oe;ie++,ae++)LyteComponent.removeSelectedBindingDeep(_defineProperty({},re,ne._items[ie].itemProperty),_defineProperty({},re,K[ae]));var se=[];LyteComponent.newAddContext(ne,se),ne._callee.updateForHelper(ne,U),LyteComponent.newRemoveContext(ne,se)}for(var le in Q){var pe=parseInt(le);if(!isNaN(pe)&&pe>=U.firstIndex){var ce=pe-U.firstIndex,de=void 0;if(de=ce<U.secondIndex?K[ce]:e[U.firstIndex-U.secondIndex+ce],this.removeSelectedBindingDeep(Q[le],de),Q[le]._forHelpers){var me=Q[le]._forHelpers.toArrayLyte();for(L=0;L<me.length;L++){var ue=me[L];ue._propBindingObject&&this.removeSelectedBindingDeep(ue._propBindingObject,de)}}e[pe]&&"object"===_typeof(e[pe])&&(e[pe]._bindings||Object.defineProperty(e[pe],"_bindings",{enumerable:!1,writable:!0,value:new Set,configurable:!0}),this.establishBindings({dummy:Q[le]},{dummy:e[pe]})),this.affectChanges(Q[le])}}}return LyteComponent.callArrayObservers(e,{type:"array",removedItems:K,index:J}),K;case"unshift":case"unshiftObject":case"unshiftObjects":var fe=arguments[2];fe instanceof Array||(fe=[fe]),LyteComponent.arrayFunctions(e,"insertAt",0,fe);break;case"insertAt":var he=parseInt(arguments[2]),ye=arguments[3],_e=ye.length;ye instanceof Array||(ye=[ye]);for(var ve=he;ve>e.length;ve--)ye.unshift(void 0),he--;var ge={firstIndex:he,secondIndex:ye.length,type:"insert"};if(e.splice.apply(e,[he,0].concat(ye)),e._bindings)for(var be=e._bindings.toArrayLyte(),Ce=0;Ce<be.length;Ce++){var Le=be[Ce];if(Le._forHelpers)for(var we=Le._forHelpers.toArrayLyte(),Ae=0;Ae<we.length;Ae++){var Ne=we[Ae],xe=[];LyteComponent.newAddContext(Ne,xe),Ne._callee.updateForHelper(Ne,ge),LyteComponent.newRemoveContext(Ne,xe)}for(var Ee in Le){var Se=parseInt(Ee);if(!isNaN(Se)&&Se>=ge.firstIndex){if(this.removeSelectedBindingDeep(Le[Ee],e[Se+ge.secondIndex]),Le[Ee]._forHelpers){var Pe=Le[Ee]._forHelpers.toArrayLyte();for(L=0;L<Pe.length;L++){var Ie=Pe[L];Ie._propBindingObject&&this.removeSelectedBindingDeep(Ie._propBindingObject,oldObject)}}e[Se]&&"object"===_typeof(e[Se])&&(e[Se]._bindings||Object.defineProperty(e[Se],"_bindings",{enumerable:!1,writable:!0,value:new Set,configurable:!0}),this.establishBindings({dummy:Le[Ee]},{dummy:e[Se]})),this.affectChanges(Le[Ee])}}}LyteComponent.callArrayObservers(e,{type:"array",insertedItems:arguments[3]instanceof Array?arguments[0].slice(parseInt(arguments[2]),_e+1):[arguments[3]],index:parseInt(arguments[2])});break;case"concat":LyteComponent.arrayFunctions(e,"insertAt",e.length,arguments[2]);break;default:return void console.error("array Function "+t+" doesn't exist")}else console.warn(t+" operation cannot be performed on empty array")},callArrayObservers:function(e,t){if(e._bindings)for(var n=e._bindings.toArrayLyte(),o=0;o<n.length;o++){var r=n[o],i=n[o]._path;if(r._observers)for(var a=r._observers.toArrayLyte(),s=0;s<a.length;s++){var l=a[s];l.isArrayObserver&&(t&&(t.item=i),l.observer.value.call(l.callee&&l.callee.component?l.callee.component:e._setterScope?e._setterScope:window,t))}r.length&&this.affectChanges(r.length)}},establishUpdateBindings:function(e,t,n){for(var o=e.toArrayLyte(),r=0;r<o.length;r++){var i=o[r];i[t]&&(n._bindings||Object.defineProperty(n,"_bindings",{value:new Set,enumerable:!1,configurable:!0,writable:!0}),n._bindings.add(i[t]),this.establishBindings(i[t],n))}},establishSelectedBinding:function(e,t,n){if(e)for(var o=e._path.split("."),r=n.getProperty(o[0]),i=t[o[0]],a=0;a<o.length&&"object"===(void 0===i?"undefined":_typeof(i));a++)i._bindings||Object.defineProperty(i,"_bindings",{enumerable:!1,configurable:!0,writable:!0,value:new Set}),i._bindings.add(r),r=r[o[a+1]],i=i[o[a+1]]},establishBindings:function(e,t){if(e._helperNodes)for(var n=e._path,o=e._helperNodes.toArrayLyte(),r=0;r<o.length;r++){var i=o[r]._dynamicProperty?o[r]._dynamicProperty[n]:void 0;if(i)for(var a=0;a<i.length;a++){var s=i[a].ownerElement;if(s&&"TEMPLATE"===s.tagName&&"for"===s.getAttribute("is")&&s._items){s.getAttribute("item");for(var l=0;l<s._items.length;l++){var p=t[l],c=s.getAttribute("item");p&&"object"===_typeof(s._items[l])&&this.establishBindings(s._items[l].itemProperty,_defineProperty({},c,p))}}}}for(var d in e){var m=t[d];m&&"string"!=typeof m&&"number"!=typeof m&&"boolean"!=typeof m?(m._bindings||Object.defineProperty(m,"_bindings",{value:new Set,enumerable:!1,writable:!0,configurable:!0}),m._bindings.add(e[d]),"object"===_typeof(e[d])&&this.establishBindings(e[d],m)):(t._bindings||Object.defineProperty(t,"_bindings",{value:new Set,enumerable:!1,writable:!0,configurable:!0}),t._bindings.add(e))}},removeSelectedBindingDeep:function(e,t){if(t){t._bindings&&(t._bindings.delete(e),t._bindings.size||delete t._bindings);for(var n in e){var o=t[n];o&&o._bindings&&(o._bindings.delete(e[n]),o._bindings.size||delete t._bindings),"object"===_typeof(e[n])&&o&&this.removeSelectedBindingDeep(e[n],o)}if(e._forHelpers)for(var r=e._forHelpers.toArrayLyte(),i=0;i<r.length;i++){var a=r[i];if("for"===a.getAttribute("is")){a.getAttribute("item");for(var s=a._attributes.items,l=a._items,p=0;p<l.length;p++)this.removeSelectedBindingDeep(l[p].itemProperty,s[p])}else a._propBindingObject&&t._bindings&&(t._bindings.delete(a._propBindingObject),t._bindings.size||delete t._bindings,this.removeSelectedBindingDeep(a._propBindingObject,t))}}},removeAllBindings:function(e,t){for(var n in e)t[n]&&t[n]._bindings&&(t[n]._bindings.delete(e[n]),t[n]._bindings.size||delete t[n]._bindings),t[n]&&"string"!=typeof t[n]&&LyteComponent.removeAllBindings(e[n],t[n])},affectChanges:function(e,t,n,o,r){if(e._dynamicNodes)for(var i=0;i<e._dynamicNodes.length;i++)e._dynamicNodes[i]._callee.updateNode(e._dynamicNodes[i],e._path);var a=e._path;if(e._helperNodes)for(var s=[],l=e._helperNodes.toArrayLyte(),p=0;p<l.length;p++)if(e._helperNodes.has(l[p]))if("for"===l[p].getAttribute("is")&&l[p]._items){var c=[];LyteComponent.newAddContext(l[p],c);for(var d=l[p].getAttribute("index"),m=l[p].getAttribute("item"),u=l[p]._callee,f=u.component.data[m],h=u.component.data[d],y=u._properties[m],_=u._properties[d],v=l[p]._attributes.items,g=0;g<l[p]._items.length;g++)if(u.component.data[m]=v[g],u.component.data[d]=g,u._properties[m]=l[p]._items[g].itemProperty,l[p]._items[g]._dynamicProperty[a]){s=l[p]._items[g]._dynamicProperty[a];for(var b=0;b<s.length;b++)s[b]._callee.updateNode(s[b],a)}u.component.data[m]=f,u.component.data[d]=h,u._properties[m]=y,u._properties[d]=_,LyteComponent.newRemoveContext(l[p],c)}else if("forIn"===l[p].getAttribute("is")&&l[p]._items){var C=[];LyteComponent.newAddContext(l[p],C);var L=l[p].getAttribute("key"),w=l[p].getAttribute("value"),A=l[p]._callee,N=A.component.data[w],x=A.component.data[L],E=A._properties[w],S=A._properties[L],P=l[p]._attributes.object;for(var I in l[p]._items)if(A.component.data[w]=P[I],A.component.data[L]=I,A._properties[w]=l[p]._items[I].itemProperty,l[p]._items[I]._dynamicProperty[a]){s=l[p]._items[I]._dynamicProperty[a];for(var k=0;k<s.length;k++)s[k]._callee.updateNode(s[k],a)}A.component.data[w]=N,A.component.data[L]=x,A._properties[w]=E,A._properties[L]=S,LyteComponent.newRemoveContext(l[p],C)}else{s=l[p]._dynamicProperty[e._path]||[];var O=[];LyteComponent.newAddContext(l[p],O);for(var B=0;B<s.length;B++)s[B]._callee.updateNode(s[B],e._path);LyteComponent.newRemoveContext(l[p],O)}if(e._observers)for(var j=e._observers.toArrayLyte(),D=0;D<j.length;D++){var H=j[D];H.observer.value.call(H.callee&&H.callee.component?H.callee.component:o||window,{type:"change",oldValue:n,newValue:r,item:e._path})}if(Array.isArray(e))for(var T=0;T<e.length;T++)for(var M in e[T])this.affectChanges(e[T][M],!0,n?n[T]?n[T][M]:n[T]:n,o,r?r[T]?r[T][M]:r[T]:r);else for(var V in e)this.affectChanges(e[V],!0,n?n[V]:n,o,r?r[V]:r)},getDynamicData:function(e,t){var n=this;return t.forEach(function(t,o){if(Array.isArray(t)){if(void 0===e)return;var r=n.getDynamicData.call(n,n.component.data,t);if(void 0===r)return;e=e[r]}else{if(void 0===e)return;e=e[t]}}),e},get:function(e,t,n){n||(n=[]);try{var o=t.match(/([^[\]]+|\[\])/g),r=e;n.push(o[0]);for(var i=o[0].split("."),a=0;a<i.length;a++)e=e[i[a]];for(var s=1;s<o.length;s++){var l=o[s];if(l.startsWith(".")){for(var p=l.substring(1).split("."),c=0;c<p.length;c++)e=e[p[c]];n[n.length-1]=n[n.length-1]+l}else if(l.startsWith("'")||l.startsWith('"')||!isNaN(l))isNaN(l)?n[n.length-1]=n[0]+"."+l.substring(1,l.length-1):n[n.length-1]=n[0]+"."+l,e=e[l.substring(1,l.length-1)];else{n.length;var d=this.get(r,l,n);n[0]=n[0]+"."+d,e=e[d]}}return e}catch(e){return}},getNew:function(e,t){try{var n=t.match(/([^[\]]+|\[\])/g),o=e,r=n[0].split(".");if(n.length<2){if(r.length<2)return{context:o,lastKey:r[0]};for(var i=0;i<r.length-1;i++)e=e[r[i]];return{context:e,lastKey:r[i]}}for(var a=0;a<r.length;a++)e=e[r[a]];for(var s=1;s<n.length-1;s++){var l=n[s];if(l.startsWith("."))for(var p=l.substring(1).split("."),c=0;c<p.length;c++)e=e[p[c]];else if(l.startsWith("'")||l.startsWith('"')||!isNaN(l))e=e[l.substring(1,l.length-1)];else{e=e[this.get(o,l)]}}var d=n[s];if(d.startsWith(".")){for(var m=d.substring(1).split("."),u=0;u<m.length-1;u++)e=e[m[u]];d=m[u]}else d=d.startsWith("'")||d.startsWith('"')||!isNaN(d)?d.substring(1,d.length-1):this.get(o,d);return{context:e,lastKey:d}}catch(e){return}},componentGetData:function(e){return e?this.get(e):this.data},componentSetData:function(e,t){if("string"==typeof e)this.set(e,t);else if(e instanceof Object)for(var n in e)this.set(n,e[n])},componentGetMethods:function(e){return e?this.methods[e]:this.methods},componentSetMethods:function(e,t){if("string"==typeof e)this.methods[e]=t;else if(e instanceof Object)for(var n in e)this.methods[n]=e[n]},render:function(e,t,n){if(e){var o=document.createElement(e);if(t&&o.setData(t),n){var r=document.querySelector(n);r?r.appendChild(o):console.warn("Specified outlet doesn't exist")}return o}console.error("Component name not specified")},String:{upperCaseFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},lowerCaseFirstLetter:function(e){return e.charAt(0).toLowerCase()+e.slice(1)},toCamelCase:function(e){return e.replace(/(-\w)/g,function(e){return e[1].toUpperCase()})},dasherize:function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}},appendChild:function(e,t){LyteComponent.ignoreDisconnect=!0,e.appendChild(t),LyteComponent.ignoreDisconnect=!1},replaceWith:function(){var e=Array.from(arguments),t=e.shift();LyteComponent.ignoreDisconnect=!0,t.replaceWith.apply(t,e),LyteComponent.ignoreDisconnect=!1},insertBefore:function(e,t){LyteComponent.ignoreDisconnect=!0,e.parentNode.insertBefore(t,e||null),LyteComponent.ignoreDisconnect=!1},insertAfter:function(){var e=Array.from(arguments),t=e.shift();LyteComponent.ignoreDisconnect=!0,t.after.apply(t,e),LyteComponent.ignoreDisconnect=!1},executeMethod:function(){var e=Array.prototype.slice.call(arguments,1),t=LyteComponent.String.toCamelCase(arguments[0]);if(this.methods[t])return this.methods[t].apply(this,e);console.error(t+" method not found")},establishObserverBindings:function(e,t,n){var o=this;t&&(o=t);for(var r=0;r<e.length;r++)for(var i=e[r].properties,a=0;a<i.length;a++){var s=void 0,l=!1;-1!==i[a].indexOf(".[]")?(l=!0,s=LyteComponent.getProperty.call(this,i[a].substring(0,i[a].indexOf(".[]")),t,n)):s=LyteComponent.getProperty.call(this,i[a],t,n),s._observers||Object.defineProperty(s,"_observers",{value:new Set,enumerable:!1,writable:!0,configurable:!0}),s._observers.add({callee:o,observer:e[r],isArrayObserver:l})}},getProperty:function(e,t,n){var o=e.split("."),r=this;t?(r=n,n[o[0]]||(n[o[0]]={}),r=n[o[0]]):(r._properties[o[0]]||(r._properties[o[0]]={}),r=r._properties[o[0]]),Object.defineProperty(r,"_path",{enumerable:!1,value:o[0]});for(var i=1;i<o.length;i++)r[o[i]]||(r[o[i]]={},Object.defineProperty(r[o[i]],"_path",{enumerable:!1,value:r._path+"."+o[i]})),r=r[o[i]];return r},getProperData:function(e){var t=e.dataType,n=e.attr,o=e.newValue,r=e.tagName;switch(t){case"boolean":o=!(!o||"false"===o);break;case"object":try{(o=JSON.parse(o))instanceof Object||console.warn("data type of the value provided for attribute "+n+" of "+r+" is not valid")}catch(e){return void console.warn("attribute "+n+" is not a valid JSON string.")}break;case"array":try{(o=JSON.parse(o))instanceof Array||console.warn("data type of the value provided for attribute "+n+" of "+r+" is not valid")}catch(e){return void console.warn("attribute "+n+" is not a valid JSON string.")}break;case"number":var i=+o;if(o!==i+"")return void console.warn("data type of the value provided for attribute "+n+" of "+r+" is not valid");o=i}return e.newValue=o,!0}};Lyte.Component.render=LyteComponent.render,LyteComponent.lyteComponentsDiv=document.createElement("div"),LyteComponent.styleDiv=document.createElement("div"),LyteComponent.lyteComponentsDiv.setAttribute("id","lyte-components-div"),LyteComponent.dummyLyteComponentsDiv=document.createElement("div"),LyteComponent.dummyLyteComponentsDiv.setAttribute("id","dummy-lyte-components-div"),Set.prototype.toArrayLyte=function(){return"Set"===this.constructor.name?Array.from(this):Array.from(this._values)},"complete"===document.readyState||"interactive"===document.readyState?onDomContentForLyte():document.addEventListener("DOMContentLoaded",function(e){onDomContentForLyte()},!0),LyteComponent.registerHelper("unbound",function(e){return e}),LyteComponent.registerHelper("action",function(e,t,n,o){n?(e._actions=e._actions?e._actions:{},e._actions[t]||(this.createCustomEvent(t,e,o),e.removeAttribute(t))):this.createEventListeners(e,t,o)}),LyteComponent.registerHelper("lbind",function(e){return this.getData(e)}),LyteComponent.registerHelper("method",function(e,t,n){arguments[0],t=arguments[1],n=arguments[2];var o=arguments[0].component,r=t?t.ownerElement:null,i=arguments[1].nodeName;t=null;var a=Array.prototype.slice.call(arguments,3),s=function(){var e=Array.from(arguments),t=a.concat(e);return o.methods[n].apply(o,t)};if(!r)return s;r.set?r.component.methods[LyteComponent.String.toCamelCase(i)]=s:r.setMethods(LyteComponent.String.toCamelCase(i),s)}),LyteComponent.registerHelper("unescape",function(e){var t=document.createElement("div");return t.innerHTML=e,t}),LyteComponent.registerHelper("debugger",function(){}),LyteComponent.registerHelper("log",function(){console.log.apply(window,Array.from(arguments))}),LyteComponent.registerHelper("ifEquals",function(e,t){return e===t}),LyteComponent.registerHelper("if",function(e,t,n){return e?t:n}),LyteComponent.registerHelper("negate",function(e){return!e}),LyteComponent.registerHelper("ifNotEquals",function(e,t){return e!==t}),LyteComponent.registerHelper("concat",function(){for(var e="",t=arguments.length,n=0;n<t;n++)void 0!=arguments[n]&&(e+=arguments[n]);return e}),Object.defineProperty(HTMLElement.prototype,"setData",{enumerable:!1,value:function(e,t){if(this._initProperties=this._initProperties||{},"string"==typeof e)this._initProperties[e]=t;else if(e instanceof Object)for(var n in e)this._initProperties[n]=e[n]}}),Object.defineProperty(HTMLElement.prototype,"setMethods",{enumerable:!1,value:function(e,t){if(this._initMethods=this._initMethods||{},"string"==typeof e)this._initMethods[e]=t;else if(e instanceof Object)for(var n in e)this._initMethods[n]=e[n]}}),LyteComponent.registerHelper("expHandlers",function(e,t,n){if("++"==t){if("postfix"==n)return e++;if("prefix"==n)return++e}else if("--"==t){if("postfix"==n)return e--;if("prefix"==n)return--e}else{if("=="==t||"==="==t)return e==n;if("!="==t||"!=="==t)return e!=n;if("&&"==t)return e&&n;if("||"==t)return e||n;if("+"==t&&n)return e+n;if("-"==t&&n)return e-n;if("*"==t)return e*n;if("/"==t)return e/n;if("%"==t)return e%n;if("<"==t)return e<n;if(">"==t)return e>n;if("<="==t)return e<=n;if(">="==t)return e>=n;if("|"==t)return e|n;if("&"==t)return e&n;if("!"==t)return!e;if("-"==t&&!n)return-e;if("="==t)return e=n;if("+="==t)return e+=n;if("-="==t)return e-=n;if("*="==t)return e*=n;if("/="==t)return e/=n}}),Lyte.Component.register("lyte-event-listener",{_template:'<template tag-name="lyte-event-listener"></template>',_dynamicNodes:[],_observedAttributes:["eventName"],init:function(){var e=this,t=Lyte.addEventListener(this.get("eventName"),function(){var t=Array.prototype.slice.call(arguments);t.splice(0,0,"on-fire"),e.throwEvent.apply(e,t)});this.regId=t},data:function(){return{eventName:Lyte.attr("string")}},didDestroy:function(){Lyte.removeEventListener(this.regId)}}),Lyte.Component.registerCustomPropHandler("ltProp");
function Adapter(e,r,t){var o=this;r&&r.mixins&&r.mixins.length&&r.mixins.forEach(function(e){var r=Lyte.registeredMixins[e];for(var t in r)o[t]=r[t]});for(key in e)this[key]=e[key];if(store.adapter.__toAddSuper&&store.adapter.__toAddSuper.hasOwnProperty(t)){for(var a=store.adapter.__toAddSuper[t],i=0;i<a.length;i++){var s=store.adapter[a[i]];s.isAdapter&&(s.$super=this)}delete store.adapter.__toAddSuper[t]}Object.defineProperty(this,"extends",{enumerable:!1,value:store.$.extendAdapter}),Object.defineProperty(this,"isAdapter",{value:!0,enumerable:!1}),Object.defineProperty(this,"__name",{value:t,enumerable:!1})}function Serializer(e,r,t){for(key in e)this[key]=e[key];var o=this;if(r&&r.mixins&&r.mixins.length&&r.mixins.forEach(function(e){var r=Lyte.registeredMixins[e];for(var t in r)o[t]=r[t]}),store.serializer.__toAddSuper&&store.serializer.__toAddSuper.hasOwnProperty(t)){for(var a=store.serializer.__toAddSuper[t],i=0;i<a.length;i++){var s=store.serializer[a[i]];s.isSerializer&&(s.$super=this)}delete store.serializer.__toAddSuper[t]}Object.defineProperty(this,"extends",{enumerable:!1,value:store.$.extendSerializer}),Object.defineProperty(this,"isSerializer",{value:!0,enumerable:!1}),Object.defineProperty(this,"__name",{value:t,enumerable:!1})}var $Record=function(){Object.assign(this,{isModified:!1,isNew:!1,isDeleted:!1,isError:!1,events:[],validatedOnCreate:!0,error:{}})},Record=function(e,r){Object.assign(this,r),Object.defineProperties(this,{$:{enumerable:!1,writable:!0,value:new $Record}});var t=store.modelFor(e);Object.defineProperties(this.$,{model:{enumerable:!1,value:t},record:{enumerable:!1,value:this},_attributes:{enumerable:!1,value:{},writable:!0},isDirty:{enumerable:!1,value:function(){var e=[];if(this.record.$.isModified)return!0;var r=this.model.relations;for(var t in r)for(var o=r[t],a=0;a<o.length;a++){var t=o[a];if(t.opts&&t.opts.serialize&&"record"===t.opts.serialize){var i=t.relKey,s=t.relType,n=this.record[i];if("belongsTo"===s&&n&&n.$&&n.$.isModified)e.push(i);else if("hasMany"===s)for(var d=0;d<n.length;d++)n[d]&&n[d].$&&n[d].$.isModified&&e.push(i)}}return e.length?e:!1}}});{var o=t.fieldList;new error1}for(var a in o){var i=o[a];if("relation"!=i.type){var s=r[a];(void 0==s||""===s||null==s)&&i.hasOwnProperty("default")&&(this[a]=i.default)}}var n=t._properties;Object.keys(n).length&&(this._bindings||Object.defineProperty(this,"_bindings",{value:new Set,enumerable:!1,writable:!0}),this._bindings.add(n),store.$.establishObserverBindings(this,n))};Object.defineProperties($Record.prototype,{get:{enumerable:!1,value:function(e){return this.record[e]}},set:{enumerable:!1,value:function e(r,e){if(this.isDeleted)store.$.setRecordError(this,this.model._primaryKey,"ERR17");else if("undefined"!=typeof LyteComponent){var t;if("string"==typeof r&&this.record[r]!==e)t=LyteComponent.set(this.record,r,e);else if("object"==typeof r){for(key in r)this.record[key]===r[key]&&delete r[key];t=LyteComponent.set(this.record,r,e)}if(t&&t.$&&t.$.isError)return t}else store.$.setData(this,r,e);return this.record}},getDirtyAttributes:{enumerable:!1,value:function(){var e=this._attributes,r=[];if(Object.keys(e).length)for(var t in e)r.push(t);return r}},rollBackAttributes:{enumerable:!1,value:function(e){Array.isArray(e)||(e=[e]);for(var r=this.record,t=[],o=this.model,a=0;a<e.length;a++){var i=e[a];if(this._attributes.hasOwnProperty(i)){var s=o.fieldList[i],n=this._attributes[i];"relation"==s.type?store.$.rollBackRecordsArray(n,r,o,s):"undefined"!=typeof LyteComponent?LyteComponent.set(r,i,n):r[i]=n,t.push(i),delete this._attributes[i],store.$.clearRecordError(this,i)}}if(Object.keys(this._attributes).length||(this.isModified=!1,this.isNew||store.$.deleteFromArray(o.dirty,this.get(o._primaryKey))),t.length>0){var d=[r,t];this.emit("change",d),o.emit("change",d)}}},rollBack:{enumerable:!1,value:function(){var e=this.model,r=e._primaryKey;if(this.isDeleted){var t=store.$.getIndex(e._deleted,r,this.get(r));store.$.rollBackDelete(e,t)}else this.isModified?this.rollBackAttributes(this.getDirtyAttributes()):this.isNew?store.$.rollBackNew(e,this.record,r):this.isError&&store.$.clearRecordError(this)}},deleteRecord:{enumerable:!1,value:function(){var e=this.model,r=this.record,t=e._primaryKey;store.$.removeFromStore(e,r[t])}},destroyRecord:{enumerable:!1,value:function(e){return this.deleteRecord(),this.save(e,"destroyRecord")}},addEventListener:{enumerable:!1,value:function(e,r){return store.$.eventListeners.add(this,e,r)}},removeEventListener:{enumerable:!1,value:function(e){store.$.eventListeners.remove(this,e)}},emit:{enumerable:!1,value:function(e,r){store.$.eventListeners.emit(this,e,r)}},triggerAction:{enumerable:!1,value:function(e,r){var t=this.model,o=t.actions,a=o?o[e]:void 0;return a?store.adapter.$.handleAction(e,t,this.record,r):Promise.reject({code:"ERR18",message:Lyte.errorCodes.ERR18,data:e})}},save:{enumerable:!1,value:function(e,r){var t=this.model,o=this.record,a=this.isDirty();if(this.isDeleted){if(!this.isNew)return store.adapter.$.del(t._name,o,!0,r,e);store.adapter.$.handleResponse(void 0,o,o,void 0,void 0,t)}else{if(this.isNew){var i=t.fieldList,s=new error1;for(var n in i){var d=o[n],l=i[n];if(!this.validatedOnCreate)if(null==d||void 0==d||""==d||0==d.length)l.mandatory&&store.$.setError(s,n,{code:"ERR02",message:Lyte.errorCodes.ERR02});else for(var c in l){var u=store.$.checkProperty(c,o[n],n,l[c]);if(1!=u){store.$.setError(s,n,u);break}}Lyte.Transform[l.type]&&Lyte.Transform[l.type].serialize&&(o[n]=Lyte.Transform[l.type].serialize(o[n]))}return Object.keys(s).length>0?Promise.reject(s):store.adapter.$.create(t._name,o,!0,e)}if(this.isModified||a&&a.length){var f={};for(var n in this._attributes)f[n]=Lyte.Transform[t.fieldList[n].type]&&Lyte.Transform[t.fieldList[n].type].serialize?Lyte.Transform[t.fieldList[n].type].serialize(o[n]):o[n];for(var y=0;y<a.length;y++)f[a[y]]=o[a[y]];var p=t._primaryKey;return f[p]=o.$.get(p),store.adapter.$.put(t._name,f,o,!0,e)}}return Promise.resolve()}},getInitialValues:{enumerable:!1,value:function(e){var r=!1;e?(Array.isArray(e)||(e=[e]),r=!0):e=this.getDirtyAttributes();for(var t={},o=this.record,a=0;a<e.length;a++)if(void 0!=o[e]&&o[e[a]].add){t[e[a]]=o[e[a]].slice(0);for(var i=this._attributes[e[a]],s=o[e[a]].model._primaryKey,n=i.length-1;n>=0;n--)if("added"==i[n]._type)for(var d=0;d<i[n].records.length;d++){var l=store.$.getIndex(t[e[a]],s,i[n].records[d][s]);-1!=l&&t[e[a]].splice(l,1)}else if("removed"==i[n]._type)for(var d=i[n].records.length-1;d>=0;d--)t[e[a]].splice(i[n]._indices[d],1,i[n].records[d]);else"changed"==i[n]._type&&(t[e[a]]=i[n].records)}else t[e[a]]=this._attributes[e[a]];return r?t[e[0]]:t}},toJSON:{enumerable:!1,value:function(){return Object.assign({},store.$.toJSON(this.model._name,this.record,!0))}}});var Model=function(e,r){Object.assign(this,{_name:e,_primaryKey:"id",fieldList:{id:{type:"string",primaryKey:!0}},relations:{},_properties:{},data:[],dirty:[],_deleted:[],events:{}});var t=[];for(var o in r){var a=r[o];if("observer"==a.type)t.push(a);else if("callBack"==a.type){a.observes&&t.push(a.observes);for(var i=a.properties,s=0;s<i.length;s++)"didLoad"===i[s]||"init"===i[s]?(this.didLoad||(this.didLoad=[]),this.didLoad.push(a.value)):("add"===i[s]||"change"===i[s])&&this.on(i[s],a.value);"didLoad"==o&&(this.didLoad||(this.didLoad=[]),this.didLoad.push(a.value))}else"didLoad"==o?(this.didLoad||(this.didLoad=[]),this.didLoad.push(a)):Object.keys(a).length&&(a.primaryKey&&(delete this.fieldList.id,this._primaryKey=o),this.fieldList[o]=r[o]);"relation"===a.type&&(a.relKey=o,this.relations[a.relatedTo]||(this.relations[a.relatedTo]=[]),this.relations[a.relatedTo].push(this.fieldList[o]))}"undefined"!=typeof LyteComponent&&LyteComponent.establishObserverBindings(t,!0,this._properties),Object.defineProperties(this.data,{model:{enumerable:!1,value:this},filterBy:{enumerable:!1,value:store.$.filterBy},sortBy:{enumerable:!1,value:store.$.sortBy},mapBy:{enumerable:!1,value:store.$.mapBy}}),Object.defineProperty(this,"extends",{enumerable:!1,value:store.$.extendModel})};Model.prototype.addEventListener=function(e,r){return store.$.eventListeners.add(this,e,r)},Model.prototype.removeEventListener=function(e){store.$.eventListeners.remove(this,e)},Model.prototype.emit=function(e,r){store.$.eventListeners.emit(this,e,r)},Model.prototype.on=function(e,r){return this.addEventListener(e,r)};var store={model:{},$:{setError:function(e,r,t){e.$.hasOwnProperty("error")?"undefined"!=typeof LyteComponent?LyteComponent.set(e.$.error,r,t):e.$.error[r]=t:console.error("Cannot set the error ",e," for ",r)},eventListeners:{add:function(e,r,t){return e.events=e.events||{},e.events[r]=e.events[r]||[],e.events[r].push({f:t}),r+"-"+(e.events[r].length-1)},remove:function(e,r){var t;if(r)if(/^(add|remove|change)$/.test(r))t=r,e.events&&e.events[t]?delete e.events[t]:void 0;else{var o=r?r.split("-"):void 0;if(o){var a=e.events[o[0]];a&&o[1]&&(a[o[1]]=null)}}else{var i=e.events;for(var s in i)i&&i[s]?delete i[s]:void 0}},emit:function(e,r,t){for(var o=e.events&&e.events[r]?e.events[r]:[],a=0;a<o.length;a++)o[a]?o[a].f.apply(null,t):void 0}},extendAdapter:function(e){var r;return e&&"string"==typeof e&&(r=store.adapter[e],r||(store.adapter.__toAddSuper||(store.adapter.__toAddSuper={}),store.adapter.__toAddSuper.hasOwnProperty(e)||(store.adapter.__toAddSuper[e]=[]),store.adapter.__toAddSuper[e].push(this.__name))),r&&r.isAdapter&&!this.$super&&(this.$super=r),this},extendSerializer:function(e){var r;return e&&"string"==typeof e&&(r=store.serializer[e],r||(store.serializer.__toAddSuper||(store.serializer.__toAddSuper={}),store.serializer.__toAddSuper.hasOwnProperty(e)||(store.serializer.__toAddSuper[e]=[]),store.serializer.__toAddSuper[e].push(this.__name))),r&&r.isSerializer&&!this.$super&&(this.$super=r),this},extendModel:function(e){if(e&&store.model[e]){var r=Object.assign({},store.model[e].fieldList);for(var t in r)"relation"==r[t].type&&delete r[t];this.fieldList=Object.assign(this.fieldList,r);var o=this._name;store.model[o].extend=e,store.model[e].extendedBy||(store.model[e].extendedBy={}),store.model[e].extendedBy[o]=!0,!store.adapter[o]&&store.adapter[e]&&(store.adapter[o]=store.adapter[e]),!store.serializer[o]&&store.serializer[e]&&(store.serializer[o]=store.serializer[e])}},establishObserverBindings:function(e,r,t){t||(t=e);for(key in r)!(e[key]instanceof Object)||e[key]._bindings&&e[key]._setterScope?e._setterScope||Object.defineProperty(e,"_setterScope",{value:e,enumerable:!1}):(e[key]._bindings||Object.defineProperty(e[key],"_bindings",{value:new Set,enumerable:!1,writable:!0}),t&&!e[key]._setterScope&&Object.defineProperty(e[key],"_setterScope",{value:t,enumerable:!1}),e[key]._bindings.add(r[key]),Object.keys(r[key]).length&&this.establishObserverBindings(e[key],r[key],e))},dataFromSocket:function(e,r,t){var o,a=store.modelFor(e),i=a._primaryKey;if(Array.isArray(t)||(t=[t]),"POST"===r)for(var s=0;s<t.length;s++)o=void 0,t&&(o=store.$.newRecord(e,t[s]),o.$.isNew=!1,store.$.deleteFromArray(a.dirty,o[i]));else if("PATCH"===r){for(var s=0;s<t.length;s++)if(o=void 0,t&&(o=store.peekRecord(e,t[s][i]),!o.$.isModified)){delete t[s][i];for(var n in t[s])LyteComponent.set(o,n,t[s][n],!0);o.$.isModified=!1}}else if("DELETE"===r)for(var s=0;s<t.length;s++)o=void 0,t&&(o=store.peekRecord(e,t[s][i]),o.$.isModified||store.unloadRecord(e,t[s][i]))},setData:function(e,r,t){var o={emit:!1,attr:[]};if(r instanceof Object)for(var a in r)this.setValue(e,a,r[a],o);else this.setValue(e,r,t,o);if(o.emit){var i=[e.record,o.attr];e.emit("change",i),e.model.emit("change",i),store.emit("change",[e.model._name,e.record,o.attr])}return e.record},setValue:function(e,r,t,o){var a=e.model;if(r!=a._primaryKey){var i=a.fieldList[r],s=e.record;if(i)if(void 0!=t&&null!=t&&""!=t||!i.mandatory){if(i.relType){var n,d={};if(this.getRelations(a,i.relKey,store.modelFor(i.relatedTo),d),s[r]&&"hasMany"==i.relType?(n=s[r].slice(0),this.toDemolishLink(a,s,d.forward),s[r].splice(0,s[r].length)):s[r]&&"belongsTo"==i.relType&&(n=this.createCopy(s[r]),this.toDemolishLink(a,s,d.forward),s[r]=void 0),Array.isArray(t)){if("belongsTo"==i.relType)return this.revertToOldVal(s,r,n,d),void store.$.setRecordError(e,r,"ERR21",t)}else t=[t];for(var l=store.modelFor(i.relatedTo),c=l._primaryKey,u=l.fieldList[c].type,f=[],y=0;y<t.length;y++)if(void 0!=t[y]){var p=t[y];if(typeof t[y]==u){if(p=store.peekRecord(t[y]._type?t[y]._type:i.relatedTo,t[y]),p.$&&p.$.isError){f.push({code:"ERR15",message:Lyte.errorCodes.ERR15,error:Object.assign({},p)});continue}}else if("object"==typeof t[y]){if(p.$&&p.$.isError){f.push({code:"ERR15",message:Lyte.errorCodes.ERR15,error:Object.assign({},p)});continue}if(!Lyte.isRecord(p)&&(p=this.newRecord(t[y]._type?t[y]._type:i.relatedTo,t[y]),p.$.isError)){f.push({code:"ERR15",data:t[y],message:Lyte.errorCodes.ERR15,error:Object.assign({},p)});continue}}var h=this.establishLink(d.forward,d.backward,s,p);1!=h&&f.push({code:h,data:t[y],message:Lyte.errorCodes[h]})}if(f.length&&f.length==t.length)return this.revertToOldVal(s,r,n,d),void("belongsTo"==i.relType?store.$.setRecordError(e,r,f[0]):store.$.setRecordError(e,r,f));f.length>1?store.$.setRecordError(e,r,f):store.$.clearRecordError(e,r),s.$._attributes.hasOwnProperty(r)||(s.$._attributes[r]=[]),s.$._attributes[r].push({_type:"changed",records:n}),o.emit=!0,o.attr.push(r);var m=s.$.getInitialValues(r),h=!0;if(m&&Array.isArray(s[r])&&m.length==s[r].length){h=!1;for(var y=0;y<m.length;y++)if(!store.$.compareRecords(m[y],s[r][y],c)){h=!0;break}}h||delete s.$._attributes[r]}else if(t!=s[r]){if(void 0!=t)for(var v in i){var g=this.checkProperty(v,t,r,i[v]);if(1!=g)return void store.$.setRecordError(e,r,g,t)}var R=s.$._attributes[r];s.$._attributes.hasOwnProperty(r)||void 0==t?("object"==typeof t&&store.adapter.$.compareObjects(R,t)||R==t)&&delete s.$._attributes[r]:s.$._attributes[r]=this.createCopy(s[r]),"undefined"!=typeof LyteComponent?LyteComponent.set(s,r,t,!0):s[r]=t,o.emit=!0,o.attr.push(r),store.$.clearRecordError(e,r)}}else store.$.setRecordError(e,r,"ERR02");else"undefined"!=typeof LyteComponent?LyteComponent.set(s,r,t,!0):s[r]=t,o.emit=!0,o.attr.push(r);Object.keys(s.$._attributes).length?(e.isModified=!0,this.checkAndAddToArray(a.dirty,s[a._primaryKey])):(e.isModified=!1,e.isNew||this.deleteFromArray(a.dirty,s[a._primaryKey]))}else store.$.setRecordError(e,r,"ERR01",t)},checkForCorrectRelation:function(e,r){var t=e.relatedTo;return Lyte.isRecord(r)?e.opts&&e.opts.polymorphic?r.$.model.extend?e.relatedTo===r.$.model.extend:!1:e&&r?t===r.$.model._name:!1:!1},removeKeys:function(e,r){for(var t in r)if(e.hasOwnProperty(t)){var o=e[t];("belongsTo"===o.type||"hasMany"===o.type&&r[t])&&this.removeNotDefinedKeys(o.relatedTo,r[t],o.opts&&o.opts.polymorphic?!0:void 0)}else delete r[t]},removeNotDefinedKeys:function(e,r,t){var o=e.fieldList;if(Array.isArray(r))for(var a=0;a<r.length;a++){var i=r[a];this.removeKeys(t&&Lyte.isRecord(i)?i.$.model.fieldList:o,i)}else this.removeKeys(t&&Lyte.isRecord(i)?i.$.model.fieldList:o,i)},add:function(e,r){var t=this.record,o=t.$.model,a=this.key,i=o.fieldList[a],s={};store.$.getRelations(o,i.relKey,store.modelFor(i.relatedTo),s),Array.isArray(e)||(e=[e]);for(var n=store.modelFor(s.forward.relatedTo)._primaryKey,d=[],l=[],c=0;c<e.length;c++){var u=e[c];if("object"!=typeof u||Lyte.isRecord(u)){if(store.modelFor(s.forward.relatedTo).fieldList[n].type.toLowerCase()==typeof u){if(this.polymorphic&&!r){d.push({code:"ERR22",data:e[c],message:Lyte.errorCodes.ERR22});continue}u=store.peekRecord(r?r:s.forward.relatedTo,u)}}else u=store.$.newRecord(u._type?u._type:r?r:i.relatedTo,u);var f=u&&u._type?u._type:r?r:void 0;if(void 0==u)d.push({code:"ERR13",data:e[c],message:Lyte.errorCodes.ERR13});else if(u.$&&u.$.isError)d.push({code:"ERR15",data:e[c],message:Lyte.errorCodes.ERR15,error:u});else if(Lyte.isRecord(u)&&!store.$.hasDuplicateRelation(u,t[a],n,f)){var y=store.$.establishLink(s.forward,s.backward,t,u);1!=y?d.push({code:y,data:e[c],message:Lyte.errorCodes[y]}):l.push(u)}}return l.length&&(t.$._attributes[a]||(t.$._attributes[a]=[]),t.$._attributes[a].push({_type:"added",records:l}),store.$.emit("change",t,[a]),store.$.hasRecordsArrayChanged(t,a)?(t.$.isModified=!0,store.$.checkAndAddToArray(o.dirty,t[o._primaryKey])):(t.$.isModified=!1,delete t.$._attributes[a],t.$.isNew||store.$.deleteFromArray(o.dirty,t[o._primaryKey]))),d.length>0?store.$.setRecordError(t.$,a,d):store.$.clearRecordError(t.$,a),t},remove:function(e,r){var t=this.record,o=t.$.model,a=this.key,i=o.fieldList[a],s={};store.$.getRelations(o,i.relKey,store.modelFor(i.relatedTo),s),Array.isArray(e)||(e=[e]);for(var n,d=store.modelFor(s.forward.relatedTo)._primaryKey,l=[],c=[],u=[],f=0;f<e.length;f++){if(store.modelFor(s.forward.relatedTo).fieldList[d].type.toLowerCase()==typeof e[f]){if(1==this.polymorphic&&!r){l.push({code:"ERR22",data:e[f],message:Lyte.errorCodes.ERR22});continue}n=store.peekRecord(r?r:s.forward.relatedTo,e[f])}else Lyte.isRecord(e[f])&&(n=e[f]);var y=n&&n._type?n._type:r?r:void 0;if(n){var p=store.$.getIndex(t[a],d,n.$.get(d),y);store.$.demolishLink(n,d,store.peekRecord(s.backward.relatedTo,t[o._primaryKey]),s.forward.relKey),store.$.demolishLink(t,o._primaryKey,store.peekRecord(y?y:s.forward.relatedTo,n[d]),s.backward.relKey),c.push(n),u.push(p)}}c.length&&(t.$._attributes[a]?store.$.hasRecordsArrayChanged(t,a)?t.$._attributes[a].push({_type:"removed",records:c,indices:u}):(t.$.isModified=!1,delete t.$._attributes[a],t.$.isNew||store.$.deleteFromArray(o.dirty,t[o._primaryKey])):(t.$._attributes[a]=[{_type:"removed",records:c,_indices:u}],t.$.isModified=!0,store.$.checkAndAddToArray(o.dirty,t[o._primaryKey])),store.$.emit("change",t,[a])),l.length>0?store.$.setRecordError(t.$,a,l):store.$.clearRecordError(t.$,a)},filter:function(e,r,t){var o=0;for(var a in r)e[a]===r[a]&&o++;return o===t?!0:void 0},filterBy:function(e){for(var r=Object.keys(e).length,t=[],o=0;o<this.length;o++)store.$.filter(this[o],e,r)&&t.push(this[o]);return t.filterBy||Object.defineProperties(t,{model:{enumerable:!1,value:this.model},filterBy:{enumerable:!1,value:this.filterBy},sortBy:{enumerable:!1,value:this.sortBy},mapBy:{enumerable:!1,value:store.$.mapBy}}),t},removeSelfCircularReference:function(e,r,t){var o=store.modelFor(e),a=o.fieldList;for(var i in r){var s=a[i];if(r[i]&&s&&"relation"==s.type){var n=store.modelFor(s.relatedTo);if(void 0==n)continue;var d=s.relKey,l={};this.getRelations(o,d,n,l);var c=s.opts?s.opts.serialize:void 0,u=r[d],f=o._primaryKey,y=r[f];if(t||"id"==c)Array.isArray(u)?r[d]=u.map(function(e){return e[f]}):u&&Lyte.isRecord(u)&&(r[d]=u[n._primaryKey]);else if("record"===c)if(Array.isArray(u)){u=Array.from(u);for(var p=0;p<u.length;p++)u[p]&&Lyte.isRecord(u[p])&&(this.removeBackwardRel(u[p],l,f,y),this.removeSelfCircularReference(n._name,u[p],t))}else u&&Lyte.isRecord(u)&&(this.removeBackwardRel(u,l,f,y),this.removeSelfCircularReference(n._name,u,t));else delete r[d]}}},removeBackwardRel:function(e,r,t,o){var a=e[r.backward.relKey];if(Array.isArray(a)){for(var i=0;i<a.length;i++)if(a[i][t]===o)return a.splice(i,1),void(0==a.length&&delete e[r.backward.relKey])}else a&&Lyte.isRecord(a)&&a[t]==o&&delete e[r.backward.relKey]},toJSON:function(e,r,t){var o;if(Array.isArray(r)){for(var a=[],i=0;i<r.length;i++)o=this.deepCopyObject(r[i]),this.removeSelfCircularReference(e,o,t),a.push(o);return a}return("object"==typeof r||Lyte.isRecord(r))&&(o=this.deepCopyObject(r),this.removeSelfCircularReference(e,o,t)),o},deepCopyObject:function(e){for(var r,t,o,a,i,s,n=[{source:e,target:Object.create(Object.getPrototypeOf(e))}],d=[e],l=n[0].target,c=[l];r=n.shift();)for(t=Object.getOwnPropertyNames(r.source),o=0;o<t.length;o++)a=Object.getOwnPropertyDescriptor(r.source,t[o]),a.value&&"object"==typeof a.value?(i=a.value,a.value=Array.isArray(i)?[]:Object.create(Object.getPrototypeOf(i)),s=d.indexOf(i),-1==s?(d.push(i),c.push(a.value),Object.defineProperty(r.target,t[o],a),n.push({source:i,target:a.value})):(a.value=c[s],Object.defineProperty(r.target,t[o],a))):Object.defineProperty(r.target,t[o],a);return l},createCopy:function(e){if(Array.isArray(e)){if(e.save){for(var r=[],t=0;t<e.length;t++){var o=this.deepCopyObject(e[t]);r.push(o)}return r}}else if(e&&(Lyte.isRecord(e)||"object"==typeof e))return this.deepCopyObject(e);return e},compareRecords:function(e,r,t,o){if(Lyte.isRecord(e)&&Lyte.isRecord(r)&&t){var a=e.$.get(t),i=r.$.get(t);return o&&e._type&&o!==e._type?!1:a===i}return!1},hasRecordInArray:function(e,r,t,o){if(Lyte.isRecord(r)&&t)for(var a=0;a<e.length;a++)if((!o||e[a]._type===o)&&this.compareRecords(e[a],r,t))return!0;return!1},hasDuplicateRelation:function(e,r,t,o){return Array.isArray(r)?this.hasRecordInArray(r,e,t,o):r&&Lyte.isRecord(r)?this.compareRecords(e,r,t,o):!1},checkPresenceInArray:function(e,r){return e.some(function(e){return e===r})},checkAndAddToArray:function(e,r){this.checkPresenceInArray(e,r)||e.push(r)},deleteFromArray:function(e,r){for(var t=0;t<e.length;t++)e[t]==r&&e.splice(t,1)},generateRandomPk:function(e,r,t,o){var a=r[t]=Math.floor(1e5*Math.random()+1);for("string"==o&&(r[t]=a.toString());this.isDuplicateRecord(e.data,r,t);){var a=r[t]=Math.floor(1e5*Math.random()+1);"string"==o&&(r[t]=a.toString())}},newRecord:function(e,r,t){var o=store.modelFor(e);if(void 0==o)return new error1("id",{code:"ERR19",data:e,message:Lyte.errorCodes.ERR19,data:e});void 0==r&&(r={});var a=o.fieldList,i={},s=new error1,n=o._primaryKey;if(r[n])this.isDuplicateRecord(o.data,r,n)&&store.$.setError(s,n,{code:"ERR16",data:i[n],message:Lyte.errorCodes.ERR16});else{var d=a[n].type;this.generateRandomPk(o,r,n,d)}for(var l in a){var c=a[l];"hasMany"==c.relType&&(i[l]=[]);var u=r[l];if(void 0==u||""==u||null==u)c.hasOwnProperty("default")&&(i[l]=c.default),c.mandatory&&!t&&store.$.setError(s,l,{code:"ERR02",message:Lyte.errorCodes.ERR02}),c.pattern&&!t&&(new RegExp(c.pattern).test(u)||store.$.setError(s,l,{code:"ERR08",message:Lyte.errorCodes.ERR08,expected:c.pattern}));else if("relation"!=c.type&&!t)for(var f in c){var y=this.checkProperty(f,u,l,c[f],r);1!=y&&store.$.setError(s,l,y)}}for(var p in r)i[p]=r[p];i=new Record(e,i);var h=o.relations;for(var m in h)for(var v=h[m],g=0;g<v.length;g++)if(i&&i[v[g].relKey]){var R=r[v[g].relKey];i[v[g].relKey]=void 0;var c=v[g],b={},y=this.getRelations(o,c.relKey,store.modelFor(c.relatedTo),b);if(1!=y){store.$.setError(s,c.relKey,{code:y,data:v,message:Lyte.errorCodes[y]});continue}var $=store.modelFor(c.relatedTo),L=$.fieldList[$._primaryKey].type;if(Array.isArray(R)){if("belongsTo"==v[g].relType){store.$.setError(s,c.relKey,{code:"ERR21",data:R,message:Lyte.errorCodes.ERR21});continue}}else R=[R];s[c.relKey]=[];for(var _=0;_<R.length;_++){var k=void 0;R[_]&&Lyte.isRecord(R[_])?k=R[_]:R[_]&&typeof R[_]==L.toLowerCase()?k=store.peekRecord(c.relatedTo,R[_]):R[_]&&"object"==typeof R[_]&&(k=this.newRecord(c.relatedTo,R[_])),k&&k.$&&k.$.isError?store.$.setError(s,c.relKey,{code:"ERR15",data:R[_],message:Lyte.errorCodes.ERR15,error:Object.assign({},k)}):k&&k.$&&!k.$.isError&&(y=this.establishLink(b.forward,b.backward,i,k),1!=y&&store.$.setError(s,c.relKey,{code:y,data:R[_],message:Lyte.errorCodes[y]}))}if(0==s[c.relKey].length&&delete s[c.relKey],"hasMany"==v[g].relType){var A=v[g].relKey;void 0==i[A]&&(i[A]=[]),i[A].add||(v[g].opts&&v[g].opts.polymorphic&&Object.defineProperty(i[A],"polymorphic",{enumerable:!1,value:!0}),Object.defineProperties(i[A],{model:{enumerable:!1,value:store.modelFor(v[g].relatedTo)},record:{enumerable:!1,writable:!0,value:i},key:{enumerable:!1,value:A},filterBy:{enumerable:!1,value:this.filterBy},add:{enumerable:!1,value:this.add},remove:{enumerable:!1,value:this.remove},sortBy:{enumerable:!1,value:this.sortBy},mapBy:{enumerable:!1,value:this.mapBy}}))}}return s&&s.$&&Object.keys(s.$.error).length>0?s:(i.$.isNew=!0,"undefined"!=typeof Lyte.arrayUtils?Lyte.arrayUtils(o.data,"push",i):o.data.push(i),this.checkAndAddToArray(o.dirty,i[o._primaryKey]),o.emit("add",[i]),store.emit("add",[o._name,i]),t&&(i.$.validatedOnCreate=!1),i)},insertIntoStore:function(e,r){var t;if(Array.isArray(r)){t=[];for(var o=0;o<r.length;o++)t[o]=this.insertIntoStore(e,r[o]),t[o]&&t[o].$&&t[o].$.isError&&(t.$=t.$||Object.defineProperty(t,"$",{enumerable:!1,value:{}}),t.$.isError=!0)}else if(r&&Object.keys(r).length){var a=e;if(r._type&&(a=e.extendedBy[r._type]?store.modelFor(r._type):void 0),Lyte.isRecord(r))return void 0;t=this.isDuplicateRecord(a.data,r,a._primaryKey)?this.validateAndMerge(a,r):this.validateAndPush(a,new Record(a._name,r))}return t},removeFromStore:function(e,r,t){var o=e.data;if(0!=o.length){Array.isArray(r)||(r=[r]);for(var a=e._primaryKey,i=0;i<r.length;i++){var s=this.getIndex(o,a,r[i]);if(-1!=s){Object.keys(e.relations).length&&this.toDemolishRelation(e,s);var n;n="undefined"!=typeof Lyte.arrayUtils?Lyte.arrayUtils(o,"removeAt",s,1):o.splice(s,1),n&&!t&&(n[0].$.isDeleted=!0,(n[0].$.isNew||n[0].$.isModified)&&store.$.deleteFromArray(e.dirty,n[0][a]),e._deleted.push(n[0]),e.emit("remove",[n[0]]),store.emit("remove",[e._name,n[0]]))}}}},getIndex:function(e,r,t,o){for(var a=0;e&&a<e.length;a++)if((!o||e[a]._type===o)&&e[a][r]==t)return a;return-1},isDuplicateRecord:function(e,r,t){return e.length?e.some(function(e){return r[t]==e[t]?!0:void 0}):!1},validateAndPush:function(e,r){if(e.rel||(e.rel={}),!r.hasOwnProperty(e._primaryKey))return new error1(e._primaryKey,{code:"ERR23",data:r,message:Lyte.errorCodes.ERR23});if(r=this.validateJSON(e,r),!r.$.isError){if(e.didLoad)for(var t=e.didLoad,o=0;o<t.length;o++)t[o].apply(r);this.isDuplicateRecord(e.data,r,e._primaryKey)?this.mergeData(store.peekRecord(e._name,r[e._primaryKey]),r):("undefined"!=typeof Lyte.arrayUtils?Lyte.arrayUtils(e.data,"push",r):e.data.push(r),e.emit("add",[r]),store.emit("add",[e._name,r]))}return r},validateAndMerge:function(e,r){e.rel||(e.rel={});var t=e._primaryKey,o=store.peekRecord(e._name,r[t]);if(!o||!Lyte.isRecord(o))return void console.error("No such record to merge, ",r);var a=this.mergeData(o,r);if(o=this.validateJSON(e,o,Object.keys(r),a),!o.$.isError&&e.didLoad)for(var i=e.didLoad,s=0;s<i.length;s++)i[s].apply(o);return o},mergeData:function(e,r){if(e&&r){var t,o=e.$.model,a=(o._primaryKey,{}),i={};for(var s in r)if(t=o.fieldList[s]){if("relation"!=t.type)"undefined"!=typeof LyteComponent?LyteComponent.set(e,s,r[s],!0):e[s]=r[s],a[s]=t;else if(t&&"relation"==t.type)switch(this.compareRelations(e,r,s,t)){case 0:var n={};store.$.getRelations(e.$.model,s,store.modelFor(e.$.model.fieldList[s].relatedTo),n),this.toDemolishLink(e.$.model,e,n.forward),"undefined"!=typeof LyteComponent?LyteComponent.set(e,s,r[s],!0):e[s]=r[s],a[s]=t;break;case 1:break;case 2:this.mergeData(e[s],r[s]);break;case 3:a[s]=t,i[s]=r[s]}}else"undefined"!=typeof LyteComponent?LyteComponent.set(e,s,r[s],!0):e[s]=r[s];return{toValidate:a,toPartialAdd:i}}},compareRelations:function(e,r,t,o){var a=store.modelFor(o.relatedTo)._primaryKey;if("belongsTo"==o.relType)return this.compareRecordWithObj(e[t],r[t],a);for(var i=r[t].length,s=0,n=1,d=0;i>d;d++){var l=r[t][d],c=this.getIndex(e[t],a,"object"==typeof l?l[a]:l);if(-1!=c){var u=this.compareRecordWithObj(e[t][c],l,a);(1==u||2==u)&&s++,2==u&&this.mergeData(e[t][c],l)}else n=0}return 0==n?s>0&&s==e[t].length?3:0:1},compareRecordWithObj:function(e,r,t){if(!e)return 0;var o=e.$.model,a=o.fieldList;if(!Lyte.isRecord(e))return 0;var i=o.fieldList[t];if(typeof r==i.type)return e[t]==r?1:0;if("object"==typeof r){if(e[t]!=r[t])return 0;for(var s in r){var i=a[s];if(i)if("relation"==i.type){var n=this.compareRelations(e,r,s,i);if(!n)return 0}else if(e[s]!=r[s])return 2}return 1}return 0},checkProperty:function(e,r,t,o,a){switch(e){case"type":if(Lyte.Transform.hasOwnProperty(o)){if(Array.isArray(r)){if("array"!=Lyte.Transform[o].extends)return{code:"ERR03",message:Lyte.errorCodes.ERR03,expected:o}}else if(Lyte.Transform[o].extends!=typeof r)return{code:"ERR03",message:Lyte.errorCodes.ERR03,expected:o}}else if(Array.isArray(r)){if("array"!=o)return{code:"ERR03",message:Lyte.errorCodes.ERR03,expected:o}}else if(o!=typeof r)return{code:"ERR03",message:Lyte.errorCodes.ERR03,expected:o};break;case"maximum":if("number"==typeof r&&r>o)return{code:"ERR04",message:Lyte.errorCodes.ERR04,expected:o};break;case"minimum":if("number"==typeof r&&o>r)return{code:"ERR05",message:Lyte.errorCodes.ERR05,expected:o};break;case"maxLength":case"maxItems":if(r.length>o)return{code:"ERR06",message:Lyte.errorCodes.ERR06,expected:o};break;case"minLength":case"minItems":if(r.length<o)return{code:"ERR07",message:Lyte.errorCodes.ERR07,expected:o};break;case"pattern":if("string"==typeof r&&!new RegExp(o).test(r))return{code:"ERR08",message:Lyte.errorCodes.ERR08,expected:o};break;case"uniqueItems":if(Array.isArray(r)&&o)for(var i=[],s=0;s<r.length;s++){var n=r[s];if(-1!=i.indexOf(n))return{code:"ERR09",message:Lyte.errorCodes.ERR09};i.push(n)}break;case"constant":if(Array.isArray(r)){var d=r.length==o.length&&r.every(function(e,r){return e===o[r]});if(!d)return{code:"ERR10",message:Lyte.errorCodes.ERR10,expected:o}}else if("object"==typeof r){var d=store.adapter.$.compareObjects(r,o);if(!d)return{code:"ERR10",message:Lyte.errorCodes.ERR10,expected:o}}else if(r!=o)return{code:"ERR10",message:Lyte.errorCodes.ERR10,expected:o};break;case"items":if(Array.isArray(r))for(var s=0;s<r.length;s++)for(var e in o){var d=this.checkProperty(e,r[s],s,o[e]);if(1!=d)return d}break;case"properties":if("object"==typeof r&&!Array.isArray(r))for(var t in r)for(var e in o){var d=this.checkProperty(e,r[t],t,o[e]);if(1!=d)return d}break;case"validation":var d=Lyte.customValidator[o].apply(a,[t,r]);if(1!=d)return d}return!0},validateJSON:function(e,r,t,o){var a=o?o.toValidate:void 0,i=a&&Object.keys(a).length?a:e.fieldList;for(var s in i)if(!t||-1!=t.indexOf(s))if("relation"==i[s].type&&r[s]){var n=o&&o.toPartialAdd?o.toPartialAdd[s]:void 0,d=this.handleRelation(s,e,i[s],r,n);if(1!=d)return new error1(s,{code:d,data:r,message:Lyte.errorCodes[d]});"hasMany"!=i[s].relType||r[s].add||Object.defineProperties(r[s],{record:{enumerable:!1,value:r},model:{enumerable:!1,value:e},key:{enumerable:!1,value:s},filterBy:{enumerable:!1,value:this.filterBy},add:{enumerable:!1,value:this.add},sortBy:{enumerable:!1,value:this.sortBy},mapBy:{enumerable:!1,value:this.mapBy},remove:{enumerable:!1,value:this.remove}})}else{var l=i[s];void 0==r[s]&&l.default&&(r[s]=l.default),r[s]&&Lyte.Transform.hasOwnProperty(l.type)&&Lyte.Transform[l.type].hasOwnProperty("deserialize")&&(r[s]=Lyte.Transform[l.type].deserialize(r[s]))}return r},handleRelation:function(e,r,t,o,a){var i={};if(r.rel.hasOwnProperty(e))i=r.rel[e];else{if(void 0==store.modelFor(t.relatedTo))return"ERR11";this.getRelations(r,e,store.modelFor(t.relatedTo),i),r.rel[e]=i}return this.solveRelation(i,r,store.modelFor(t.relatedTo),e,o,a)},getRelations:function(e,r,t,o){return void 0==t?"ERR11":(o.forward=e.fieldList[r],o.backward=this.getBackwardRel(e,o.forward,t),!0)},getBackwardRel:function(e,r,t){var o,a;if(r.opts&&(o=r.opts.inverse,a=r.opts.polymorphic)){var i=t.extendedBy;if(i)for(var s in i){var n=store.modelFor(s);if(n.relations[e._name]){t=n;break}}}var d;if(o&&""!=o)d=o;else{var l=t.relations[e._name],c=store.modelFor(e.extend);!l&&c&&t.relations[c._name]&&t.relations[c._name].opts&&t.relations[c._name].opts.polymorphic&&(l=t.relations[c._name]),d=l&&1==l.length?l[0].relKey:void 0}if(!d){var u=t.relations[e._name],f=store.modelFor(e.extend);if(!u&&f&&t.relations[f._name]&&t.relations[f._name].opts&&t.relations[f._name].opts.polymorphic&&(u=t.relations[f._name]),u)for(var y=0;y<u.length;y++)if(u[y]&&u[y].opts&&u[y].opts.inverse===r.relKey){d=u[y].relKey;break}}return d?t.fieldList[d]:void 0},solveRelation:function(e,r,t,o,a,i){var s=e.backward,n=e.forward;if(!s&&(n.relatedTo===r._name&&(s=n),!s))return"ERR12";if(i)d=i;else{if(a[o]&&(a[o].add||Lyte.isRecord(a[o])))return!0;if(Array.isArray(a[o])){if("belongsTo"==n.relType)return"ERR21"
}else a[o]=[a[o]];var d=a[o].splice(0,a[o].length);"belongsTo"==n.relType&&(a[o]=void 0)}for(var l=0;l<d.length;l++){var c;if(typeof d[l]==t.fieldList[t._primaryKey].type?c=store.peekRecord(t._name,d[l]):"object"!=typeof d[l]||Lyte.isRecord(d[l])||(c=this.insertIntoStore(t,d[l])),c&&c.$&&c.$.isError){a.$.isError=!0;var u={code:"ERR24",message:Lyte.errorCodes.ERR24,data:a,error:c.$.error};"undefined"!=typeof LyteComponent?LyteComponent.set(a.$.error,o,u):a.$.error[o]=u}else c&&(this.hasDuplicateRelation(c,a[o],t._primaryKey,d[l]._type)||this.establishLink(n,s,a,c))}return!0},establishLink:function(e,r,t,o,a){if(!o)return"ERR13";if(!this.checkForCorrectRelation(e,o))return"ERR14";var i=e.relKey,s=o._type;if("belongsTo"==e.relType)t[i]!==o&&("undefined"!=typeof LyteComponent?LyteComponent.set(t,i,o,!0):t[i]=o);else if("hasMany"===e.relType){if(t[i]||("undefined"!=typeof LyteComponent?LyteComponent.set(t,i,[],!0):t[i]=[]),!t[i].model){var n=o.$.model;s&&(Object.defineProperty(t[i],"polymorphic",{enumerable:!1,value:!0}),n=store.modelFor(n.extend)),store.$.establishObserverBindings(t,t.$.model._properties),Object.defineProperties(t[i],{record:{enumerable:!1,value:t},model:{enumerable:!1,value:n},key:{enumerable:!1,value:i},filterBy:{enumerable:!1,value:this.filterBy},add:{enumerable:!1,value:this.add},remove:{enumerable:!1,value:this.remove},sortBy:{enumerable:!1,value:this.sortBy},mapBy:{enumerable:!1,value:store.$.mapBy}})}this.hasDuplicateRelation(o,t[i],e?store.modelFor(e.relatedTo)._primaryKey:void 0,s)||(void 0!=a?t[i].splice(a,0,o):"undefined"!=typeof Lyte.arrayUtils?Lyte.arrayUtils(t[i],"push",o):t[i].push(o))}if(e==r)return!0;if(!this.checkForCorrectRelation(r,t))return"ERR14";var d=r.relKey;return"belongsTo"==r.relType?(void 0!=o[d]&&o[r.relKey]!==t&&this.toDemolishLink(o.$.model,o,r),o[d]!==t&&("undefined"!=typeof LyteComponent?LyteComponent.set(o,d,t,!0):o[d]=t)):"hasMany"===r.relType&&(o[d]||("undefined"!=typeof LyteComponent?LyteComponent.set(o,d,[],!0):o[d]=[]),o[d].model||Object.defineProperties(o[d],{record:{enumerable:!1,value:o},model:{enumerable:!1,value:t.$.model},key:{enumerable:!1,value:d},filterBy:{enumerable:!1,value:this.filterBy},add:{enumerable:!1,value:this.add},sortBy:{enumerable:!1,value:this.sortBy},mapBy:{enumerable:!1,value:this.mapBy},remove:{enumerable:!1,value:this.remove}}),this.hasDuplicateRelation(t,o[d],r?store.modelFor(r.relatedTo)._primaryKey:void 0,s)||("undefined"!=typeof Lyte.arrayUtils?Lyte.arrayUtils(o[d],"push",t):o[d].push(t))),!0},toDemolishRelation:function(e,r){var t=e.data[r],o=e.relations;for(var a in o)for(var i=o[a],s=0;s<i.length;s++){var n=i[s];t[n.relKey]&&this.toDemolishLink(e,t,n)}},toDemolishLink:function(e,r,t){var o=r[t.relKey],a=e._primaryKey,i=store.modelFor(t.relatedTo),s=(i._primaryKey,t.relatedTo,this.getBackwardRel(e,t,i));if(Array.isArray(o))for(var n=0;n<o.length;n++)this.demolishLink(r,a,o[n],s.relKey);else Lyte.isRecord(o)&&this.demolishLink(r,a,o,s.relKey)},demolishLink:function(e,r,t,o){var a=t[o];if(Array.isArray(a)){var i=this.getIndex(a,r,e[r],e._type);-1!=i&&("undefined"!=typeof Lyte.arrayUtils?Lyte.arrayUtils(t[o],"removeAt",i,1):t[o].splice(i,1))}else a&&("object"==typeof a||Lyte.isRecord(a))&&delete t[o]},toInsertData:function(e,r){var t=store.modelFor(e),o=this.insertIntoStore(t,r[e]);return delete t.rel,o},rollBackRecordsArray:function(e,r,t,o){var a={},i=t._primaryKey,s=store.modelFor(o.relatedTo)._primaryKey;store.$.getRelations(t,o.relKey,store.modelFor(o.relatedTo),a);for(var n=e.length-1;n>=0;n--){var d=e[n].records;if("added"==e[n]._type)for(var l=0;l<d.length;l++){var c=d[l];this.demolishLink(c,s,r,a.forward.relKey),this.demolishLink(r,i,c,a.backward.relKey)}else if("removed"==e[n]._type)for(var l=d.length-1;l>=0;l--){var c=d[l];this.establishLink(a.forward,a.backward,r,c,e[n]._indices[l])}else if("changed"==e[n]._type){var u=r[o.relKey];for(Array.isArray(u)||(u=[u]);u.length;){var c=u[0];if(this.demolishLink(c,s,r,a.forward.relKey),this.demolishLink(r,i,c,a.backward.relKey),"belongsTo"==a.forward.relType)break}Array.isArray(d)||(d=[d]);for(var l=0;l<d.length;l++){var c=d[l];this.establishLink(a.forward,a.backward,r,c)}}}},sortBy:function(e,r){var t=store.$.mapBy.call(this,e),o=this.model,a=o.fieldList[e];a&&"string"==a.type?(t.sort(),"desc"==r&&t.reverse()):(t.sort(function(e,r){return e-r}),"desc"==r&&t.sort(function(e,r){return r-e}));for(var i=this.slice(0),s=[],n=0;n<t.length;n++)if(void 0!=t[n]){var d=store.$.getIndex(i,e,t[n]);s.push(i[d]),i.splice(d,1)}return i.length>0&&(s="desc"==r?s.concat(i):i.concat(s)),Object.defineProperties(s,{model:{enumerable:!1,value:this.model},filterBy:{enumerable:!1,value:this.filterBy},sortBy:{enumerable:!1,value:this.sortBy},mapBy:{enumerable:!1,value:this.mapBy}}),s},mapBy:function(e){return this.map(function(r){return r.$.get(e)})},revertToOldVal:function(e,r,t,o){if(void 0!=t&&0!=t.length){Array.isArray(t)||(t=[t]);for(var a=0;a<t.length;a++)this.establishLink(o.forward,o.backward,e,t[a])}},rollBackDelete:function(e,r){var t=e._deleted,o=t.splice(r,1)[0];o.$.isDeleted=!1,"undefined"!=typeof Lyte.arrayUtils?Lyte.arrayUtils(e.data,"push",o):e.data.push(o),(o.$.isNew||o.$.isModified)&&this.checkAndAddToArray(e.dirty,o[e._primaryKey]),store.$.clearRecordError(o.$,e._primaryKey,"ERR17"),e.emit("add",[o]),store.emit("add",[e._name,o])},rollBackNew:function(e,r,t){var o=this.getIndex(e.data,t,r[t]);"undefined"!=typeof Lyte.arrayUtils?Lyte.arrayUtils(e.data,"removeAt",o,1):e.data.splice(o,1),r.$.isNew=!1,e.emit("delete",[r]),store.emit("delete",[e._name,r]),this.deleteFromArray(e.dirty,r[t])},emit:function(e,r,t){r.$.emit(e,[r,t]),r.$.model.emit(e,[r,t]),store.emit(e,[r.$.model._name,r,t])},hasRecordsArrayChanged:function(e,r){var t=e.$.getInitialValues(r),o=!0,a=e.$.model._primaryKey;if(t&&t.length==e[r].length){o=!1;for(var i=0;i<t.length;i++)if(!this.compareRecords(t[i],e[r][i],a))return!0}return o},setRecordError:function(e,r,t,o){e.isError=!0,"object"==typeof t?"undefined"!=typeof LyteComponent?LyteComponent.set(e.error,r,t):e.error[r]=t:("undefined"!=typeof LyteComponent?LyteComponent.set(e.error,r,{code:t,message:Lyte.errorCodes[t]}):e.error[r]={code:t,message:Lyte.errorCodes[t]},o&&("undefined"!=typeof LyteComponent?LyteComponent.set(e.error.field,"value",o):e.error[r].value=o))},clearRecordError:function(e,r,t){if(t)e.error.code==t&&("undefined"!=typeof LyteComponent?Lyte.objectUtils(e.error,"delete",r):delete e.error[r]);else if(r)"undefined"!=typeof LyteComponent?Lyte.objectUtils(e.error,"delete",r):delete e.error[r];else if("undefined"!=typeof LyteComponent)for(var o in e.error)Lyte.objectUtils(e.error,"delete",o);else e.error={};0==Object.keys(e.error).length&&(e.isError=!1)},cacheQuery:function(e,r,t){void 0==store.model.cachedQueries&&(store.model.cachedQueries={}),void 0==store.model.cachedQueries[e]&&(store.model.cachedQueries[e]=[]),store.model.cachedQueries[e].push({queryParams:r,data:t})},cacheRecordQuery:function(e,r,t,o){void 0==store.model.cachedRecordQueries&&(store.model.cachedRecordQueries={}),void 0==store.model.cachedRecordQueries[e]&&(store.model.cachedRecordQueries[e]={}),void 0==store.model.cachedRecordQueries[e][r]&&(store.model.cachedRecordQueries[e][r]=[]),store.model.cachedRecordQueries[e][r].push({queryParams:t,data:o})}}};store.adapter={$:{getFromAdapter:function(e,r){for(var t=e?e[r]:void 0;void 0==t;)if(e&&e.$super)e=e.$super,t=e?e[r]:void 0;else{if(e=store.adapter.application,!e||!e[r]){switch(r){case"host":t=window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.host;break;case"namespace":t="";break;default:t=void 0}break}t=e[r]}return t},getNamespace:function(e){for(var r=e?e.namespace:void 0;void 0==r;)e&&e.$super?(e=e.$super,r=e?e.namespace:void 0):(e=store.adapter.application,r=e&&e.namespace?e.namespace:"");return r},getHost:function(e){for(var r=e?e.host:void 0;void 0==r;)e&&e.$super?(e=e.$super,r=e?e.host:void 0):(e=store.adapter.application,r=e&&e.host?e.host:window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.host);return r},buildURL:function(e,r,t,o,a,i,s,n){var d=store.adapter[t],l=this.getHost(d),c="";void 0!=l&&(c+=l,"/"!=l[l.length-1]&&(c+="/"));var u=this.getNamespace(d);if(c+=""!=u&&"/"!=u[u.length-1]?u+"/":u,c+=t,o&&(c+="/"+o),"action"==e){c+="/"+this.getActionNamespace(d);var f=store.modelFor(t).actions,y=f[s].endPoint?f[s].endPoint:s;c+="/"+y}i||(i={});var p,h=this.getCallBackScope(t,"headersForRequest"),m={method:r?r:""};if(h&&(p=this.constructArgs(e,i,n),m.headers=this.callBack(h,p)),h=this.getCallBackScope(t,"buildURL"),h&&(p=this.constructArgs(t,e,i,a,c,s,n),c=this.callBack(h,p)),h=this.getCallBackScope(t,"methodForRequest"),h&&(p=this.constructArgs(r,e,i,n),m.method=this.callBack(h,p)),!m.data&&Object.keys(i).length){c+="?";var v=0;for(var o in i)0!=v&&(c+="&"),c+=o+"="+i[o],v++}return d&&1==d.withCredentials&&(m.withCredentials=!0),m.url=c,m},getCallBackScope:function(e,r){for(var t,o=store.adapter[e],a=store.adapter.application;void 0==t;){if(o&&o[r]&&"function"==typeof o[r])return{scope:o,func:o[r]};if(!o||!o.$super)return a&&a[r]&&"function"==typeof a[r]?{scope:a,func:a[r]}:void 0;o=o.$super}},callBack:function(e,r){return callbackValue=e.func.apply(e.scope,r)},constructArgs:function(){for(var e=arguments,r=[],t=0;t<e.length;t++)r.push(e[t]);return r},get:function(e,r,t,o,a,i){if(store.modelFor(r)){if("findAll"==e&&o&&store.model.cachedQueries&&store.model.cachedQueries[r]){for(var s,n=store.model.cachedQueries[r],d=0;d<n.length;d++){var l=n[d].queryParams;if(this.compareObjects(l,o)){s=[n[d].data,"cache"];break}}if(s)return new Promise(function(e){e(s)})}else if("findRecord"==e&&o&&store.model.cachedRecordQueries&&store.model.cachedRecordQueries[r]&&store.model.cachedRecordQueries[r][t]){for(var s,n=store.model.cachedRecordQueries[r][t],d=0;d<n.length;d++){var l=n[d].queryParams;if(this.compareObjects(l,o)){s=[n[d].data,"cache"];break}}if(s)return new Promise(function(e){e(s)})}else{var c=this.getCallBackScope(r,"findRecord"==e?"reloadRecord":"reloadAll");if(c){var u;if("findRecord"==e?u=store.peekRecord(r,t):"findAll"==e&&(u=store.peekAll(r)),!this.callBack(c,[u,o])){var f={};return f[r]=u,new Promise(function(e){e([f,"cache"],"success",void 0,!0)})}}}var y=this.buildURL(e,"GET",r,t,void 0,o,void 0,i),p=this;return new Promise(function(t,o){var a,i=p.getFromAdapter(store.adapter[r],"processRequest"),s=!0;if(i){s=!1;var n=p.callGeneric(e,r);n instanceof Promise?n.then(function(o){o=JSON.parse(""==o?"{}":o),a=p.getResponse(o,r,e,l,y),t([a])},function(e){o(e)}):s=!0}if(s){var d=new XMLHttpRequest;d.open("GET",y.url,!0);for(var l in y.headers)d.setRequestHeader(l,y.headers[l]);d.withCredentials=y.withCredentials?!0:!1,d.send(y.data),d.onreadystatechange=function(){if(4==d.readyState)if("2"==d.status.toString()[0]||"3"==d.status.toString()[0]){var i=d.responseText;if(i=JSON.parse(""==i?"{}":i),store.adapter&&store.adapter[r]){var s,n=p.getCallBackScope(r,"parseResponse");n&&(s=p.constructArgs(e,r,d,i),i=p.callBack(n,s))}a=p.getResponse(i,r,e,l,y,d),t([a,d.statusText,d])}else{var s,n=p.getCallBackScope(r,"parseResponse");n&&(s=p.constructArgs(e,r,d),i=p.callBack(n,s)),o(d)}}}})}return Promise.reject({code:"ERR19",message:Lyte.errorCodes.ERR19,data:r})},getResponse:function(e,r,t,o,a,i){e=store.serializer.$.normalizeResponse(r,t,e,o,i?i.status:i,a.headers);var s,n=store.serializer.$.getCallBackScope(r,"extractMeta"),d=e;if("object"!=typeof d&&(d=JSON.parse(d)),n&&(s=this.constructArgs(d,r,t),d.meta=this.callBack(n,s)),d){if(n=store.serializer.$.getCallBackScope(r,"deserializeKey")){var l=Object.keys(d),c=0;2==l.length&&"meta"==l[0]&&(c=1),s=this.constructArgs(r,t);var u=this.callBack(n,s),f=d[l[c]];delete d[l[c]],d[u]=f}store.serializer.$.normalize(r,t,d,o,i?i.status:i,a.headers)}return d},put:function(e,r,t,o,a){var i=o?"updateRecord":"update",s=this.buildURL(i,"PATCH",e,o?r[store.modelFor(e)._primaryKey]:void 0,r,void 0,void 0,a),n=store.$.toJSON(e,r);return store.$.removeNotDefinedKeys(store.modelFor(e),n),this.sendingData(e,n,s,i,a),this.handleRequest(s,e,t,i)},del:function(e,r,t,o,a){var i=store.modelFor(e)._primaryKey,s=o||"deleteRecord",n=this.buildURL(s,"DELETE",e,t?r[i]:void 0,r,void 0,void 0,a),d={};return t||(d=r.map(function(e){return e[i]})),this.sendingData(e,t?r?r[i]:void 0:d,n,s,a),this.handleRequest(n,e,r,s)},create:function(e,r,t,o){var a=store.$.toJSON(e,r);store.$.removeNotDefinedKeys(store.modelFor(e),a);var i=t?"createRecord":"create",s=this.buildURL(i,"POST",e,void 0,r,void 0,void 0,o);return this.sendingData(e,a,s,i,o),this.handleRequest(s,e,r,i)},sendingData:function(e,r,t,o,a){var i=store.serializer.$.getCallBackScope(e,"serializeKey"),s=e,n={};if(i){var d=this.constructArgs(e,o,a);s=this.callBack(i,d)}s?(Array.isArray(r)||"object"==typeof r||Lyte.isRecord(r))&&(n[s]=r):n=r;var i=store.serializer.$.getCallBackScope(e,"serialize");if(i){var d=this.constructArgs(o,n,r,a);n=this.callBack(i,d)}"deleteRecord"!==o&&"destroyRecord"!==o?t.data=n:i&&n&&void 0!==n&&null!==n&&""!==n&&(t.data=n)},handleAction:function(e,r,t,o){var a;t&&Lyte.isRecord(t)&&(a=t.$.get(r._primaryKey));var i="action",s=this.buildURL(i,"POST",r._name,a,t,void 0,e,o),n=store.serializer.$.getCallBackScope(r._name,"serialize");if(n){var d=this.constructArgs(e,void 0,t,o);s.data=this.callBack(n,d)}return this.handleRequest(s,r._name,void 0,i)},handleRequest:function(e,r,t,o){!e.data||"object"!=typeof e.data&&!Lyte.isRecord(e.data)&&!Array.isArray(e.data)||e.data instanceof FormData||(e.data=JSON.stringify(e.data));var a=this;return new Promise(function(i,s){var n=a.getFromAdapter(store.adapter[r],"processRequest"),d=!0;if(n){d=!1;var l,c=a.callGeneric(o,r,e.data,t);c instanceof Promise?c.then(function(s){s=JSON.parse(""==s?"{}":s),l=a.genericResponse(s,r,o,t,e),i(l)},function(e){s(e)}):d=!0}if(d){var u=new XMLHttpRequest;u.open(e.method,e.url,!0);for(var f in e.headers)u.setRequestHeader(f,e.headers[f]);u.withCredentials=e.withCredentials?!0:!1,u.send(e.data),u.onreadystatechange=function(){if(4==u.readyState)if("2"==u.status.toString()[0]||"3"==u.status.toString()[0]){var n,d=u.responseText;if(d=JSON.parse(""==d?"{}":d),store.adapter&&store.adapter[r]){var l,c=a.getCallBackScope(r,"parseResponse");c&&(l=a.constructArgs(o,r,u,d),d=a.callBack(c,l))}n=a.genericResponse(d,r,o,t,e,u),i(n)}else{var l,c=a.getCallBackScope(r,"parseResponse");c&&(l=a.constructArgs(o,r,u),d=a.callBack(c,l)),s(u)}}}})},callGeneric:function(e,r,t,o,a){var i,s=this.getCallBackScope(r,"processRequest");if(s){var n=this.constructArgs(e,r,t,o,a);i=this.callBack(s,n)}return i},genericResponse:function(e,r,t,o,a,i){var s,n,d=e;if(s=store.serializer.$.getCallBackScope(r,"extractMeta"),s&&(n=this.constructArgs(d,r,t),d.meta=this.callBack(s,n)),d){d=store.serializer.$.buildJSON(r,t,d,Lyte.isRecord(o)?o[store.modelFor(r)._primaryKey]:void 0,i?i.status:i,a.headers);var s=store.serializer.$.getCallBackScope(r,"deserializeKey");if(s){var l=Object.keys(d),c=0;2==l.length&&"meta"==l[0]&&(c=1);var n=this.constructArgs(r,t),u=this.callBack(s,n),f=d[l[c]];delete d[l[c]],d[u]=f}}return"action"!=t&&this.handleResponse(a,o,d[r],i?i.statusText:i,i,store.modelFor(r)),d},checkResponse:function(e,r,t,o){if(e.$.isNew&&(e.hasOwnProperty(o)&&t.hasOwnProperty(o)&&("undefined"!=typeof LyteComponent?LyteComponent.set(e,o,t[o],!0):e[o]=t[o]),store.$.validateAndMerge(r,t),e.$.isNew=!1),e.$.isModified&&(e.$.isModified=!1,e.$._attributes={},!e.$.isDeleted&&t&&store.$.validateAndMerge(r,t)),r.dirty.length&&store.$.deleteFromArray(r.dirty,e[o]),e.$.isDeleted){e.$.isDeleted=!1;var a=r._deleted,i=store.$.getIndex(a,o,e[o]);r._deleted.splice(i,1)}for(var s=e.$.isDirty(),n=0;n<s.length;n++){var d=e[s[n]];if(Array.isArray(d))for(var l=0;l<d.length;l++)d[l].$.isModified=!1;else Lyte.isRecord(d)&&(d.$.isModified=!1)}store.$.clearRecordError(e.$)},handleResponse:function(e,r,t,o,a,i){var s=i._primaryKey;if(Array.isArray(r))for(var n=0;n<r.length;n++)this.checkResponse(r[n],i,Array.isArray(t)?t[n]:t,s);else this.checkResponse(r,i,t,s)},compareObjects:function(e,r){if(!(e instanceof Object&&r instanceof Object))return!1;if(Object.keys(e).length!=Object.keys(r).length)return!1;for(var t in e){var o=e[t],a=r[t];if(void 0==a||o!=a)return!1}return!0},getActionNamespace:function(e){for(var r=e?e.actionNamespace:void 0;void 0==r;)e&&e.$super?(e=e.$super,r=e?e.actionNamespace:void 0):(e=store.adapter.application,r=e&&e.actionNamespace?e.actionNamespace:"action");return r}}},Object.defineProperty(store.adapter,"extends",{enumerable:!1,value:function(e,r,t){if(e){if(store.adapter.hasOwnProperty(e))throw new Error("Adapter with name - "+e+" -  already exists");return store.adapter[e]=new Adapter(r,t,e),store.adapter[e]}}}),store.serializer={$:{getCallBackScope:function(e,r){for(var t,o=store.serializer[e],a=store.serializer.application;void 0==t;){if(o&&o[r]&&"function"==typeof o[r])return{scope:o,func:o[r]};if(!o||!o.$super)return a&&a[r]&&"function"==typeof a[r]?{scope:a,func:a[r]}:void 0;o=o.$super}},buildJSON:function(e,r,t,o,a,i){var s=this.getCallBackScope(e,"normalizeResponse"),n=t;if(s){var d=store.adapter.$.constructArgs(e,r,n,o,a,i);n=store.adapter.$.callBack(s,d)}var l=!1;if((/^(findRecord|findAll)$/.test(r)||n[e])&&(n=n[e],l=!0),s=this.getCallBackScope(e,"normalize"))if(Array.isArray(n))for(var c=0;c<n.length;c++){var d=store.adapter.$.constructArgs(e,r,n[c]);n[c]=store.adapter.$.callBack(s,d)}else{var d=store.adapter.$.constructArgs(e,r,n);n=store.adapter.$.callBack(s,d)}return l?(t={},t[e]=n,t):n},normalizeResponse:function(e,r,t,o,a,i){var s=this.getCallBackScope(e,"normalizeResponse"),n=t;if(s){var d=store.adapter.$.constructArgs(e,r,n,o,a,i);n=store.adapter.$.callBack(s,d)}return n},normalize:function(e,r,t){var o=t,a=!1;(/^(findRecord|findAll)$/.test(r)||o[e])&&(o=o[e],a=!0);var i=this.getCallBackScope(e,"normalize");if(i)if(Array.isArray(o))for(var s=0;s<o.length;s++){var n=store.adapter.$.constructArgs(e,r,o[s]);o[s]=store.adapter.$.callBack(i,n)}else{var n=store.adapter.$.constructArgs(e,r,o);o=store.adapter.$.callBack(i,n)}a&&(t={},t[e]=o)}}},Object.defineProperty(store.serializer,"extends",{enumerable:!1,value:function(e,r,t){if(store.serializer.hasOwnProperty(e))throw new Error("Serializer with name - "+e+" -  already exists");return store.serializer[e]=new Serializer(r,t,e),store.serializer[e]}}),Object.defineProperties(store,{pushPayload:{enumerable:!1,value:function(e,r,t){var o=store.modelFor(e),a=r;if(t){r=store.serializer.$.buildJSON(e,"pushPayload",r);var i=store.serializer.$.getCallBackScope(e,"deserializeKey");if(i){var s=Object.keys(r),n=0;2==s.length&&"meta"==s[0]&&(n=1);var d=store.adapter.$.constructArgs(e,"pushPayload"),l=store.adapter.$.callBack(i,d),c=r[s[n]];delete r[s[n]],r[l]=c}a=r[e]}return r=store.$.insertIntoStore(o,a),delete o.rel,r}},registerModel:{enumerable:!1,value:function(e,r,t){if(store.model.hasOwnProperty(e))throw new Error("Model with name - "+e+" - already exists");var o,a;if(t&&"object"==typeof t&&(o=t.extends?t.extends:void 0,a=t.actions?t.actions:void 0),o){var i=Object.assign({},store.model[o].fieldList);for(var s in i)"relation"==i[s].type&&delete i[s];r=Object.assign(r,i)}if(store.model[e]=new Model(e,r),o&&(store.model[e].extend=o,store.model[o].extendedBy||(store.model[o].extendedBy={}),store.model[o].extendedBy[e]=!0,!store.adapter[e]&&store.adapter[o]&&(store.adapter[e]=store.adapter[o]),!store.serializer[e]&&store.serializer[o]&&(store.serializer[e]=store.serializer[o]),store.model[o].actions)){void 0==a&&(a={});for(var s in store.model[o].actions)a.hasOwnProperty(s)||(a[s]=store.model[o].actions[s])}return a&&(store.model[e].actions=a),store.model[e]}},modelFor:{enumerable:!1,value:function(e){return store.model[e]}},createRecord:{enumerable:!1,value:function(e,r,t){return this.$.newRecord(e,r,t)}},deleteRecord:{enumerable:!1,value:function(e,r){this.$.removeFromStore(store.modelFor(e),r)}},findAll:{enumerable:!1,value:function(e,r,t,o,a){return store.adapter.$.get("findAll",e,void 0,r,t,a).then(function(){var a=arguments[0][0],i="cache"==arguments[0][1]?!0:!1;if(o===!1)return t&&Object.keys(r).length>0&&store.$.cacheQuery(e,r,a),a;if(a&&!a.save){if(!i){var s=(Object.assign({},a),store.$.toInsertData(e,a));a[e]=s,a.meta&&s&&Object.defineProperty(a[e],"$",{enumerable:!1,value:{meta:a.meta}}),t&&Object.keys(r).length>0&&store.$.cacheQuery(e,r,a)}return a[e]}return arguments},function(e){return Promise.reject(e)})}},findRecord:{enumerable:!1,value:function(e,r,t,o,a,i){return void 0==r?Promise.reject({code:"ERR20",message:Lyte.errorCodes.ERR20}):store.adapter.$.get("findRecord",e,r,t,o,i).then(function(){var i=arguments[0][0],s="cache"==arguments[0][1]?!0:!1;if(a===!1)return"cache"!=arguments[0][1]&&o&&Object.keys(t).length>0&&store.$.cacheRecordQuery(e,r,t,i),i;if(i){if(!s){{Object.assign({},i)}if(!Lyte.isRecord(i)){var n=store.$.toInsertData(e,i);i[e]=n,i.meta&&(n.$.meta=i.meta)}"cache"!=arguments[0][1]&&o&&Object.keys(t).length>0&&store.$.cacheRecordQuery(e,r,t,i)}return i[e]}return arguments},function(e){return Promise.reject(e)})}},peekRecord:{enumerable:!1,value:function(e,r){var t=this.modelFor(e);if(!t)return void console.error("No model found for ",e);var o=t.data,a=this.model[e]._primaryKey,i=o.filter(function(e){return e[a]==r?e:void 0});return i[0]?i[0]:void 0}},peekAll:{enumerable:!1,value:function(e){var r,t=this.modelFor(e);return t?r=t.data:void console.error("No model found for ",e)}},deleteMany:{enumerable:!1,value:function(e,r){this.$.removeFromStore(store.modelFor(e),r)}},unloadRecord:{enumerable:!1,value:function(e,r){var t=store.peekRecord(e,r),o=store.modelFor(e);t&&this.$.removeFromStore(o,t[o._primaryKey],!0);for(var a=0;a<o._deleted.length;a++)if(o._deleted[a].$.get(o._primaryKey)==r){o._deleted.splice(a,1);break}this.model.cachedRecordQueries&&this.model.cachedRecordQueries[e]&&this.model.cachedRecordQueries[e][r]&&(this.model.cachedRecordQueries[e][r]=[])}},unloadAll:{enumerable:!1,value:function(e){var r=[],t=store.peekAll(e),o=this.modelFor(e);if(t)for(var a=0;a<t.length;a++)r.push(t[a][o._primaryKey]);this.$.removeFromStore(o,r,!0),this.model[e].dirty=[],this.model[e]._deleted=[],this.model.cachedQueries&&this.model.cachedQueries[e]&&(this.model.cachedQueries[e]=[])}},triggerAction:{enumerable:!1,value:function(e,r,t){var o=store.modelFor(e),a=o.actions,i=a?o.actions[r]:void 0;return i?store.adapter.$.handleAction(r,o,store.peekAll(e),t).then(function(e){return e},function(e){return Promise.reject(e)}):Promise.reject({code:"ERR18",message:Lyte.errorCodes.ERR18})}},rollBack:{enumerable:!1,value:function(e){var r=this.modelFor(e);if(void 0!=r){for(var t=r._primaryKey,o=this;r.dirty.length;){var a=o.peekRecord(e,r.dirty[0]);a&&a.$.isModified?a.$.rollBackAttributes(a.$.getDirtyAttributes()):a&&a.$.isNew&&o.$.rollBackNew(r,a,t)}for(;r._deleted.length>0;)this.$.rollBackDelete(r,0)}}},create:{enumerable:!1,value:function(e,r,t){var o=store.modelFor(e);if(void 0==o)return Promise.reject({code:"ERR19",message:Lyte.errorCodes.ERR19,data:e});if(r){var a=this.$.newRecord(e,r);if(a.$.isError)return Promise.reject(a)}for(var i=o.dirty,s=[],n=0;n<i.length;n++){var d=store.peekRecord(e,i[n]);d&&d.$.isNew&&s.push(d)}return s.length?store.adapter.$.create(e,s,!1,t):Promise.resolve()}},update:{enumerable:!1,value:function(e,r){var t=this.modelFor(e);if(void 0==t)return Promise.reject({code:"ERR19",message:Lyte.errorCodes.ERR19,data:e});for(var o=[],a=[],i=t._primaryKey,s=0;s<t.dirty.length;s++){var n=store.peekRecord(e,t.dirty[s]);if(n&&n.$.isModified&&!n.$.isNew){var d=n.$._attributes,l={};for(var c in d)l[c]=n.$.get(c);l[i]=n.$.get(i),o.push(l),a.push(n)}}return o.length?store.adapter.$.put(e,o,a,!1,r):Promise.resolve()}},"delete":{enumerable:!1,value:function(e,r,t){var o=store.modelFor(e);if(void 0==o)return Promise.reject({code:"ERR19",message:Lyte.errorCodes.ERR19,data:e});r&&this.deleteRecord(e,r);for(var a=[],i=0;i<o._deleted.length;i++)o._deleted[i].$.isNew?store.adapter.$.handleResponse(void 0,o._deleted[i],o._deleted[i],void 0,void 0,o):a.push(o._deleted[i]);if(a.length){{o._primaryKey}return store.adapter.$.del(e,a,void 0,"delete",t).then(function(e){return e},function(e){return Promise.reject(e)})}return Promise.resolve()}},registerAdapter:{enumerable:!1,value:store.adapter.extends},registerSerializer:{enumerable:!1,value:store.serializer.extends},clearCachedQuery:{enumerable:!1,value:function(e,r,t){var o=[];r&&"object"==typeof r?(t=r,this.model.cachedQueries&&this.model.cachedQueries[e]&&(o=this.model.cachedQueries[e])):this.model.cachedRecordQueries&&this.model.cachedRecordQueries[e]&&this.model.cachedRecordQueries[e][r]&&(o=this.model.cachedRecordQueries[e][r]);for(var a=0;a<o.length;a++)if(this.adapter.$.compareObjects(o[a].queryParams,t)){o.splice(a,1);break}}},setErrorMessages:{enumerable:!1,value:function(e){Object.assign(Lyte.errorCodes,e)}},addEventListener:{enumerable:!1,value:function(e,r){return store.$.eventListeners.add(store,e,r)}},removeEventListener:{enumerable:!1,value:function(e){store.$.eventListeners.remove(store,e)}},emit:{enumerable:!1,value:function(e,r){store.$.eventListeners.emit(store,e,r)}}});var error1=function(e,r){Object.defineProperties(this,{$:{enumerable:!1,value:{isError:!0,error:{}}}}),e&&store.$.setError(this,e,r)};