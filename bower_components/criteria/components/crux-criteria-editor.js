Lyte.Component.register("crux-criteria-editor",{_template:'<template tag-name="crux-criteria-editor">\t<template is="if" value="{{expHandlers(type,\'==\',\'create\')}}"><template case="true">\t\t<lyte-alert lt-prop-type="warning" id="patternWarning"></lyte-alert>\t\t<div class="pwie">\t\t\t<div id="criteriaDiv">\t\t\t\t<lyte-table lt-prop-yield="true" id="criteriaTable">\t\t\t\t<template is="registerYield" yield-name="yield">\t\t\t\t     <lyte-table-structure>\t\t\t\t        <lyte-thead>\t\t\t\t           <lyte-tr>\t\t\t\t                <lyte-th>\t\t\t\t                \t<div>\t\t\t\t                \t\t<lyte-table lt-prop-yield="true" id="searchlayer_new" class="newApCriteriaTable newCriUi newSrchView">\t\t\t\t\t\t\t\t\t\t<template is="registerYield" yield-name="yield">\t\t\t\t\t\t\t\t\t\t     <lyte-table-structure>\t\t\t\t\t\t\t\t\t\t        <lyte-thead class="criteriaHeader" id="{{totalCriteria}}">\t\t\t\t\t\t\t\t\t\t        \t<template is="for" items="{{arr}}" item="val" index="index">\t\t\t\t\t\t\t\t\t\t           <lyte-tr id="searchcrt{{add(index,1)}}" class="searchcrt" data-index="1">\t\t\t\t\t\t\t\t\t\t                <crux-criteria-editor-header id="criteriaEditorHeader{{add(index,1)}}" module="{{module}}" on-operator-change-call="{{method(\'onOperatorChangeCall\')}}" criteria-array-object-update="{{method(\'criteriaArrayObjectUpdate\')}}" on-field-change-call="{{method(\'onFieldChangeCall\')}}" on-value-change-call="{{method(\'onValueChangeCall\')}}" and-or-condition="{{patternArrDis[index]}}" criteria-index="{{add(index,1)}}" show-add="{{if(ifEquals(arr.length, add(index,1)), true, false)}}" show-remove="{{if(ifEquals(arr.length,1), false, true)}}" fields="{{fields}}" tags="{{tags}}" layout="{{layout}}" set-criteria-obj="{{unbound(if(setCriteriaObj[index],setCriteriaObj[index]))}}"></crux-criteria-editor-header>\t\t\t\t\t\t\t\t\t\t            </lyte-tr> \t\t\t\t\t\t\t\t\t        \t\t\t\t\t\t\t\t\t\t\t        \t</template>\t\t\t\t\t\t\t\t\t\t        \t<template is="if" value="{{expHandlers(arr.length,\'>\',1)}}"><template case="true">\t\t\t\t\t\t\t\t\t\t            <lyte-tr>\t\t\t\t\t\t\t\t\t\t            <div class="w100per oH new_pat_edtr gBB" id="changePattern">\t\t\t\t\t\t\t\t\t\t            <lyte-th></lyte-th>\t\t\t\t\t\t\t\t\t\t            <lyte-th>\t\t\t\t\t\t\t\t\t\t            \t<span class="wf_form_lab dIB vam">{{cruxGetI18n("crm.label.criteria.pattern")}}</span>\t\t\t\t\t\t\t\t\t\t            </lyte-th>\t\t\t\t\t\t\t\t\t\t            <lyte-th>\t\t\t\t\t\t\t\t\t            \t\t\t<lyte-input lt-prop-disabled="{{if(ifEquals(showEdit,true), false, true)}}" lt-prop-height="40px" lt-prop-text-area-resize="{}" lt-prop-type="textarea" class="criteriaPatternText" lt-prop-id="lyteInputCriteria" lt-prop-rows="5" lt-prop-cols="60"></lyte-input>\t\t\t\t\t\t\t\t\t\t            </lyte-th>\t\t\t\t\t\t\t\t\t\t            <lyte-th>\t\t\t\t\t\t\t\t\t\t\t            \t<template is="if" value="{{expHandlers(showEdit,\'!\')}}"><template case="true">\t\t\t\t\t\t\t\t\t\t\t            \t<span style="padding: 5px; cursor:pointer; color: blue" onclick="{{action(\'openEditCriteria\')}}">{{cruxGetI18n("crm.label.edit.criteria.pattern")}}</span>\t\t\t\t\t\t\t\t\t\t\t            \t</template><template case="false">\t\t\t\t\t\t\t\t\t\t\t            \t<span style="padding: 5px; cursor:pointer;  color: blue" onclick="{{action(\'saveCriteriaPattern\')}}">{{cruxGetI18n("crm.button.save")}}</span>\t\t\t\t\t\t\t\t\t\t\t            \t<span style="padding: 5px; cursor:pointer;" onclick="{{action(\'closeEditCriteria\')}}">{{cruxGetI18n("crm.button.cancel")}}</span>\t\t\t\t\t\t\t\t\t\t\t            \t</template></template>\t\t\t\t\t\t\t\t\t\t            </lyte-th>\t\t\t\t\t\t\t\t\t\t            </div></lyte-tr></template></template>\t\t\t\t\t\t\t\t\t\t             \t\t\t\t\t\t\t\t\t\t            \t\t\t\t\t\t\t  \t\t\t        </lyte-thead> \t\t\t\t\t\t\t\t\t\t     </lyte-table-structure>\t\t\t\t\t\t\t\t\t\t </template> \t\t\t\t\t\t\t\t\t</lyte-table>\t\t\t\t                \t</div>\t\t\t\t                 </lyte-th>\t\t\t\t            </lyte-tr> \t  \t\t\t        </lyte-thead> \t\t\t\t     </lyte-table-structure>\t\t\t\t </template> \t\t\t</lyte-table>\t\t\t</div>\t\t</div>\t</template></template><template is="if" value="{{expHandlers(type,\'==\',\'view\')}}"><template case="true">\t\t<div class="pwie">\t\t\t<div id="criteriaDiv">\t\t\t\t<lyte-table lt-prop-yield="true" id="criteriaTable">\t\t\t\t<template is="registerYield" yield-name="yield">\t\t\t\t     <lyte-table-structure>\t\t\t\t        <lyte-thead>\t\t\t\t           <lyte-tr>\t\t\t\t                <lyte-th>\t\t\t\t                \t<div>\t\t\t\t                \t\t<lyte-table lt-prop-yield="true" id="searchlayer_new" class="newApCriteriaTable newCriUi newSrchView">\t\t\t\t\t\t\t\t\t\t<template is="registerYield" yield-name="yield">\t\t\t\t\t\t\t\t\t\t     <lyte-table-structure>\t\t\t\t\t\t\t\t\t\t        <lyte-thead class="criteriaHeader" id="{{totalCriteria}}">\t\t\t\t\t\t\t\t\t\t        \t<template is="for" items="{{arr}}" item="val" index="index">\t\t\t\t\t\t\t\t\t\t\t        \t <lyte-tr id="searchcrt{{add(index,1)}}" class="searchcrt" data-index="1">\t\t\t\t\t\t\t\t\t\t                <crux-criteria-editor-view-header id="criteriaEditorHeader{{add(index,1)}}" module="{{module}}" criteria-index="{{add(index,1)}}" and-or-condition="{{patternArrDis[index]}}" fields="{{fields}}" criteria="{{unbound(if(setCriteriaObj[index],setCriteriaObj[index]))}}"></crux-criteria-editor-view-header>\t\t\t\t\t\t\t\t\t\t            </lyte-tr> \t\t\t\t\t        \t\t\t\t\t\t\t\t\t\t\t        \t</template>\t\t\t\t\t\t\t\t\t\t        \t<template is="if" value="{{expHandlers(arr.length,\'>\',1)}}"><template case="true">\t\t\t\t\t\t\t\t\t\t            <lyte-tr>\t\t\t\t\t\t\t\t\t\t            <div class="w100per oH new_pat_edtr gBB" id="changePattern">\t\t\t\t\t\t\t\t\t\t            <lyte-th></lyte-th>\t\t\t\t\t\t\t\t\t\t            <lyte-th>\t\t\t\t\t\t\t\t\t\t            \t<span class="wf_form_lab dIB vam">{{cruxGetI18n("crm.label.criteria.pattern")}}</span>\t\t\t\t\t\t\t\t\t\t            </lyte-th>\t\t\t\t\t\t\t\t\t\t            <lyte-th>\t\t\t\t\t\t\t\t\t            \t\t\t<lyte-input lt-prop-disabled="{{if(ifEquals(showEdit,true), false, true)}}" lt-prop-height="40px" lt-prop-text-area-resize="{}" class="criteriaPatternText" lt-prop-id="lyteInputCriteria" lt-prop-rows="5" lt-prop-cols="60"></lyte-input>\t\t\t\t\t\t\t\t\t\t            </lyte-th>\t\t\t\t\t\t\t\t\t\t            </div></lyte-tr></template></template>\t\t\t\t\t\t\t\t\t\t             \t\t\t\t\t\t\t\t\t\t            \t\t\t\t\t\t\t  \t\t\t        </lyte-thead> \t\t\t\t\t\t\t\t\t\t     </lyte-table-structure>\t\t\t\t\t\t\t\t\t\t </template> \t\t\t\t\t\t\t\t\t</lyte-table>\t\t\t\t                \t</div>\t\t\t\t                 </lyte-th>\t\t\t\t            </lyte-tr> \t  \t\t\t        </lyte-thead> \t\t\t\t     </lyte-table-structure>\t\t\t\t </template> \t\t\t</lyte-table>\t\t\t</div>\t\t</div>\t</template></template></template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"componentDynamic",position:[1]},{type:"registerYield",position:[3,1,1,1],dynamicNodes:[{type:"registerYield",position:[1,1,1,1,1,1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"componentDynamic",position:[1,1,1]},{type:"text",position:[1,1,3,1,0]},{type:"componentDynamic",position:[1,1,3]},{type:"attr",position:[1,1,5,1]},{type:"componentDynamic",position:[1,1,5,1]},{type:"componentDynamic",position:[1,1,5]},{type:"attr",position:[1,1,7,1]},{type:"if",position:[1,1,7,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"attr",position:[3]},{type:"text",position:[3,0]}]}},default:{}},{type:"componentDynamic",position:[1,1,7]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1,1,1,1,1]},{type:"componentDynamic",position:[1,1,1,1]},{type:"componentDynamic",position:[1,1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3,1,1]}]}},default:{}},{type:"attr",position:[2]},{type:"if",position:[2],cases:{true:{dynamicNodes:[{type:"registerYield",position:[1,1,1,1],dynamicNodes:[{type:"registerYield",position:[1,1,1,1,1,1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"componentDynamic",position:[1,1,1]},{type:"text",position:[1,1,3,1,0]},{type:"componentDynamic",position:[1,1,3]},{type:"attr",position:[1,1,5,1]},{type:"componentDynamic",position:[1,1,5,1]},{type:"componentDynamic",position:[1,1,5]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1,1,1,1,1]},{type:"componentDynamic",position:[1,1,1,1]},{type:"componentDynamic",position:[1,1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1,1]}]}},default:{}}],_observedAttributes:["fields","totalCriteria","module","arr","patternArr","showEdit","criteria","patternArrDis","bufferCriteria","shownAlert","criteriaArrayObject","setCriteria","setCriteriaObj","tags","layout","moduleId","type","response","setCriteriaViewObj"],data:function(){return{fields:Lyte.attr("array"),totalCriteria:Lyte.attr("number",{default:1}),module:Lyte.attr("string"),arr:Lyte.attr("array",{default:[1]}),patternArr:Lyte.attr("array",{default:[" "]}),showEdit:Lyte.attr("boolean",{default:!1}),criteria:Lyte.attr("string",{default:"1"}),patternArrDis:Lyte.attr("array",{default:[" "]}),bufferCriteria:Lyte.attr("string"),shownAlert:Lyte.attr("boolean",{default:!1}),criteriaArrayObject:Lyte.attr("array",{default:[]}),setCriteria:Lyte.attr("string"),setCriteriaObj:Lyte.attr("array"),tags:Lyte.attr("array",{default:[]}),layout:Lyte.attr("array",{default:[]}),moduleId:Lyte.attr("string"),type:Lyte.attr("string",{default:"create"}),response:Lyte.attr("string"),setCriteriaViewObj:Lyte.attr("array")}},didConnect:function(){this.getData("setCriteria")&&this.setCriteria(this.getData("setCriteria")),this.getMethods("onDidConnect")&&this.executemethod("onDidConnect")},init:function(){function t(t,e){const r=t.field_label,a=e.field_label;let i=0;return r>a?i=1:r<a&&(i=-1),i}this.getMethods("onInit")&&this.executeMethod("onInit");this.getData("module");var e=this;void 0==this.getData("fields")?store.findRecord("module",this.getData("moduleId")).then(function(r){r[0].fields.push({api_name:"Campaign_Source",field_label:"Campaign Name",data_type:"lookup"}),e.setData("fields",r[0].fields.sort(t))}):this.setData("fields",this.getData("fields").sort(t)),store.findAll("user"),store.findAll("tag",{module:""+this.getData("module")}),store.findAll("layout",{module:""+this.getData("module")})},validatePattern:function(t,e,r){e=void 0!==e?e:"";var a=(t=t.replace(/#/g,"~")).match(/\(/gi);if(a)var i=a.length;var n=t.match(/\)/gi);if(n)var o=n.length;if(i!=o)return this.showAlert(_cruxUtils.getI18n("criteria.error.alert.brackets.count.mismatch")),this.setData("shownAlert",!0),!1;var s=t.replace(/(and|or)/g,"#").split(" ").join("").replace(/\n/g,"");if(-1!=s.indexOf("(#")||-1!=s.indexOf("#)"))return this.showAlert(_cruxUtils.getI18n("criteria.error.alert.brackets.invalid")),this.setData("shownAlert",!0),!1;if(-1!=s.indexOf("()"))return this.showAlert(_cruxUtils.getI18n("criteria.error.alert.brackets.invalid")),this.setData("shownAlert",!0),!1;var l=s.replace(/[()]/g,"#"),c=t.match(/[0-9]+/g);if(null!=c)for(var p=c.length,d=0;d<p;d++)if(c[d]!=d+1)return this.showAlert(_cruxUtils.getI18n("crm.criteria.number.notmatch.check",c[d])),this.setData("shownAlert",!0),!1;var h=l.replace(/[0-9]+/g,"#").replace(/#/g,"");if(h&&h.length>=1)return this.showAlert(_cruxUtils.getI18n("criteria.error.alert.other.params")),this.setData("shownAlert",!0),!1;var u=t.match(/(and|or)/gi);return r=r||Search["rowcnt"+e],u&&r-1!==u.length?(this.showAlert(_cruxUtils.getI18n("criteria.error.alert.andor.rowcount.mismatch")),this.setData("shownAlert",!0),!1):r!=l.replace(/[0-9]+/g,"$").replace(/#/g,"").length?(this.showAlert(_cruxUtils.getI18n("criteria.error.alert.critnum.rowcount.mismatch")),this.setData("shownAlert",!0),!1):t=(t=this.addSpaceBetweenParanthesis(t)).replace(/\n/g,"")},savePattern:function(t,e,r,a){t=void 0!==t?t:"";var i=e,n=a.split(" ").join("");if(!(n=this.validatePattern(n,t,i)))return!1;n.replace(new RegExp("and","g"),_cruxUtils.getI18n("and")).replace(new RegExp("or","g"),_cruxUtils.getI18n("or"));return this.updateCriteriaRowsBasedOnChangedPattern(n),n},updateCriteriaRowsBasedOnChangedPattern:function(t){for(var e=[" "],r=t.match(/(and|or)/gi),a=[" "],i=r.length,n=0;n<i;n++)e.push(r[n]),r[n]==_cruxUtils.getI18n("or")?a.push(_cruxUtils.getI18n("crm.label.or")):r[n]==_cruxUtils.getI18n("and")&&a.push(_cruxUtils.getI18n("crm.label.and"));this.setData("patternArr",e),this.setData("patternArrDis",a)},criteriaOption:function(t,e){var r=this.getData("patternArr"),a=this.getData("criteria");if("add"==t)a="("+a+r[e-1]+e+")";else if("remove"==t){var i=0,n=e+" ";a=(a=a.replace(/(and|or)/g,"#")).replace(/#/g,function(t){return++i===(1!=e?e-1:e)?"":t});var o=new RegExp(n,"g");i=0;a=(a=a.replace(o,"")).replace(/#/g,function(t){return++i<=r.length?r[i]:t});i=1;a=(a=(a=a.replace(/[0-9]/g,"#")).replace(/##/g,"#")).replace(/#/g,function(t){return i<=a.match(/#/g).length?i++:t})}else if("mod"==t){i=0;a=(a=a.replace(/(and|or)/g,"#")).replace(/#/g,function(t){return++i<=r.length?r[i]:t})}for(a=a.replace(/ /g,"");a.match(/\(\)/g,"");)a=a.replace(/\(\)/g,"");a=this.addSpaceBetweenParanthesis(a),this.setData("criteria",a),this.criteriaPatternChange()},criteriaPatternChange:function(){var t=this.getData("criteria"),e=document.querySelector(".criteriaPatternText");e&&e.ltProp("value",t)},showAlert:function(t){var e=!0;if(this.getMethods("onBeforeErrorAlert")&&(e=this.executeMethod("onBeforeErrorAlert")),e){var r=document.getElementById("patternWarning");r.ltProp("primaryMessage",t),r.ltProp("heading","Warning Alert"),r.ltProp("show",!0),this.getMethods("onErrorAlert")&&this.executeMethod("onErrorAlert")}},checkValuesCondition:function(){for(var t=this.getData("criteriaArrayObject"),e=t.length,r=1;r<e;r++){var a=t[r];if(""==a.field||"None"==a.field||null==a.field)return this.showAlert(_cruxUtils.getI18n("crm.criteria.fieldlabel.valid.check",r)),!1;if(""==a.comparator||"None"==a.comparator||null==a.field)return this.showAlert(_cruxUtils.getI18n("crm.criteria.condition.valid.check",a.field)),!1;if(""==a.value||null==a.field)return this.showAlert(_cruxUtils.getI18n("crm.field.valid.check",a.field)),!1;if(a.comparator.match(/between/)){var i=a.value.split(",");if(i[0]>i[1])return this.showAlert(_cruxUtils.getI18n("crm.custom.field.less.than.to")),!1}}return!0},getCriteria:function(){for(var t=0;t<this.getData("totalCriteria");t++)document.getElementsByTagName("crux-criteria-editor-header")[t].component.getValue();var e=this.getData("criteriaArrayObject");if(this.checkValuesCondition())if("new"==this.getData("response")){var r=e,a=this.getData("criteria");a=(a=(a=(a=a.replace(/ /g,"")).replace(/and/g,"+").replace(/or/g,"-")).replace(/[0-9]/g,"#")).replace(/##/g,"#");for(var i=[],n=[],o=[],s=(t=0,1);t<a.length;t++)if("("==a[t])i.push(a[t]);else if("+"==a[t]||"-"==a[t])n.push(a[t]);else if(")"==a[t]){if(o.length>1){i.pop();var l=[];l.push(o.pop()),l.push(o.pop()),l.reverse();var c=n.pop();"+"==c?c="and":"-"==c&&(c="or"),o.push({group_operator:c,group:l})}}else o.push(r[s++])}else{var p=0;o="["+(r=(r=(r=(r=(r=(r=this.getData("criteria")).replace(/\( /g,"[").replace(/ \)/g,"]")).replace(/ and /g,',"and",').replace(/ or /g,',"or",')).replace(/[0-9]/g,"#")).replace(/##/g,"#")).replace(/#/g,function(t){return++p<=e.length?JSON.stringify(e[p]):t}))+"]"}return o},inorder:function(t,e){return null!==t&&(null!=t.left&&(e+="("),e=this.inorder(t.left,e),e+=t.value,e=this.inorder(t.right,e),null!=t.right&&(e+=")")),e},setCriteria:function(t){Lyte.arrayUtils(this.getData("arr"),"pop");JSON.stringify(t);if("new"==this.getData("response")){var e=new function t(e,r,a){e.group_operator?(this.value=e.group_operator,r.push(e.group_operator),this.left=new t(e.group[0],r,a),this.right=new t(e.group[1],r,a)):(a.push(e),this.value=a.length,this.left=null,this.right=null),this.andOr=r,this.criteria=a}(t,[],[]);s=this.inorder(e,"");var r=e.andOr;this.setData("setCriteriaObj",e.criteria),this.setData("criteria",this.addSpaceBetweenParanthesis(s)),this.setData("totalCriteria",e.criteria.length)}else{r=t.match(/("and"|"or")/g);var a=this.getCriteriaPattern(t);this.setData("criteria",a[0]),this.setData("setCriteriaObj",a[1]),this.setData("totalCriteria",a[2])}if(null!=r)for(var i=r.length,n=0;n<i;n++)r[n]=r[n].replace(/"/g,""),r[n]==_cruxUtils.getI18n("and")?(Lyte.arrayUtils(this.getData("patternArrDis"),"push",_cruxUtils.getI18n("crm.label.and")),Lyte.arrayUtils(this.getData("patternArr"),"push",_cruxUtils.getI18n("and"))):r[n]==_cruxUtils.getI18n("or")&&(Lyte.arrayUtils(this.getData("patternArrDis"),"push",_cruxUtils.getI18n("crm.label.or")),Lyte.arrayUtils(this.getData("patternArr"),"push",_cruxUtils.getI18n("or")));for(n=0;n<this.getData("totalCriteria");n++)Lyte.arrayUtils(this.getData("arr"),"push",n+1);this.criteriaPatternChange()},addSpaceBetweenParanthesis:function(t){for(var e="",r=(t=t.replace(/\s/g,"")).length,a=0;a<r;a++){var i=t.charAt(a);"("==i||"d"==i||"r"==i?e=e+i+" ":")"==i||"a"==i||"o"==i?e=e+" "+i:e+=i}return e},setCriteriaViewObj:function(){for(var t=this.getData("setCriteriaObj"),e=[],r=t.length,a=0;a<r;a++){var i={field_label:"",condition:"",value:""},n=this.getFieldConditionValue(t[a]);i.field_label=n[0],i.condition=n[1],i.value=n[2],e.push(i)}this.setData("setCriteriaViewObj",e)},getFieldConditionValue(t){var e=t.field,r=t.comparator,a=t.value;e=(e=e.split("."))[e.length-1];for(var i=this.getData("fields"),n=i.length,o=0;o<n;o++)i[o].api_name==e&&(e=i[o].field_label,i[o].data_type);switch(selectId){case"none":select="none";break;case"text":case"email":case"phone":case"website":case"textarea":select="text";break;case"currency":case"double":case"integer":case"bigint":select="number";break;case"datetime":case"date":select="date";break;case"boolean":select="boolean";break;case"ownerlookup":select="default",this.setData("selectUser",!0);break;case"picklist":this.setData("pickList",!0),select="text",this.setData("selectedFieldPicklist",this.getData("fields")[b]);break;case"lookup":select="text",this.setData("lookup",!0);var s=field.lookup.module.api_name;store.findRecord("module",moduleRecordMapping[s].id),this.setData("callModule",s),this.setData("lookupField",field.api_name)}return a.match(/Tag/)&&(this.setData("tagComponent",!0),select="defWithEmpty",this.setData("showEmpty",!0)),a.match(/Layout/)&&(this.setData("layoutComponent",!0),select="default",this.setData("showEmpty",!0)),[e,r,a]},getFieldLabel:function(t){t=(t=t.split("."))[1];for(var e=this.getData("fields"),r=e.length,a=0;a<r;a++)if(e[a].api_name==t)return e[a].field_label;return t},getConditionValue:function(t,e){var r=t;return(e=e).match(/NOTEMPTY/)?r="is not empty":e.match(/EMPTY/)&&(r="is empty"),[r,e]},actions:{createNewCriteria:function(){var t=!0;if(this.getMethods("onBeforeAddCriteria")&&(t=this.executeMethod("onBeforeAddCriteria")),t){var e=this.getData("totalCriteria");this.getData("showEdit")?this.showAlert(_cruxUtils.getI18n("crm.alert.label.savepattern")):e>=25?this.showAlert(_cruxUtils.getI18n("crm.criteria.max.rowcnt.exceeds")):(Lyte.arrayUtils(this.getData("patternArrDis"),"push",_cruxUtils.getI18n("crm.label.and")),e+=1,Lyte.arrayUtils(this.getData("patternArr"),"push",_cruxUtils.getI18n("and")),Lyte.arrayUtils(this.getData("arr"),"push",e),this.setData("totalCriteria",e),this.criteriaOption("add",e),this.getMethods("onAddCriteria")&&this.executeMethod("onAddCriteria"))}},removeCriteria:function(t){var e=!0;if(this.getMethods("onBeforeAddCriteria")&&(e=this.executeMethod("onBeforeAddCriteria")),e){var r=this.getData("totalCriteria");this.getData("showEdit")?this.showAlert(_cruxUtils.getI18n("crm.alert.label.savepattern")):(r-=1,this.setData("totalCriteria",r),Lyte.arrayUtils(this.getData("patternArrDis"),"removeAt",1!=t?t-1:t),Lyte.arrayUtils(this.getData("patternArr"),"removeAt",1!=t?t-1:t),Lyte.arrayUtils(this.getData("arr"),"removeAt",t-1),Lyte.arrayUtils(this.getData("criteriaArrayObject"),"removeAt",t),this.criteriaOption("remove",t),this.getMethods("onDeleteCriteria")&&this.executeMethod("onDeleteCriteria"))}},openEditCriteria:function(){var t=!0;this.getMethods("onBeforeEditPattern")&&(t=this.executeMethod("onBeforeEditPattern")),t&&(this.setData("bufferCriteria",this.getData("criteria")),this.setData("showEdit",!0),this.getMethods("onEditPattern")&&this.excuteMethod("onEditPattern"))},closeEditCriteria:function(){this.setData("criteria",this.getData("bufferCriteria")),this.setData("showEdit",!1),this.criteriaPatternChange(),this.getMethods("onCancelPattern")&&this.executeMethod("onCancelPattern")},saveCriteriaPattern:function(){var t=!0;if(this.getMethods("onBeforeSavePattern")&&(t=this.executeMethod("onBeforeSavePattern")),t){var e=document.querySelector("lyte-input.criteriaPatternText"),r=e.ltProp("value"),a=this.savePattern("",this.getData("totalCriteria"),!0,r);this.getData("shownAlert")?this.setData("shownAlert",!1):(this.setData("criteria",a),e.ltProp("value",a),this.setData("showEdit",!1)),this.getMethods("onBeforeSavePattern")&&this.executeMethod("onBeforeSavePattern")}},changeAndOr:function(t,e){var r,a,i=!0;(this.getMethods("onBeforeConditionChange")&&(i=this.executeMethod("onBeforeConditionChange")),i)&&(t==_cruxUtils.getI18n("crm.label.or")?(a=_cruxUtils.getI18n("crm.label.and"),r=_cruxUtils.getI18n("and")):t==_cruxUtils.getI18n("crm.label.and")&&(r=_cruxUtils.getI18n("or"),a=_cruxUtils.getI18n("crm.label.or")),Lyte.arrayUtils(this.getData("patternArr"),"replaceAt",e-1,r),Lyte.arrayUtils(this.getData("patternArrDis"),"replaceAt",e-1,a),this.criteriaOption("mod",e),this.getMethods("onConditionChange")&&this.executeMethod("onConditionChange"))}},methods:{onBeforeFieldChangeCall:function(){var t=!0;return this.getMethods("onBeforeFieldChange")&&(t=this.executeMethod("onBeforeFieldChange")),t},onBeforeOperatorChangeCall:function(){var t=!0;return this.getMethods("onBeforeOperatorChange")&&(t=this.executeMethod("onBeforeOperatorChange")),t},onFieldChangeCall:function(){this.getMethods("onFieldChange")&&this.executeMethod("onFieldChange")},onOperatorChangeCall:function(){this.getMethods("onOperatorChange")&&this.executeMethod("onOperatorChange")},onBeforeValueChangeCall:function(){var t=!0;return this.getMethods("onBeforeValueChange")&&(t=this.executeMethod("onBeforeValueChange")),t},onValueChangeCall:function(){this.getMethods("onValueChange")&&this.executeMethod("onValueChange")},criteriaArrayObjectUpdate:function(t,e){var r=this.getData("criteriaArrayObject");r[e]=t,this.setData("criteriaArrayObject",r)}}},{mixins:["crux-criteria-util"]});